2022-10-17 14:54:35,650 - trainer - INFO - MLP(
  (linears): ModuleList(
    (0): Linear(in_features=64, out_features=128, bias=True)
    (1): Linear(in_features=128, out_features=64, bias=True)
    (2): Linear(in_features=64, out_features=32, bias=True)
  )
  (activation_layers): ModuleList(
    (0): ReLU(inplace=True)
    (1): ReLU(inplace=True)
    (2): ReLU(inplace=True)
  )
  (dropout): Dropout(p=0.0, inplace=False)
  (linear_output): Linear(in_features=32, out_features=10, bias=True)
)
2022-10-17 14:54:35,651 - trainer - INFO -   Total params: 18986
2022-10-17 14:54:35,652 - trainer - INFO -   Trainable params: 18986
2022-10-17 14:54:35,652 - trainer - INFO -   Non-trainable params: 0
2022-10-17 14:54:35,653 - trainer - INFO -   There are 1437  training examples
2022-10-17 14:54:35,654 - trainer - INFO -   There are 360 examples for development
2022-10-17 14:54:35,779 - trainer - INFO - start training epoch 1
2022-10-17 14:54:35,780 - trainer - INFO - training using device=cuda
2022-10-17 14:54:35,780 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:35,781 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:36,959 - trainer - INFO - 
*****************[epoch: 1, global step: 2] eval training set based on eval_every=2***************
2022-10-17 14:54:36,963 - trainer - INFO -               precision    recall  f1-score   support

           0       0.15      0.34      0.21        29
           1       0.00      0.00      0.00        25
           2       0.05      0.10      0.07        21
           3       0.00      0.00      0.00        28
           4       1.00      0.03      0.07        29
           5       0.00      0.00      0.00        21
           6       0.00      0.00      0.00        26
           7       0.25      0.17      0.20        30
           8       0.07      0.39      0.12        23
           9       0.00      0.00      0.00        28

    accuracy                           0.10       260
   macro avg       0.15      0.10      0.07       260
weighted avg       0.17      0.10      0.07       260

2022-10-17 14:54:36,964 - trainer - INFO - {
  "train_accuracy_score": 0.10384615384615385,
  "train_loss": 3.4735164642333984
}
2022-10-17 14:54:37,219 - trainer - INFO - 
*****************[epoch: 1, global step: 2] eval development set based on eval_every=2***************
2022-10-17 14:54:37,226 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.00      0.00      0.00        33
         1.0       0.00      0.00      0.00        42
         2.0       0.00      0.00      0.00        32
         3.0       0.00      0.00      0.00        34
         4.0       0.10      1.00      0.18        36
         5.0       0.00      0.00      0.00        40
         6.0       0.00      0.00      0.00        38
         7.0       0.00      0.00      0.00        33
         8.0       0.00      0.00      0.00        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.10       360
   macro avg       0.01      0.10      0.02       360
weighted avg       0.01      0.10      0.02       360

2022-10-17 14:54:37,228 - trainer - INFO - {
  "dev_loss": 6.151733795801799,
  "dev_accuracy": 0.1,
  "dev_best_score_for_accuracy": 0.1
}
2022-10-17 14:54:37,229 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:37,230 - trainer - INFO -    Check 0 checkpoints already saved
2022-10-17 14:54:37,230 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:37,234 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:37,234 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:37,235 - trainer - INFO -   patience: 200
2022-10-17 14:54:37,237 - trainer - INFO -    Check 0 checkpoints already saved
2022-10-17 14:54:37,238 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_2
2022-10-17 14:54:37,243 - trainer - INFO - save model to path: tmp/mlp_digits\ck_2
2022-10-17 14:54:37,303 - trainer - INFO - 
*****************[epoch: 1, global step: 4] eval training set based on eval_every=2***************
2022-10-17 14:54:37,307 - trainer - INFO -               precision    recall  f1-score   support

           0       0.19      0.37      0.25        54
           1       0.00      0.00      0.00        53
           2       0.05      0.04      0.04        53
           3       0.00      0.00      0.00        48
           4       0.07      0.31      0.12        52
           5       0.00      0.00      0.00        45
           6       0.00      0.00      0.00        64
           7       0.25      0.09      0.13        57
           8       0.07      0.20      0.10        44
           9       0.00      0.00      0.00        50

    accuracy                           0.10       520
   macro avg       0.06      0.10      0.06       520
weighted avg       0.07      0.10      0.07       520

2022-10-17 14:54:37,308 - trainer - INFO - {
  "train_accuracy_score": 0.1,
  "train_loss": 4.2257981300354
}
2022-10-17 14:54:37,636 - trainer - INFO - 
*****************[epoch: 1, global step: 4] eval development set based on eval_every=2***************
2022-10-17 14:54:37,641 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.11      0.21      0.14        33
         1.0       0.00      0.00      0.00        42
         2.0       0.80      0.25      0.38        32
         3.0       0.00      0.00      0.00        34
         4.0       0.00      0.00      0.00        36
         5.0       0.00      0.00      0.00        40
         6.0       0.11      0.45      0.18        38
         7.0       0.21      0.82      0.33        33
         8.0       0.00      0.00      0.00        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.16       360
   macro avg       0.12      0.17      0.10       360
weighted avg       0.11      0.16      0.10       360

2022-10-17 14:54:37,642 - trainer - INFO - {
  "dev_loss": 2.2866046826044717,
  "dev_accuracy": 0.1638888888888889,
  "dev_best_score_for_accuracy": 0.1638888888888889
}
2022-10-17 14:54:37,643 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:37,644 - trainer - INFO -    Check 1 checkpoints already saved
2022-10-17 14:54:37,645 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:37,649 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:37,649 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:37,650 - trainer - INFO -   patience: 200
2022-10-17 14:54:37,651 - trainer - INFO -    Check 1 checkpoints already saved
2022-10-17 14:54:37,651 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_4
2022-10-17 14:54:37,656 - trainer - INFO - save model to path: tmp/mlp_digits\ck_4
2022-10-17 14:54:37,717 - trainer - INFO - 
*****************[epoch: 1, global step: 6] eval training set based on eval_every=2***************
2022-10-17 14:54:37,723 - trainer - INFO -               precision    recall  f1-score   support

           0       0.16      0.27      0.21        73
           1       0.00      0.00      0.00        77
           2       0.15      0.09      0.11        78
           3       0.00      0.00      0.00        73
           4       0.07      0.21      0.11        78
           5       0.00      0.00      0.00        75
           6       0.18      0.12      0.15        88
           7       0.15      0.36      0.21        81
           8       0.07      0.12      0.09        75
           9       0.00      0.00      0.00        82

    accuracy                           0.12       780
   macro avg       0.08      0.12      0.09       780
weighted avg       0.08      0.12      0.09       780

2022-10-17 14:54:37,726 - trainer - INFO - {
  "train_accuracy_score": 0.11794871794871795,
  "train_loss": 2.296696901321411
}
2022-10-17 14:54:37,973 - trainer - INFO - 
*****************[epoch: 1, global step: 6] eval development set based on eval_every=2***************
2022-10-17 14:54:37,978 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.00      0.00      0.00        33
         1.0       0.00      0.00      0.00        42
         2.0       0.45      0.47      0.46        32
         3.0       0.00      0.00      0.00        34
         4.0       0.00      0.00      0.00        36
         5.0       0.68      0.38      0.48        40
         6.0       0.39      0.63      0.48        38
         7.0       0.20      0.36      0.26        33
         8.0       0.00      0.00      0.00        41
         9.0       0.13      0.74      0.22        31

    accuracy                           0.25       360
   macro avg       0.19      0.26      0.19       360
weighted avg       0.19      0.25      0.19       360

2022-10-17 14:54:37,979 - trainer - INFO - {
  "dev_loss": 2.210938493410746,
  "dev_accuracy": 0.24722222222222223,
  "dev_best_score_for_accuracy": 0.24722222222222223
}
2022-10-17 14:54:37,980 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:37,981 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:37,981 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:37,988 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:37,988 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:37,989 - trainer - INFO -   patience: 200
2022-10-17 14:54:37,990 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:37,990 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_6
2022-10-17 14:54:37,995 - trainer - INFO - save model to path: tmp/mlp_digits\ck_6
2022-10-17 14:54:38,059 - trainer - INFO - 
*****************[epoch: 1, global step: 8] eval training set based on eval_every=2***************
2022-10-17 14:54:38,065 - trainer - INFO -               precision    recall  f1-score   support

           0       0.16      0.20      0.18       100
           1       0.00      0.00      0.00       103
           2       0.25      0.15      0.19       106
           3       0.00      0.00      0.00       101
           4       0.07      0.16      0.10        98
           5       0.26      0.20      0.23       111
           6       0.22      0.15      0.18       112
           7       0.15      0.32      0.21       101
           8       0.07      0.09      0.08        98
           9       0.15      0.17      0.16       110

    accuracy                           0.15      1040
   macro avg       0.13      0.14      0.13      1040
weighted avg       0.14      0.15      0.13      1040

2022-10-17 14:54:38,067 - trainer - INFO - {
  "train_accuracy_score": 0.1451923076923077,
  "train_loss": 2.1456857919692993
}
2022-10-17 14:54:38,313 - trainer - INFO - 
*****************[epoch: 1, global step: 8] eval development set based on eval_every=2***************
2022-10-17 14:54:38,317 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.50      0.03      0.06        33
         1.0       1.00      0.10      0.17        42
         2.0       0.27      0.84      0.41        32
         3.0       0.00      0.00      0.00        34
         4.0       0.00      0.00      0.00        36
         5.0       0.19      0.97      0.32        40
         6.0       0.00      0.00      0.00        38
         7.0       0.00      0.00      0.00        33
         8.0       0.00      0.00      0.00        41
         9.0       0.19      0.29      0.23        31

    accuracy                           0.22       360
   macro avg       0.22      0.22      0.12       360
weighted avg       0.22      0.22      0.12       360

2022-10-17 14:54:38,319 - trainer - INFO - {
  "dev_loss": 2.0492982864379883,
  "dev_accuracy": 0.2222222222222222,
  "dev_best_score_for_accuracy": 0.24722222222222223
}
2022-10-17 14:54:38,319 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:38,320 - trainer - INFO -   patience: 200
2022-10-17 14:54:38,320 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:38,321 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:38,321 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_2
2022-10-17 14:54:38,322 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_8
2022-10-17 14:54:38,326 - trainer - INFO - save model to path: tmp/mlp_digits\ck_8
2022-10-17 14:54:38,402 - trainer - INFO - 
*****************[epoch: 1, global step: 10] eval training set based on eval_every=2***************
2022-10-17 14:54:38,407 - trainer - INFO -               precision    recall  f1-score   support

           0       0.16      0.15      0.16       130
           1       0.20      0.01      0.01       129
           2       0.25      0.32      0.28       133
           3       0.00      0.00      0.00       125
           4       0.07      0.13      0.09       125
           5       0.21      0.32      0.25       132
           6       0.23      0.14      0.17       128
           7       0.15      0.25      0.19       128
           8       0.07      0.07      0.07       125
           9       0.17      0.19      0.18       145

    accuracy                           0.16      1300
   macro avg       0.15      0.16      0.14      1300
weighted avg       0.15      0.16      0.14      1300

2022-10-17 14:54:38,408 - trainer - INFO - {
  "train_accuracy_score": 0.15923076923076923,
  "train_loss": 2.0176278948783875
}
2022-10-17 14:54:38,706 - trainer - INFO - 
*****************[epoch: 1, global step: 10] eval development set based on eval_every=2***************
2022-10-17 14:54:38,712 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.67      0.06      0.11        33
         1.0       0.68      0.62      0.65        42
         2.0       0.22      1.00      0.36        32
         3.0       0.08      0.03      0.04        34
         4.0       0.00      0.00      0.00        36
         5.0       0.24      0.93      0.39        40
         6.0       0.00      0.00      0.00        38
         7.0       0.00      0.00      0.00        33
         8.0       0.00      0.00      0.00        41
         9.0       0.43      0.10      0.16        31

    accuracy                           0.28       360
   macro avg       0.23      0.27      0.17       360
weighted avg       0.23      0.28      0.18       360

2022-10-17 14:54:38,713 - trainer - INFO - {
  "dev_loss": 1.813898464043935,
  "dev_accuracy": 0.28055555555555556,
  "dev_best_score_for_accuracy": 0.28055555555555556
}
2022-10-17 14:54:38,713 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:38,715 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:38,715 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:38,715 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_4
2022-10-17 14:54:38,717 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:38,720 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:38,721 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:38,721 - trainer - INFO -   patience: 200
2022-10-17 14:54:38,722 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:38,722 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_10
2022-10-17 14:54:38,727 - trainer - INFO - save model to path: tmp/mlp_digits\ck_10
2022-10-17 14:54:38,777 - trainer - INFO - 
*****************[epoch: 1, global step: 12] eval training set based on eval_every=2***************
2022-10-17 14:54:38,780 - trainer - INFO -               precision    recall  f1-score   support

           0       0.16      0.14      0.15       145
           1       0.43      0.04      0.08       140
           2       0.24      0.37      0.29       145
           3       0.00      0.00      0.00       149
           4       0.07      0.11      0.09       145
           5       0.19      0.36      0.25       142
           6       0.23      0.13      0.16       143
           7       0.15      0.22      0.18       146
           8       0.07      0.07      0.07       133
           9       0.16      0.19      0.18       149

    accuracy                           0.16      1437
   macro avg       0.17      0.16      0.14      1437
weighted avg       0.17      0.16      0.14      1437

2022-10-17 14:54:38,782 - trainer - INFO - {
  "train_accuracy_score": 0.16214335421016005,
  "train_loss": 1.9240473508834839
}
2022-10-17 14:54:39,019 - trainer - INFO - 
*****************[epoch: 1, global step: 12] eval development set based on eval_every=2***************
2022-10-17 14:54:39,023 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.52      1.00      0.69        33
         1.0       0.35      0.95      0.51        42
         2.0       0.92      0.69      0.79        32
         3.0       0.35      0.74      0.48        34
         4.0       0.00      0.00      0.00        36
         5.0       0.43      0.95      0.59        40
         6.0       0.00      0.00      0.00        38
         7.0       0.00      0.00      0.00        33
         8.0       0.00      0.00      0.00        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.44       360
   macro avg       0.26      0.43      0.31       360
weighted avg       0.25      0.44      0.30       360

2022-10-17 14:54:39,024 - trainer - INFO - {
  "dev_loss": 1.646678388118744,
  "dev_accuracy": 0.4388888888888889,
  "dev_best_score_for_accuracy": 0.4388888888888889
}
2022-10-17 14:54:39,025 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:39,026 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:39,026 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:39,026 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_6
2022-10-17 14:54:39,027 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:39,031 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:39,031 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:39,031 - trainer - INFO -   patience: 200
2022-10-17 14:54:39,032 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:39,032 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_12
2022-10-17 14:54:39,036 - trainer - INFO - save model to path: tmp/mlp_digits\ck_12
2022-10-17 14:54:39,044 - trainer - INFO - 
*****************[epoch: 1, global step: 13] eval training set at end of epoch***************
2022-10-17 14:54:39,048 - trainer - INFO -               precision    recall  f1-score   support

           0       0.16      0.14      0.15       145
           1       0.43      0.04      0.08       140
           2       0.24      0.37      0.29       145
           3       0.00      0.00      0.00       149
           4       0.07      0.11      0.09       145
           5       0.19      0.36      0.25       142
           6       0.23      0.13      0.16       143
           7       0.15      0.22      0.18       146
           8       0.07      0.07      0.07       133
           9       0.16      0.19      0.18       149

    accuracy                           0.16      1437
   macro avg       0.17      0.16      0.14      1437
weighted avg       0.17      0.16      0.14      1437

2022-10-17 14:54:39,050 - trainer - INFO - {
  "train_accuracy_score": 0.16214335421016005,
  "train_loss": 2.6805620888868966
}
2022-10-17 14:54:39,052 - trainer - INFO - start training epoch 2
2022-10-17 14:54:39,052 - trainer - INFO - training using device=cuda
2022-10-17 14:54:39,053 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:39,053 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:39,116 - trainer - INFO - 
*****************[epoch: 2, global step: 14] eval training set based on eval_every=2***************
2022-10-17 14:54:39,120 - trainer - INFO -               precision    recall  f1-score   support

           0       0.73      0.95      0.83        20
           1       0.40      0.94      0.56        31
           2       1.00      0.79      0.89        34
           3       0.45      0.97      0.62        30
           4       0.00      0.00      0.00        30
           5       0.34      1.00      0.51        24
           6       0.00      0.00      0.00        22
           7       0.00      0.00      0.00        23
           8       0.00      0.00      0.00        28
           9       0.00      0.00      0.00        18

    accuracy                           0.49       260
   macro avg       0.29      0.46      0.34       260
weighted avg       0.32      0.49      0.36       260

2022-10-17 14:54:39,121 - trainer - INFO - {
  "train_accuracy_score": 0.49230769230769234,
  "train_loss": 1.5791801810264587
}
2022-10-17 14:54:39,359 - trainer - INFO - 
*****************[epoch: 2, global step: 14] eval development set based on eval_every=2***************
2022-10-17 14:54:39,365 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.48      1.00      0.65        33
         1.0       0.49      0.79      0.60        42
         2.0       0.60      0.84      0.70        32
         3.0       0.30      0.91      0.46        34
         4.0       0.00      0.00      0.00        36
         5.0       0.50      0.93      0.65        40
         6.0       0.00      0.00      0.00        38
         7.0       0.00      0.00      0.00        33
         8.0       0.00      0.00      0.00        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.45       360
   macro avg       0.24      0.45      0.31       360
weighted avg       0.24      0.45      0.31       360

2022-10-17 14:54:39,366 - trainer - INFO - {
  "dev_loss": 1.4186800519625347,
  "dev_accuracy": 0.44722222222222224,
  "dev_best_score_for_accuracy": 0.44722222222222224
}
2022-10-17 14:54:39,366 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:39,368 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:39,368 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:39,369 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_8
2022-10-17 14:54:39,370 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:39,373 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:39,373 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:39,373 - trainer - INFO -   patience: 200
2022-10-17 14:54:39,374 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:39,374 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_14
2022-10-17 14:54:39,378 - trainer - INFO - save model to path: tmp/mlp_digits\ck_14
2022-10-17 14:54:39,441 - trainer - INFO - 
*****************[epoch: 2, global step: 16] eval training set based on eval_every=2***************
2022-10-17 14:54:39,446 - trainer - INFO -               precision    recall  f1-score   support

           0       0.55      0.98      0.70        45
           1       0.45      0.88      0.59        52
           2       0.88      0.80      0.84        61
           3       0.32      0.95      0.48        56
           4       0.00      0.00      0.00        50
           5       0.39      0.98      0.55        42
           6       0.20      0.02      0.03        57
           7       0.00      0.00      0.00        49
           8       0.00      0.00      0.00        54
           9       0.00      0.00      0.00        54

    accuracy                           0.45       520
   macro avg       0.28      0.46      0.32       520
weighted avg       0.28      0.45      0.32       520

2022-10-17 14:54:39,447 - trainer - INFO - {
  "train_accuracy_score": 0.45,
  "train_loss": 1.5033965110778809
}
2022-10-17 14:54:39,755 - trainer - INFO - 
*****************[epoch: 2, global step: 16] eval development set based on eval_every=2***************
2022-10-17 14:54:39,760 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.63      1.00      0.78        33
         1.0       0.62      0.79      0.69        42
         2.0       0.65      0.88      0.75        32
         3.0       0.45      0.88      0.59        34
         4.0       0.88      0.19      0.32        36
         5.0       0.56      0.97      0.71        40
         6.0       0.55      0.29      0.38        38
         7.0       0.44      0.61      0.51        33
         8.0       0.50      0.02      0.05        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.56       360
   macro avg       0.53      0.56      0.48       360
weighted avg       0.54      0.56      0.48       360

2022-10-17 14:54:39,761 - trainer - INFO - {
  "dev_loss": 1.1316024561723073,
  "dev_accuracy": 0.5611111111111111,
  "dev_best_score_for_accuracy": 0.5611111111111111
}
2022-10-17 14:54:39,761 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:39,762 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:39,762 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:39,763 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_10
2022-10-17 14:54:39,764 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:39,769 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:39,769 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:39,769 - trainer - INFO -   patience: 200
2022-10-17 14:54:39,770 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:39,770 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_16
2022-10-17 14:54:39,775 - trainer - INFO - save model to path: tmp/mlp_digits\ck_16
2022-10-17 14:54:39,838 - trainer - INFO - 
*****************[epoch: 2, global step: 18] eval training set based on eval_every=2***************
2022-10-17 14:54:39,843 - trainer - INFO -               precision    recall  f1-score   support

           0       0.61      0.96      0.75        72
           1       0.49      0.85      0.62        81
           2       0.83      0.84      0.84        82
           3       0.36      0.90      0.51        80
           4       0.70      0.09      0.16        78
           5       0.47      0.96      0.63        77
           6       0.43      0.14      0.21        84
           7       0.40      0.24      0.30        71
           8       0.00      0.00      0.00        79
           9       0.50      0.01      0.03        76

    accuracy                           0.50       780
   macro avg       0.48      0.50      0.40       780
weighted avg       0.48      0.50      0.40       780

2022-10-17 14:54:39,844 - trainer - INFO - {
  "train_accuracy_score": 0.5,
  "train_loss": 1.1235391199588776
}
2022-10-17 14:54:40,087 - trainer - INFO - 
*****************[epoch: 2, global step: 18] eval development set based on eval_every=2***************
2022-10-17 14:54:40,091 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.70      1.00      0.82        33
         1.0       0.75      0.90      0.82        42
         2.0       1.00      0.81      0.90        32
         3.0       0.83      0.29      0.43        34
         4.0       0.78      0.50      0.61        36
         5.0       0.80      1.00      0.89        40
         6.0       0.88      0.76      0.82        38
         7.0       0.51      0.91      0.65        33
         8.0       0.80      0.39      0.52        41
         9.0       0.54      0.68      0.60        31

    accuracy                           0.73       360
   macro avg       0.76      0.73      0.71       360
weighted avg       0.76      0.72      0.71       360

2022-10-17 14:54:40,092 - trainer - INFO - {
  "dev_loss": 0.9225529829661051,
  "dev_accuracy": 0.725,
  "dev_best_score_for_accuracy": 0.725
}
2022-10-17 14:54:40,092 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:40,094 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:40,094 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:40,094 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_12
2022-10-17 14:54:40,095 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:40,099 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:40,099 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:40,099 - trainer - INFO -   patience: 200
2022-10-17 14:54:40,100 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:40,100 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_18
2022-10-17 14:54:40,104 - trainer - INFO - save model to path: tmp/mlp_digits\ck_18
2022-10-17 14:54:40,171 - trainer - INFO - 
*****************[epoch: 2, global step: 20] eval training set based on eval_every=2***************
2022-10-17 14:54:40,174 - trainer - INFO -               precision    recall  f1-score   support

           0       0.64      0.94      0.76        97
           1       0.52      0.83      0.64       102
           2       0.86      0.82      0.84       107
           3       0.37      0.68      0.48       111
           4       0.67      0.17      0.28       103
           5       0.52      0.93      0.67       103
           6       0.57      0.32      0.41       117
           7       0.59      0.45      0.51       104
           8       0.45      0.05      0.09        96
           9       0.43      0.24      0.31       100

    accuracy                           0.55      1040
   macro avg       0.56      0.55      0.50      1040
weighted avg       0.56      0.55      0.50      1040

2022-10-17 14:54:40,176 - trainer - INFO - {
  "train_accuracy_score": 0.5461538461538461,
  "train_loss": 0.9425432085990906
}
2022-10-17 14:54:40,418 - trainer - INFO - 
*****************[epoch: 2, global step: 20] eval development set based on eval_every=2***************
2022-10-17 14:54:40,422 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.80      0.85      0.82        33
         1.0       0.94      0.71      0.81        42
         2.0       0.90      0.88      0.89        32
         3.0       0.76      0.65      0.70        34
         4.0       0.95      0.56      0.70        36
         5.0       0.92      0.85      0.88        40
         6.0       0.62      0.95      0.75        38
         7.0       0.67      0.91      0.77        33
         8.0       0.71      0.66      0.68        41
         9.0       0.62      0.68      0.65        31

    accuracy                           0.77       360
   macro avg       0.79      0.77      0.77       360
weighted avg       0.79      0.77      0.77       360

2022-10-17 14:54:40,423 - trainer - INFO - {
  "dev_loss": 0.7203723986943563,
  "dev_accuracy": 0.7666666666666667,
  "dev_best_score_for_accuracy": 0.7666666666666667
}
2022-10-17 14:54:40,423 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:40,425 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:40,425 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:40,425 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_14
2022-10-17 14:54:40,426 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:40,430 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:40,430 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:40,431 - trainer - INFO -   patience: 200
2022-10-17 14:54:40,435 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:40,435 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_20
2022-10-17 14:54:40,439 - trainer - INFO - save model to path: tmp/mlp_digits\ck_20
2022-10-17 14:54:40,500 - trainer - INFO - 
*****************[epoch: 2, global step: 22] eval training set based on eval_every=2***************
2022-10-17 14:54:40,504 - trainer - INFO -               precision    recall  f1-score   support

           0       0.67      0.92      0.77       130
           1       0.56      0.82      0.66       131
           2       0.86      0.82      0.84       131
           3       0.40      0.70      0.51       135
           4       0.74      0.25      0.37       130
           5       0.57      0.94      0.71       124
           6       0.59      0.41      0.48       133
           7       0.65      0.53      0.59       132
           8       0.57      0.17      0.26       123
           9       0.53      0.34      0.41       131

    accuracy                           0.59      1300
   macro avg       0.61      0.59      0.56      1300
weighted avg       0.61      0.59      0.56      1300

2022-10-17 14:54:40,505 - trainer - INFO - {
  "train_accuracy_score": 0.5884615384615385,
  "train_loss": 0.7093251645565033
}
2022-10-17 14:54:40,769 - trainer - INFO - 
*****************[epoch: 2, global step: 22] eval development set based on eval_every=2***************
2022-10-17 14:54:40,772 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.82      1.00      0.90        33
         1.0       0.95      0.83      0.89        42
         2.0       0.67      0.94      0.78        32
         3.0       0.56      0.56      0.56        34
         4.0       0.93      0.78      0.85        36
         5.0       0.96      0.65      0.78        40
         6.0       0.92      0.89      0.91        38
         7.0       0.78      0.88      0.83        33
         8.0       0.55      0.80      0.65        41
         9.0       0.92      0.39      0.55        31

    accuracy                           0.78       360
   macro avg       0.81      0.77      0.77       360
weighted avg       0.81      0.78      0.77       360

2022-10-17 14:54:40,773 - trainer - INFO - {
  "dev_loss": 0.7559696237246195,
  "dev_accuracy": 0.775,
  "dev_best_score_for_accuracy": 0.775
}
2022-10-17 14:54:40,774 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:40,775 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:40,775 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:40,775 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_16
2022-10-17 14:54:40,777 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:40,780 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:40,780 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:40,780 - trainer - INFO -   patience: 200
2022-10-17 14:54:40,781 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:40,781 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_22
2022-10-17 14:54:40,785 - trainer - INFO - save model to path: tmp/mlp_digits\ck_22
2022-10-17 14:54:40,870 - trainer - INFO - 
*****************[epoch: 2, global step: 24] eval training set based on eval_every=2***************
2022-10-17 14:54:40,874 - trainer - INFO -               precision    recall  f1-score   support

           0       0.69      0.92      0.79       145
           1       0.57      0.83      0.67       140
           2       0.83      0.83      0.83       145
           3       0.40      0.66      0.50       149
           4       0.79      0.32      0.45       145
           5       0.59      0.91      0.72       142
           6       0.62      0.44      0.52       143
           7       0.67      0.55      0.61       146
           8       0.50      0.22      0.30       133
           9       0.57      0.36      0.44       149

    accuracy                           0.61      1437
   macro avg       0.62      0.60      0.58      1437
weighted avg       0.62      0.61      0.58      1437

2022-10-17 14:54:40,875 - trainer - INFO - {
  "train_accuracy_score": 0.605427974947808,
  "train_loss": 0.5273425877094269
}
2022-10-17 14:54:41,115 - trainer - INFO - 
*****************[epoch: 2, global step: 24] eval development set based on eval_every=2***************
2022-10-17 14:54:41,120 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.66      1.00      0.80        33
         1.0       0.97      0.71      0.82        42
         2.0       0.91      0.91      0.91        32
         3.0       0.75      0.53      0.62        34
         4.0       0.86      0.86      0.86        36
         5.0       0.44      0.97      0.61        40
         6.0       0.80      0.42      0.55        38
         7.0       0.89      0.76      0.82        33
         8.0       0.60      0.07      0.13        41
         9.0       0.33      0.48      0.39        31

    accuracy                           0.66       360
   macro avg       0.72      0.67      0.65       360
weighted avg       0.72      0.66      0.64       360

2022-10-17 14:54:41,121 - trainer - INFO - {
  "dev_loss": 1.287818153699239,
  "dev_accuracy": 0.6638888888888889,
  "dev_best_score_for_accuracy": 0.775
}
2022-10-17 14:54:41,122 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:41,122 - trainer - INFO -   patience: 200
2022-10-17 14:54:41,123 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:41,124 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:41,124 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_18
2022-10-17 14:54:41,125 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_24
2022-10-17 14:54:41,129 - trainer - INFO - save model to path: tmp/mlp_digits\ck_24
2022-10-17 14:54:41,130 - trainer - INFO - 
*****************[epoch: 2, global step: 25] eval training set at end of epoch***************
2022-10-17 14:54:41,135 - trainer - INFO -               precision    recall  f1-score   support

           0       0.69      0.92      0.79       145
           1       0.57      0.83      0.67       140
           2       0.83      0.83      0.83       145
           3       0.40      0.66      0.50       149
           4       0.79      0.32      0.45       145
           5       0.59      0.91      0.72       142
           6       0.62      0.44      0.52       143
           7       0.67      0.55      0.61       146
           8       0.50      0.22      0.30       133
           9       0.57      0.36      0.44       149

    accuracy                           0.61      1437
   macro avg       0.62      0.60      0.58      1437
weighted avg       0.62      0.61      0.58      1437

2022-10-17 14:54:41,136 - trainer - INFO - {
  "train_accuracy_score": 0.605427974947808,
  "train_loss": 1.064221128821373
}
2022-10-17 14:54:41,137 - trainer - INFO - start training epoch 3
2022-10-17 14:54:41,137 - trainer - INFO - training using device=cuda
2022-10-17 14:54:41,138 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:41,138 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:41,198 - trainer - INFO - 
*****************[epoch: 3, global step: 26] eval training set based on eval_every=2***************
2022-10-17 14:54:41,201 - trainer - INFO -               precision    recall  f1-score   support

           0       0.89      0.89      0.89        28
           1       0.83      0.70      0.76        27
           2       0.82      0.92      0.87        25
           3       0.77      0.53      0.63        32
           4       0.71      0.88      0.79        25
           5       0.70      1.00      0.82        30
           6       0.75      0.35      0.48        17
           7       0.68      0.82      0.74        28
           8       0.67      0.20      0.31        20
           9       0.51      0.68      0.58        28

    accuracy                           0.72       260
   macro avg       0.73      0.70      0.69       260
weighted avg       0.73      0.72      0.70       260

2022-10-17 14:54:41,202 - trainer - INFO - {
  "train_accuracy_score": 0.7230769230769231,
  "train_loss": 0.812629759311676
}
2022-10-17 14:54:41,468 - trainer - INFO - 
*****************[epoch: 3, global step: 26] eval development set based on eval_every=2***************
2022-10-17 14:54:41,471 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      0.88      0.91        33
         1.0       0.83      0.81      0.82        42
         2.0       0.81      0.91      0.85        32
         3.0       0.51      0.85      0.64        34
         4.0       0.82      0.92      0.87        36
         5.0       0.94      0.80      0.86        40
         6.0       0.88      0.92      0.90        38
         7.0       0.59      0.97      0.74        33
         8.0       0.84      0.39      0.53        41
         9.0       1.00      0.26      0.41        31

    accuracy                           0.77       360
   macro avg       0.82      0.77      0.75       360
weighted avg       0.82      0.77      0.76       360

2022-10-17 14:54:41,472 - trainer - INFO - {
  "dev_loss": 0.7334802647431692,
  "dev_accuracy": 0.7694444444444445,
  "dev_best_score_for_accuracy": 0.775
}
2022-10-17 14:54:41,473 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:41,473 - trainer - INFO -   patience: 200
2022-10-17 14:54:41,474 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:41,474 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:41,475 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_20
2022-10-17 14:54:41,476 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_26
2022-10-17 14:54:41,480 - trainer - INFO - save model to path: tmp/mlp_digits\ck_26
2022-10-17 14:54:41,554 - trainer - INFO - 
*****************[epoch: 3, global step: 28] eval training set based on eval_every=2***************
2022-10-17 14:54:41,557 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.88      0.91        58
           1       0.64      0.79      0.71        48
           2       0.88      0.92      0.90        53
           3       0.66      0.68      0.67        60
           4       0.77      0.77      0.77        52
           5       0.78      0.94      0.86        54
           6       0.78      0.67      0.72        42
           7       0.74      0.89      0.81        54
           8       0.77      0.41      0.53        49
           9       0.56      0.50      0.53        50

    accuracy                           0.75       520
   macro avg       0.75      0.75      0.74       520
weighted avg       0.75      0.75      0.74       520

2022-10-17 14:54:41,558 - trainer - INFO - {
  "train_accuracy_score": 0.7519230769230769,
  "train_loss": 0.6416665613651276
}
2022-10-17 14:54:41,810 - trainer - INFO - 
*****************[epoch: 3, global step: 28] eval development set based on eval_every=2***************
2022-10-17 14:54:41,814 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.91      0.95        33
         1.0       0.88      0.90      0.89        42
         2.0       1.00      0.94      0.97        32
         3.0       0.83      0.88      0.86        34
         4.0       0.81      0.97      0.89        36
         5.0       0.97      0.75      0.85        40
         6.0       0.73      0.97      0.83        38
         7.0       0.85      0.85      0.85        33
         8.0       0.79      0.83      0.81        41
         9.0       0.95      0.61      0.75        31

    accuracy                           0.86       360
   macro avg       0.88      0.86      0.86       360
weighted avg       0.88      0.86      0.86       360

2022-10-17 14:54:41,815 - trainer - INFO - {
  "dev_loss": 0.5918783148129781,
  "dev_accuracy": 0.8638888888888889,
  "dev_best_score_for_accuracy": 0.8638888888888889
}
2022-10-17 14:54:41,816 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:41,817 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:41,817 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:41,817 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_22
2022-10-17 14:54:41,819 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:41,822 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:41,822 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:41,822 - trainer - INFO -   patience: 200
2022-10-17 14:54:41,823 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:41,823 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_28
2022-10-17 14:54:41,828 - trainer - INFO - save model to path: tmp/mlp_digits\ck_28
2022-10-17 14:54:41,950 - trainer - INFO - 
*****************[epoch: 3, global step: 30] eval training set based on eval_every=2***************
2022-10-17 14:54:41,953 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.90      0.93        78
           1       0.70      0.76      0.73        75
           2       0.92      0.95      0.93        80
           3       0.72      0.73      0.73        89
           4       0.77      0.80      0.79        76
           5       0.81      0.93      0.86        68
           6       0.82      0.80      0.81        79
           7       0.77      0.89      0.83        83
           8       0.62      0.45      0.52        69
           9       0.67      0.59      0.63        83

    accuracy                           0.78       780
   macro avg       0.78      0.78      0.78       780
weighted avg       0.78      0.78      0.78       780

2022-10-17 14:54:41,954 - trainer - INFO - {
  "train_accuracy_score": 0.7807692307692308,
  "train_loss": 0.5249018371105194
}
2022-10-17 14:54:42,208 - trainer - INFO - 
*****************[epoch: 3, global step: 30] eval development set based on eval_every=2***************
2022-10-17 14:54:42,211 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       1.00      0.69      0.82        42
         2.0       0.96      0.78      0.86        32
         3.0       0.81      0.62      0.70        34
         4.0       0.77      0.83      0.80        36
         5.0       0.97      0.78      0.86        40
         6.0       0.78      0.95      0.86        38
         7.0       0.86      0.76      0.81        33
         8.0       0.74      0.98      0.84        41
         9.0       0.59      0.77      0.67        31

    accuracy                           0.82       360
   macro avg       0.83      0.82      0.81       360
weighted avg       0.84      0.82      0.82       360

2022-10-17 14:54:42,212 - trainer - INFO - {
  "dev_loss": 0.617059737443924,
  "dev_accuracy": 0.8166666666666667,
  "dev_best_score_for_accuracy": 0.8638888888888889
}
2022-10-17 14:54:42,213 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:42,214 - trainer - INFO -   patience: 200
2022-10-17 14:54:42,216 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:42,219 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:42,219 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_24
2022-10-17 14:54:42,220 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_30
2022-10-17 14:54:42,225 - trainer - INFO - save model to path: tmp/mlp_digits\ck_30
2022-10-17 14:54:42,287 - trainer - INFO - 
*****************[epoch: 3, global step: 32] eval training set based on eval_every=2***************
2022-10-17 14:54:42,292 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.90      0.92       104
           1       0.76      0.76      0.76       103
           2       0.92      0.91      0.92       113
           3       0.74      0.71      0.72       114
           4       0.80      0.81      0.80       106
           5       0.85      0.93      0.89        95
           6       0.81      0.82      0.81        99
           7       0.79      0.84      0.81       106
           8       0.57      0.54      0.55        95
           9       0.66      0.64      0.65       105

    accuracy                           0.79      1040
   macro avg       0.78      0.79      0.78      1040
weighted avg       0.78      0.79      0.79      1040

2022-10-17 14:54:42,293 - trainer - INFO - {
  "train_accuracy_score": 0.7865384615384615,
  "train_loss": 0.7066271603107452
}
2022-10-17 14:54:42,555 - trainer - INFO - 
*****************[epoch: 3, global step: 32] eval development set based on eval_every=2***************
2022-10-17 14:54:42,559 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.55      0.86      0.67        42
         2.0       0.75      0.94      0.83        32
         3.0       1.00      0.74      0.85        34
         4.0       0.83      0.94      0.88        36
         5.0       0.94      0.85      0.89        40
         6.0       0.73      0.29      0.42        38
         7.0       0.83      0.73      0.77        33
         8.0       0.65      0.85      0.74        41
         9.0       0.89      0.55      0.68        31

    accuracy                           0.78       360
   macro avg       0.81      0.77      0.77       360
weighted avg       0.80      0.78      0.77       360

2022-10-17 14:54:42,560 - trainer - INFO - {
  "dev_loss": 0.6197005361318588,
  "dev_accuracy": 0.775,
  "dev_best_score_for_accuracy": 0.8638888888888889
}
2022-10-17 14:54:42,560 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:42,561 - trainer - INFO -   patience: 200
2022-10-17 14:54:42,562 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:42,563 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:42,563 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_26
2022-10-17 14:54:42,564 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_32
2022-10-17 14:54:42,569 - trainer - INFO - save model to path: tmp/mlp_digits\ck_32
2022-10-17 14:54:42,636 - trainer - INFO - 
*****************[epoch: 3, global step: 34] eval training set based on eval_every=2***************
2022-10-17 14:54:42,640 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.92      0.93       132
           1       0.73      0.78      0.75       127
           2       0.88      0.92      0.90       131
           3       0.77      0.71      0.74       140
           4       0.83      0.83      0.83       133
           5       0.87      0.92      0.89       122
           6       0.80      0.78      0.79       124
           7       0.82      0.84      0.83       133
           8       0.61      0.61      0.61       126
           9       0.71      0.64      0.67       132

    accuracy                           0.80      1300
   macro avg       0.79      0.80      0.79      1300
weighted avg       0.79      0.80      0.79      1300

2022-10-17 14:54:42,642 - trainer - INFO - {
  "train_accuracy_score": 0.7953846153846154,
  "train_loss": 0.5675260722637177
}
2022-10-17 14:54:42,932 - trainer - INFO - 
*****************[epoch: 3, global step: 34] eval development set based on eval_every=2***************
2022-10-17 14:54:42,935 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.93      0.95        42
         2.0       0.86      0.94      0.90        32
         3.0       0.96      0.74      0.83        34
         4.0       0.85      0.97      0.91        36
         5.0       0.86      0.95      0.90        40
         6.0       0.94      0.84      0.89        38
         7.0       0.79      0.91      0.85        33
         8.0       0.78      0.88      0.83        41
         9.0       0.90      0.61      0.73        31

    accuracy                           0.88       360
   macro avg       0.89      0.88      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:54:42,936 - trainer - INFO - {
  "dev_loss": 0.4024764498074849,
  "dev_accuracy": 0.8805555555555555,
  "dev_best_score_for_accuracy": 0.8805555555555555
}
2022-10-17 14:54:42,936 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:42,937 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:42,937 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:42,938 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_28
2022-10-17 14:54:42,939 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:42,942 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:42,942 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:42,944 - trainer - INFO -   patience: 200
2022-10-17 14:54:42,945 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:42,949 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_34
2022-10-17 14:54:42,955 - trainer - INFO - save model to path: tmp/mlp_digits\ck_34
2022-10-17 14:54:43,001 - trainer - INFO - 
*****************[epoch: 3, global step: 36] eval training set based on eval_every=2***************
2022-10-17 14:54:43,007 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.92      0.93       145
           1       0.73      0.80      0.76       140
           2       0.89      0.92      0.91       145
           3       0.78      0.72      0.75       149
           4       0.84      0.85      0.85       145
           5       0.86      0.92      0.89       142
           6       0.82      0.78      0.80       143
           7       0.84      0.84      0.84       146
           8       0.60      0.62      0.61       133
           9       0.72      0.64      0.68       149

    accuracy                           0.80      1437
   macro avg       0.80      0.80      0.80      1437
weighted avg       0.80      0.80      0.80      1437

2022-10-17 14:54:43,009 - trainer - INFO - {
  "train_accuracy_score": 0.8030619345859429,
  "train_loss": 0.3147531524300575
}
2022-10-17 14:54:43,257 - trainer - INFO - 
*****************[epoch: 3, global step: 36] eval development set based on eval_every=2***************
2022-10-17 14:54:43,262 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.94      0.95        33
         1.0       1.00      0.74      0.85        42
         2.0       0.94      0.94      0.94        32
         3.0       0.81      0.74      0.77        34
         4.0       0.52      1.00      0.69        36
         5.0       0.97      0.72      0.83        40
         6.0       0.69      0.47      0.56        38
         7.0       0.65      0.91      0.76        33
         8.0       0.74      0.78      0.76        41
         9.0       0.80      0.52      0.63        31

    accuracy                           0.77       360
   macro avg       0.81      0.78      0.77       360
weighted avg       0.81      0.77      0.77       360

2022-10-17 14:54:43,263 - trainer - INFO - {
  "dev_loss": 0.6833949685096741,
  "dev_accuracy": 0.7722222222222223,
  "dev_best_score_for_accuracy": 0.8805555555555555
}
2022-10-17 14:54:43,264 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:43,264 - trainer - INFO -   patience: 200
2022-10-17 14:54:43,265 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:43,266 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:43,266 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_30
2022-10-17 14:54:43,268 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_36
2022-10-17 14:54:43,273 - trainer - INFO - save model to path: tmp/mlp_digits\ck_36
2022-10-17 14:54:43,274 - trainer - INFO - 
*****************[epoch: 3, global step: 37] eval training set at end of epoch***************
2022-10-17 14:54:43,279 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.92      0.93       145
           1       0.73      0.80      0.76       140
           2       0.89      0.92      0.91       145
           3       0.78      0.72      0.75       149
           4       0.84      0.85      0.85       145
           5       0.86      0.92      0.89       142
           6       0.82      0.78      0.80       143
           7       0.84      0.84      0.84       146
           8       0.60      0.62      0.61       133
           9       0.72      0.64      0.68       149

    accuracy                           0.80      1437
   macro avg       0.80      0.80      0.80      1437
weighted avg       0.80      0.80      0.80      1437

2022-10-17 14:54:43,281 - trainer - INFO - {
  "train_accuracy_score": 0.8030619345859429,
  "train_loss": 0.5946840904653072
}
2022-10-17 14:54:43,282 - trainer - INFO - start training epoch 4
2022-10-17 14:54:43,283 - trainer - INFO - training using device=cuda
2022-10-17 14:54:43,284 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:43,287 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:43,354 - trainer - INFO - 
*****************[epoch: 4, global step: 38] eval training set based on eval_every=2***************
2022-10-17 14:54:43,356 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      0.91      0.93        23
           1       0.89      0.86      0.87        28
           2       0.96      0.88      0.92        25
           3       0.96      0.92      0.94        26
           4       0.67      0.97      0.79        31
           5       1.00      0.83      0.90        23
           6       0.83      0.65      0.73        31
           7       0.67      1.00      0.80        18
           8       0.77      0.68      0.72        34
           9       1.00      0.86      0.92        21

    accuracy                           0.84       260
   macro avg       0.87      0.85      0.85       260
weighted avg       0.86      0.84      0.84       260

2022-10-17 14:54:43,357 - trainer - INFO - {
  "train_accuracy_score": 0.8423076923076923,
  "train_loss": 0.504624217748642
}
2022-10-17 14:54:43,613 - trainer - INFO - 
*****************[epoch: 4, global step: 38] eval development set based on eval_every=2***************
2022-10-17 14:54:43,616 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.91      0.97      0.94        33
         1.0       1.00      0.62      0.76        42
         2.0       0.94      0.94      0.94        32
         3.0       0.76      0.82      0.79        34
         4.0       0.97      0.83      0.90        36
         5.0       1.00      0.68      0.81        40
         6.0       0.59      1.00      0.75        38
         7.0       0.70      0.91      0.79        33
         8.0       0.84      0.90      0.87        41
         9.0       0.76      0.52      0.62        31

    accuracy                           0.82       360
   macro avg       0.85      0.82      0.82       360
weighted avg       0.85      0.82      0.82       360

2022-10-17 14:54:43,617 - trainer - INFO - {
  "dev_loss": 0.5868585209051768,
  "dev_accuracy": 0.8166666666666667,
  "dev_best_score_for_accuracy": 0.8805555555555555
}
2022-10-17 14:54:43,617 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:43,618 - trainer - INFO -   patience: 200
2022-10-17 14:54:43,619 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:43,619 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:43,619 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_32
2022-10-17 14:54:43,621 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_38
2022-10-17 14:54:43,626 - trainer - INFO - save model to path: tmp/mlp_digits\ck_38
2022-10-17 14:54:43,696 - trainer - INFO - 
*****************[epoch: 4, global step: 40] eval training set based on eval_every=2***************
2022-10-17 14:54:43,699 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.94      0.95        52
           1       0.91      0.79      0.85        53
           2       0.91      0.91      0.91        46
           3       0.93      0.88      0.91        49
           4       0.74      0.80      0.77        56
           5       1.00      0.83      0.91        53
           6       0.67      0.79      0.72        58
           7       0.76      1.00      0.87        52
           8       0.78      0.71      0.74        51
           9       0.93      0.80      0.86        50

    accuracy                           0.84       520
   macro avg       0.86      0.85      0.85       520
weighted avg       0.86      0.84      0.85       520

2022-10-17 14:54:43,700 - trainer - INFO - {
  "train_accuracy_score": 0.8442307692307692,
  "train_loss": 0.48323601484298706
}
2022-10-17 14:54:44,013 - trainer - INFO - 
*****************[epoch: 4, global step: 40] eval development set based on eval_every=2***************
2022-10-17 14:54:44,019 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.82      1.00      0.90        33
         1.0       1.00      0.79      0.88        42
         2.0       0.97      0.94      0.95        32
         3.0       0.64      0.94      0.76        34
         4.0       1.00      0.50      0.67        36
         5.0       1.00      0.75      0.86        40
         6.0       0.73      1.00      0.84        38
         7.0       0.73      0.73      0.73        33
         8.0       0.85      0.68      0.76        41
         9.0       0.68      0.87      0.76        31

    accuracy                           0.81       360
   macro avg       0.84      0.82      0.81       360
weighted avg       0.85      0.81      0.81       360

2022-10-17 14:54:44,020 - trainer - INFO - {
  "dev_loss": 0.6013860901196798,
  "dev_accuracy": 0.8138888888888889,
  "dev_best_score_for_accuracy": 0.8805555555555555
}
2022-10-17 14:54:44,021 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:44,021 - trainer - INFO -   patience: 200
2022-10-17 14:54:44,023 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:44,023 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:44,023 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_34
2022-10-17 14:54:44,025 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_40
2022-10-17 14:54:44,030 - trainer - INFO - save model to path: tmp/mlp_digits\ck_40
2022-10-17 14:54:44,092 - trainer - INFO - 
*****************[epoch: 4, global step: 42] eval training set based on eval_every=2***************
2022-10-17 14:54:44,096 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.95      0.94        79
           1       0.90      0.74      0.81        73
           2       0.92      0.94      0.93        65
           3       0.85      0.89      0.87        79
           4       0.78      0.74      0.76        76
           5       1.00      0.82      0.90        80
           6       0.69      0.85      0.77        88
           7       0.81      0.95      0.87        84
           8       0.79      0.76      0.77        74
           9       0.87      0.80      0.84        82

    accuracy                           0.84       780
   macro avg       0.86      0.84      0.85       780
weighted avg       0.85      0.84      0.85       780

2022-10-17 14:54:44,097 - trainer - INFO - {
  "train_accuracy_score": 0.8448717948717949,
  "train_loss": 0.454006090760231
}
2022-10-17 14:54:44,368 - trainer - INFO - 
*****************[epoch: 4, global step: 42] eval development set based on eval_every=2***************
2022-10-17 14:54:44,372 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.80      1.00      0.89        33
         1.0       0.72      1.00      0.84        42
         2.0       0.97      0.94      0.95        32
         3.0       0.96      0.76      0.85        34
         4.0       1.00      0.78      0.88        36
         5.0       0.82      0.93      0.87        40
         6.0       0.82      0.95      0.88        38
         7.0       0.97      0.88      0.92        33
         8.0       0.90      0.46      0.61        41
         9.0       0.71      0.81      0.76        31

    accuracy                           0.85       360
   macro avg       0.87      0.85      0.85       360
weighted avg       0.87      0.85      0.84       360

2022-10-17 14:54:44,373 - trainer - INFO - {
  "dev_loss": 0.5409469405810038,
  "dev_accuracy": 0.8472222222222222,
  "dev_best_score_for_accuracy": 0.8805555555555555
}
2022-10-17 14:54:44,374 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:54:44,374 - trainer - INFO -   patience: 200
2022-10-17 14:54:44,376 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:44,376 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:44,376 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_36
2022-10-17 14:54:44,378 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_42
2022-10-17 14:54:44,384 - trainer - INFO - save model to path: tmp/mlp_digits\ck_42
2022-10-17 14:54:44,449 - trainer - INFO - 
*****************[epoch: 4, global step: 44] eval training set based on eval_every=2***************
2022-10-17 14:54:44,453 - trainer - INFO -               precision    recall  f1-score   support

           0       0.93      0.96      0.95       103
           1       0.86      0.79      0.83        96
           2       0.95      0.94      0.95       107
           3       0.88      0.83      0.85       105
           4       0.83      0.71      0.76       107
           5       0.93      0.86      0.89        99
           6       0.70      0.88      0.78       109
           7       0.82      0.95      0.88       107
           8       0.78      0.73      0.75       100
           9       0.82      0.79      0.80       107

    accuracy                           0.85      1040
   macro avg       0.85      0.84      0.84      1040
weighted avg       0.85      0.85      0.84      1040

2022-10-17 14:54:44,455 - trainer - INFO - {
  "train_accuracy_score": 0.8451923076923077,
  "train_loss": 0.6194064617156982
}
2022-10-17 14:54:44,749 - trainer - INFO - 
*****************[epoch: 4, global step: 44] eval development set based on eval_every=2***************
2022-10-17 14:54:44,752 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.97      0.88      0.93        42
         2.0       0.94      0.94      0.94        32
         3.0       0.91      0.88      0.90        34
         4.0       0.94      0.89      0.91        36
         5.0       0.97      0.85      0.91        40
         6.0       0.90      0.95      0.92        38
         7.0       0.94      0.94      0.94        33
         8.0       0.75      0.98      0.85        41
         9.0       0.92      0.74      0.82        31

    accuracy                           0.91       360
   macro avg       0.91      0.90      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:54:44,753 - trainer - INFO - {
  "dev_loss": 0.38088491310675937,
  "dev_accuracy": 0.9055555555555556,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:44,754 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:44,755 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:44,755 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:44,757 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_38
2022-10-17 14:54:44,759 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:44,764 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:44,765 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:44,765 - trainer - INFO -   patience: 200
2022-10-17 14:54:44,766 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:44,766 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_44
2022-10-17 14:54:44,771 - trainer - INFO - save model to path: tmp/mlp_digits\ck_44
2022-10-17 14:54:44,848 - trainer - INFO - 
*****************[epoch: 4, global step: 46] eval training set based on eval_every=2***************
2022-10-17 14:54:44,853 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.96      0.95       129
           1       0.88      0.76      0.82       122
           2       0.95      0.95      0.95       132
           3       0.89      0.84      0.86       132
           4       0.82      0.73      0.78       132
           5       0.95      0.87      0.91       134
           6       0.73      0.86      0.79       129
           7       0.84      0.96      0.90       130
           8       0.71      0.78      0.74       125
           9       0.84      0.78      0.81       135

    accuracy                           0.85      1300
   macro avg       0.85      0.85      0.85      1300
weighted avg       0.85      0.85      0.85      1300

2022-10-17 14:54:44,854 - trainer - INFO - {
  "train_accuracy_score": 0.85,
  "train_loss": 0.3975321426987648
}
2022-10-17 14:54:45,174 - trainer - INFO - 
*****************[epoch: 4, global step: 46] eval development set based on eval_every=2***************
2022-10-17 14:54:45,177 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       1.00      0.76      0.86        42
         2.0       0.86      0.94      0.90        32
         3.0       0.86      0.91      0.89        34
         4.0       0.87      0.94      0.91        36
         5.0       0.97      0.88      0.92        40
         6.0       0.95      0.92      0.93        38
         7.0       0.94      0.97      0.96        33
         8.0       0.75      0.93      0.83        41
         9.0       0.95      0.68      0.79        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:54:45,179 - trainer - INFO - {
  "dev_loss": 0.4797009378671646,
  "dev_accuracy": 0.8916666666666667,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:45,180 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:45,180 - trainer - INFO -   patience: 200
2022-10-17 14:54:45,181 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:45,182 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:45,182 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_40
2022-10-17 14:54:45,183 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_46
2022-10-17 14:54:45,188 - trainer - INFO - save model to path: tmp/mlp_digits\ck_46
2022-10-17 14:54:45,242 - trainer - INFO - 
*****************[epoch: 4, global step: 48] eval training set based on eval_every=2***************
2022-10-17 14:54:45,248 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.96      0.95       145
           1       0.89      0.77      0.83       140
           2       0.94      0.95      0.95       145
           3       0.89      0.85      0.87       149
           4       0.83      0.76      0.79       145
           5       0.95      0.87      0.90       142
           6       0.75      0.87      0.80       143
           7       0.85      0.96      0.90       146
           8       0.69      0.78      0.73       133
           9       0.85      0.77      0.81       149

    accuracy                           0.85      1437
   macro avg       0.86      0.85      0.85      1437
weighted avg       0.86      0.85      0.85      1437

2022-10-17 14:54:45,250 - trainer - INFO - {
  "train_accuracy_score": 0.8538622129436325,
  "train_loss": 0.5193759500980377
}
2022-10-17 14:54:45,527 - trainer - INFO - 
*****************[epoch: 4, global step: 48] eval development set based on eval_every=2***************
2022-10-17 14:54:45,531 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       0.84      0.90      0.87        42
         2.0       1.00      0.94      0.97        32
         3.0       0.97      0.88      0.92        34
         4.0       0.90      0.97      0.93        36
         5.0       0.80      0.93      0.86        40
         6.0       0.92      0.95      0.94        38
         7.0       0.91      0.97      0.94        33
         8.0       0.96      0.54      0.69        41
         9.0       0.71      0.77      0.74        31

    accuracy                           0.88       360
   macro avg       0.89      0.88      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:54:45,532 - trainer - INFO - {
  "dev_loss": 0.5483851333459219,
  "dev_accuracy": 0.8805555555555555,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:45,533 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:45,537 - trainer - INFO -   patience: 200
2022-10-17 14:54:45,538 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:45,538 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:45,538 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_42
2022-10-17 14:54:45,539 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_48
2022-10-17 14:54:45,544 - trainer - INFO - save model to path: tmp/mlp_digits\ck_48
2022-10-17 14:54:45,545 - trainer - INFO - 
*****************[epoch: 4, global step: 49] eval training set at end of epoch***************
2022-10-17 14:54:45,556 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      0.96      0.95       145
           1       0.89      0.77      0.83       140
           2       0.94      0.95      0.95       145
           3       0.89      0.85      0.87       149
           4       0.83      0.76      0.79       145
           5       0.95      0.87      0.90       142
           6       0.75      0.87      0.80       143
           7       0.85      0.96      0.90       146
           8       0.69      0.78      0.73       133
           9       0.85      0.77      0.81       149

    accuracy                           0.85      1437
   macro avg       0.86      0.85      0.85      1437
weighted avg       0.86      0.85      0.85      1437

2022-10-17 14:54:45,558 - trainer - INFO - {
  "train_accuracy_score": 0.8538622129436325,
  "train_loss": 0.49636347964406013
}
2022-10-17 14:54:45,559 - trainer - INFO - start training epoch 5
2022-10-17 14:54:45,559 - trainer - INFO - training using device=cuda
2022-10-17 14:54:45,559 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:45,560 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:45,625 - trainer - INFO - 
*****************[epoch: 5, global step: 50] eval training set based on eval_every=2***************
2022-10-17 14:54:45,628 - trainer - INFO -               precision    recall  f1-score   support

           0       0.94      1.00      0.97        17
           1       0.82      0.82      0.82        22
           2       1.00      0.90      0.95        31
           3       0.92      0.89      0.91        27
           4       0.94      0.91      0.93        34
           5       0.86      1.00      0.93        25
           6       0.81      0.92      0.86        24
           7       0.90      1.00      0.95        26
           8       0.90      0.38      0.53        24
           9       0.68      0.87      0.76        30

    accuracy                           0.87       260
   macro avg       0.88      0.87      0.86       260
weighted avg       0.88      0.87      0.86       260

2022-10-17 14:54:45,629 - trainer - INFO - {
  "train_accuracy_score": 0.8692307692307693,
  "train_loss": 0.42334336042404175
}
2022-10-17 14:54:45,898 - trainer - INFO - 
*****************[epoch: 5, global step: 50] eval development set based on eval_every=2***************
2022-10-17 14:54:45,900 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      0.97      0.96        33
         1.0       0.74      0.93      0.82        42
         2.0       0.97      0.94      0.95        32
         3.0       0.97      0.88      0.92        34
         4.0       0.95      0.97      0.96        36
         5.0       0.75      0.97      0.85        40
         6.0       0.84      0.97      0.90        38
         7.0       0.97      0.94      0.95        33
         8.0       0.91      0.24      0.38        41
         9.0       0.69      0.77      0.73        31

    accuracy                           0.85       360
   macro avg       0.87      0.86      0.84       360
weighted avg       0.87      0.85      0.83       360

2022-10-17 14:54:45,902 - trainer - INFO - {
  "dev_loss": 0.592403382062912,
  "dev_accuracy": 0.8527777777777777,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:45,902 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:45,903 - trainer - INFO -   patience: 200
2022-10-17 14:54:45,905 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:45,908 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:45,908 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_44
2022-10-17 14:54:45,909 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_50
2022-10-17 14:54:45,913 - trainer - INFO - save model to path: tmp/mlp_digits\ck_50
2022-10-17 14:54:45,987 - trainer - INFO - 
*****************[epoch: 5, global step: 52] eval training set based on eval_every=2***************
2022-10-17 14:54:45,990 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.93      0.95        42
           1       0.66      0.86      0.75        43
           2       0.98      0.95      0.96        56
           3       0.95      0.90      0.92        61
           4       0.94      0.85      0.90        55
           5       0.83      1.00      0.91        55
           6       0.80      0.94      0.87        52
           7       0.93      1.00      0.97        43
           8       0.94      0.29      0.44        55
           9       0.71      0.88      0.78        58

    accuracy                           0.86       520
   macro avg       0.87      0.86      0.85       520
weighted avg       0.87      0.86      0.84       520

2022-10-17 14:54:45,991 - trainer - INFO - {
  "train_accuracy_score": 0.8557692307692307,
  "train_loss": 0.5478543192148209
}
2022-10-17 14:54:46,312 - trainer - INFO - 
*****************[epoch: 5, global step: 52] eval development set based on eval_every=2***************
2022-10-17 14:54:46,316 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.94      0.97        33
         1.0       0.81      0.90      0.85        42
         2.0       0.91      0.97      0.94        32
         3.0       0.74      0.91      0.82        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.80      0.89        40
         6.0       0.86      0.97      0.91        38
         7.0       0.94      0.97      0.96        33
         8.0       0.96      0.56      0.71        41
         9.0       0.69      0.77      0.73        31

    accuracy                           0.88       360
   macro avg       0.89      0.88      0.87       360
weighted avg       0.89      0.88      0.87       360

2022-10-17 14:54:46,317 - trainer - INFO - {
  "dev_loss": 0.42865048348903656,
  "dev_accuracy": 0.875,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:46,318 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:54:46,318 - trainer - INFO -   patience: 200
2022-10-17 14:54:46,320 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:46,320 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:46,321 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_46
2022-10-17 14:54:46,322 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_52
2022-10-17 14:54:46,327 - trainer - INFO - save model to path: tmp/mlp_digits\ck_52
2022-10-17 14:54:46,396 - trainer - INFO - 
*****************[epoch: 5, global step: 54] eval training set based on eval_every=2***************
2022-10-17 14:54:46,399 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.97        72
           1       0.69      0.86      0.76        71
           2       0.96      0.96      0.96        72
           3       0.86      0.90      0.88        83
           4       0.96      0.90      0.93        80
           5       0.88      0.94      0.91        83
           6       0.79      0.94      0.86        72
           7       0.92      1.00      0.96        72
           8       0.97      0.37      0.53        87
           9       0.71      0.82      0.76        88

    accuracy                           0.86       780
   macro avg       0.87      0.86      0.85       780
weighted avg       0.87      0.86      0.85       780

2022-10-17 14:54:46,401 - trainer - INFO - {
  "train_accuracy_score": 0.8564102564102564,
  "train_loss": 0.4188205599784851
}
2022-10-17 14:54:46,672 - trainer - INFO - 
*****************[epoch: 5, global step: 54] eval development set based on eval_every=2***************
2022-10-17 14:54:46,676 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.97      0.98        33
         1.0       0.90      0.90      0.90        42
         2.0       1.00      0.91      0.95        32
         3.0       0.80      0.82      0.81        34
         4.0       0.84      1.00      0.91        36
         5.0       1.00      0.68      0.81        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.97      0.94        33
         8.0       0.77      0.88      0.82        41
         9.0       0.68      0.68      0.68        31

    accuracy                           0.88       360
   macro avg       0.88      0.88      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:54:46,677 - trainer - INFO - {
  "dev_loss": 0.4777778784434001,
  "dev_accuracy": 0.8777777777777778,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:46,678 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:54:46,678 - trainer - INFO -   patience: 200
2022-10-17 14:54:46,680 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:46,683 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:46,684 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_48
2022-10-17 14:54:46,685 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_54
2022-10-17 14:54:46,690 - trainer - INFO - save model to path: tmp/mlp_digits\ck_54
2022-10-17 14:54:46,752 - trainer - INFO - 
*****************[epoch: 5, global step: 56] eval training set based on eval_every=2***************
2022-10-17 14:54:46,756 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.93      0.96        98
           1       0.74      0.90      0.81        99
           2       0.97      0.96      0.96        98
           3       0.89      0.88      0.88       109
           4       0.93      0.93      0.93       114
           5       0.90      0.91      0.90       103
           6       0.83      0.96      0.89       104
           7       0.93      0.99      0.96       101
           8       0.83      0.40      0.54       100
           9       0.74      0.82      0.78       114

    accuracy                           0.87      1040
   macro avg       0.87      0.87      0.86      1040
weighted avg       0.87      0.87      0.86      1040

2022-10-17 14:54:46,757 - trainer - INFO - {
  "train_accuracy_score": 0.8682692307692308,
  "train_loss": 0.29953260719776154
}
2022-10-17 14:54:47,028 - trainer - INFO - 
*****************[epoch: 5, global step: 56] eval development set based on eval_every=2***************
2022-10-17 14:54:47,031 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.92      0.86      0.89        42
         2.0       1.00      0.91      0.95        32
         3.0       0.95      0.62      0.75        34
         4.0       0.90      1.00      0.95        36
         5.0       1.00      0.82      0.90        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.94      0.93        33
         8.0       0.60      0.90      0.72        41
         9.0       0.81      0.71      0.76        31

    accuracy                           0.88       360
   macro avg       0.90      0.87      0.88       360
weighted avg       0.90      0.88      0.88       360

2022-10-17 14:54:47,032 - trainer - INFO - {
  "dev_loss": 0.48902344703674316,
  "dev_accuracy": 0.875,
  "dev_best_score_for_accuracy": 0.9055555555555556
}
2022-10-17 14:54:47,033 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:54:47,033 - trainer - INFO -   patience: 200
2022-10-17 14:54:47,034 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:47,035 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:47,035 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_50
2022-10-17 14:54:47,036 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_56
2022-10-17 14:54:47,040 - trainer - INFO - save model to path: tmp/mlp_digits\ck_56
2022-10-17 14:54:47,099 - trainer - INFO - 
*****************[epoch: 5, global step: 58] eval training set based on eval_every=2***************
2022-10-17 14:54:47,103 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       130
           1       0.76      0.90      0.82       122
           2       0.98      0.95      0.96       125
           3       0.90      0.83      0.87       132
           4       0.93      0.94      0.94       136
           5       0.92      0.93      0.92       130
           6       0.84      0.97      0.90       126
           7       0.94      0.98      0.96       134
           8       0.79      0.51      0.62       126
           9       0.73      0.80      0.76       139

    accuracy                           0.88      1300
   macro avg       0.88      0.88      0.87      1300
weighted avg       0.88      0.88      0.87      1300

2022-10-17 14:54:47,105 - trainer - INFO - {
  "train_accuracy_score": 0.8761538461538462,
  "train_loss": 0.28952641785144806
}
2022-10-17 14:54:47,384 - trainer - INFO - 
*****************[epoch: 5, global step: 58] eval development set based on eval_every=2***************
2022-10-17 14:54:47,388 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.85      1.00      0.92        33
         1.0       0.95      0.88      0.91        42
         2.0       1.00      0.91      0.95        32
         3.0       0.88      0.85      0.87        34
         4.0       0.97      0.86      0.91        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.84      0.90      0.87        41
         9.0       0.75      0.87      0.81        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:54:47,388 - trainer - INFO - {
  "dev_loss": 0.3819375733534495,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:47,389 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:47,391 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:47,392 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:47,393 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_52
2022-10-17 14:54:47,397 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:47,400 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:47,400 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:47,401 - trainer - INFO -   patience: 200
2022-10-17 14:54:47,401 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:47,402 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_58
2022-10-17 14:54:47,407 - trainer - INFO - save model to path: tmp/mlp_digits\ck_58
2022-10-17 14:54:47,497 - trainer - INFO - 
*****************[epoch: 5, global step: 60] eval training set based on eval_every=2***************
2022-10-17 14:54:47,501 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.95      0.97       145
           1       0.78      0.89      0.83       140
           2       0.97      0.96      0.97       145
           3       0.91      0.83      0.87       149
           4       0.94      0.93      0.93       145
           5       0.91      0.94      0.92       142
           6       0.85      0.96      0.90       143
           7       0.95      0.97      0.96       146
           8       0.80      0.53      0.64       133
           9       0.72      0.81      0.77       149

    accuracy                           0.88      1437
   macro avg       0.88      0.88      0.88      1437
weighted avg       0.88      0.88      0.88      1437

2022-10-17 14:54:47,503 - trainer - INFO - {
  "train_accuracy_score": 0.8796102992345164,
  "train_loss": 0.4011356830596924
}
2022-10-17 14:54:47,786 - trainer - INFO - 
*****************[epoch: 5, global step: 60] eval development set based on eval_every=2***************
2022-10-17 14:54:47,789 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.91      0.95        32
         3.0       0.82      0.91      0.86        34
         4.0       0.95      0.97      0.96        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      0.95      0.96        38
         7.0       0.77      1.00      0.87        33
         8.0       0.81      0.83      0.82        41
         9.0       1.00      0.61      0.76        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.91      0.90      0.90       360

2022-10-17 14:54:47,790 - trainer - INFO - {
  "dev_loss": 0.3698521206776301,
  "dev_accuracy": 0.9027777777777778,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:47,790 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:47,791 - trainer - INFO -   patience: 200
2022-10-17 14:54:47,792 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:47,792 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:47,792 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_54
2022-10-17 14:54:47,793 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_60
2022-10-17 14:54:47,800 - trainer - INFO - save model to path: tmp/mlp_digits\ck_60
2022-10-17 14:54:47,801 - trainer - INFO - 
*****************[epoch: 5, global step: 61] eval training set at end of epoch***************
2022-10-17 14:54:47,807 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.95      0.97       145
           1       0.78      0.89      0.83       140
           2       0.97      0.96      0.97       145
           3       0.91      0.83      0.87       149
           4       0.94      0.93      0.93       145
           5       0.91      0.94      0.92       142
           6       0.85      0.96      0.90       143
           7       0.95      0.97      0.96       146
           8       0.80      0.53      0.64       133
           9       0.72      0.81      0.77       149

    accuracy                           0.88      1437
   macro avg       0.88      0.88      0.88      1437
weighted avg       0.88      0.88      0.88      1437

2022-10-17 14:54:47,809 - trainer - INFO - {
  "train_accuracy_score": 0.8796102992345164,
  "train_loss": 0.39670215795437497
}
2022-10-17 14:54:47,810 - trainer - INFO - start training epoch 6
2022-10-17 14:54:47,810 - trainer - INFO - training using device=cuda
2022-10-17 14:54:47,811 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:47,811 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:47,877 - trainer - INFO - 
*****************[epoch: 6, global step: 62] eval training set based on eval_every=2***************
2022-10-17 14:54:47,880 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       0.92      0.92      0.92        26
           2       1.00      0.97      0.99        34
           3       0.83      0.91      0.87        22
           4       0.96      1.00      0.98        24
           5       1.00      0.92      0.96        26
           6       0.89      0.96      0.92        25
           7       0.74      1.00      0.85        26
           8       0.90      0.83      0.86        23
           9       0.95      0.66      0.78        29

    accuracy                           0.92       260
   macro avg       0.92      0.92      0.91       260
weighted avg       0.92      0.92      0.91       260

2022-10-17 14:54:47,882 - trainer - INFO - {
  "train_accuracy_score": 0.9153846153846154,
  "train_loss": 0.36634258925914764
}
2022-10-17 14:54:48,163 - trainer - INFO - 
*****************[epoch: 6, global step: 62] eval development set based on eval_every=2***************
2022-10-17 14:54:48,166 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.85      0.92        33
         1.0       0.83      0.93      0.88        42
         2.0       1.00      0.91      0.95        32
         3.0       0.81      0.85      0.83        34
         4.0       0.77      1.00      0.87        36
         5.0       1.00      0.68      0.81        40
         6.0       0.79      0.97      0.87        38
         7.0       0.67      0.97      0.79        33
         8.0       0.71      0.71      0.71        41
         9.0       1.00      0.32      0.49        31

    accuracy                           0.82       360
   macro avg       0.86      0.82      0.81       360
weighted avg       0.85      0.82      0.81       360

2022-10-17 14:54:48,167 - trainer - INFO - {
  "dev_loss": 0.7026651501655579,
  "dev_accuracy": 0.8222222222222222,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:48,168 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:48,169 - trainer - INFO -   patience: 200
2022-10-17 14:54:48,170 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:48,170 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:48,170 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_56
2022-10-17 14:54:48,172 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_62
2022-10-17 14:54:48,176 - trainer - INFO - save model to path: tmp/mlp_digits\ck_62
2022-10-17 14:54:48,238 - trainer - INFO - 
*****************[epoch: 6, global step: 64] eval training set based on eval_every=2***************
2022-10-17 14:54:48,241 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.93      0.96        43
           1       0.87      0.93      0.90        57
           2       1.00      0.95      0.97        56
           3       0.90      0.87      0.89        63
           4       0.84      0.98      0.91        49
           5       1.00      0.83      0.91        53
           6       0.76      0.95      0.85        44
           7       0.77      1.00      0.87        53
           8       0.70      0.75      0.73        44
           9       0.97      0.55      0.70        58

    accuracy                           0.87       520
   macro avg       0.88      0.87      0.87       520
weighted avg       0.89      0.87      0.87       520

2022-10-17 14:54:48,243 - trainer - INFO - {
  "train_accuracy_score": 0.8711538461538462,
  "train_loss": 0.605023205280304
}
2022-10-17 14:54:48,518 - trainer - INFO - 
*****************[epoch: 6, global step: 64] eval development set based on eval_every=2***************
2022-10-17 14:54:48,524 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.91      0.95        33
         1.0       0.81      1.00      0.89        42
         2.0       1.00      0.91      0.95        32
         3.0       0.69      0.97      0.80        34
         4.0       0.84      1.00      0.91        36
         5.0       1.00      0.70      0.82        40
         6.0       0.82      0.97      0.89        38
         7.0       0.84      0.97      0.90        33
         8.0       0.91      0.76      0.83        41
         9.0       1.00      0.42      0.59        31

    accuracy                           0.86       360
   macro avg       0.89      0.86      0.85       360
weighted avg       0.89      0.86      0.86       360

2022-10-17 14:54:48,526 - trainer - INFO - {
  "dev_loss": 0.4942120164632797,
  "dev_accuracy": 0.8638888888888889,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:48,528 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:48,528 - trainer - INFO -   patience: 200
2022-10-17 14:54:48,529 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:48,529 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:48,529 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_58
2022-10-17 14:54:48,531 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_64
2022-10-17 14:54:48,535 - trainer - INFO - save model to path: tmp/mlp_digits\ck_64
2022-10-17 14:54:48,650 - trainer - INFO - 
*****************[epoch: 6, global step: 66] eval training set based on eval_every=2***************
2022-10-17 14:54:48,654 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.91      0.95        75
           1       0.81      0.94      0.87        79
           2       0.99      0.96      0.97        94
           3       0.79      0.91      0.85        85
           4       0.85      0.97      0.90        73
           5       1.00      0.82      0.90        76
           6       0.79      0.96      0.87        68
           7       0.82      0.96      0.88        83
           8       0.71      0.67      0.69        67
           9       0.95      0.53      0.68        80

    accuracy                           0.86       780
   macro avg       0.87      0.86      0.86       780
weighted avg       0.88      0.86      0.86       780

2022-10-17 14:54:48,655 - trainer - INFO - {
  "train_accuracy_score": 0.8641025641025641,
  "train_loss": 0.5544667989015579
}
2022-10-17 14:54:48,927 - trainer - INFO - 
*****************[epoch: 6, global step: 66] eval development set based on eval_every=2***************
2022-10-17 14:54:48,932 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.83      0.95      0.89        42
         2.0       0.97      0.91      0.94        32
         3.0       0.68      1.00      0.81        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.82      0.90        40
         6.0       0.93      0.97      0.95        38
         7.0       0.88      0.91      0.90        33
         8.0       0.93      0.66      0.77        41
         9.0       0.92      0.74      0.82        31

    accuracy                           0.89       360
   macro avg       0.91      0.90      0.89       360
weighted avg       0.91      0.89      0.89       360

2022-10-17 14:54:48,933 - trainer - INFO - {
  "dev_loss": 0.37214336295922595,
  "dev_accuracy": 0.8944444444444445,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:48,933 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:54:48,934 - trainer - INFO -   patience: 200
2022-10-17 14:54:48,935 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:48,935 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:48,935 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_60
2022-10-17 14:54:48,937 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_66
2022-10-17 14:54:48,941 - trainer - INFO - save model to path: tmp/mlp_digits\ck_66
2022-10-17 14:54:49,006 - trainer - INFO - 
*****************[epoch: 6, global step: 68] eval training set based on eval_every=2***************
2022-10-17 14:54:49,009 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.93      0.96       102
           1       0.81      0.93      0.86       103
           2       0.98      0.95      0.97       117
           3       0.81      0.90      0.85       111
           4       0.88      0.96      0.92        97
           5       1.00      0.85      0.92       103
           6       0.85      0.95      0.90       106
           7       0.85      0.97      0.91       107
           8       0.74      0.65      0.69        91
           9       0.85      0.61      0.71       103

    accuracy                           0.88      1040
   macro avg       0.88      0.87      0.87      1040
weighted avg       0.88      0.88      0.87      1040

2022-10-17 14:54:49,011 - trainer - INFO - {
  "train_accuracy_score": 0.875,
  "train_loss": 0.2630043774843216
}
2022-10-17 14:54:49,293 - trainer - INFO - 
*****************[epoch: 6, global step: 68] eval development set based on eval_every=2***************
2022-10-17 14:54:49,296 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.85      1.00      0.92        33
         1.0       0.87      0.95      0.91        42
         2.0       1.00      0.91      0.95        32
         3.0       0.89      0.74      0.81        34
         4.0       0.91      0.89      0.90        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.95      0.96        38
         7.0       0.91      0.97      0.94        33
         8.0       0.94      0.73      0.82        41
         9.0       0.64      0.87      0.74        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:54:49,297 - trainer - INFO - {
  "dev_loss": 0.38338159024715424,
  "dev_accuracy": 0.8888888888888888,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:49,298 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:54:49,298 - trainer - INFO -   patience: 200
2022-10-17 14:54:49,299 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:49,299 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:49,300 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_62
2022-10-17 14:54:49,301 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_68
2022-10-17 14:54:49,306 - trainer - INFO - save model to path: tmp/mlp_digits\ck_68
2022-10-17 14:54:49,367 - trainer - INFO - 
*****************[epoch: 6, global step: 70] eval training set based on eval_every=2***************
2022-10-17 14:54:49,372 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       132
           1       0.81      0.95      0.87       129
           2       0.98      0.95      0.97       131
           3       0.84      0.85      0.84       139
           4       0.91      0.97      0.94       132
           5       0.98      0.87      0.92       127
           6       0.86      0.96      0.91       129
           7       0.84      0.98      0.91       132
           8       0.79      0.67      0.72       118
           9       0.79      0.64      0.71       131

    accuracy                           0.88      1300
   macro avg       0.88      0.88      0.88      1300
weighted avg       0.88      0.88      0.88      1300

2022-10-17 14:54:49,373 - trainer - INFO - {
  "train_accuracy_score": 0.88,
  "train_loss": 0.3252235949039459
}
2022-10-17 14:54:49,732 - trainer - INFO - 
*****************[epoch: 6, global step: 70] eval development set based on eval_every=2***************
2022-10-17 14:54:49,735 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.93      0.93        42
         2.0       1.00      0.94      0.97        32
         3.0       0.93      0.74      0.82        34
         4.0       0.92      1.00      0.96        36
         5.0       0.92      0.90      0.91        40
         6.0       0.95      0.95      0.95        38
         7.0       0.86      0.97      0.91        33
         8.0       0.73      0.88      0.80        41
         9.0       0.81      0.68      0.74        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.90      0.90      0.90       360

2022-10-17 14:54:49,736 - trainer - INFO - {
  "dev_loss": 0.30811578780412674,
  "dev_accuracy": 0.9,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:49,737 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:54:49,737 - trainer - INFO -   patience: 200
2022-10-17 14:54:49,739 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:49,739 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:49,739 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_64
2022-10-17 14:54:49,741 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_70
2022-10-17 14:54:49,746 - trainer - INFO - save model to path: tmp/mlp_digits\ck_70
2022-10-17 14:54:49,795 - trainer - INFO - 
*****************[epoch: 6, global step: 72] eval training set based on eval_every=2***************
2022-10-17 14:54:49,799 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       145
           1       0.82      0.94      0.88       140
           2       0.99      0.96      0.97       145
           3       0.85      0.85      0.85       149
           4       0.92      0.97      0.94       145
           5       0.98      0.87      0.93       142
           6       0.87      0.96      0.91       143
           7       0.85      0.98      0.91       146
           8       0.80      0.71      0.75       133
           9       0.80      0.66      0.73       149

    accuracy                           0.89      1437
   macro avg       0.89      0.89      0.88      1437
weighted avg       0.89      0.89      0.88      1437

2022-10-17 14:54:49,801 - trainer - INFO - {
  "train_accuracy_score": 0.8858733472512178,
  "train_loss": 0.1351404320448637
}
2022-10-17 14:54:50,094 - trainer - INFO - 
*****************[epoch: 6, global step: 72] eval development set based on eval_every=2***************
2022-10-17 14:54:50,097 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.90      0.93        42
         2.0       1.00      0.94      0.97        32
         3.0       1.00      0.74      0.85        34
         4.0       0.92      1.00      0.96        36
         5.0       0.93      0.93      0.93        40
         6.0       0.95      0.95      0.95        38
         7.0       0.94      0.94      0.94        33
         8.0       0.62      0.93      0.75        41
         9.0       1.00      0.68      0.81        31

    accuracy                           0.90       360
   macro avg       0.93      0.90      0.91       360
weighted avg       0.92      0.90      0.91       360

2022-10-17 14:54:50,098 - trainer - INFO - {
  "dev_loss": 0.3624671846628189,
  "dev_accuracy": 0.9027777777777778,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:50,099 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:54:50,099 - trainer - INFO -   patience: 200
2022-10-17 14:54:50,100 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:50,100 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:50,100 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_66
2022-10-17 14:54:50,102 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_72
2022-10-17 14:54:50,106 - trainer - INFO - save model to path: tmp/mlp_digits\ck_72
2022-10-17 14:54:50,108 - trainer - INFO - 
*****************[epoch: 6, global step: 73] eval training set at end of epoch***************
2022-10-17 14:54:50,111 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       145
           1       0.82      0.94      0.88       140
           2       0.99      0.96      0.97       145
           3       0.85      0.85      0.85       149
           4       0.92      0.97      0.94       145
           5       0.98      0.87      0.93       142
           6       0.87      0.96      0.91       143
           7       0.85      0.98      0.91       146
           8       0.80      0.71      0.75       133
           9       0.80      0.66      0.73       149

    accuracy                           0.89      1437
   macro avg       0.89      0.89      0.88      1437
weighted avg       0.89      0.89      0.88      1437

2022-10-17 14:54:50,113 - trainer - INFO - {
  "train_accuracy_score": 0.8858733472512178,
  "train_loss": 0.37486683297902346
}
2022-10-17 14:54:50,113 - trainer - INFO - start training epoch 7
2022-10-17 14:54:50,114 - trainer - INFO - training using device=cuda
2022-10-17 14:54:50,114 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:50,114 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:50,193 - trainer - INFO - 
*****************[epoch: 7, global step: 74] eval training set based on eval_every=2***************
2022-10-17 14:54:50,196 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        26
           1       0.96      0.96      0.96        23
           2       1.00      1.00      1.00        17
           3       0.93      0.87      0.90        31
           4       1.00      0.94      0.97        33
           5       0.91      1.00      0.95        21
           6       1.00      1.00      1.00        28
           7       0.88      1.00      0.94        23
           8       0.75      1.00      0.86        27
           9       1.00      0.68      0.81        31

    accuracy                           0.93       260
   macro avg       0.94      0.94      0.94       260
weighted avg       0.94      0.93      0.93       260

2022-10-17 14:54:50,198 - trainer - INFO - {
  "train_accuracy_score": 0.9346153846153846,
  "train_loss": 0.2592020407319069
}
2022-10-17 14:54:50,484 - trainer - INFO - 
*****************[epoch: 7, global step: 74] eval development set based on eval_every=2***************
2022-10-17 14:54:50,487 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.94      0.97        33
         1.0       0.95      0.88      0.91        42
         2.0       0.97      0.94      0.95        32
         3.0       0.93      0.74      0.82        34
         4.0       0.92      1.00      0.96        36
         5.0       0.93      0.93      0.93        40
         6.0       0.90      0.95      0.92        38
         7.0       0.91      0.94      0.93        33
         8.0       0.62      0.93      0.75        41
         9.0       1.00      0.58      0.73        31

    accuracy                           0.89       360
   macro avg       0.91      0.88      0.89       360
weighted avg       0.91      0.89      0.89       360

2022-10-17 14:54:50,489 - trainer - INFO - {
  "dev_loss": 0.3792535463968913,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:50,489 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:54:50,490 - trainer - INFO -   patience: 200
2022-10-17 14:54:50,491 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:50,492 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:50,493 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_68
2022-10-17 14:54:50,497 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_74
2022-10-17 14:54:50,502 - trainer - INFO - save model to path: tmp/mlp_digits\ck_74
2022-10-17 14:54:50,582 - trainer - INFO - 
*****************[epoch: 7, global step: 76] eval training set based on eval_every=2***************
2022-10-17 14:54:50,586 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.92      0.96        61
           1       0.87      0.89      0.88        45
           2       1.00      0.94      0.97        51
           3       0.96      0.82      0.88        56
           4       0.98      0.95      0.97        60
           5       0.91      1.00      0.95        42
           6       0.94      1.00      0.97        51
           7       0.92      1.00      0.96        54
           8       0.62      0.94      0.74        48
           9       1.00      0.62      0.76        52

    accuracy                           0.91       520
   macro avg       0.92      0.91      0.90       520
weighted avg       0.93      0.91      0.91       520

2022-10-17 14:54:50,587 - trainer - INFO - {
  "train_accuracy_score": 0.9057692307692308,
  "train_loss": 0.41403697431087494
}
2022-10-17 14:54:50,919 - trainer - INFO - 
*****************[epoch: 7, global step: 76] eval development set based on eval_every=2***************
2022-10-17 14:54:50,922 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.93      0.93        42
         2.0       0.97      0.94      0.95        32
         3.0       0.90      0.79      0.84        34
         4.0       0.88      1.00      0.94        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.95      0.96        38
         7.0       0.84      0.94      0.89        33
         8.0       0.76      0.85      0.80        41
         9.0       0.96      0.77      0.86        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:54:50,923 - trainer - INFO - {
  "dev_loss": 0.2893596440553665,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9083333333333333
}
2022-10-17 14:54:50,923 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:54:50,924 - trainer - INFO -   patience: 200
2022-10-17 14:54:50,925 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:50,925 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:50,925 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_70
2022-10-17 14:54:50,927 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_76
2022-10-17 14:54:50,931 - trainer - INFO - save model to path: tmp/mlp_digits\ck_76
2022-10-17 14:54:50,993 - trainer - INFO - 
*****************[epoch: 7, global step: 78] eval training set based on eval_every=2***************
2022-10-17 14:54:50,998 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.94      0.97        93
           1       0.87      0.86      0.86        69
           2       0.99      0.95      0.97        76
           3       0.96      0.84      0.89        81
           4       0.98      0.96      0.97        85
           5       0.94      0.96      0.95        68
           6       0.94      0.96      0.95        77
           7       0.93      0.98      0.95        82
           8       0.67      0.93      0.78        74
           9       0.90      0.72      0.80        75

    accuracy                           0.91       780
   macro avg       0.92      0.91      0.91       780
weighted avg       0.92      0.91      0.91       780

2022-10-17 14:54:50,999 - trainer - INFO - {
  "train_accuracy_score": 0.9102564102564102,
  "train_loss": 0.2922622114419937
}
2022-10-17 14:54:51,285 - trainer - INFO - 
*****************[epoch: 7, global step: 78] eval development set based on eval_every=2***************
2022-10-17 14:54:51,288 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.87      0.98      0.92        42
         2.0       1.00      0.94      0.97        32
         3.0       0.91      0.88      0.90        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.90      0.92        40
         6.0       0.97      0.87      0.92        38
         7.0       0.82      0.97      0.89        33
         8.0       0.91      0.76      0.83        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.92       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.92      0.92       360

2022-10-17 14:54:51,289 - trainer - INFO - {
  "dev_loss": 0.2588631610075633,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9194444444444444
}
2022-10-17 14:54:51,289 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:51,290 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:51,290 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:51,290 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_72
2022-10-17 14:54:51,292 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:51,296 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:51,296 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:51,298 - trainer - INFO -   patience: 200
2022-10-17 14:54:51,299 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:51,302 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_78
2022-10-17 14:54:51,306 - trainer - INFO - save model to path: tmp/mlp_digits\ck_78
2022-10-17 14:54:51,375 - trainer - INFO - 
*****************[epoch: 7, global step: 80] eval training set based on eval_every=2***************
2022-10-17 14:54:51,379 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       114
           1       0.87      0.89      0.88       101
           2       0.99      0.96      0.98       103
           3       0.96      0.87      0.91       107
           4       0.98      0.95      0.97       111
           5       0.96      0.97      0.96        96
           6       0.94      0.96      0.95        99
           7       0.92      0.98      0.95       106
           8       0.71      0.91      0.80        92
           9       0.91      0.77      0.83       111

    accuracy                           0.92      1040
   macro avg       0.92      0.92      0.92      1040
weighted avg       0.93      0.92      0.92      1040

2022-10-17 14:54:51,381 - trainer - INFO - {
  "train_accuracy_score": 0.9201923076923076,
  "train_loss": 0.18002105504274368
}
2022-10-17 14:54:51,687 - trainer - INFO - 
*****************[epoch: 7, global step: 80] eval development set based on eval_every=2***************
2022-10-17 14:54:51,690 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.76      1.00      0.87        42
         2.0       1.00      0.94      0.97        32
         3.0       0.86      0.91      0.89        34
         4.0       0.95      1.00      0.97        36
         5.0       0.94      0.80      0.86        40
         6.0       0.97      0.89      0.93        38
         7.0       0.82      0.97      0.89        33
         8.0       0.96      0.56      0.71        41
         9.0       0.79      0.84      0.81        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.88       360

2022-10-17 14:54:51,691 - trainer - INFO - {
  "dev_loss": 0.3140932594736417,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9194444444444444
}
2022-10-17 14:54:51,692 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:51,693 - trainer - INFO -   patience: 200
2022-10-17 14:54:51,694 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:51,694 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:51,694 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_74
2022-10-17 14:54:51,696 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_80
2022-10-17 14:54:51,700 - trainer - INFO - save model to path: tmp/mlp_digits\ck_80
2022-10-17 14:54:51,760 - trainer - INFO - 
*****************[epoch: 7, global step: 82] eval training set based on eval_every=2***************
2022-10-17 14:54:51,764 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.96      0.97       136
           1       0.86      0.91      0.89       125
           2       0.99      0.97      0.98       128
           3       0.95      0.86      0.90       133
           4       0.98      0.95      0.96       136
           5       0.97      0.97      0.97       125
           6       0.95      0.96      0.96       131
           7       0.92      0.99      0.95       134
           8       0.74      0.88      0.80       114
           9       0.89      0.78      0.83       138

    accuracy                           0.92      1300
   macro avg       0.92      0.92      0.92      1300
weighted avg       0.93      0.92      0.92      1300

2022-10-17 14:54:51,766 - trainer - INFO - {
  "train_accuracy_score": 0.9215384615384615,
  "train_loss": 0.23219289630651474
}
2022-10-17 14:54:52,081 - trainer - INFO - 
*****************[epoch: 7, global step: 82] eval development set based on eval_every=2***************
2022-10-17 14:54:52,084 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.84      1.00      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       0.89      0.94      0.91        34
         4.0       0.92      1.00      0.96        36
         5.0       0.97      0.80      0.88        40
         6.0       0.97      0.95      0.96        38
         7.0       0.89      0.97      0.93        33
         8.0       0.97      0.68      0.80        41
         9.0       0.78      0.81      0.79        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:54:52,085 - trainer - INFO - {
  "dev_loss": 0.3127894252538681,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9194444444444444
}
2022-10-17 14:54:52,085 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:52,086 - trainer - INFO -   patience: 200
2022-10-17 14:54:52,087 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:52,087 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:52,087 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_76
2022-10-17 14:54:52,089 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_82
2022-10-17 14:54:52,092 - trainer - INFO - save model to path: tmp/mlp_digits\ck_82
2022-10-17 14:54:52,142 - trainer - INFO - 
*****************[epoch: 7, global step: 84] eval training set based on eval_every=2***************
2022-10-17 14:54:52,145 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.96      0.97       145
           1       0.85      0.92      0.89       140
           2       0.99      0.97      0.98       145
           3       0.95      0.87      0.91       149
           4       0.98      0.95      0.97       145
           5       0.97      0.96      0.97       142
           6       0.96      0.96      0.96       143
           7       0.92      0.99      0.95       146
           8       0.76      0.87      0.81       133
           9       0.88      0.79      0.83       149

    accuracy                           0.92      1437
   macro avg       0.92      0.92      0.92      1437
weighted avg       0.93      0.92      0.92      1437

2022-10-17 14:54:52,147 - trainer - INFO - {
  "train_accuracy_score": 0.9227557411273486,
  "train_loss": 0.1966659277677536
}
2022-10-17 14:54:52,426 - trainer - INFO - 
*****************[epoch: 7, global step: 84] eval development set based on eval_every=2***************
2022-10-17 14:54:52,429 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.90      0.86      0.88        42
         2.0       0.94      0.97      0.95        32
         3.0       0.87      1.00      0.93        34
         4.0       0.88      1.00      0.94        36
         5.0       0.94      0.85      0.89        40
         6.0       0.95      0.92      0.93        38
         7.0       1.00      0.94      0.97        33
         8.0       0.83      0.83      0.83        41
         9.0       0.92      0.77      0.84        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:54:52,431 - trainer - INFO - {
  "dev_loss": 0.30962900072336197,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9194444444444444
}
2022-10-17 14:54:52,431 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:52,432 - trainer - INFO -   patience: 200
2022-10-17 14:54:52,433 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:52,433 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:52,433 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_78
2022-10-17 14:54:52,434 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_84
2022-10-17 14:54:52,438 - trainer - INFO - save model to path: tmp/mlp_digits\ck_84
2022-10-17 14:54:52,439 - trainer - INFO - 
*****************[epoch: 7, global step: 85] eval training set at end of epoch***************
2022-10-17 14:54:52,443 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.96      0.97       145
           1       0.85      0.92      0.89       140
           2       0.99      0.97      0.98       145
           3       0.95      0.87      0.91       149
           4       0.98      0.95      0.97       145
           5       0.97      0.96      0.97       142
           6       0.96      0.96      0.96       143
           7       0.92      0.99      0.95       146
           8       0.76      0.87      0.81       133
           9       0.88      0.79      0.83       149

    accuracy                           0.92      1437
   macro avg       0.92      0.92      0.92      1437
weighted avg       0.93      0.92      0.92      1437

2022-10-17 14:54:52,445 - trainer - INFO - {
  "train_accuracy_score": 0.9227557411273486,
  "train_loss": 0.26239685093363124
}
2022-10-17 14:54:52,446 - trainer - INFO - start training epoch 8
2022-10-17 14:54:52,446 - trainer - INFO - training using device=cuda
2022-10-17 14:54:52,446 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:52,447 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:52,511 - trainer - INFO - 
*****************[epoch: 8, global step: 86] eval training set based on eval_every=2***************
2022-10-17 14:54:52,515 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        25
           1       0.88      0.85      0.87        27
           2       0.88      1.00      0.93        21
           3       1.00      0.95      0.98        22
           4       0.95      1.00      0.98        21
           5       1.00      0.97      0.98        29
           6       1.00      0.96      0.98        28
           7       0.96      1.00      0.98        23
           8       0.90      0.97      0.94        38
           9       1.00      0.81      0.89        26

    accuracy                           0.95       260
   macro avg       0.95      0.95      0.95       260
weighted avg       0.95      0.95      0.95       260

2022-10-17 14:54:52,517 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.23505010455846786
}
2022-10-17 14:54:52,814 - trainer - INFO - 
*****************[epoch: 8, global step: 86] eval development set based on eval_every=2***************
2022-10-17 14:54:52,817 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.93      0.88      0.90        42
         2.0       0.97      0.97      0.97        32
         3.0       0.92      1.00      0.96        34
         4.0       0.90      1.00      0.95        36
         5.0       0.95      0.93      0.94        40
         6.0       0.95      0.92      0.93        38
         7.0       1.00      0.94      0.97        33
         8.0       0.83      0.95      0.89        41
         9.0       1.00      0.71      0.83        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:54:52,818 - trainer - INFO - {
  "dev_loss": 0.2889539524912834,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9305555555555556
}
2022-10-17 14:54:52,819 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:52,820 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:52,821 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:52,821 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_80
2022-10-17 14:54:52,822 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:52,825 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:52,826 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:52,826 - trainer - INFO -   patience: 200
2022-10-17 14:54:52,827 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:52,827 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_86
2022-10-17 14:54:52,832 - trainer - INFO - save model to path: tmp/mlp_digits\ck_86
2022-10-17 14:54:52,906 - trainer - INFO - 
*****************[epoch: 8, global step: 88] eval training set based on eval_every=2***************
2022-10-17 14:54:52,910 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        49
           1       0.85      0.90      0.87        50
           2       0.94      1.00      0.97        48
           3       0.91      0.96      0.93        52
           4       0.98      1.00      0.99        42
           5       1.00      0.95      0.97        61
           6       0.98      0.96      0.97        49
           7       0.98      0.96      0.97        50
           8       0.90      0.94      0.92        65
           9       0.95      0.78      0.86        54

    accuracy                           0.94       520
   macro avg       0.94      0.94      0.94       520
weighted avg       0.94      0.94      0.94       520

2022-10-17 14:54:52,911 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.17283450812101364
}
2022-10-17 14:54:53,234 - trainer - INFO - 
*****************[epoch: 8, global step: 88] eval development set based on eval_every=2***************
2022-10-17 14:54:53,238 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.97      0.97        33
         1.0       0.93      0.95      0.94        42
         2.0       1.00      0.91      0.95        32
         3.0       0.92      0.97      0.94        34
         4.0       0.90      1.00      0.95        36
         5.0       0.93      0.93      0.93        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.94      0.97        33
         8.0       0.83      0.98      0.90        41
         9.0       1.00      0.71      0.83        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:54:53,240 - trainer - INFO - {
  "dev_loss": 0.27393287420272827,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9333333333333333
}
2022-10-17 14:54:53,240 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:53,242 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:53,242 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:53,242 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_82
2022-10-17 14:54:53,243 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:53,247 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:53,247 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:53,247 - trainer - INFO -   patience: 200
2022-10-17 14:54:53,248 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:53,249 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_88
2022-10-17 14:54:53,253 - trainer - INFO - save model to path: tmp/mlp_digits\ck_88
2022-10-17 14:54:53,317 - trainer - INFO - 
*****************[epoch: 8, global step: 90] eval training set based on eval_every=2***************
2022-10-17 14:54:53,321 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.96      0.97        73
           1       0.90      0.90      0.90        78
           2       0.96      0.96      0.96        68
           3       0.91      0.95      0.93        83
           4       0.96      1.00      0.98        73
           5       0.99      0.96      0.98        84
           6       0.96      0.97      0.97        72
           7       0.97      0.97      0.97        87
           8       0.87      0.96      0.91        89
           9       0.97      0.78      0.86        73

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.94      0.94      0.94       780

2022-10-17 14:54:53,322 - trainer - INFO - {
  "train_accuracy_score": 0.941025641025641,
  "train_loss": 0.20002121478319168
}
2022-10-17 14:54:53,613 - trainer - INFO - 
*****************[epoch: 8, global step: 90] eval development set based on eval_every=2***************
2022-10-17 14:54:53,616 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.81      1.00      0.89        42
         2.0       1.00      0.84      0.92        32
         3.0       0.94      0.94      0.94        34
         4.0       0.92      1.00      0.96        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.92      0.96        38
         7.0       0.91      0.97      0.94        33
         8.0       0.95      0.85      0.90        41
         9.0       0.96      0.74      0.84        31

    accuracy                           0.93       360
   macro avg       0.94      0.92      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:54:53,617 - trainer - INFO - {
  "dev_loss": 0.21441852301359177,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9333333333333333
}
2022-10-17 14:54:53,617 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:53,618 - trainer - INFO -   patience: 200
2022-10-17 14:54:53,619 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:53,619 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:53,620 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_84
2022-10-17 14:54:53,621 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_90
2022-10-17 14:54:53,627 - trainer - INFO - save model to path: tmp/mlp_digits\ck_90
2022-10-17 14:54:53,688 - trainer - INFO - 
*****************[epoch: 8, global step: 92] eval training set based on eval_every=2***************
2022-10-17 14:54:53,691 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.96      0.97        98
           1       0.87      0.92      0.89        99
           2       0.97      0.94      0.95        96
           3       0.92      0.95      0.94       108
           4       0.96      0.97      0.97       105
           5       0.98      0.97      0.98       109
           6       0.96      0.97      0.97       105
           7       0.96      0.97      0.97       114
           8       0.87      0.95      0.91       105
           9       0.98      0.80      0.88       101

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:54:53,693 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.22768814116716385
}
2022-10-17 14:54:53,971 - trainer - INFO - 
*****************[epoch: 8, global step: 92] eval development set based on eval_every=2***************
2022-10-17 14:54:53,974 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.82      1.00      0.90        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.85      0.97      0.91        40
         6.0       1.00      0.89      0.94        38
         7.0       0.91      0.97      0.94        33
         8.0       1.00      0.73      0.85        41
         9.0       0.96      0.84      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:54:53,975 - trainer - INFO - {
  "dev_loss": 0.22455133746067682,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9361111111111111
}
2022-10-17 14:54:53,975 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:53,977 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:53,977 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:53,977 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_86
2022-10-17 14:54:53,979 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:53,982 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:53,982 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:53,982 - trainer - INFO -   patience: 200
2022-10-17 14:54:53,983 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:53,983 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_92
2022-10-17 14:54:53,987 - trainer - INFO - save model to path: tmp/mlp_digits\ck_92
2022-10-17 14:54:54,052 - trainer - INFO - 
*****************[epoch: 8, global step: 94] eval training set based on eval_every=2***************
2022-10-17 14:54:54,056 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.97      0.98       132
           1       0.86      0.92      0.89       125
           2       0.98      0.95      0.96       129
           3       0.93      0.96      0.95       131
           4       0.97      0.97      0.97       131
           5       0.98      0.98      0.98       130
           6       0.96      0.96      0.96       130
           7       0.96      0.98      0.97       136
           8       0.88      0.93      0.90       125
           9       0.96      0.82      0.89       131

    accuracy                           0.94      1300
   macro avg       0.95      0.94      0.94      1300
weighted avg       0.95      0.94      0.94      1300

2022-10-17 14:54:54,058 - trainer - INFO - {
  "train_accuracy_score": 0.9446153846153846,
  "train_loss": 0.15606511384248734
}
2022-10-17 14:54:54,339 - trainer - INFO - 
*****************[epoch: 8, global step: 94] eval development set based on eval_every=2***************
2022-10-17 14:54:54,343 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.98      0.94        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       0.88      1.00      0.94        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.89      0.97      0.93        33
         8.0       1.00      0.66      0.79        41
         9.0       0.82      0.90      0.86        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:54:54,343 - trainer - INFO - {
  "dev_loss": 0.23945125192403793,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9361111111111111
}
2022-10-17 14:54:54,344 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:54,344 - trainer - INFO -   patience: 200
2022-10-17 14:54:54,345 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:54,345 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:54,345 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_88
2022-10-17 14:54:54,346 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_94
2022-10-17 14:54:54,350 - trainer - INFO - save model to path: tmp/mlp_digits\ck_94
2022-10-17 14:54:54,441 - trainer - INFO - 
*****************[epoch: 8, global step: 96] eval training set based on eval_every=2***************
2022-10-17 14:54:54,445 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.86      0.92      0.89       140
           2       0.97      0.96      0.97       145
           3       0.94      0.96      0.95       149
           4       0.97      0.97      0.97       145
           5       0.98      0.98      0.98       142
           6       0.97      0.97      0.97       143
           7       0.92      0.97      0.95       146
           8       0.88      0.92      0.90       133
           9       0.94      0.81      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:54,447 - trainer - INFO - {
  "train_accuracy_score": 0.942240779401531,
  "train_loss": 0.160016268491745
}
2022-10-17 14:54:54,732 - trainer - INFO - 
*****************[epoch: 8, global step: 96] eval development set based on eval_every=2***************
2022-10-17 14:54:54,735 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.85      0.98      0.91        42
         2.0       0.89      1.00      0.94        32
         3.0       0.94      0.97      0.96        34
         4.0       0.88      1.00      0.94        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.92      0.95        38
         7.0       0.97      0.94      0.95        33
         8.0       1.00      0.73      0.85        41
         9.0       0.89      0.81      0.85        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.92       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:54:54,736 - trainer - INFO - {
  "dev_loss": 0.2638578141729037,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9361111111111111
}
2022-10-17 14:54:54,737 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:54,738 - trainer - INFO -   patience: 200
2022-10-17 14:54:54,739 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:54,739 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:54,739 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_90
2022-10-17 14:54:54,740 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_96
2022-10-17 14:54:54,745 - trainer - INFO - save model to path: tmp/mlp_digits\ck_96
2022-10-17 14:54:54,746 - trainer - INFO - 
*****************[epoch: 8, global step: 97] eval training set at end of epoch***************
2022-10-17 14:54:54,750 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.86      0.92      0.89       140
           2       0.97      0.96      0.97       145
           3       0.94      0.96      0.95       149
           4       0.97      0.97      0.97       145
           5       0.98      0.98      0.98       142
           6       0.97      0.97      0.97       143
           7       0.92      0.97      0.95       146
           8       0.88      0.92      0.90       133
           9       0.94      0.81      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:54,753 - trainer - INFO - {
  "train_accuracy_score": 0.942240779401531,
  "train_loss": 0.1919458918273449
}
2022-10-17 14:54:54,753 - trainer - INFO - start training epoch 9
2022-10-17 14:54:54,754 - trainer - INFO - training using device=cuda
2022-10-17 14:54:54,754 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:54,754 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:54,821 - trainer - INFO - 
*****************[epoch: 9, global step: 98] eval training set based on eval_every=2***************
2022-10-17 14:54:54,824 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        31
           1       0.81      1.00      0.90        26
           2       1.00      1.00      1.00        21
           3       0.97      0.94      0.95        31
           4       1.00      1.00      1.00        25
           5       0.96      1.00      0.98        26
           6       1.00      0.96      0.98        24
           7       1.00      0.93      0.97        30
           8       0.88      0.71      0.79        21
           9       0.88      0.92      0.90        25

    accuracy                           0.95       260
   macro avg       0.95      0.95      0.95       260
weighted avg       0.95      0.95      0.95       260

2022-10-17 14:54:54,825 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.11277433671057224
}
2022-10-17 14:54:55,101 - trainer - INFO - 
*****************[epoch: 9, global step: 98] eval development set based on eval_every=2***************
2022-10-17 14:54:55,104 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.87      0.95      0.91        42
         2.0       0.94      1.00      0.97        32
         3.0       0.89      1.00      0.94        34
         4.0       0.90      1.00      0.95        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.95      0.96        38
         7.0       0.97      0.97      0.97        33
         8.0       0.97      0.83      0.89        41
         9.0       1.00      0.74      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.93       360

2022-10-17 14:54:55,105 - trainer - INFO - {
  "dev_loss": 0.24434689432382584,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9361111111111111
}
2022-10-17 14:54:55,105 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:55,106 - trainer - INFO -   patience: 200
2022-10-17 14:54:55,106 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:55,107 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:55,107 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_92
2022-10-17 14:54:55,108 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_98
2022-10-17 14:54:55,113 - trainer - INFO - save model to path: tmp/mlp_digits\ck_98
2022-10-17 14:54:55,175 - trainer - INFO - 
*****************[epoch: 9, global step: 100] eval training set based on eval_every=2***************
2022-10-17 14:54:55,178 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        59
           1       0.80      1.00      0.89        53
           2       0.98      1.00      0.99        51
           3       0.93      0.96      0.95        54
           4       0.98      0.98      0.98        52
           5       0.98      1.00      0.99        50
           6       0.98      0.96      0.97        46
           7       0.98      0.95      0.96        55
           8       0.93      0.76      0.84        50
           9       0.93      0.84      0.88        50

    accuracy                           0.95       520
   macro avg       0.95      0.94      0.94       520
weighted avg       0.95      0.95      0.95       520

2022-10-17 14:54:55,179 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.15773267298936844
}
2022-10-17 14:54:55,461 - trainer - INFO - 
*****************[epoch: 9, global step: 100] eval development set based on eval_every=2***************
2022-10-17 14:54:55,464 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.88      0.90      0.89        42
         2.0       1.00      0.88      0.93        32
         3.0       0.85      1.00      0.92        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.88      0.90      0.89        41
         9.0       1.00      0.84      0.91        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:54:55,465 - trainer - INFO - {
  "dev_loss": 0.2284244199593862,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9361111111111111
}
2022-10-17 14:54:55,466 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:54:55,466 - trainer - INFO -   patience: 200
2022-10-17 14:54:55,467 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:55,467 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:55,468 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_94
2022-10-17 14:54:55,469 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_100
2022-10-17 14:54:55,473 - trainer - INFO - save model to path: tmp/mlp_digits\ck_100
2022-10-17 14:54:55,593 - trainer - INFO - 
*****************[epoch: 9, global step: 102] eval training set based on eval_every=2***************
2022-10-17 14:54:55,596 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        78
           1       0.83      0.97      0.89        74
           2       0.99      0.99      0.99        82
           3       0.93      0.95      0.94        84
           4       0.99      0.98      0.98        82
           5       0.99      1.00      0.99        75
           6       0.99      0.96      0.97        74
           7       0.96      0.96      0.96        83
           8       0.87      0.83      0.85        72
           9       0.95      0.83      0.89        76

    accuracy                           0.95       780
   macro avg       0.95      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:54:55,598 - trainer - INFO - {
  "train_accuracy_score": 0.9487179487179487,
  "train_loss": 0.13284380361437798
}
2022-10-17 14:54:55,865 - trainer - INFO - 
*****************[epoch: 9, global step: 102] eval development set based on eval_every=2***************
2022-10-17 14:54:55,870 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      0.83      0.89        42
         2.0       1.00      0.91      0.95        32
         3.0       0.92      0.97      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.94      0.95        33
         8.0       0.76      0.95      0.85        41
         9.0       1.00      0.94      0.97        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:54:55,871 - trainer - INFO - {
  "dev_loss": 0.2139580212533474,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:55,872 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:55,876 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:55,876 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:55,876 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_96
2022-10-17 14:54:55,877 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:55,882 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:55,882 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:55,882 - trainer - INFO -   patience: 200
2022-10-17 14:54:55,883 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:55,884 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_102
2022-10-17 14:54:55,889 - trainer - INFO - save model to path: tmp/mlp_digits\ck_102
2022-10-17 14:54:55,959 - trainer - INFO - 
*****************[epoch: 9, global step: 104] eval training set based on eval_every=2***************
2022-10-17 14:54:55,962 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       0.85      0.92      0.88       100
           2       0.98      0.98      0.98       111
           3       0.91      0.96      0.94       106
           4       0.99      0.97      0.98       113
           5       0.99      0.99      0.99        96
           6       0.97      0.96      0.96        93
           7       0.94      0.96      0.95       105
           8       0.79      0.86      0.83        96
           9       0.94      0.75      0.84       113

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.93      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:54:55,964 - trainer - INFO - {
  "train_accuracy_score": 0.9355769230769231,
  "train_loss": 0.39291606843471527
}
2022-10-17 14:54:56,245 - trainer - INFO - 
*****************[epoch: 9, global step: 104] eval development set based on eval_every=2***************
2022-10-17 14:54:56,248 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.93      0.90      0.92        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.88      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.95      0.96        38
         7.0       0.86      0.97      0.91        33
         8.0       0.82      0.88      0.85        41
         9.0       1.00      0.90      0.95        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:54:56,249 - trainer - INFO - {
  "dev_loss": 0.16710439572731653,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:56,250 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:56,250 - trainer - INFO -   patience: 200
2022-10-17 14:54:56,251 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:56,252 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:56,252 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_98
2022-10-17 14:54:56,253 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_104
2022-10-17 14:54:56,258 - trainer - INFO - save model to path: tmp/mlp_digits\ck_104
2022-10-17 14:54:56,334 - trainer - INFO - 
*****************[epoch: 9, global step: 106] eval training set based on eval_every=2***************
2022-10-17 14:54:56,339 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       129
           1       0.87      0.94      0.90       126
           2       0.99      0.99      0.99       135
           3       0.93      0.95      0.94       133
           4       0.99      0.97      0.98       132
           5       0.99      0.98      0.98       131
           6       0.97      0.96      0.96       122
           7       0.93      0.97      0.95       134
           8       0.82      0.89      0.85       119
           9       0.94      0.78      0.85       139

    accuracy                           0.94      1300
   macro avg       0.94      0.94      0.94      1300
weighted avg       0.94      0.94      0.94      1300

2022-10-17 14:54:56,340 - trainer - INFO - {
  "train_accuracy_score": 0.9407692307692308,
  "train_loss": 0.12314152717590332
}
2022-10-17 14:54:56,657 - trainer - INFO - 
*****************[epoch: 9, global step: 106] eval development set based on eval_every=2***************
2022-10-17 14:54:56,660 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.79      1.00      0.88        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.76      0.87        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       0.95      0.95      0.95        38
         7.0       0.91      0.97      0.94        33
         8.0       0.97      0.71      0.82        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:54:56,661 - trainer - INFO - {
  "dev_loss": 0.2522560643653075,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:56,662 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:54:56,662 - trainer - INFO -   patience: 200
2022-10-17 14:54:56,663 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:56,664 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:56,664 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_100
2022-10-17 14:54:56,665 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_106
2022-10-17 14:54:56,669 - trainer - INFO - save model to path: tmp/mlp_digits\ck_106
2022-10-17 14:54:56,723 - trainer - INFO - 
*****************[epoch: 9, global step: 108] eval training set based on eval_every=2***************
2022-10-17 14:54:56,729 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.86      0.94      0.90       140
           2       0.99      0.99      0.99       145
           3       0.93      0.94      0.94       149
           4       0.99      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.97      0.97      0.97       143
           7       0.93      0.97      0.95       146
           8       0.82      0.87      0.84       133
           9       0.94      0.79      0.86       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:56,731 - trainer - INFO - {
  "train_accuracy_score": 0.940848990953375,
  "train_loss": 0.12108536809682846
}
2022-10-17 14:54:57,008 - trainer - INFO - 
*****************[epoch: 9, global step: 108] eval development set based on eval_every=2***************
2022-10-17 14:54:57,011 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.79      1.00      0.88        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.80      0.97      0.88        40
         6.0       0.97      0.92      0.95        38
         7.0       0.97      0.88      0.92        33
         8.0       1.00      0.54      0.70        41
         9.0       0.82      0.90      0.86        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.92      0.91      0.90       360

2022-10-17 14:54:57,012 - trainer - INFO - {
  "dev_loss": 0.33132636671264964,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:57,013 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:54:57,013 - trainer - INFO -   patience: 200
2022-10-17 14:54:57,015 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:57,015 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:57,016 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_102
2022-10-17 14:54:57,019 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_108
2022-10-17 14:54:57,026 - trainer - INFO - save model to path: tmp/mlp_digits\ck_108
2022-10-17 14:54:57,027 - trainer - INFO - 
*****************[epoch: 9, global step: 109] eval training set at end of epoch***************
2022-10-17 14:54:57,032 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.86      0.94      0.90       140
           2       0.99      0.99      0.99       145
           3       0.93      0.94      0.94       149
           4       0.99      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.97      0.97      0.97       143
           7       0.93      0.97      0.95       146
           8       0.82      0.87      0.84       133
           9       0.94      0.79      0.86       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:57,034 - trainer - INFO - {
  "train_accuracy_score": 0.940848990953375,
  "train_loss": 0.17341562950362763
}
2022-10-17 14:54:57,035 - trainer - INFO - start training epoch 10
2022-10-17 14:54:57,035 - trainer - INFO - training using device=cuda
2022-10-17 14:54:57,036 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:57,036 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:57,105 - trainer - INFO - 
*****************[epoch: 10, global step: 110] eval training set based on eval_every=2***************
2022-10-17 14:54:57,108 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        26
           1       0.85      1.00      0.92        29
           2       0.97      1.00      0.99        36
           3       1.00      0.92      0.96        24
           4       1.00      1.00      1.00        21
           5       0.84      1.00      0.91        26
           6       0.92      0.92      0.92        24
           7       0.74      0.88      0.80        16
           8       0.93      0.56      0.70        25
           9       0.90      0.82      0.86        33

    accuracy                           0.91       260
   macro avg       0.91      0.91      0.90       260
weighted avg       0.92      0.91      0.91       260

2022-10-17 14:54:57,109 - trainer - INFO - {
  "train_accuracy_score": 0.9115384615384615,
  "train_loss": 0.30056338012218475
}
2022-10-17 14:54:57,376 - trainer - INFO - 
*****************[epoch: 10, global step: 110] eval development set based on eval_every=2***************
2022-10-17 14:54:57,379 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.95      0.92        42
         2.0       0.84      1.00      0.91        32
         3.0       0.97      0.91      0.94        34
         4.0       0.92      1.00      0.96        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.95      0.96        38
         7.0       0.97      0.97      0.97        33
         8.0       0.96      0.66      0.78        41
         9.0       0.80      0.90      0.85        31

    accuracy                           0.92       360
   macro avg       0.92      0.93      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:54:57,380 - trainer - INFO - {
  "dev_loss": 0.22939461593826613,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:57,381 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:54:57,381 - trainer - INFO -   patience: 200
2022-10-17 14:54:57,382 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:57,382 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:57,383 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_104
2022-10-17 14:54:57,384 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_110
2022-10-17 14:54:57,388 - trainer - INFO - save model to path: tmp/mlp_digits\ck_110
2022-10-17 14:54:57,454 - trainer - INFO - 
*****************[epoch: 10, global step: 112] eval training set based on eval_every=2***************
2022-10-17 14:54:57,457 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        45
           1       0.87      1.00      0.93        54
           2       0.95      1.00      0.97        57
           3       1.00      0.91      0.95        55
           4       1.00      0.98      0.99        43
           5       0.91      1.00      0.95        53
           6       0.95      0.93      0.94        44
           7       0.85      0.96      0.90        52
           8       0.93      0.73      0.82        55
           9       0.93      0.85      0.89        62

    accuracy                           0.93       520
   macro avg       0.94      0.94      0.93       520
weighted avg       0.94      0.93      0.93       520

2022-10-17 14:54:57,459 - trainer - INFO - {
  "train_accuracy_score": 0.9326923076923077,
  "train_loss": 0.16001475602388382
}
2022-10-17 14:54:57,786 - trainer - INFO - 
*****************[epoch: 10, global step: 112] eval development set based on eval_every=2***************
2022-10-17 14:54:57,789 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.83      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       0.72      1.00      0.84        34
         4.0       0.90      1.00      0.95        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.85      0.92        33
         8.0       0.85      0.85      0.85        41
         9.0       0.87      0.84      0.85        31

    accuracy                           0.91       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:54:57,791 - trainer - INFO - {
  "dev_loss": 0.25280455499887466,
  "dev_accuracy": 0.9138888888888889,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:57,792 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:54:57,792 - trainer - INFO -   patience: 200
2022-10-17 14:54:57,793 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:57,793 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:57,794 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_106
2022-10-17 14:54:57,795 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_112
2022-10-17 14:54:57,800 - trainer - INFO - save model to path: tmp/mlp_digits\ck_112
2022-10-17 14:54:57,873 - trainer - INFO - 
*****************[epoch: 10, global step: 114] eval training set based on eval_every=2***************
2022-10-17 14:54:57,876 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98        75
           1       0.91      0.95      0.93        83
           2       0.97      1.00      0.98        83
           3       0.96      0.94      0.95        83
           4       0.99      0.99      0.99        67
           5       0.94      1.00      0.97        75
           6       0.96      0.93      0.95        75
           7       0.89      0.95      0.92        76
           8       0.92      0.81      0.86        80
           9       0.92      0.87      0.89        83

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.94      0.94      0.94       780

2022-10-17 14:54:57,878 - trainer - INFO - {
  "train_accuracy_score": 0.941025641025641,
  "train_loss": 0.1426529362797737
}
2022-10-17 14:54:58,165 - trainer - INFO - 
*****************[epoch: 10, global step: 114] eval development set based on eval_every=2***************
2022-10-17 14:54:58,168 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.81      0.88        42
         2.0       1.00      0.84      0.92        32
         3.0       0.77      1.00      0.87        34
         4.0       0.88      1.00      0.94        36
         5.0       1.00      0.80      0.89        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.94      0.97        33
         8.0       0.81      0.93      0.86        41
         9.0       0.90      0.87      0.89        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:54:58,169 - trainer - INFO - {
  "dev_loss": 0.30424002061287564,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:58,170 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:54:58,170 - trainer - INFO -   patience: 200
2022-10-17 14:54:58,171 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:58,172 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:58,172 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_108
2022-10-17 14:54:58,173 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_114
2022-10-17 14:54:58,179 - trainer - INFO - save model to path: tmp/mlp_digits\ck_114
2022-10-17 14:54:58,257 - trainer - INFO - 
*****************[epoch: 10, global step: 116] eval training set based on eval_every=2***************
2022-10-17 14:54:58,260 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.99      0.98       101
           1       0.91      0.94      0.92       109
           2       0.97      0.96      0.97       113
           3       0.93      0.94      0.94       107
           4       0.98      0.99      0.98        94
           5       0.95      0.97      0.96       105
           6       0.96      0.95      0.96       101
           7       0.92      0.95      0.93       102
           8       0.87      0.84      0.86        99
           9       0.92      0.84      0.88       109

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:54:58,262 - trainer - INFO - {
  "train_accuracy_score": 0.9375,
  "train_loss": 0.18648431450128555
}
2022-10-17 14:54:58,554 - trainer - INFO - 
*****************[epoch: 10, global step: 116] eval development set based on eval_every=2***************
2022-10-17 14:54:58,557 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.95      0.93        42
         2.0       1.00      0.84      0.92        32
         3.0       0.85      0.97      0.90        34
         4.0       0.84      1.00      0.91        36
         5.0       1.00      0.88      0.93        40
         6.0       0.95      1.00      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.88      0.90      0.89        41
         9.0       1.00      0.77      0.87        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:54:58,558 - trainer - INFO - {
  "dev_loss": 0.2604627460241318,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:58,559 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:54:58,559 - trainer - INFO -   patience: 200
2022-10-17 14:54:58,560 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:58,560 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:58,561 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_110
2022-10-17 14:54:58,562 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_116
2022-10-17 14:54:58,566 - trainer - INFO - save model to path: tmp/mlp_digits\ck_116
2022-10-17 14:54:58,640 - trainer - INFO - 
*****************[epoch: 10, global step: 118] eval training set based on eval_every=2***************
2022-10-17 14:54:58,644 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       130
           1       0.91      0.95      0.93       130
           2       0.98      0.96      0.97       137
           3       0.92      0.95      0.94       128
           4       0.98      0.98      0.98       130
           5       0.96      0.96      0.96       127
           6       0.94      0.96      0.95       127
           7       0.93      0.96      0.95       137
           8       0.89      0.84      0.87       126
           9       0.92      0.84      0.88       128

    accuracy                           0.94      1300
   macro avg       0.94      0.94      0.94      1300
weighted avg       0.94      0.94      0.94      1300

2022-10-17 14:54:58,645 - trainer - INFO - {
  "train_accuracy_score": 0.9415384615384615,
  "train_loss": 0.13567731529474258
}
2022-10-17 14:54:58,966 - trainer - INFO - 
*****************[epoch: 10, global step: 118] eval development set based on eval_every=2***************
2022-10-17 14:54:58,969 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.91      0.95        32
         3.0       0.94      0.91      0.93        34
         4.0       0.86      1.00      0.92        36
         5.0       0.95      0.90      0.92        40
         6.0       0.93      0.97      0.95        38
         7.0       0.97      0.97      0.97        33
         8.0       0.89      0.83      0.86        41
         9.0       1.00      0.77      0.87        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:54:58,970 - trainer - INFO - {
  "dev_loss": 0.21122476955254874,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9388888888888889
}
2022-10-17 14:54:58,971 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:54:58,971 - trainer - INFO -   patience: 200
2022-10-17 14:54:58,972 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:58,973 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:58,973 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_112
2022-10-17 14:54:58,974 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_118
2022-10-17 14:54:58,979 - trainer - INFO - save model to path: tmp/mlp_digits\ck_118
2022-10-17 14:54:59,039 - trainer - INFO - 
*****************[epoch: 10, global step: 120] eval training set based on eval_every=2***************
2022-10-17 14:54:59,043 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.90      0.94      0.92       140
           2       0.98      0.97      0.97       145
           3       0.93      0.95      0.94       149
           4       0.97      0.98      0.98       145
           5       0.96      0.96      0.96       142
           6       0.93      0.97      0.95       143
           7       0.92      0.97      0.94       146
           8       0.90      0.83      0.86       133
           9       0.93      0.84      0.88       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:59,045 - trainer - INFO - {
  "train_accuracy_score": 0.9401530967292971,
  "train_loss": 0.18712371587753296
}
2022-10-17 14:54:59,323 - trainer - INFO - 
*****************[epoch: 10, global step: 120] eval development set based on eval_every=2***************
2022-10-17 14:54:59,327 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.84      1.00      0.91        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.94      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.93      0.93        40
         6.0       0.95      0.95      0.95        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.88      0.92        41
         9.0       1.00      0.84      0.91        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:54:59,329 - trainer - INFO - {
  "dev_loss": 0.1592902553578218,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:54:59,329 - trainer - INFO -    save the model with best score so far
2022-10-17 14:54:59,331 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:59,331 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:59,331 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_114
2022-10-17 14:54:59,333 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:54:59,337 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:54:59,337 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:54:59,337 - trainer - INFO -   patience: 200
2022-10-17 14:54:59,338 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:54:59,338 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_120
2022-10-17 14:54:59,343 - trainer - INFO - save model to path: tmp/mlp_digits\ck_120
2022-10-17 14:54:59,345 - trainer - INFO - 
*****************[epoch: 10, global step: 121] eval training set at end of epoch***************
2022-10-17 14:54:59,353 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.90      0.94      0.92       140
           2       0.98      0.97      0.97       145
           3       0.93      0.95      0.94       149
           4       0.97      0.98      0.98       145
           5       0.96      0.96      0.96       142
           6       0.93      0.97      0.95       143
           7       0.92      0.97      0.94       146
           8       0.90      0.83      0.86       133
           9       0.93      0.84      0.88       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:54:59,357 - trainer - INFO - {
  "train_accuracy_score": 0.9401530967292971,
  "train_loss": 0.18541940301656723
}
2022-10-17 14:54:59,361 - trainer - INFO - start training epoch 11
2022-10-17 14:54:59,362 - trainer - INFO - training using device=cuda
2022-10-17 14:54:59,362 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:54:59,363 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:54:59,451 - trainer - INFO - 
*****************[epoch: 11, global step: 122] eval training set based on eval_every=2***************
2022-10-17 14:54:59,454 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        25
           1       0.74      1.00      0.85        25
           2       0.96      1.00      0.98        24
           3       1.00      0.96      0.98        28
           4       1.00      0.96      0.98        26
           5       1.00      0.96      0.98        28
           6       1.00      0.76      0.86        25
           7       0.91      1.00      0.95        30
           8       0.77      0.81      0.79        21
           9       0.95      0.75      0.84        28

    accuracy                           0.92       260
   macro avg       0.93      0.92      0.92       260
weighted avg       0.93      0.92      0.92       260

2022-10-17 14:54:59,455 - trainer - INFO - {
  "train_accuracy_score": 0.9230769230769231,
  "train_loss": 0.213448166847229
}
2022-10-17 14:54:59,759 - trainer - INFO - 
*****************[epoch: 11, global step: 122] eval development set based on eval_every=2***************
2022-10-17 14:54:59,763 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.77      0.98      0.86        42
         2.0       0.94      1.00      0.97        32
         3.0       0.94      0.91      0.93        34
         4.0       1.00      0.97      0.99        36
         5.0       0.94      0.85      0.89        40
         6.0       0.94      0.84      0.89        38
         7.0       0.91      0.97      0.94        33
         8.0       0.95      0.95      0.95        41
         9.0       1.00      0.81      0.89        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:54:59,765 - trainer - INFO - {
  "dev_loss": 0.21824507166941962,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:54:59,765 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:54:59,766 - trainer - INFO -   patience: 200
2022-10-17 14:54:59,767 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:54:59,767 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:54:59,768 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_116
2022-10-17 14:54:59,769 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_122
2022-10-17 14:54:59,773 - trainer - INFO - save model to path: tmp/mlp_digits\ck_122
2022-10-17 14:54:59,844 - trainer - INFO - 
*****************[epoch: 11, global step: 124] eval training set based on eval_every=2***************
2022-10-17 14:54:59,847 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        52
           1       0.75      1.00      0.85        41
           2       0.98      1.00      0.99        54
           3       0.98      0.98      0.98        50
           4       1.00      0.96      0.98        55
           5       1.00      0.98      0.99        51
           6       1.00      0.85      0.92        52
           7       0.92      1.00      0.96        56
           8       0.89      0.91      0.90        46
           9       0.96      0.79      0.87        63

    accuracy                           0.94       520
   macro avg       0.95      0.95      0.94       520
weighted avg       0.95      0.94      0.94       520

2022-10-17 14:54:59,848 - trainer - INFO - {
  "train_accuracy_score": 0.9442307692307692,
  "train_loss": 0.1276587899774313
}
2022-10-17 14:55:00,197 - trainer - INFO - 
*****************[epoch: 11, global step: 124] eval development set based on eval_every=2***************
2022-10-17 14:55:00,200 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.87      0.81      0.84        42
         2.0       0.97      1.00      0.98        32
         3.0       0.86      0.94      0.90        34
         4.0       1.00      0.97      0.99        36
         5.0       0.97      0.82      0.89        40
         6.0       0.92      0.95      0.94        38
         7.0       0.91      0.97      0.94        33
         8.0       0.84      0.93      0.88        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:55:00,201 - trainer - INFO - {
  "dev_loss": 0.20907681435346603,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:55:00,202 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:00,202 - trainer - INFO -   patience: 200
2022-10-17 14:55:00,203 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:00,203 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:00,204 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_118
2022-10-17 14:55:00,205 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_124
2022-10-17 14:55:00,209 - trainer - INFO - save model to path: tmp/mlp_digits\ck_124
2022-10-17 14:55:00,277 - trainer - INFO - 
*****************[epoch: 11, global step: 126] eval training set based on eval_every=2***************
2022-10-17 14:55:00,280 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        72
           1       0.81      0.92      0.86        75
           2       0.97      1.00      0.99        76
           3       0.99      0.96      0.97        80
           4       1.00      0.98      0.99        82
           5       1.00      0.96      0.98        82
           6       0.99      0.89      0.94        76
           7       0.94      1.00      0.97        79
           8       0.85      0.95      0.90        74
           9       0.94      0.81      0.87        84

    accuracy                           0.95       780
   macro avg       0.95      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:55:00,282 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.1425451524555683
}
2022-10-17 14:55:00,578 - trainer - INFO - 
*****************[epoch: 11, global step: 126] eval development set based on eval_every=2***************
2022-10-17 14:55:00,582 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.90      0.88      0.89        42
         2.0       1.00      1.00      1.00        32
         3.0       0.87      0.97      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.92      0.95        38
         7.0       0.97      0.97      0.97        33
         8.0       0.92      0.88      0.90        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.94       360
   macro avg       0.94      0.95      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:00,583 - trainer - INFO - {
  "dev_loss": 0.21052010481556258,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:55:00,583 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:00,586 - trainer - INFO -   patience: 200
2022-10-17 14:55:00,587 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:00,587 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:00,587 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_120
2022-10-17 14:55:00,589 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_126
2022-10-17 14:55:00,593 - trainer - INFO - save model to path: tmp/mlp_digits\ck_126
2022-10-17 14:55:00,655 - trainer - INFO - 
*****************[epoch: 11, global step: 128] eval training set based on eval_every=2***************
2022-10-17 14:55:00,661 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       107
           1       0.82      0.90      0.86       103
           2       0.96      1.00      0.98        98
           3       0.98      0.96      0.97       105
           4       1.00      0.98      0.99       107
           5       0.99      0.97      0.98       100
           6       0.99      0.90      0.94       103
           7       0.95      0.99      0.97       107
           8       0.84      0.92      0.88        98
           9       0.94      0.83      0.88       112

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:00,662 - trainer - INFO - {
  "train_accuracy_score": 0.9451923076923077,
  "train_loss": 0.17203540354967117
}
2022-10-17 14:55:00,938 - trainer - INFO - 
*****************[epoch: 11, global step: 128] eval development set based on eval_every=2***************
2022-10-17 14:55:00,944 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.93      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       0.89      0.94      0.91        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.92      0.95        38
         7.0       0.97      0.97      0.97        33
         8.0       0.94      0.83      0.88        41
         9.0       0.81      0.97      0.88        31

    accuracy                           0.94       360
   macro avg       0.94      0.95      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:00,945 - trainer - INFO - {
  "dev_loss": 0.241204264263312,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:55:00,946 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:00,946 - trainer - INFO -   patience: 200
2022-10-17 14:55:00,948 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:00,948 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:00,948 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_122
2022-10-17 14:55:00,950 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_128
2022-10-17 14:55:00,956 - trainer - INFO - save model to path: tmp/mlp_digits\ck_128
2022-10-17 14:55:01,026 - trainer - INFO - 
*****************[epoch: 11, global step: 130] eval training set based on eval_every=2***************
2022-10-17 14:55:01,031 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       128
           1       0.85      0.92      0.88       131
           2       0.97      1.00      0.98       126
           3       0.98      0.95      0.96       135
           4       1.00      0.97      0.99       136
           5       0.99      0.98      0.98       124
           6       0.99      0.92      0.96       130
           7       0.96      0.99      0.97       131
           8       0.87      0.92      0.89       121
           9       0.93      0.86      0.89       138

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:01,032 - trainer - INFO - {
  "train_accuracy_score": 0.9507692307692308,
  "train_loss": 0.11756588146090508
}
2022-10-17 14:55:01,309 - trainer - INFO - 
*****************[epoch: 11, global step: 130] eval development set based on eval_every=2***************
2022-10-17 14:55:01,312 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.88      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       0.89      0.91      0.90        34
         4.0       0.88      1.00      0.94        36
         5.0       0.97      0.90      0.94        40
         6.0       0.92      0.92      0.92        38
         7.0       0.97      0.97      0.97        33
         8.0       0.92      0.80      0.86        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:01,315 - trainer - INFO - {
  "dev_loss": 0.25162654370069504,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:55:01,315 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:01,316 - trainer - INFO -   patience: 200
2022-10-17 14:55:01,317 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:01,317 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:01,317 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_124
2022-10-17 14:55:01,318 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_130
2022-10-17 14:55:01,324 - trainer - INFO - save model to path: tmp/mlp_digits\ck_130
2022-10-17 14:55:01,425 - trainer - INFO - 
*****************[epoch: 11, global step: 132] eval training set based on eval_every=2***************
2022-10-17 14:55:01,428 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.85      0.93      0.89       140
           2       0.97      0.99      0.98       145
           3       0.98      0.95      0.97       149
           4       1.00      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.99      0.93      0.96       143
           7       0.96      0.99      0.98       146
           8       0.87      0.92      0.89       133
           9       0.93      0.87      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:01,430 - trainer - INFO - {
  "train_accuracy_score": 0.9526791927627001,
  "train_loss": 0.04792799847200513
}
2022-10-17 14:55:01,711 - trainer - INFO - 
*****************[epoch: 11, global step: 132] eval development set based on eval_every=2***************
2022-10-17 14:55:01,715 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.97      0.97        33
         1.0       0.94      0.69      0.79        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.97      0.96        34
         4.0       0.68      1.00      0.81        36
         5.0       1.00      0.85      0.92        40
         6.0       0.92      0.95      0.94        38
         7.0       0.97      0.97      0.97        33
         8.0       0.95      0.95      0.95        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:01,716 - trainer - INFO - {
  "dev_loss": 0.46266642957925797,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.95
}
2022-10-17 14:55:01,717 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:01,717 - trainer - INFO -   patience: 200
2022-10-17 14:55:01,718 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:01,719 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:01,719 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_126
2022-10-17 14:55:01,720 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_132
2022-10-17 14:55:01,725 - trainer - INFO - save model to path: tmp/mlp_digits\ck_132
2022-10-17 14:55:01,726 - trainer - INFO - 
*****************[epoch: 11, global step: 133] eval training set at end of epoch***************
2022-10-17 14:55:01,731 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.85      0.93      0.89       140
           2       0.97      0.99      0.98       145
           3       0.98      0.95      0.97       149
           4       1.00      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.99      0.93      0.96       143
           7       0.96      0.99      0.98       146
           8       0.87      0.92      0.89       133
           9       0.93      0.87      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:01,734 - trainer - INFO - {
  "train_accuracy_score": 0.9526791927627001,
  "train_loss": 0.13686356546046832
}
2022-10-17 14:55:01,734 - trainer - INFO - start training epoch 12
2022-10-17 14:55:01,735 - trainer - INFO - training using device=cuda
2022-10-17 14:55:01,735 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:01,735 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:01,818 - trainer - INFO - 
*****************[epoch: 12, global step: 134] eval training set based on eval_every=2***************
2022-10-17 14:55:01,821 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        28
           1       1.00      0.79      0.88        19
           2       1.00      1.00      1.00        29
           3       1.00      0.92      0.96        24
           4       0.80      0.97      0.88        29
           5       1.00      1.00      1.00        19
           6       1.00      0.92      0.96        26
           7       0.93      1.00      0.96        27
           8       0.83      0.96      0.89        25
           9       0.94      0.85      0.89        34

    accuracy                           0.94       260
   macro avg       0.95      0.94      0.94       260
weighted avg       0.95      0.94      0.94       260

2022-10-17 14:55:01,822 - trainer - INFO - {
  "train_accuracy_score": 0.9384615384615385,
  "train_loss": 0.2401503473520279
}
2022-10-17 14:55:02,101 - trainer - INFO - 
*****************[epoch: 12, global step: 134] eval development set based on eval_every=2***************
2022-10-17 14:55:02,104 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      0.93      0.92        42
         2.0       1.00      0.97      0.98        32
         3.0       0.87      0.97      0.92        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       0.95      0.93      0.94        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:02,105 - trainer - INFO - {
  "dev_loss": 0.16944069229066372,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:02,106 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:02,107 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:02,107 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:02,108 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_128
2022-10-17 14:55:02,109 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:02,112 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:02,112 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:02,113 - trainer - INFO -   patience: 200
2022-10-17 14:55:02,113 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:02,114 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_134
2022-10-17 14:55:02,119 - trainer - INFO - save model to path: tmp/mlp_digits\ck_134
2022-10-17 14:55:02,211 - trainer - INFO - 
*****************[epoch: 12, global step: 136] eval training set based on eval_every=2***************
2022-10-17 14:55:02,215 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        44
           1       0.98      0.90      0.93        48
           2       1.00      1.00      1.00        58
           3       0.98      0.96      0.97        55
           4       0.88      0.96      0.92        52
           5       0.98      1.00      0.99        45
           6       1.00      0.96      0.98        53
           7       0.96      1.00      0.98        53
           8       0.87      0.96      0.91        49
           9       0.97      0.89      0.93        63

    accuracy                           0.96       520
   macro avg       0.96      0.96      0.96       520
weighted avg       0.96      0.96      0.96       520

2022-10-17 14:55:02,216 - trainer - INFO - {
  "train_accuracy_score": 0.9596153846153846,
  "train_loss": 0.08062082901597023
}
2022-10-17 14:55:02,537 - trainer - INFO - 
*****************[epoch: 12, global step: 136] eval development set based on eval_every=2***************
2022-10-17 14:55:02,542 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.82      1.00      0.90        42
         2.0       1.00      1.00      1.00        32
         3.0       0.87      1.00      0.93        34
         4.0       1.00      0.81      0.89        36
         5.0       0.95      0.90      0.92        40
         6.0       0.88      0.92      0.90        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.85      0.92        41
         9.0       0.87      0.87      0.87        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:02,544 - trainer - INFO - {
  "dev_loss": 0.27885623400410015,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:02,545 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:02,545 - trainer - INFO -   patience: 200
2022-10-17 14:55:02,547 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:02,547 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:02,547 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_130
2022-10-17 14:55:02,549 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_136
2022-10-17 14:55:02,555 - trainer - INFO - save model to path: tmp/mlp_digits\ck_136
2022-10-17 14:55:02,683 - trainer - INFO - 
*****************[epoch: 12, global step: 138] eval training set based on eval_every=2***************
2022-10-17 14:55:02,686 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.97        76
           1       0.88      0.93      0.90        75
           2       1.00      0.99      0.99        82
           3       0.98      0.98      0.98        82
           4       0.91      0.82      0.86        84
           5       0.97      1.00      0.99        67
           6       0.91      0.95      0.93        74
           7       0.98      1.00      0.99        82
           8       0.89      0.92      0.91        73
           9       0.94      0.91      0.92        85

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.94      0.94      0.94       780

2022-10-17 14:55:02,687 - trainer - INFO - {
  "train_accuracy_score": 0.9435897435897436,
  "train_loss": 0.432283628731966
}
2022-10-17 14:55:02,987 - trainer - INFO - 
*****************[epoch: 12, global step: 138] eval development set based on eval_every=2***************
2022-10-17 14:55:02,990 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.93      0.95      0.94        42
         2.0       1.00      1.00      1.00        32
         3.0       0.77      1.00      0.87        34
         4.0       1.00      0.86      0.93        36
         5.0       0.94      0.85      0.89        40
         6.0       0.94      0.89      0.92        38
         7.0       0.94      0.97      0.96        33
         8.0       0.94      0.80      0.87        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:55:02,991 - trainer - INFO - {
  "dev_loss": 0.28835367287198704,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:02,992 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:02,992 - trainer - INFO -   patience: 200
2022-10-17 14:55:02,993 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:02,993 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:02,994 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_132
2022-10-17 14:55:02,995 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_138
2022-10-17 14:55:03,000 - trainer - INFO - save model to path: tmp/mlp_digits\ck_138
2022-10-17 14:55:03,077 - trainer - INFO - 
*****************[epoch: 12, global step: 140] eval training set based on eval_every=2***************
2022-10-17 14:55:03,081 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       111
           1       0.90      0.89      0.89       100
           2       0.99      0.99      0.99       107
           3       0.96      0.98      0.97       104
           4       0.93      0.85      0.89       111
           5       0.97      0.97      0.97        98
           6       0.93      0.95      0.94       102
           7       0.97      1.00      0.99       108
           8       0.91      0.94      0.92        96
           9       0.90      0.92      0.91       103

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:03,083 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.10813846066594124
}
2022-10-17 14:55:03,385 - trainer - INFO - 
*****************[epoch: 12, global step: 140] eval development set based on eval_every=2***************
2022-10-17 14:55:03,388 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      0.93      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       0.82      0.97      0.89        34
         4.0       0.88      0.97      0.92        36
         5.0       0.97      0.72      0.83        40
         6.0       0.97      0.89      0.93        38
         7.0       0.84      0.97      0.90        33
         8.0       0.94      0.83      0.88        41
         9.0       0.82      0.90      0.86        31

    accuracy                           0.91       360
   macro avg       0.91      0.92      0.91       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:55:03,389 - trainer - INFO - {
  "dev_loss": 0.30794743200143176,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:03,390 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:03,391 - trainer - INFO -   patience: 200
2022-10-17 14:55:03,392 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:03,392 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:03,393 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_134
2022-10-17 14:55:03,394 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_140
2022-10-17 14:55:03,399 - trainer - INFO - save model to path: tmp/mlp_digits\ck_140
2022-10-17 14:55:03,465 - trainer - INFO - 
*****************[epoch: 12, global step: 142] eval training set based on eval_every=2***************
2022-10-17 14:55:03,469 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.98      0.99       138
           1       0.90      0.90      0.90       125
           2       0.99      0.99      0.99       132
           3       0.96      0.98      0.97       129
           4       0.90      0.87      0.89       133
           5       0.98      0.97      0.97       127
           6       0.95      0.96      0.96       133
           7       0.98      1.00      0.99       130
           8       0.92      0.92      0.92       119
           9       0.90      0.90      0.90       134

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:03,470 - trainer - INFO - {
  "train_accuracy_score": 0.9476923076923077,
  "train_loss": 0.16947510093450546
}
2022-10-17 14:55:03,845 - trainer - INFO - 
*****************[epoch: 12, global step: 142] eval development set based on eval_every=2***************
2022-10-17 14:55:03,848 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       0.91      0.95      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.97      0.96        34
         4.0       0.81      0.97      0.89        36
         5.0       0.97      0.82      0.89        40
         6.0       0.97      0.89      0.93        38
         7.0       0.94      0.97      0.96        33
         8.0       0.89      0.83      0.86        41
         9.0       0.89      0.81      0.85        31

    accuracy                           0.92       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.92      0.92       360

2022-10-17 14:55:03,849 - trainer - INFO - {
  "dev_loss": 0.3105550209681193,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:03,850 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:03,850 - trainer - INFO -   patience: 200
2022-10-17 14:55:03,852 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:03,852 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:03,852 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_136
2022-10-17 14:55:03,853 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_142
2022-10-17 14:55:03,857 - trainer - INFO - save model to path: tmp/mlp_digits\ck_142
2022-10-17 14:55:03,909 - trainer - INFO - 
*****************[epoch: 12, global step: 144] eval training set based on eval_every=2***************
2022-10-17 14:55:03,913 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.98      0.98       145
           1       0.90      0.90      0.90       140
           2       0.99      0.99      0.99       145
           3       0.97      0.97      0.97       149
           4       0.91      0.88      0.90       145
           5       0.98      0.96      0.97       142
           6       0.95      0.95      0.95       143
           7       0.98      1.00      0.99       146
           8       0.92      0.93      0.93       133
           9       0.91      0.90      0.91       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:03,915 - trainer - INFO - {
  "train_accuracy_score": 0.9478079331941545,
  "train_loss": 0.15338226151652634
}
2022-10-17 14:55:04,203 - trainer - INFO - 
*****************[epoch: 12, global step: 144] eval development set based on eval_every=2***************
2022-10-17 14:55:04,209 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.84      0.98      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.89      0.94        38
         7.0       1.00      0.91      0.95        33
         8.0       0.88      0.90      0.89        41
         9.0       0.93      0.81      0.86        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:04,210 - trainer - INFO - {
  "dev_loss": 0.21606682116786638,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:04,211 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:04,211 - trainer - INFO -   patience: 200
2022-10-17 14:55:04,213 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:04,213 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:04,213 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_138
2022-10-17 14:55:04,215 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_144
2022-10-17 14:55:04,221 - trainer - INFO - save model to path: tmp/mlp_digits\ck_144
2022-10-17 14:55:04,222 - trainer - INFO - 
*****************[epoch: 12, global step: 145] eval training set at end of epoch***************
2022-10-17 14:55:04,228 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.98      0.98       145
           1       0.90      0.90      0.90       140
           2       0.99      0.99      0.99       145
           3       0.97      0.97      0.97       149
           4       0.91      0.88      0.90       145
           5       0.98      0.96      0.97       142
           6       0.95      0.95      0.95       143
           7       0.98      1.00      0.99       146
           8       0.92      0.93      0.93       133
           9       0.91      0.90      0.91       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:04,230 - trainer - INFO - {
  "train_accuracy_score": 0.9478079331941545,
  "train_loss": 0.19734177136948952
}
2022-10-17 14:55:04,231 - trainer - INFO - start training epoch 13
2022-10-17 14:55:04,231 - trainer - INFO - training using device=cuda
2022-10-17 14:55:04,232 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:04,232 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:04,297 - trainer - INFO - 
*****************[epoch: 13, global step: 146] eval training set based on eval_every=2***************
2022-10-17 14:55:04,301 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        31
           1       0.77      0.94      0.85        18
           2       1.00      0.96      0.98        27
           3       1.00      1.00      1.00        22
           4       0.93      0.93      0.93        30
           5       1.00      1.00      1.00        19
           6       1.00      1.00      1.00        24
           7       1.00      1.00      1.00        34
           8       0.86      0.96      0.91        25
           9       1.00      0.83      0.91        30

    accuracy                           0.96       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.96      0.96      0.96       260

2022-10-17 14:55:04,302 - trainer - INFO - {
  "train_accuracy_score": 0.9576923076923077,
  "train_loss": 0.1524517461657524
}
2022-10-17 14:55:04,583 - trainer - INFO - 
*****************[epoch: 13, global step: 146] eval development set based on eval_every=2***************
2022-10-17 14:55:04,587 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.87      0.93      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      0.97      0.97        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.87      0.93        38
         7.0       0.97      0.91      0.94        33
         8.0       0.87      0.95      0.91        41
         9.0       0.93      0.87      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:04,587 - trainer - INFO - {
  "dev_loss": 0.23981082066893578,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:04,588 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:04,588 - trainer - INFO -   patience: 200
2022-10-17 14:55:04,589 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:04,589 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:04,590 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_140
2022-10-17 14:55:04,592 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_146
2022-10-17 14:55:04,598 - trainer - INFO - save model to path: tmp/mlp_digits\ck_146
2022-10-17 14:55:04,676 - trainer - INFO - 
*****************[epoch: 13, global step: 148] eval training set based on eval_every=2***************
2022-10-17 14:55:04,679 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.94      0.96        63
           1       0.83      0.98      0.90        41
           2       1.00      0.98      0.99        51
           3       1.00      0.98      0.99        44
           4       0.96      0.91      0.93        55
           5       0.91      1.00      0.96        43
           6       1.00      0.96      0.98        49
           7       1.00      0.97      0.98        58
           8       0.82      0.96      0.88        48
           9       0.97      0.87      0.91        68

    accuracy                           0.95       520
   macro avg       0.95      0.95      0.95       520
weighted avg       0.95      0.95      0.95       520

2022-10-17 14:55:04,680 - trainer - INFO - {
  "train_accuracy_score": 0.948076923076923,
  "train_loss": 0.17838506400585175
}
2022-10-17 14:55:04,999 - trainer - INFO - 
*****************[epoch: 13, global step: 148] eval development set based on eval_every=2***************
2022-10-17 14:55:05,003 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.90      0.90      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      0.97      0.97        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      0.91      0.92        33
         8.0       0.86      0.88      0.87        41
         9.0       0.80      0.90      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:05,004 - trainer - INFO - {
  "dev_loss": 0.22201226651668549,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:05,005 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:55:05,005 - trainer - INFO -   patience: 200
2022-10-17 14:55:05,006 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:05,007 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:05,007 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_142
2022-10-17 14:55:05,008 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_148
2022-10-17 14:55:05,014 - trainer - INFO - save model to path: tmp/mlp_digits\ck_148
2022-10-17 14:55:05,081 - trainer - INFO - 
*****************[epoch: 13, global step: 150] eval training set based on eval_every=2***************
2022-10-17 14:55:05,085 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97        91
           1       0.87      0.99      0.93        69
           2       1.00      0.96      0.98        83
           3       0.97      0.99      0.98        71
           4       0.96      0.92      0.94        77
           5       0.95      0.97      0.96        79
           6       0.99      0.94      0.96        71
           7       0.99      0.98      0.98        85
           8       0.83      0.96      0.89        68
           9       0.96      0.87      0.91        86

    accuracy                           0.95       780
   macro avg       0.95      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:55:05,086 - trainer - INFO - {
  "train_accuracy_score": 0.9512820512820512,
  "train_loss": 0.12374872714281082
}
2022-10-17 14:55:05,375 - trainer - INFO - 
*****************[epoch: 13, global step: 150] eval development set based on eval_every=2***************
2022-10-17 14:55:05,378 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.95      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       0.90      1.00      0.95        36
         5.0       0.95      0.95      0.95        40
         6.0       0.97      0.92      0.95        38
         7.0       0.97      0.94      0.95        33
         8.0       0.97      0.78      0.86        41
         9.0       0.78      0.94      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:05,379 - trainer - INFO - {
  "dev_loss": 0.2186987685660521,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:05,380 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:55:05,380 - trainer - INFO -   patience: 200
2022-10-17 14:55:05,381 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:05,381 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:05,382 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_144
2022-10-17 14:55:05,383 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_150
2022-10-17 14:55:05,388 - trainer - INFO - save model to path: tmp/mlp_digits\ck_150
2022-10-17 14:55:05,464 - trainer - INFO - 
*****************[epoch: 13, global step: 152] eval training set based on eval_every=2***************
2022-10-17 14:55:05,469 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.97       116
           1       0.87      0.97      0.92        97
           2       1.00      0.97      0.99       111
           3       0.98      0.98      0.98       105
           4       0.93      0.94      0.94       106
           5       0.96      0.98      0.97       104
           6       0.99      0.96      0.97       101
           7       0.99      0.98      0.99       104
           8       0.85      0.91      0.88        91
           9       0.95      0.86      0.90       105

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:05,470 - trainer - INFO - {
  "train_accuracy_score": 0.9519230769230769,
  "train_loss": 0.11720974370837212
}
2022-10-17 14:55:05,764 - trainer - INFO - 
*****************[epoch: 13, global step: 152] eval development set based on eval_every=2***************
2022-10-17 14:55:05,767 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.95      0.93        42
         2.0       0.94      1.00      0.97        32
         3.0       0.94      0.94      0.94        34
         4.0       0.92      1.00      0.96        36
         5.0       0.95      0.93      0.94        40
         6.0       0.95      0.95      0.95        38
         7.0       0.94      0.94      0.94        33
         8.0       1.00      0.71      0.83        41
         9.0       0.81      0.94      0.87        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:05,768 - trainer - INFO - {
  "dev_loss": 0.2382949503759543,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:05,768 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:55:05,769 - trainer - INFO -   patience: 200
2022-10-17 14:55:05,770 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:05,770 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:05,771 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_146
2022-10-17 14:55:05,772 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_152
2022-10-17 14:55:05,777 - trainer - INFO - save model to path: tmp/mlp_digits\ck_152
2022-10-17 14:55:05,846 - trainer - INFO - 
*****************[epoch: 13, global step: 154] eval training set based on eval_every=2***************
2022-10-17 14:55:05,850 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.98       136
           1       0.88      0.96      0.92       127
           2       0.99      0.98      0.99       135
           3       0.99      0.99      0.99       134
           4       0.94      0.95      0.95       132
           5       0.97      0.98      0.98       129
           6       0.98      0.97      0.98       124
           7       0.99      0.98      0.99       127
           8       0.88      0.91      0.89       121
           9       0.95      0.88      0.92       135

    accuracy                           0.96      1300
   macro avg       0.96      0.96      0.96      1300
weighted avg       0.96      0.96      0.96      1300

2022-10-17 14:55:05,852 - trainer - INFO - {
  "train_accuracy_score": 0.9569230769230769,
  "train_loss": 0.08650853857398033
}
2022-10-17 14:55:06,178 - trainer - INFO - 
*****************[epoch: 13, global step: 154] eval development set based on eval_every=2***************
2022-10-17 14:55:06,181 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.93      0.91        42
         2.0       0.91      1.00      0.96        32
         3.0       0.92      0.97      0.94        34
         4.0       0.92      1.00      0.96        36
         5.0       0.95      0.90      0.92        40
         6.0       0.95      0.95      0.95        38
         7.0       0.94      0.97      0.96        33
         8.0       1.00      0.68      0.81        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:06,183 - trainer - INFO - {
  "dev_loss": 0.2712279458840688,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:06,184 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:55:06,184 - trainer - INFO -   patience: 200
2022-10-17 14:55:06,186 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:06,186 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:06,186 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_148
2022-10-17 14:55:06,188 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_154
2022-10-17 14:55:06,193 - trainer - INFO - save model to path: tmp/mlp_digits\ck_154
2022-10-17 14:55:06,256 - trainer - INFO - 
*****************[epoch: 13, global step: 156] eval training set based on eval_every=2***************
2022-10-17 14:55:06,262 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.87      0.96      0.91       140
           2       0.98      0.98      0.98       145
           3       0.99      0.97      0.98       149
           4       0.94      0.94      0.94       145
           5       0.97      0.99      0.98       142
           6       0.99      0.96      0.97       143
           7       0.99      0.98      0.98       146
           8       0.88      0.90      0.89       133
           9       0.96      0.89      0.92       149

    accuracy                           0.95      1437
   macro avg       0.96      0.95      0.95      1437
weighted avg       0.96      0.95      0.96      1437

2022-10-17 14:55:06,264 - trainer - INFO - {
  "train_accuracy_score": 0.9547668754349339,
  "train_loss": 0.11781824007630348
}
2022-10-17 14:55:06,579 - trainer - INFO - 
*****************[epoch: 13, global step: 156] eval development set based on eval_every=2***************
2022-10-17 14:55:06,582 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.95      0.92        42
         2.0       0.94      1.00      0.97        32
         3.0       0.92      0.97      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.90      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       1.00      0.76      0.86        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:06,583 - trainer - INFO - {
  "dev_loss": 0.21563045059641203,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:06,584 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:55:06,584 - trainer - INFO -   patience: 200
2022-10-17 14:55:06,586 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:06,586 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:06,586 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_150
2022-10-17 14:55:06,587 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_156
2022-10-17 14:55:06,592 - trainer - INFO - save model to path: tmp/mlp_digits\ck_156
2022-10-17 14:55:06,595 - trainer - INFO - 
*****************[epoch: 13, global step: 157] eval training set at end of epoch***************
2022-10-17 14:55:06,600 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.87      0.96      0.91       140
           2       0.98      0.98      0.98       145
           3       0.99      0.97      0.98       149
           4       0.94      0.94      0.94       145
           5       0.97      0.99      0.98       142
           6       0.99      0.96      0.97       143
           7       0.99      0.98      0.98       146
           8       0.88      0.90      0.89       133
           9       0.96      0.89      0.92       149

    accuracy                           0.95      1437
   macro avg       0.96      0.95      0.95      1437
weighted avg       0.96      0.95      0.96      1437

2022-10-17 14:55:06,603 - trainer - INFO - {
  "train_accuracy_score": 0.9547668754349339,
  "train_loss": 0.12935367661217848
}
2022-10-17 14:55:06,604 - trainer - INFO - start training epoch 14
2022-10-17 14:55:06,604 - trainer - INFO - training using device=cuda
2022-10-17 14:55:06,604 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:06,605 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:06,664 - trainer - INFO - 
*****************[epoch: 14, global step: 158] eval training set based on eval_every=2***************
2022-10-17 14:55:06,669 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.89      1.00      0.94        25
           2       1.00      1.00      1.00        32
           3       0.96      1.00      0.98        24
           4       1.00      0.96      0.98        25
           5       1.00      1.00      1.00        28
           6       1.00      1.00      1.00        33
           7       0.96      0.93      0.94        27
           8       0.88      0.79      0.83        19
           9       0.93      0.93      0.93        29

    accuracy                           0.97       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.97      0.97      0.96       260

2022-10-17 14:55:06,670 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.10215028747916222
}
2022-10-17 14:55:06,950 - trainer - INFO - 
*****************[epoch: 14, global step: 158] eval development set based on eval_every=2***************
2022-10-17 14:55:06,954 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.95      0.92        42
         2.0       0.97      0.97      0.97        32
         3.0       0.87      1.00      0.93        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.82      0.90        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.80      0.88        41
         9.0       0.85      0.90      0.88        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:06,956 - trainer - INFO - {
  "dev_loss": 0.20957542955875397,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:06,956 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:55:06,957 - trainer - INFO -   patience: 200
2022-10-17 14:55:06,958 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:06,958 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:06,959 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_152
2022-10-17 14:55:06,960 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_158
2022-10-17 14:55:06,965 - trainer - INFO - save model to path: tmp/mlp_digits\ck_158
2022-10-17 14:55:07,034 - trainer - INFO - 
*****************[epoch: 14, global step: 160] eval training set based on eval_every=2***************
2022-10-17 14:55:07,037 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        39
           1       0.86      1.00      0.93        56
           2       1.00      1.00      1.00        65
           3       0.96      1.00      0.98        53
           4       1.00      0.98      0.99        53
           5       1.00      0.98      0.99        48
           6       1.00      0.96      0.98        55
           7       0.92      0.96      0.94        51
           8       0.94      0.87      0.90        38
           9       0.96      0.87      0.92        62

    accuracy                           0.96       520
   macro avg       0.97      0.96      0.96       520
weighted avg       0.97      0.96      0.96       520

2022-10-17 14:55:07,039 - trainer - INFO - {
  "train_accuracy_score": 0.9634615384615385,
  "train_loss": 0.10587721318006516
}
2022-10-17 14:55:07,354 - trainer - INFO - 
*****************[epoch: 14, global step: 160] eval development set based on eval_every=2***************
2022-10-17 14:55:07,357 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.89      0.95      0.92        42
         2.0       1.00      0.97      0.98        32
         3.0       0.85      0.97      0.90        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.78      0.87        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.85      0.91        41
         9.0       0.82      0.90      0.86        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:07,358 - trainer - INFO - {
  "dev_loss": 0.21337506671746573,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:07,359 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:55:07,359 - trainer - INFO -   patience: 200
2022-10-17 14:55:07,360 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:07,361 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:07,361 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_154
2022-10-17 14:55:07,362 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_160
2022-10-17 14:55:07,367 - trainer - INFO - save model to path: tmp/mlp_digits\ck_160
2022-10-17 14:55:07,442 - trainer - INFO - 
*****************[epoch: 14, global step: 162] eval training set based on eval_every=2***************
2022-10-17 14:55:07,446 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99        73
           1       0.89      1.00      0.94        79
           2       1.00      1.00      1.00        88
           3       0.96      1.00      0.98        75
           4       0.99      0.99      0.99        77
           5       1.00      0.97      0.98        64
           6       1.00      0.97      0.98        86
           7       0.95      0.98      0.97        85
           8       0.97      0.93      0.95        69
           9       0.97      0.89      0.93        84

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:07,447 - trainer - INFO - {
  "train_accuracy_score": 0.9705128205128205,
  "train_loss": 0.06300315447151661
}
2022-10-17 14:55:07,755 - trainer - INFO - 
*****************[epoch: 14, global step: 162] eval development set based on eval_every=2***************
2022-10-17 14:55:07,758 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.91      0.93      0.92        42
         2.0       1.00      0.94      0.97        32
         3.0       0.86      0.91      0.89        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.82      0.90        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       0.90      0.85      0.88        41
         9.0       0.80      0.90      0.85        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:07,759 - trainer - INFO - {
  "dev_loss": 0.22706900785366693,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:07,760 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:55:07,760 - trainer - INFO -   patience: 200
2022-10-17 14:55:07,761 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:07,762 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:07,762 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_156
2022-10-17 14:55:07,763 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_162
2022-10-17 14:55:07,769 - trainer - INFO - save model to path: tmp/mlp_digits\ck_162
2022-10-17 14:55:07,844 - trainer - INFO - 
*****************[epoch: 14, global step: 164] eval training set based on eval_every=2***************
2022-10-17 14:55:07,847 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       106
           1       0.89      1.00      0.94       102
           2       1.00      0.99      1.00       105
           3       0.96      0.99      0.98       106
           4       0.98      0.97      0.98       110
           5       1.00      0.97      0.98        97
           6       1.00      0.97      0.99       110
           7       0.96      0.97      0.97       106
           8       0.95      0.93      0.94        85
           9       0.97      0.92      0.95       113

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:07,848 - trainer - INFO - {
  "train_accuracy_score": 0.9711538461538461,
  "train_loss": 0.0938565693795681
}
2022-10-17 14:55:08,119 - trainer - INFO - 
*****************[epoch: 14, global step: 164] eval development set based on eval_every=2***************
2022-10-17 14:55:08,122 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.94      0.97        32
         3.0       0.91      0.91      0.91        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.90      0.95        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.88      0.94        33
         8.0       0.92      0.88      0.90        41
         9.0       0.78      0.94      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:08,123 - trainer - INFO - {
  "dev_loss": 0.20512556036313376,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9555555555555556
}
2022-10-17 14:55:08,124 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:55:08,124 - trainer - INFO -   patience: 200
2022-10-17 14:55:08,125 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:08,126 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:08,126 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_158
2022-10-17 14:55:08,127 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_164
2022-10-17 14:55:08,134 - trainer - INFO - save model to path: tmp/mlp_digits\ck_164
2022-10-17 14:55:08,205 - trainer - INFO - 
*****************[epoch: 14, global step: 166] eval training set based on eval_every=2***************
2022-10-17 14:55:08,209 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.99       131
           1       0.89      1.00      0.94       124
           2       1.00      0.99      1.00       135
           3       0.97      0.98      0.97       131
           4       0.99      0.98      0.98       135
           5       1.00      0.96      0.98       129
           6       1.00      0.98      0.99       133
           7       0.97      0.98      0.97       134
           8       0.95      0.93      0.94       112
           9       0.95      0.92      0.94       136

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:08,211 - trainer - INFO - {
  "train_accuracy_score": 0.9707692307692307,
  "train_loss": 0.06527512520551682
}
2022-10-17 14:55:08,496 - trainer - INFO - 
*****************[epoch: 14, global step: 166] eval development set based on eval_every=2***************
2022-10-17 14:55:08,498 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.97      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.95      0.97        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.94      0.97        33
         8.0       0.95      0.88      0.91        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:08,499 - trainer - INFO - {
  "dev_loss": 0.15729922180374464,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:08,499 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:08,501 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:08,501 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:08,501 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_160
2022-10-17 14:55:08,507 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:08,513 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:08,514 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:08,514 - trainer - INFO -   patience: 200
2022-10-17 14:55:08,516 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:08,517 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_166
2022-10-17 14:55:08,526 - trainer - INFO - save model to path: tmp/mlp_digits\ck_166
2022-10-17 14:55:08,630 - trainer - INFO - 
*****************[epoch: 14, global step: 168] eval training set based on eval_every=2***************
2022-10-17 14:55:08,634 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.90      0.99      0.95       140
           2       1.00      0.99      1.00       145
           3       0.97      0.97      0.97       149
           4       0.99      0.97      0.98       145
           5       1.00      0.96      0.98       142
           6       1.00      0.98      0.99       143
           7       0.97      0.98      0.98       146
           8       0.95      0.93      0.94       133
           9       0.95      0.93      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:08,635 - trainer - INFO - {
  "train_accuracy_score": 0.9707724425887265,
  "train_loss": 0.1932951956987381
}
2022-10-17 14:55:08,911 - trainer - INFO - 
*****************[epoch: 14, global step: 168] eval development set based on eval_every=2***************
2022-10-17 14:55:08,914 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.86      0.92        42
         2.0       0.91      1.00      0.96        32
         3.0       0.59      0.97      0.73        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       0.93      0.61      0.74        41
         9.0       0.89      0.81      0.85        31

    accuracy                           0.91       360
   macro avg       0.93      0.91      0.91       360
weighted avg       0.93      0.91      0.91       360

2022-10-17 14:55:08,914 - trainer - INFO - {
  "dev_loss": 0.49236096690098446,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:08,915 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:08,915 - trainer - INFO -   patience: 200
2022-10-17 14:55:08,916 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:08,916 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:08,917 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_162
2022-10-17 14:55:08,918 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_168
2022-10-17 14:55:08,924 - trainer - INFO - save model to path: tmp/mlp_digits\ck_168
2022-10-17 14:55:08,926 - trainer - INFO - 
*****************[epoch: 14, global step: 169] eval training set at end of epoch***************
2022-10-17 14:55:08,931 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.90      0.99      0.95       140
           2       1.00      0.99      1.00       145
           3       0.97      0.97      0.97       149
           4       0.99      0.97      0.98       145
           5       1.00      0.96      0.98       142
           6       1.00      0.98      0.99       143
           7       0.97      0.98      0.98       146
           8       0.95      0.93      0.94       133
           9       0.95      0.93      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:08,933 - trainer - INFO - {
  "train_accuracy_score": 0.9707724425887265,
  "train_loss": 0.10390959090242784
}
2022-10-17 14:55:08,934 - trainer - INFO - start training epoch 15
2022-10-17 14:55:08,936 - trainer - INFO - training using device=cuda
2022-10-17 14:55:08,936 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:08,936 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:09,012 - trainer - INFO - 
*****************[epoch: 15, global step: 170] eval training set based on eval_every=2***************
2022-10-17 14:55:09,015 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        28
           1       0.95      0.86      0.90        22
           2       0.94      1.00      0.97        30
           3       0.69      0.97      0.81        37
           4       1.00      1.00      1.00        25
           5       0.92      1.00      0.96        23
           6       1.00      0.95      0.98        22
           7       1.00      0.92      0.96        26
           8       0.80      0.59      0.68        27
           9       1.00      0.70      0.82        20

    accuracy                           0.90       260
   macro avg       0.93      0.90      0.91       260
weighted avg       0.92      0.90      0.90       260

2022-10-17 14:55:09,016 - trainer - INFO - {
  "train_accuracy_score": 0.9038461538461539,
  "train_loss": 0.396479532122612
}
2022-10-17 14:55:09,298 - trainer - INFO - 
*****************[epoch: 15, global step: 170] eval development set based on eval_every=2***************
2022-10-17 14:55:09,302 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       1.00      0.76      0.86        42
         2.0       0.82      1.00      0.90        32
         3.0       0.62      0.91      0.74        34
         4.0       0.97      1.00      0.99        36
         5.0       0.86      0.95      0.90        40
         6.0       1.00      0.89      0.94        38
         7.0       1.00      0.91      0.95        33
         8.0       0.81      0.54      0.65        41
         9.0       0.85      0.90      0.88        31

    accuracy                           0.88       360
   macro avg       0.89      0.89      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:55:09,303 - trainer - INFO - {
  "dev_loss": 0.5444816549619039,
  "dev_accuracy": 0.8777777777777778,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:09,303 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:09,304 - trainer - INFO -   patience: 200
2022-10-17 14:55:09,305 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:09,305 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:09,305 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_164
2022-10-17 14:55:09,306 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_170
2022-10-17 14:55:09,312 - trainer - INFO - save model to path: tmp/mlp_digits\ck_170
2022-10-17 14:55:09,382 - trainer - INFO - 
*****************[epoch: 15, global step: 172] eval training set based on eval_every=2***************
2022-10-17 14:55:09,385 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        58
           1       0.91      0.84      0.88        38
           2       0.90      1.00      0.95        54
           3       0.68      0.91      0.78        67
           4       1.00      1.00      1.00        53
           5       0.96      0.98      0.97        53
           6       1.00      0.96      0.98        48
           7       1.00      0.92      0.96        49
           8       0.81      0.56      0.66        54
           9       0.91      0.85      0.88        46

    accuracy                           0.90       520
   macro avg       0.92      0.90      0.90       520
weighted avg       0.91      0.90      0.90       520

2022-10-17 14:55:09,387 - trainer - INFO - {
  "train_accuracy_score": 0.9019230769230769,
  "train_loss": 0.34216585755348206
}
2022-10-17 14:55:09,660 - trainer - INFO - 
*****************[epoch: 15, global step: 172] eval development set based on eval_every=2***************
2022-10-17 14:55:09,663 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      0.72      0.84        32
         3.0       1.00      0.56      0.72        34
         4.0       0.95      1.00      0.97        36
         5.0       0.87      1.00      0.93        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.62      0.83      0.71        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.89       360
   macro avg       0.92      0.89      0.89       360
weighted avg       0.91      0.89      0.89       360

2022-10-17 14:55:09,664 - trainer - INFO - {
  "dev_loss": 0.4508526275555293,
  "dev_accuracy": 0.8944444444444445,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:09,665 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:09,665 - trainer - INFO -   patience: 200
2022-10-17 14:55:09,667 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:09,667 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:09,668 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_166
2022-10-17 14:55:09,670 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_172
2022-10-17 14:55:09,674 - trainer - INFO - save model to path: tmp/mlp_digits\ck_172
2022-10-17 14:55:09,793 - trainer - INFO - 
*****************[epoch: 15, global step: 174] eval training set based on eval_every=2***************
2022-10-17 14:55:09,796 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        81
           1       0.93      0.91      0.92        68
           2       0.93      0.91      0.92        86
           3       0.72      0.89      0.80        85
           4       1.00      0.99      0.99        79
           5       0.96      0.99      0.98        80
           6       0.99      0.96      0.97        78
           7       0.99      0.95      0.97        76
           8       0.74      0.67      0.70        76
           9       0.92      0.86      0.89        71

    accuracy                           0.91       780
   macro avg       0.92      0.91      0.91       780
weighted avg       0.92      0.91      0.91       780

2022-10-17 14:55:09,797 - trainer - INFO - {
  "train_accuracy_score": 0.9128205128205128,
  "train_loss": 0.25310856103897095
}
2022-10-17 14:55:10,064 - trainer - INFO - 
*****************[epoch: 15, global step: 174] eval development set based on eval_every=2***************
2022-10-17 14:55:10,067 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.84      1.00      0.91        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.59      0.74        34
         4.0       0.92      1.00      0.96        36
         5.0       0.90      0.93      0.91        40
         6.0       0.84      0.95      0.89        38
         7.0       0.94      0.97      0.96        33
         8.0       0.78      0.61      0.68        41
         9.0       0.79      0.87      0.83        31

    accuracy                           0.89       360
   macro avg       0.89      0.89      0.88       360
weighted avg       0.89      0.89      0.88       360

2022-10-17 14:55:10,070 - trainer - INFO - {
  "dev_loss": 0.4016408125559489,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:10,071 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:10,071 - trainer - INFO -   patience: 200
2022-10-17 14:55:10,072 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:10,073 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:10,073 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_168
2022-10-17 14:55:10,075 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_174
2022-10-17 14:55:10,081 - trainer - INFO - save model to path: tmp/mlp_digits\ck_174
2022-10-17 14:55:10,154 - trainer - INFO - 
*****************[epoch: 15, global step: 176] eval training set based on eval_every=2***************
2022-10-17 14:55:10,157 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       111
           1       0.91      0.92      0.92        91
           2       0.94      0.93      0.93       107
           3       0.76      0.85      0.80       110
           4       0.99      0.99      0.99       105
           5       0.96      0.99      0.98        99
           6       0.94      0.96      0.95       105
           7       0.97      0.96      0.97       109
           8       0.75      0.67      0.71        99
           9       0.93      0.89      0.91       104

    accuracy                           0.92      1040
   macro avg       0.92      0.92      0.91      1040
weighted avg       0.92      0.92      0.92      1040

2022-10-17 14:55:10,159 - trainer - INFO - {
  "train_accuracy_score": 0.9163461538461538,
  "train_loss": 0.22159339487552643
}
2022-10-17 14:55:10,427 - trainer - INFO - 
*****************[epoch: 15, global step: 176] eval development set based on eval_every=2***************
2022-10-17 14:55:10,430 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.91      0.93        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.88      0.93        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.90      0.85      0.88        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:10,430 - trainer - INFO - {
  "dev_loss": 0.180380430072546,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:10,431 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:10,431 - trainer - INFO -   patience: 200
2022-10-17 14:55:10,432 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:10,433 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:10,433 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_170
2022-10-17 14:55:10,434 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_176
2022-10-17 14:55:10,438 - trainer - INFO - save model to path: tmp/mlp_digits\ck_176
2022-10-17 14:55:10,521 - trainer - INFO - 
*****************[epoch: 15, global step: 178] eval training set based on eval_every=2***************
2022-10-17 14:55:10,526 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       130
           1       0.89      0.94      0.92       121
           2       0.95      0.93      0.94       126
           3       0.78      0.85      0.81       142
           4       0.98      0.99      0.99       130
           5       0.97      0.95      0.96       130
           6       0.95      0.97      0.96       134
           7       0.95      0.97      0.96       133
           8       0.77      0.69      0.73       118
           9       0.93      0.87      0.90       136

    accuracy                           0.92      1300
   macro avg       0.92      0.92      0.92      1300
weighted avg       0.92      0.92      0.92      1300

2022-10-17 14:55:10,528 - trainer - INFO - {
  "train_accuracy_score": 0.916923076923077,
  "train_loss": 0.26349951326847076
}
2022-10-17 14:55:10,850 - trainer - INFO - 
*****************[epoch: 15, global step: 178] eval development set based on eval_every=2***************
2022-10-17 14:55:10,854 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.83      0.90        42
         2.0       0.97      1.00      0.98        32
         3.0       0.89      1.00      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.88      0.92        40
         6.0       0.97      0.89      0.93        38
         7.0       0.97      0.97      0.97        33
         8.0       0.90      0.90      0.90        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:10,855 - trainer - INFO - {
  "dev_loss": 0.2344878688454628,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:10,855 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:10,856 - trainer - INFO -   patience: 200
2022-10-17 14:55:10,857 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:10,857 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:10,858 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_172
2022-10-17 14:55:10,859 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_178
2022-10-17 14:55:10,863 - trainer - INFO - save model to path: tmp/mlp_digits\ck_178
2022-10-17 14:55:10,905 - trainer - INFO - 
*****************[epoch: 15, global step: 180] eval training set based on eval_every=2***************
2022-10-17 14:55:10,910 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.90      0.94      0.92       140
           2       0.96      0.94      0.95       145
           3       0.77      0.86      0.81       149
           4       0.99      0.99      0.99       145
           5       0.97      0.94      0.96       142
           6       0.95      0.97      0.96       143
           7       0.95      0.97      0.96       146
           8       0.79      0.72      0.75       133
           9       0.93      0.87      0.90       149

    accuracy                           0.92      1437
   macro avg       0.92      0.92      0.92      1437
weighted avg       0.92      0.92      0.92      1437

2022-10-17 14:55:10,912 - trainer - INFO - {
  "train_accuracy_score": 0.9199721642310369,
  "train_loss": 0.08903008745983243
}
2022-10-17 14:55:11,183 - trainer - INFO - 
*****************[epoch: 15, global step: 180] eval development set based on eval_every=2***************
2022-10-17 14:55:11,186 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.95      0.90      0.93        42
         2.0       0.91      1.00      0.96        32
         3.0       1.00      0.85      0.92        34
         4.0       0.95      1.00      0.97        36
         5.0       0.88      0.90      0.89        40
         6.0       1.00      0.87      0.93        38
         7.0       1.00      0.88      0.94        33
         8.0       0.88      0.88      0.88        41
         9.0       0.76      0.90      0.82        31

    accuracy                           0.92       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.92      0.92       360

2022-10-17 14:55:11,187 - trainer - INFO - {
  "dev_loss": 0.26396191368500393,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:11,187 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:55:11,188 - trainer - INFO -   patience: 200
2022-10-17 14:55:11,189 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:11,189 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:11,189 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_174
2022-10-17 14:55:11,191 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_180
2022-10-17 14:55:11,195 - trainer - INFO - save model to path: tmp/mlp_digits\ck_180
2022-10-17 14:55:11,196 - trainer - INFO - 
*****************[epoch: 15, global step: 181] eval training set at end of epoch***************
2022-10-17 14:55:11,202 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.90      0.94      0.92       140
           2       0.96      0.94      0.95       145
           3       0.77      0.86      0.81       149
           4       0.99      0.99      0.99       145
           5       0.97      0.94      0.96       142
           6       0.95      0.97      0.96       143
           7       0.95      0.97      0.96       146
           8       0.79      0.72      0.75       133
           9       0.93      0.87      0.90       149

    accuracy                           0.92      1437
   macro avg       0.92      0.92      0.92      1437
weighted avg       0.92      0.92      0.92      1437

2022-10-17 14:55:11,204 - trainer - INFO - {
  "train_accuracy_score": 0.9199721642310369,
  "train_loss": 0.2609794910531491
}
2022-10-17 14:55:11,205 - trainer - INFO - start training epoch 16
2022-10-17 14:55:11,205 - trainer - INFO - training using device=cuda
2022-10-17 14:55:11,205 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:11,206 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:11,268 - trainer - INFO - 
*****************[epoch: 16, global step: 182] eval training set based on eval_every=2***************
2022-10-17 14:55:11,271 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.96      0.96        24
           1       0.91      1.00      0.95        29
           2       0.88      0.95      0.91        22
           3       1.00      0.75      0.86        24
           4       0.97      0.97      0.97        30
           5       0.94      1.00      0.97        29
           6       1.00      0.96      0.98        27
           7       1.00      0.88      0.94        26
           8       0.95      0.82      0.88        22
           9       0.76      0.93      0.83        27

    accuracy                           0.93       260
   macro avg       0.93      0.92      0.92       260
weighted avg       0.93      0.93      0.93       260

2022-10-17 14:55:11,272 - trainer - INFO - {
  "train_accuracy_score": 0.926923076923077,
  "train_loss": 0.245906051248312
}
2022-10-17 14:55:11,587 - trainer - INFO - 
*****************[epoch: 16, global step: 182] eval development set based on eval_every=2***************
2022-10-17 14:55:11,591 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.90      0.88      0.89        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.85      0.91        34
         4.0       0.95      1.00      0.97        36
         5.0       0.78      0.90      0.84        40
         6.0       1.00      0.87      0.93        38
         7.0       1.00      0.94      0.97        33
         8.0       0.84      0.93      0.88        41
         9.0       0.88      0.74      0.81        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:55:11,593 - trainer - INFO - {
  "dev_loss": 0.2570471266905467,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:11,593 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:55:11,594 - trainer - INFO -   patience: 200
2022-10-17 14:55:11,595 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:11,595 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:11,596 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_176
2022-10-17 14:55:11,597 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_182
2022-10-17 14:55:11,602 - trainer - INFO - save model to path: tmp/mlp_digits\ck_182
2022-10-17 14:55:11,677 - trainer - INFO - 
*****************[epoch: 16, global step: 184] eval training set based on eval_every=2***************
2022-10-17 14:55:11,681 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.96      0.96        48
           1       0.95      0.90      0.93        62
           2       0.93      0.96      0.94        53
           3       1.00      0.86      0.92        42
           4       0.95      0.98      0.96        56
           5       0.92      1.00      0.96        57
           6       0.94      0.96      0.95        47
           7       1.00      0.89      0.94        53
           8       0.85      0.90      0.87        50
           9       0.81      0.85      0.83        52

    accuracy                           0.93       520
   macro avg       0.93      0.93      0.93       520
weighted avg       0.93      0.93      0.93       520

2022-10-17 14:55:11,682 - trainer - INFO - {
  "train_accuracy_score": 0.926923076923077,
  "train_loss": 0.21263156831264496
}
2022-10-17 14:55:11,998 - trainer - INFO - 
*****************[epoch: 16, global step: 184] eval development set based on eval_every=2***************
2022-10-17 14:55:12,002 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.85      0.98      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.90      0.94        41
         9.0       0.96      0.84      0.90        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:12,003 - trainer - INFO - {
  "dev_loss": 0.137868732213974,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:12,004 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:55:12,005 - trainer - INFO -   patience: 200
2022-10-17 14:55:12,007 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:12,010 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:12,010 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_178
2022-10-17 14:55:12,011 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_184
2022-10-17 14:55:12,016 - trainer - INFO - save model to path: tmp/mlp_digits\ck_184
2022-10-17 14:55:12,091 - trainer - INFO - 
*****************[epoch: 16, global step: 186] eval training set based on eval_every=2***************
2022-10-17 14:55:12,095 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97        75
           1       0.89      0.93      0.91        84
           2       0.95      0.97      0.96        73
           3       0.99      0.92      0.95        77
           4       0.96      0.97      0.97        76
           5       0.95      1.00      0.97        88
           6       0.96      0.96      0.96        71
           7       0.99      0.92      0.95        75
           8       0.87      0.89      0.88        74
           9       0.88      0.84      0.86        87

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.94      0.94      0.94       780

2022-10-17 14:55:12,096 - trainer - INFO - {
  "train_accuracy_score": 0.9371794871794872,
  "train_loss": 0.15779758244752884
}
2022-10-17 14:55:12,385 - trainer - INFO - 
*****************[epoch: 16, global step: 186] eval development set based on eval_every=2***************
2022-10-17 14:55:12,388 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      1.00      0.95        42
         2.0       1.00      0.94      0.97        32
         3.0       0.89      1.00      0.94        34
         4.0       1.00      0.97      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.89      0.93        38
         7.0       0.85      1.00      0.92        33
         8.0       0.95      0.90      0.92        41
         9.0       1.00      0.81      0.89        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:12,389 - trainer - INFO - {
  "dev_loss": 0.15629669030507407,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:12,390 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:55:12,390 - trainer - INFO -   patience: 200
2022-10-17 14:55:12,391 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:12,392 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:12,392 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_180
2022-10-17 14:55:12,393 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_186
2022-10-17 14:55:12,398 - trainer - INFO - save model to path: tmp/mlp_digits\ck_186
2022-10-17 14:55:12,471 - trainer - INFO - 
*****************[epoch: 16, global step: 188] eval training set based on eval_every=2***************
2022-10-17 14:55:12,476 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.97      0.98       106
           1       0.89      0.94      0.92       108
           2       0.96      0.95      0.95        98
           3       0.97      0.93      0.95        99
           4       0.96      0.97      0.97       103
           5       0.95      1.00      0.97       112
           6       0.97      0.95      0.96        96
           7       0.96      0.94      0.95       105
           8       0.88      0.92      0.90        96
           9       0.90      0.85      0.87       117

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:55:12,477 - trainer - INFO - {
  "train_accuracy_score": 0.9413461538461538,
  "train_loss": 0.19801244139671326
}
2022-10-17 14:55:12,751 - trainer - INFO - 
*****************[epoch: 16, global step: 188] eval development set based on eval_every=2***************
2022-10-17 14:55:12,754 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.91      1.00      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      0.94      0.97        36
         5.0       1.00      0.88      0.93        40
         6.0       0.97      0.92      0.95        38
         7.0       0.85      1.00      0.92        33
         8.0       0.93      0.90      0.91        41
         9.0       0.93      0.87      0.90        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:12,755 - trainer - INFO - {
  "dev_loss": 0.16838610668977103,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:12,755 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:55:12,756 - trainer - INFO -   patience: 200
2022-10-17 14:55:12,757 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:12,757 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:12,757 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_182
2022-10-17 14:55:12,758 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_188
2022-10-17 14:55:12,764 - trainer - INFO - save model to path: tmp/mlp_digits\ck_188
2022-10-17 14:55:12,846 - trainer - INFO - 
*****************[epoch: 16, global step: 190] eval training set based on eval_every=2***************
2022-10-17 14:55:12,850 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       132
           1       0.90      0.95      0.92       126
           2       0.97      0.96      0.96       125
           3       0.98      0.95      0.96       133
           4       0.97      0.97      0.97       129
           5       0.96      0.99      0.97       135
           6       0.98      0.95      0.96       128
           7       0.94      0.96      0.95       135
           8       0.89      0.92      0.91       116
           9       0.90      0.85      0.88       141

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:12,852 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.11445784941315651
}
2022-10-17 14:55:13,170 - trainer - INFO - 
*****************[epoch: 16, global step: 190] eval development set based on eval_every=2***************
2022-10-17 14:55:13,173 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.91      0.95      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.95      0.90      0.92        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:13,174 - trainer - INFO - {
  "dev_loss": 0.14749224949628115,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:13,175 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:55:13,175 - trainer - INFO -   patience: 200
2022-10-17 14:55:13,177 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:13,177 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:13,178 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_184
2022-10-17 14:55:13,180 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_190
2022-10-17 14:55:13,185 - trainer - INFO - save model to path: tmp/mlp_digits\ck_190
2022-10-17 14:55:13,247 - trainer - INFO - 
*****************[epoch: 16, global step: 192] eval training set based on eval_every=2***************
2022-10-17 14:55:13,251 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       145
           1       0.89      0.96      0.92       140
           2       0.97      0.97      0.97       145
           3       0.98      0.95      0.97       149
           4       0.97      0.95      0.96       145
           5       0.96      0.99      0.97       142
           6       0.98      0.95      0.96       143
           7       0.93      0.96      0.95       146
           8       0.90      0.93      0.92       133
           9       0.91      0.84      0.87       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:13,253 - trainer - INFO - {
  "train_accuracy_score": 0.9471120389700766,
  "train_loss": 0.0536496500717476
}
2022-10-17 14:55:13,567 - trainer - INFO - 
*****************[epoch: 16, global step: 192] eval development set based on eval_every=2***************
2022-10-17 14:55:13,571 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.93      0.98      0.95        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.94      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.82      0.90        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.94      0.97        33
         8.0       0.92      0.88      0.90        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:13,573 - trainer - INFO - {
  "dev_loss": 0.26822711651523906,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:13,574 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:55:13,575 - trainer - INFO -   patience: 200
2022-10-17 14:55:13,576 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:13,577 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:13,577 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_186
2022-10-17 14:55:13,579 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_192
2022-10-17 14:55:13,586 - trainer - INFO - save model to path: tmp/mlp_digits\ck_192
2022-10-17 14:55:13,588 - trainer - INFO - 
*****************[epoch: 16, global step: 193] eval training set at end of epoch***************
2022-10-17 14:55:13,596 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       145
           1       0.89      0.96      0.92       140
           2       0.97      0.97      0.97       145
           3       0.98      0.95      0.97       149
           4       0.97      0.95      0.96       145
           5       0.96      0.99      0.97       142
           6       0.98      0.95      0.96       143
           7       0.93      0.96      0.95       146
           8       0.90      0.93      0.92       133
           9       0.91      0.84      0.87       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:13,598 - trainer - INFO - {
  "train_accuracy_score": 0.9471120389700766,
  "train_loss": 0.1637425238150172
}
2022-10-17 14:55:13,599 - trainer - INFO - start training epoch 17
2022-10-17 14:55:13,599 - trainer - INFO - training using device=cuda
2022-10-17 14:55:13,599 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:13,600 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:13,680 - trainer - INFO - 
*****************[epoch: 17, global step: 194] eval training set based on eval_every=2***************
2022-10-17 14:55:13,683 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        23
           1       0.93      1.00      0.97        28
           2       1.00      0.96      0.98        25
           3       0.96      0.96      0.96        27
           4       0.96      0.96      0.96        27
           5       1.00      0.93      0.96        29
           6       0.93      1.00      0.96        25
           7       1.00      0.79      0.88        19
           8       0.95      0.86      0.90        22
           9       0.87      0.97      0.92        35

    accuracy                           0.95       260
   macro avg       0.96      0.94      0.95       260
weighted avg       0.95      0.95      0.95       260

2022-10-17 14:55:13,684 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.15735198929905891
}
2022-10-17 14:55:13,963 - trainer - INFO - 
*****************[epoch: 17, global step: 194] eval development set based on eval_every=2***************
2022-10-17 14:55:13,966 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.95      0.90      0.93        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.94      0.97        34
         4.0       0.90      1.00      0.95        36
         5.0       1.00      0.82      0.90        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      0.88      0.94        33
         8.0       0.92      0.83      0.87        41
         9.0       0.78      1.00      0.87        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:13,967 - trainer - INFO - {
  "dev_loss": 0.29875052720308304,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:13,968 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:55:13,968 - trainer - INFO -   patience: 200
2022-10-17 14:55:13,969 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:13,969 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:13,969 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_188
2022-10-17 14:55:13,971 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_194
2022-10-17 14:55:13,975 - trainer - INFO - save model to path: tmp/mlp_digits\ck_194
2022-10-17 14:55:14,048 - trainer - INFO - 
*****************[epoch: 17, global step: 196] eval training set based on eval_every=2***************
2022-10-17 14:55:14,052 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        52
           1       0.96      0.91      0.94        56
           2       1.00      0.98      0.99        51
           3       0.98      0.95      0.96        42
           4       0.89      0.98      0.93        51
           5       1.00      0.89      0.94        54
           6       0.90      0.98      0.94        53
           7       1.00      0.85      0.92        46
           8       0.97      0.83      0.90        42
           9       0.85      0.99      0.91        73

    accuracy                           0.94       520
   macro avg       0.95      0.94      0.94       520
weighted avg       0.95      0.94      0.94       520

2022-10-17 14:55:14,054 - trainer - INFO - {
  "train_accuracy_score": 0.9403846153846154,
  "train_loss": 0.19062933325767517
}
2022-10-17 14:55:14,395 - trainer - INFO - 
*****************[epoch: 17, global step: 196] eval development set based on eval_every=2***************
2022-10-17 14:55:14,398 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      0.86      0.90        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.97      0.99        34
         4.0       0.92      1.00      0.96        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.85      0.90        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:14,399 - trainer - INFO - {
  "dev_loss": 0.17806563526391983,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:14,399 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:55:14,400 - trainer - INFO -   patience: 200
2022-10-17 14:55:14,401 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:14,401 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:14,401 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_190
2022-10-17 14:55:14,403 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_196
2022-10-17 14:55:14,407 - trainer - INFO - save model to path: tmp/mlp_digits\ck_196
2022-10-17 14:55:14,482 - trainer - INFO - 
*****************[epoch: 17, global step: 198] eval training set based on eval_every=2***************
2022-10-17 14:55:14,485 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.99        78
           1       0.96      0.90      0.93        80
           2       1.00      0.99      0.99        78
           3       0.97      0.97      0.97        74
           4       0.90      0.99      0.94        75
           5       1.00      0.91      0.95        80
           6       0.93      0.99      0.95        75
           7       1.00      0.90      0.95        77
           8       0.98      0.88      0.93        68
           9       0.85      0.98      0.91        95

    accuracy                           0.95       780
   macro avg       0.96      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:55:14,487 - trainer - INFO - {
  "train_accuracy_score": 0.9512820512820512,
  "train_loss": 0.12429015710949898
}
2022-10-17 14:55:14,823 - trainer - INFO - 
*****************[epoch: 17, global step: 198] eval development set based on eval_every=2***************
2022-10-17 14:55:14,827 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.88      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       0.92      1.00      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.84      0.91        38
         7.0       0.94      0.97      0.96        33
         8.0       0.90      0.88      0.89        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.95      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:14,828 - trainer - INFO - {
  "dev_loss": 0.20617448662718138,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:14,830 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:55:14,834 - trainer - INFO -   patience: 200
2022-10-17 14:55:14,835 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:14,835 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:14,836 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_192
2022-10-17 14:55:14,837 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_198
2022-10-17 14:55:14,845 - trainer - INFO - save model to path: tmp/mlp_digits\ck_198
2022-10-17 14:55:14,913 - trainer - INFO - 
*****************[epoch: 17, global step: 200] eval training set based on eval_every=2***************
2022-10-17 14:55:14,916 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       104
           1       0.96      0.92      0.94       109
           2       0.99      0.99      0.99       102
           3       0.98      0.97      0.98       105
           4       0.92      0.99      0.95       101
           5       0.97      0.93      0.95        97
           6       0.94      0.96      0.95       101
           7       0.98      0.92      0.95       105
           8       0.98      0.90      0.94       101
           9       0.87      0.96      0.91       115

    accuracy                           0.95      1040
   macro avg       0.96      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:14,918 - trainer - INFO - {
  "train_accuracy_score": 0.9528846153846153,
  "train_loss": 0.1349434331059456
}
2022-10-17 14:55:15,208 - trainer - INFO - 
*****************[epoch: 17, global step: 200] eval development set based on eval_every=2***************
2022-10-17 14:55:15,211 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.95      0.93        42
         2.0       0.94      0.97      0.95        32
         3.0       0.92      1.00      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.84      0.91        38
         7.0       0.92      1.00      0.96        33
         8.0       0.92      0.88      0.90        41
         9.0       0.96      0.81      0.88        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:15,212 - trainer - INFO - {
  "dev_loss": 0.1757279671728611,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:15,213 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:55:15,213 - trainer - INFO -   patience: 200
2022-10-17 14:55:15,215 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:15,215 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:15,216 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_194
2022-10-17 14:55:15,217 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_200
2022-10-17 14:55:15,221 - trainer - INFO - save model to path: tmp/mlp_digits\ck_200
2022-10-17 14:55:15,293 - trainer - INFO - 
*****************[epoch: 17, global step: 202] eval training set based on eval_every=2***************
2022-10-17 14:55:15,297 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       129
           1       0.94      0.93      0.94       133
           2       0.99      0.99      0.99       128
           3       0.96      0.97      0.97       136
           4       0.92      0.97      0.94       124
           5       0.96      0.94      0.95       126
           6       0.95      0.96      0.96       131
           7       0.98      0.94      0.96       133
           8       0.96      0.90      0.93       121
           9       0.89      0.94      0.91       139

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:15,299 - trainer - INFO - {
  "train_accuracy_score": 0.953076923076923,
  "train_loss": 0.1611563377082348
}
2022-10-17 14:55:15,593 - trainer - INFO - 
*****************[epoch: 17, global step: 202] eval development set based on eval_every=2***************
2022-10-17 14:55:15,596 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.89      1.00      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       0.97      0.92      0.95        38
         7.0       0.94      1.00      0.97        33
         8.0       0.93      0.90      0.91        41
         9.0       1.00      0.84      0.91        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:15,597 - trainer - INFO - {
  "dev_loss": 0.11268976951638858,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:15,597 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:55:15,598 - trainer - INFO -   patience: 200
2022-10-17 14:55:15,599 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:15,599 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:15,599 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_196
2022-10-17 14:55:15,601 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_202
2022-10-17 14:55:15,606 - trainer - INFO - save model to path: tmp/mlp_digits\ck_202
2022-10-17 14:55:15,705 - trainer - INFO - 
*****************[epoch: 17, global step: 204] eval training set based on eval_every=2***************
2022-10-17 14:55:15,709 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.97      0.97       145
           1       0.93      0.94      0.93       140
           2       0.99      0.99      0.99       145
           3       0.96      0.97      0.97       149
           4       0.93      0.97      0.95       145
           5       0.96      0.95      0.96       142
           6       0.95      0.96      0.95       143
           7       0.98      0.95      0.96       146
           8       0.95      0.91      0.93       133
           9       0.88      0.91      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:15,711 - trainer - INFO - {
  "train_accuracy_score": 0.9512874043145442,
  "train_loss": 0.10468605137430131
}
2022-10-17 14:55:15,984 - trainer - INFO - 
*****************[epoch: 17, global step: 204] eval development set based on eval_every=2***************
2022-10-17 14:55:15,987 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.98      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      0.97      0.97        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.92      0.88      0.90        41
         9.0       0.96      0.87      0.92        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:15,988 - trainer - INFO - {
  "dev_loss": 0.1169183657815059,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:15,990 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:55:15,990 - trainer - INFO -   patience: 200
2022-10-17 14:55:15,994 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:15,994 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:15,994 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_198
2022-10-17 14:55:15,996 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_204
2022-10-17 14:55:16,000 - trainer - INFO - save model to path: tmp/mlp_digits\ck_204
2022-10-17 14:55:16,001 - trainer - INFO - 
*****************[epoch: 17, global step: 205] eval training set at end of epoch***************
2022-10-17 14:55:16,006 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.97      0.97       145
           1       0.93      0.94      0.93       140
           2       0.99      0.99      0.99       145
           3       0.96      0.97      0.97       149
           4       0.93      0.97      0.95       145
           5       0.96      0.95      0.96       142
           6       0.95      0.96      0.95       143
           7       0.98      0.95      0.96       146
           8       0.95      0.91      0.93       133
           9       0.88      0.91      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:16,008 - trainer - INFO - {
  "train_accuracy_score": 0.9512874043145442,
  "train_loss": 0.14550955030911913
}
2022-10-17 14:55:16,009 - trainer - INFO - start training epoch 18
2022-10-17 14:55:16,009 - trainer - INFO - training using device=cuda
2022-10-17 14:55:16,009 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:16,009 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:16,082 - trainer - INFO - 
*****************[epoch: 18, global step: 206] eval training set based on eval_every=2***************
2022-10-17 14:55:16,085 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        27
           1       0.88      1.00      0.93        28
           2       1.00      0.93      0.96        14
           3       1.00      0.97      0.98        30
           4       1.00      0.92      0.96        26
           5       1.00      0.95      0.97        19
           6       1.00      0.96      0.98        27
           7       0.93      1.00      0.96        27
           8       0.87      1.00      0.93        26
           9       0.94      0.83      0.88        36

    accuracy                           0.95       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.96      0.95      0.95       260

2022-10-17 14:55:16,087 - trainer - INFO - {
  "train_accuracy_score": 0.9538461538461539,
  "train_loss": 0.13289715722203255
}
2022-10-17 14:55:16,355 - trainer - INFO - 
*****************[epoch: 18, global step: 206] eval development set based on eval_every=2***************
2022-10-17 14:55:16,359 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.95      0.95      0.95        42
         2.0       1.00      0.94      0.97        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      0.97      0.97        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       0.93      0.90      0.91        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:16,360 - trainer - INFO - {
  "dev_loss": 0.15593123622238636,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:16,360 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:55:16,362 - trainer - INFO -   patience: 200
2022-10-17 14:55:16,363 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:16,365 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:16,366 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_200
2022-10-17 14:55:16,367 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_206
2022-10-17 14:55:16,373 - trainer - INFO - save model to path: tmp/mlp_digits\ck_206
2022-10-17 14:55:16,460 - trainer - INFO - 
*****************[epoch: 18, global step: 208] eval training set based on eval_every=2***************
2022-10-17 14:55:16,463 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        51
           1       0.91      0.98      0.94        60
           2       1.00      0.98      0.99        43
           3       0.98      0.94      0.96        54
           4       0.98      0.95      0.96        55
           5       1.00      0.97      0.99        37
           6       1.00      0.98      0.99        52
           7       0.96      1.00      0.98        54
           8       0.91      0.95      0.93        55
           9       0.91      0.88      0.90        59

    accuracy                           0.96       520
   macro avg       0.97      0.96      0.96       520
weighted avg       0.96      0.96      0.96       520

2022-10-17 14:55:16,464 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.09292758628726006
}
2022-10-17 14:55:16,740 - trainer - INFO - 
*****************[epoch: 18, global step: 208] eval development set based on eval_every=2***************
2022-10-17 14:55:16,743 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      0.88      0.91        42
         2.0       1.00      0.88      0.93        32
         3.0       0.94      0.97      0.96        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.93      0.95        40
         6.0       0.93      0.97      0.95        38
         7.0       1.00      0.97      0.98        33
         8.0       0.90      0.90      0.90        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:16,744 - trainer - INFO - {
  "dev_loss": 0.2005298063158989,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:16,744 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:55:16,745 - trainer - INFO -   patience: 200
2022-10-17 14:55:16,745 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:16,746 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:16,746 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_202
2022-10-17 14:55:16,748 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_208
2022-10-17 14:55:16,755 - trainer - INFO - save model to path: tmp/mlp_digits\ck_208
2022-10-17 14:55:16,883 - trainer - INFO - 
*****************[epoch: 18, global step: 210] eval training set based on eval_every=2***************
2022-10-17 14:55:16,886 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        84
           1       0.93      0.98      0.95        85
           2       0.98      0.96      0.97        68
           3       0.96      0.93      0.95        76
           4       0.97      0.96      0.97        79
           5       1.00      0.98      0.99        62
           6       0.97      0.99      0.98        71
           7       0.96      0.98      0.97        84
           8       0.94      0.96      0.95        84
           9       0.92      0.90      0.91        87

    accuracy                           0.96       780
   macro avg       0.96      0.96      0.96       780
weighted avg       0.96      0.96      0.96       780

2022-10-17 14:55:16,888 - trainer - INFO - {
  "train_accuracy_score": 0.9628205128205128,
  "train_loss": 0.08325891196727753
}
2022-10-17 14:55:17,153 - trainer - INFO - 
*****************[epoch: 18, global step: 210] eval development set based on eval_every=2***************
2022-10-17 14:55:17,157 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.93      0.88      0.90        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       0.92      1.00      0.96        36
         5.0       0.97      0.93      0.95        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.92      0.85      0.89        41
         9.0       0.86      0.97      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:17,158 - trainer - INFO - {
  "dev_loss": 0.16922161914408207,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9611111111111111
}
2022-10-17 14:55:17,159 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:55:17,159 - trainer - INFO -   patience: 200
2022-10-17 14:55:17,160 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:17,160 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:17,161 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_204
2022-10-17 14:55:17,162 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_210
2022-10-17 14:55:17,166 - trainer - INFO - save model to path: tmp/mlp_digits\ck_210
2022-10-17 14:55:17,252 - trainer - INFO - 
*****************[epoch: 18, global step: 212] eval training set based on eval_every=2***************
2022-10-17 14:55:17,257 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       108
           1       0.94      0.96      0.95       113
           2       0.99      0.97      0.98        97
           3       0.97      0.95      0.96        99
           4       0.98      0.97      0.98       108
           5       0.99      0.97      0.98        94
           6       0.94      0.99      0.97       100
           7       0.96      0.98      0.97       111
           8       0.95      0.96      0.96       104
           9       0.92      0.90      0.91       106

    accuracy                           0.96      1040
   macro avg       0.97      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:55:17,258 - trainer - INFO - {
  "train_accuracy_score": 0.9644230769230769,
  "train_loss": 0.1038714237511158
}
2022-10-17 14:55:17,579 - trainer - INFO - 
*****************[epoch: 18, global step: 212] eval development set based on eval_every=2***************
2022-10-17 14:55:17,583 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.98      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.94      0.97        33
         8.0       0.97      0.88      0.92        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.97      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:55:17,586 - trainer - INFO - {
  "dev_loss": 0.14388962338368097,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:17,587 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:17,588 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:17,589 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:17,589 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_206
2022-10-17 14:55:17,591 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:17,595 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:17,596 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:17,596 - trainer - INFO -   patience: 200
2022-10-17 14:55:17,597 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:17,597 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_212
2022-10-17 14:55:17,603 - trainer - INFO - save model to path: tmp/mlp_digits\ck_212
2022-10-17 14:55:17,684 - trainer - INFO - 
*****************[epoch: 18, global step: 214] eval training set based on eval_every=2***************
2022-10-17 14:55:17,688 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       0.94      0.96      0.95       128
           2       0.99      0.98      0.98       128
           3       0.98      0.96      0.97       130
           4       0.98      0.97      0.98       129
           5       0.99      0.98      0.98       125
           6       0.95      0.99      0.97       126
           7       0.97      0.99      0.98       136
           8       0.95      0.96      0.96       127
           9       0.94      0.92      0.93       137

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:17,689 - trainer - INFO - {
  "train_accuracy_score": 0.97,
  "train_loss": 0.032911017537117004
}
2022-10-17 14:55:18,019 - trainer - INFO - 
*****************[epoch: 18, global step: 214] eval development set based on eval_every=2***************
2022-10-17 14:55:18,022 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.95      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       0.89      1.00      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.91      0.95        33
         8.0       0.97      0.83      0.89        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:18,025 - trainer - INFO - {
  "dev_loss": 0.14233480269710222,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:18,025 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:18,026 - trainer - INFO -   patience: 200
2022-10-17 14:55:18,027 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:18,027 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:18,027 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_208
2022-10-17 14:55:18,029 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_214
2022-10-17 14:55:18,035 - trainer - INFO - save model to path: tmp/mlp_digits\ck_214
2022-10-17 14:55:18,090 - trainer - INFO - 
*****************[epoch: 18, global step: 216] eval training set based on eval_every=2***************
2022-10-17 14:55:18,094 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.94      0.96      0.95       140
           2       0.99      0.98      0.99       145
           3       0.98      0.97      0.97       149
           4       0.99      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.96      0.99      0.98       143
           7       0.97      0.99      0.98       146
           8       0.96      0.96      0.96       133
           9       0.94      0.92      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:18,096 - trainer - INFO - {
  "train_accuracy_score": 0.9721642310368824,
  "train_loss": 0.0740982461720705
}
2022-10-17 14:55:18,368 - trainer - INFO - 
*****************[epoch: 18, global step: 216] eval development set based on eval_every=2***************
2022-10-17 14:55:18,372 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.89      0.98      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.88      0.94        33
         8.0       0.97      0.85      0.91        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:18,373 - trainer - INFO - {
  "dev_loss": 0.14620736924310526,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:18,374 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:18,374 - trainer - INFO -   patience: 200
2022-10-17 14:55:18,375 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:18,376 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:18,376 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_210
2022-10-17 14:55:18,377 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_216
2022-10-17 14:55:18,382 - trainer - INFO - save model to path: tmp/mlp_digits\ck_216
2022-10-17 14:55:18,383 - trainer - INFO - 
*****************[epoch: 18, global step: 217] eval training set at end of epoch***************
2022-10-17 14:55:18,389 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.94      0.96      0.95       140
           2       0.99      0.98      0.99       145
           3       0.98      0.97      0.97       149
           4       0.99      0.97      0.98       145
           5       0.99      0.98      0.99       142
           6       0.96      0.99      0.98       143
           7       0.97      0.99      0.98       146
           8       0.96      0.96      0.96       133
           9       0.94      0.92      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:18,392 - trainer - INFO - {
  "train_accuracy_score": 0.9721642310368824,
  "train_loss": 0.08666072382281224
}
2022-10-17 14:55:18,394 - trainer - INFO - start training epoch 19
2022-10-17 14:55:18,398 - trainer - INFO - training using device=cuda
2022-10-17 14:55:18,398 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:18,399 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:18,476 - trainer - INFO - 
*****************[epoch: 19, global step: 218] eval training set based on eval_every=2***************
2022-10-17 14:55:18,479 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        29
           1       0.85      1.00      0.92        22
           2       1.00      1.00      1.00        26
           3       1.00      0.94      0.97        36
           4       1.00      0.95      0.98        21
           5       1.00      1.00      1.00        22
           6       1.00      1.00      1.00        22
           7       1.00      1.00      1.00        32
           8       0.92      0.88      0.90        25
           9       1.00      1.00      1.00        25

    accuracy                           0.98       260
   macro avg       0.98      0.98      0.98       260
weighted avg       0.98      0.98      0.98       260

2022-10-17 14:55:18,480 - trainer - INFO - {
  "train_accuracy_score": 0.9769230769230769,
  "train_loss": 0.0986519381403923
}
2022-10-17 14:55:18,760 - trainer - INFO - 
*****************[epoch: 19, global step: 218] eval development set based on eval_every=2***************
2022-10-17 14:55:18,763 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.79      0.89        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.95      0.97        40
         6.0       0.97      0.92      0.95        38
         7.0       1.00      0.91      0.95        33
         8.0       0.85      0.85      0.85        41
         9.0       0.81      0.97      0.88        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:18,764 - trainer - INFO - {
  "dev_loss": 0.2115937570730845,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:18,765 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:18,768 - trainer - INFO -   patience: 200
2022-10-17 14:55:18,769 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:18,770 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:18,770 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_212
2022-10-17 14:55:18,772 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_218
2022-10-17 14:55:18,777 - trainer - INFO - save model to path: tmp/mlp_digits\ck_218
2022-10-17 14:55:18,857 - trainer - INFO - 
*****************[epoch: 19, global step: 220] eval training set based on eval_every=2***************
2022-10-17 14:55:18,860 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        56
           1       0.83      1.00      0.91        48
           2       1.00      0.98      0.99        59
           3       1.00      0.93      0.96        57
           4       1.00      0.93      0.96        44
           5       1.00      0.94      0.97        50
           6       1.00      0.94      0.97        49
           7       1.00      0.98      0.99        58
           8       0.87      0.93      0.90        44
           9       0.95      0.98      0.96        55

    accuracy                           0.96       520
   macro avg       0.96      0.96      0.96       520
weighted avg       0.97      0.96      0.96       520

2022-10-17 14:55:18,861 - trainer - INFO - {
  "train_accuracy_score": 0.9634615384615385,
  "train_loss": 0.1518411785364151
}
2022-10-17 14:55:19,190 - trainer - INFO - 
*****************[epoch: 19, global step: 220] eval development set based on eval_every=2***************
2022-10-17 14:55:19,194 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.95      0.95        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.79      0.89        34
         4.0       0.92      1.00      0.96        36
         5.0       1.00      0.95      0.97        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       0.86      0.88      0.87        41
         9.0       0.86      0.97      0.91        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:19,195 - trainer - INFO - {
  "dev_loss": 0.221972679408888,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:19,195 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:19,196 - trainer - INFO -   patience: 200
2022-10-17 14:55:19,197 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:19,198 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:19,199 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_214
2022-10-17 14:55:19,200 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_220
2022-10-17 14:55:19,208 - trainer - INFO - save model to path: tmp/mlp_digits\ck_220
2022-10-17 14:55:19,284 - trainer - INFO - 
*****************[epoch: 19, global step: 222] eval training set based on eval_every=2***************
2022-10-17 14:55:19,288 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        81
           1       0.87      1.00      0.93        79
           2       1.00      0.99      0.99        86
           3       1.00      0.93      0.96        83
           4       1.00      0.96      0.98        75
           5       0.98      0.96      0.97        68
           6       0.99      0.94      0.96        77
           7       0.99      0.99      0.99        80
           8       0.89      0.96      0.92        69
           9       0.96      0.96      0.96        82

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:19,290 - trainer - INFO - {
  "train_accuracy_score": 0.9666666666666667,
  "train_loss": 0.0940113253891468
}
2022-10-17 14:55:19,598 - trainer - INFO - 
*****************[epoch: 19, global step: 222] eval development set based on eval_every=2***************
2022-10-17 14:55:19,602 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.81      0.88        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.79      0.89        34
         4.0       0.86      1.00      0.92        36
         5.0       0.97      0.97      0.97        40
         6.0       1.00      0.97      0.99        38
         7.0       0.91      0.97      0.94        33
         8.0       0.85      0.85      0.85        41
         9.0       0.81      0.97      0.88        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:19,604 - trainer - INFO - {
  "dev_loss": 0.30805722375710803,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:19,604 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:19,605 - trainer - INFO -   patience: 200
2022-10-17 14:55:19,606 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:19,606 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:19,606 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_216
2022-10-17 14:55:19,608 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_222
2022-10-17 14:55:19,612 - trainer - INFO - save model to path: tmp/mlp_digits\ck_222
2022-10-17 14:55:19,674 - trainer - INFO - 
*****************[epoch: 19, global step: 224] eval training set based on eval_every=2***************
2022-10-17 14:55:19,678 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       107
           1       0.89      0.97      0.93        96
           2       1.00      0.99      1.00       112
           3       1.00      0.91      0.95       110
           4       0.96      0.96      0.96       104
           5       0.98      0.97      0.97        99
           6       0.98      0.95      0.97       105
           7       0.98      0.99      0.99       105
           8       0.88      0.95      0.91        92
           9       0.95      0.95      0.95       110

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:55:19,679 - trainer - INFO - {
  "train_accuracy_score": 0.9625,
  "train_loss": 0.17692359164357185
}
2022-10-17 14:55:19,972 - trainer - INFO - 
*****************[epoch: 19, global step: 224] eval development set based on eval_every=2***************
2022-10-17 14:55:19,976 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.97      0.88      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.85      0.91        34
         4.0       0.94      0.94      0.94        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.91      0.95        33
         8.0       0.86      0.88      0.87        41
         9.0       0.76      1.00      0.86        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:19,977 - trainer - INFO - {
  "dev_loss": 0.25032327075799304,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:19,977 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:19,978 - trainer - INFO -   patience: 200
2022-10-17 14:55:19,979 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:19,979 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:19,979 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_218
2022-10-17 14:55:19,981 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_224
2022-10-17 14:55:19,985 - trainer - INFO - save model to path: tmp/mlp_digits\ck_224
2022-10-17 14:55:20,059 - trainer - INFO - 
*****************[epoch: 19, global step: 226] eval training set based on eval_every=2***************
2022-10-17 14:55:20,063 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       131
           1       0.90      0.98      0.94       122
           2       1.00      0.99      1.00       139
           3       1.00      0.92      0.96       135
           4       0.96      0.95      0.96       129
           5       0.98      0.97      0.98       131
           6       0.98      0.96      0.97       126
           7       0.99      0.98      0.98       135
           8       0.89      0.91      0.90       115
           9       0.93      0.96      0.95       137

    accuracy                           0.96      1300
   macro avg       0.96      0.96      0.96      1300
weighted avg       0.96      0.96      0.96      1300

2022-10-17 14:55:20,064 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.1626073271036148
}
2022-10-17 14:55:20,425 - trainer - INFO - 
*****************[epoch: 19, global step: 226] eval development set based on eval_every=2***************
2022-10-17 14:55:20,430 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       0.94      0.97      0.95        32
         3.0       0.91      0.88      0.90        34
         4.0       0.97      0.97      0.97        36
         5.0       0.97      0.90      0.94        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.88      0.94        33
         8.0       0.88      0.88      0.88        41
         9.0       0.79      0.97      0.87        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:20,431 - trainer - INFO - {
  "dev_loss": 0.24206366017460823,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:20,432 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:55:20,433 - trainer - INFO -   patience: 200
2022-10-17 14:55:20,434 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:20,434 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:20,434 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_220
2022-10-17 14:55:20,436 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_226
2022-10-17 14:55:20,441 - trainer - INFO - save model to path: tmp/mlp_digits\ck_226
2022-10-17 14:55:20,494 - trainer - INFO - 
*****************[epoch: 19, global step: 228] eval training set based on eval_every=2***************
2022-10-17 14:55:20,498 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.98       145
           1       0.91      0.97      0.94       140
           2       1.00      0.99      1.00       145
           3       1.00      0.92      0.96       149
           4       0.97      0.95      0.96       145
           5       0.99      0.97      0.98       142
           6       0.98      0.97      0.97       143
           7       0.99      0.98      0.98       146
           8       0.90      0.92      0.91       133
           9       0.94      0.97      0.95       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:55:20,500 - trainer - INFO - {
  "train_accuracy_score": 0.9631176061238692,
  "train_loss": 0.16712770238518715
}
2022-10-17 14:55:20,791 - trainer - INFO - 
*****************[epoch: 19, global step: 228] eval development set based on eval_every=2***************
2022-10-17 14:55:20,794 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.93      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.79      0.91      0.85        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.91      0.95        33
         8.0       0.84      0.90      0.87        41
         9.0       0.85      0.74      0.79        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:20,796 - trainer - INFO - {
  "dev_loss": 0.2850438356399536,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:20,796 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:55:20,797 - trainer - INFO -   patience: 200
2022-10-17 14:55:20,798 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:20,798 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:20,798 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_222
2022-10-17 14:55:20,799 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_228
2022-10-17 14:55:20,804 - trainer - INFO - save model to path: tmp/mlp_digits\ck_228
2022-10-17 14:55:20,805 - trainer - INFO - 
*****************[epoch: 19, global step: 229] eval training set at end of epoch***************
2022-10-17 14:55:20,810 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.98       145
           1       0.91      0.97      0.94       140
           2       1.00      0.99      1.00       145
           3       1.00      0.92      0.96       149
           4       0.97      0.95      0.96       145
           5       0.99      0.97      0.98       142
           6       0.98      0.97      0.97       143
           7       0.99      0.98      0.98       146
           8       0.90      0.92      0.91       133
           9       0.94      0.97      0.95       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:55:20,812 - trainer - INFO - {
  "train_accuracy_score": 0.9631176061238692,
  "train_loss": 0.14186051053305468
}
2022-10-17 14:55:20,813 - trainer - INFO - start training epoch 20
2022-10-17 14:55:20,813 - trainer - INFO - training using device=cuda
2022-10-17 14:55:20,813 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:20,814 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:20,893 - trainer - INFO - 
*****************[epoch: 20, global step: 230] eval training set based on eval_every=2***************
2022-10-17 14:55:20,896 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.93      0.96        28
           1       1.00      0.95      0.97        37
           2       1.00      1.00      1.00        23
           3       0.85      0.97      0.90        29
           4       0.91      1.00      0.95        20
           5       1.00      0.95      0.97        20
           6       0.94      1.00      0.97        16
           7       1.00      0.95      0.98        21
           8       0.94      1.00      0.97        34
           9       0.97      0.88      0.92        32

    accuracy                           0.96       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.96      0.96      0.96       260

2022-10-17 14:55:20,897 - trainer - INFO - {
  "train_accuracy_score": 0.9576923076923077,
  "train_loss": 0.19050657004117966
}
2022-10-17 14:55:21,178 - trainer - INFO - 
*****************[epoch: 20, global step: 230] eval development set based on eval_every=2***************
2022-10-17 14:55:21,181 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.97      0.98        33
         1.0       0.95      0.88      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.85      0.92        34
         4.0       0.84      1.00      0.91        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.94      0.97        33
         8.0       0.90      0.85      0.88        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:21,182 - trainer - INFO - {
  "dev_loss": 0.2745884085694949,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:21,183 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:55:21,184 - trainer - INFO -   patience: 200
2022-10-17 14:55:21,184 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:21,185 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:21,185 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_224
2022-10-17 14:55:21,186 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_230
2022-10-17 14:55:21,190 - trainer - INFO - save model to path: tmp/mlp_digits\ck_230
2022-10-17 14:55:21,264 - trainer - INFO - 
*****************[epoch: 20, global step: 232] eval training set based on eval_every=2***************
2022-10-17 14:55:21,268 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.97        56
           1       0.98      0.91      0.94        55
           2       1.00      1.00      1.00        46
           3       0.91      0.91      0.91        55
           4       0.94      0.98      0.96        45
           5       1.00      0.98      0.99        48
           6       0.92      0.98      0.95        45
           7       1.00      0.98      0.99        55
           8       0.97      0.98      0.97        57
           9       0.89      0.93      0.91        58

    accuracy                           0.96       520
   macro avg       0.96      0.96      0.96       520
weighted avg       0.96      0.96      0.96       520

2022-10-17 14:55:21,270 - trainer - INFO - {
  "train_accuracy_score": 0.9576923076923077,
  "train_loss": 0.11689821630716324
}
2022-10-17 14:55:21,630 - trainer - INFO - 
*****************[epoch: 20, global step: 232] eval development set based on eval_every=2***************
2022-10-17 14:55:21,633 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.95      0.94        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.74      0.85        34
         4.0       0.83      0.97      0.90        36
         5.0       0.97      0.97      0.97        40
         6.0       0.97      0.95      0.96        38
         7.0       0.91      0.94      0.93        33
         8.0       0.91      0.76      0.83        41
         9.0       0.77      0.97      0.86        31

    accuracy                           0.92       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:21,633 - trainer - INFO - {
  "dev_loss": 0.3586611623565356,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:21,634 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:55:21,634 - trainer - INFO -   patience: 200
2022-10-17 14:55:21,635 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:21,636 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:21,636 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_226
2022-10-17 14:55:21,637 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_232
2022-10-17 14:55:21,641 - trainer - INFO - save model to path: tmp/mlp_digits\ck_232
2022-10-17 14:55:21,705 - trainer - INFO - 
*****************[epoch: 20, global step: 234] eval training set based on eval_every=2***************
2022-10-17 14:55:21,708 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.94      0.97        86
           1       0.93      0.90      0.92        78
           2       1.00      1.00      1.00        80
           3       0.94      0.86      0.90        86
           4       0.89      0.96      0.92        74
           5       1.00      0.99      0.99        79
           6       0.93      0.97      0.95        68
           7       0.98      0.98      0.98        82
           8       0.96      0.93      0.94        73
           9       0.82      0.92      0.87        74

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.95      0.94      0.94       780

2022-10-17 14:55:21,710 - trainer - INFO - {
  "train_accuracy_score": 0.9435897435897436,
  "train_loss": 0.22791355103254318
}
2022-10-17 14:55:21,982 - trainer - INFO - 
*****************[epoch: 20, global step: 234] eval development set based on eval_every=2***************
2022-10-17 14:55:21,985 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.98      0.94        42
         2.0       0.91      1.00      0.96        32
         3.0       0.97      0.88      0.92        34
         4.0       0.95      0.97      0.96        36
         5.0       0.89      0.97      0.93        40
         6.0       1.00      0.89      0.94        38
         7.0       0.84      0.97      0.90        33
         8.0       1.00      0.83      0.91        41
         9.0       0.89      0.81      0.85        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:21,987 - trainer - INFO - {
  "dev_loss": 0.3801329433917999,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:21,988 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:55:21,989 - trainer - INFO -   patience: 200
2022-10-17 14:55:21,991 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:21,993 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:21,993 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_228
2022-10-17 14:55:21,995 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_234
2022-10-17 14:55:22,000 - trainer - INFO - save model to path: tmp/mlp_digits\ck_234
2022-10-17 14:55:22,065 - trainer - INFO - 
*****************[epoch: 20, global step: 236] eval training set based on eval_every=2***************
2022-10-17 14:55:22,068 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.95      0.97       110
           1       0.91      0.91      0.91       103
           2       0.98      1.00      0.99       106
           3       0.94      0.87      0.91       117
           4       0.89      0.95      0.92        98
           5       0.98      0.99      0.99       100
           6       0.95      0.96      0.95        99
           7       0.95      0.98      0.97       104
           8       0.96      0.90      0.93       100
           9       0.86      0.91      0.89       103

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:55:22,070 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.27942515164613724
}
2022-10-17 14:55:22,354 - trainer - INFO - 
*****************[epoch: 20, global step: 236] eval development set based on eval_every=2***************
2022-10-17 14:55:22,357 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       1.00      0.76      0.86        42
         2.0       0.91      1.00      0.96        32
         3.0       0.92      0.97      0.94        34
         4.0       0.97      0.97      0.97        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.89      0.94        38
         7.0       0.89      0.94      0.91        33
         8.0       0.81      0.93      0.86        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:22,358 - trainer - INFO - {
  "dev_loss": 0.3165775214632352,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:22,359 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:55:22,360 - trainer - INFO -   patience: 200
2022-10-17 14:55:22,361 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:22,361 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:22,361 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_230
2022-10-17 14:55:22,363 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_236
2022-10-17 14:55:22,367 - trainer - INFO - save model to path: tmp/mlp_digits\ck_236
2022-10-17 14:55:22,426 - trainer - INFO - 
*****************[epoch: 20, global step: 238] eval training set based on eval_every=2***************
2022-10-17 14:55:22,433 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.96      0.96       129
           1       0.93      0.90      0.91       124
           2       0.99      1.00      0.99       139
           3       0.95      0.89      0.92       137
           4       0.92      0.96      0.94       127
           5       0.98      0.98      0.98       124
           6       0.96      0.93      0.95       134
           7       0.95      0.98      0.97       129
           8       0.90      0.92      0.91       121
           9       0.88      0.90      0.89       136

    accuracy                           0.94      1300
   macro avg       0.94      0.94      0.94      1300
weighted avg       0.94      0.94      0.94      1300

2022-10-17 14:55:22,434 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.2583381161093712
}
2022-10-17 14:55:22,721 - trainer - INFO - 
*****************[epoch: 20, global step: 238] eval development set based on eval_every=2***************
2022-10-17 14:55:22,725 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.94      0.97        32
         3.0       0.92      0.97      0.94        34
         4.0       0.97      0.92      0.94        36
         5.0       0.97      0.90      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.88      0.94        33
         8.0       0.93      0.90      0.91        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:22,726 - trainer - INFO - {
  "dev_loss": 0.24083667869369188,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:22,726 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:55:22,727 - trainer - INFO -   patience: 200
2022-10-17 14:55:22,728 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:22,728 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:22,728 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_232
2022-10-17 14:55:22,730 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_238
2022-10-17 14:55:22,734 - trainer - INFO - save model to path: tmp/mlp_digits\ck_238
2022-10-17 14:55:22,824 - trainer - INFO - 
*****************[epoch: 20, global step: 240] eval training set based on eval_every=2***************
2022-10-17 14:55:22,828 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97       145
           1       0.91      0.91      0.91       140
           2       0.99      0.99      0.99       145
           3       0.94      0.90      0.92       149
           4       0.93      0.95      0.94       145
           5       0.99      0.96      0.98       142
           6       0.96      0.94      0.95       143
           7       0.95      0.98      0.97       146
           8       0.90      0.91      0.91       133
           9       0.88      0.91      0.90       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:55:22,829 - trainer - INFO - {
  "train_accuracy_score": 0.942240779401531,
  "train_loss": 0.9291336536407471
}
2022-10-17 14:55:23,099 - trainer - INFO - 
*****************[epoch: 20, global step: 240] eval development set based on eval_every=2***************
2022-10-17 14:55:23,103 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.87      1.00      0.93        33
         1.0       0.89      1.00      0.94        42
         2.0       1.00      0.88      0.93        32
         3.0       0.91      0.88      0.90        34
         4.0       0.97      0.92      0.94        36
         5.0       0.97      0.88      0.92        40
         6.0       0.90      1.00      0.95        38
         7.0       1.00      0.91      0.95        33
         8.0       0.84      0.88      0.86        41
         9.0       0.97      0.90      0.93        31

    accuracy                           0.93       360
   macro avg       0.93      0.92      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:23,104 - trainer - INFO - {
  "dev_loss": 0.3420792569716771,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:23,104 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:55:23,105 - trainer - INFO -   patience: 200
2022-10-17 14:55:23,106 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:23,106 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:23,106 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_234
2022-10-17 14:55:23,108 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_240
2022-10-17 14:55:23,113 - trainer - INFO - save model to path: tmp/mlp_digits\ck_240
2022-10-17 14:55:23,115 - trainer - INFO - 
*****************[epoch: 20, global step: 241] eval training set at end of epoch***************
2022-10-17 14:55:23,124 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97       145
           1       0.91      0.91      0.91       140
           2       0.99      0.99      0.99       145
           3       0.94      0.90      0.92       149
           4       0.93      0.95      0.94       145
           5       0.99      0.96      0.98       142
           6       0.96      0.94      0.95       143
           7       0.95      0.98      0.97       146
           8       0.90      0.91      0.91       133
           9       0.88      0.91      0.90       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:55:23,127 - trainer - INFO - {
  "train_accuracy_score": 0.942240779401531,
  "train_loss": 0.3337025431295236
}
2022-10-17 14:55:23,128 - trainer - INFO - start training epoch 21
2022-10-17 14:55:23,128 - trainer - INFO - training using device=cuda
2022-10-17 14:55:23,129 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:23,129 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:23,205 - trainer - INFO - 
*****************[epoch: 21, global step: 242] eval training set based on eval_every=2***************
2022-10-17 14:55:23,208 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        27
           1       0.96      0.93      0.94        27
           2       1.00      0.94      0.97        17
           3       1.00      1.00      1.00        29
           4       0.92      0.94      0.93        35
           5       1.00      0.92      0.96        26
           6       0.90      1.00      0.95        26
           7       1.00      0.88      0.93        24
           8       0.88      0.92      0.90        24
           9       0.92      0.96      0.94        25

    accuracy                           0.95       260
   macro avg       0.95      0.95      0.95       260
weighted avg       0.95      0.95      0.95       260

2022-10-17 14:55:23,209 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.17889239639043808
}
2022-10-17 14:55:23,486 - trainer - INFO - 
*****************[epoch: 21, global step: 242] eval development set based on eval_every=2***************
2022-10-17 14:55:23,491 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.97      0.97        33
         1.0       0.97      0.67      0.79        42
         2.0       1.00      0.88      0.93        32
         3.0       0.86      0.94      0.90        34
         4.0       0.88      1.00      0.94        36
         5.0       1.00      0.85      0.92        40
         6.0       0.84      1.00      0.92        38
         7.0       1.00      0.94      0.97        33
         8.0       0.76      0.90      0.82        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.92      0.91      0.90       360

2022-10-17 14:55:23,492 - trainer - INFO - {
  "dev_loss": 0.4880789468685786,
  "dev_accuracy": 0.9055555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:23,493 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:55:23,495 - trainer - INFO -   patience: 200
2022-10-17 14:55:23,496 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:23,497 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:23,497 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_236
2022-10-17 14:55:23,498 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_242
2022-10-17 14:55:23,504 - trainer - INFO - save model to path: tmp/mlp_digits\ck_242
2022-10-17 14:55:23,586 - trainer - INFO - 
*****************[epoch: 21, global step: 244] eval training set based on eval_every=2***************
2022-10-17 14:55:23,589 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98        55
           1       0.92      0.72      0.81        50
           2       1.00      0.96      0.98        48
           3       0.92      0.96      0.94        57
           4       0.88      0.95      0.91        55
           5       1.00      0.94      0.97        47
           6       0.94      1.00      0.97        58
           7       1.00      0.90      0.95        52
           8       0.77      0.96      0.85        46
           9       0.92      0.90      0.91        52

    accuracy                           0.93       520
   macro avg       0.93      0.93      0.93       520
weighted avg       0.93      0.93      0.93       520

2022-10-17 14:55:23,590 - trainer - INFO - {
  "train_accuracy_score": 0.9288461538461539,
  "train_loss": 0.2840579152107239
}
2022-10-17 14:55:23,871 - trainer - INFO - 
*****************[epoch: 21, global step: 244] eval development set based on eval_every=2***************
2022-10-17 14:55:23,875 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.94      0.38      0.54        42
         2.0       1.00      0.88      0.93        32
         3.0       0.85      1.00      0.92        34
         4.0       0.92      1.00      0.96        36
         5.0       1.00      0.90      0.95        40
         6.0       0.95      1.00      0.97        38
         7.0       0.91      0.97      0.94        33
         8.0       0.60      0.85      0.71        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.88       360
   macro avg       0.90      0.89      0.88       360
weighted avg       0.90      0.88      0.87       360

2022-10-17 14:55:23,876 - trainer - INFO - {
  "dev_loss": 0.3650129437446594,
  "dev_accuracy": 0.8805555555555555,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:23,876 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:55:23,877 - trainer - INFO -   patience: 200
2022-10-17 14:55:23,878 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:23,878 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:23,878 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_238
2022-10-17 14:55:23,879 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_244
2022-10-17 14:55:23,884 - trainer - INFO - save model to path: tmp/mlp_digits\ck_244
2022-10-17 14:55:24,004 - trainer - INFO - 
*****************[epoch: 21, global step: 246] eval training set based on eval_every=2***************
2022-10-17 14:55:24,007 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99        85
           1       0.92      0.62      0.74        79
           2       1.00      0.96      0.98        74
           3       0.89      0.95      0.92        79
           4       0.90      0.96      0.93        78
           5       0.99      0.95      0.97        74
           6       0.93      1.00      0.96        82
           7       0.96      0.92      0.94        73
           8       0.78      0.95      0.86        78
           9       0.85      0.87      0.86        78

    accuracy                           0.92       780
   macro avg       0.92      0.92      0.91       780
weighted avg       0.92      0.92      0.91       780

2022-10-17 14:55:24,008 - trainer - INFO - {
  "train_accuracy_score": 0.9166666666666666,
  "train_loss": 0.32572630792856216
}
2022-10-17 14:55:24,294 - trainer - INFO - 
*****************[epoch: 21, global step: 246] eval development set based on eval_every=2***************
2022-10-17 14:55:24,298 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.43      0.59        42
         2.0       0.97      0.97      0.97        32
         3.0       0.94      1.00      0.97        34
         4.0       0.92      0.97      0.95        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      0.97      0.96        33
         8.0       0.60      0.73      0.66        41
         9.0       0.74      0.94      0.83        31

    accuracy                           0.88       360
   macro avg       0.90      0.90      0.89       360
weighted avg       0.90      0.88      0.88       360

2022-10-17 14:55:24,299 - trainer - INFO - {
  "dev_loss": 0.30685028433799744,
  "dev_accuracy": 0.8833333333333333,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:24,299 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:55:24,300 - trainer - INFO -   patience: 200
2022-10-17 14:55:24,301 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:24,301 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:24,301 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_240
2022-10-17 14:55:24,302 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_246
2022-10-17 14:55:24,307 - trainer - INFO - save model to path: tmp/mlp_digits\ck_246
2022-10-17 14:55:24,372 - trainer - INFO - 
*****************[epoch: 21, global step: 248] eval training set based on eval_every=2***************
2022-10-17 14:55:24,377 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       105
           1       0.93      0.64      0.76       102
           2       1.00      0.97      0.98        99
           3       0.91      0.93      0.92       100
           4       0.93      0.97      0.95       106
           5       0.97      0.96      0.97       105
           6       0.95      1.00      0.97       115
           7       0.95      0.93      0.94       101
           8       0.78      0.92      0.84       101
           9       0.84      0.89      0.86       106

    accuracy                           0.92      1040
   macro avg       0.92      0.92      0.92      1040
weighted avg       0.92      0.92      0.92      1040

2022-10-17 14:55:24,378 - trainer - INFO - {
  "train_accuracy_score": 0.9211538461538461,
  "train_loss": 0.1882372871041298
}
2022-10-17 14:55:24,653 - trainer - INFO - 
*****************[epoch: 21, global step: 248] eval development set based on eval_every=2***************
2022-10-17 14:55:24,656 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.76      0.74      0.75        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       0.94      0.92      0.93        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      1.00      1.00        38
         7.0       0.91      0.97      0.94        33
         8.0       0.68      0.61      0.64        41
         9.0       0.77      0.87      0.82        31

    accuracy                           0.89       360
   macro avg       0.90      0.90      0.90       360
weighted avg       0.89      0.89      0.89       360

2022-10-17 14:55:24,658 - trainer - INFO - {
  "dev_loss": 0.2763919346034527,
  "dev_accuracy": 0.8944444444444445,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:24,659 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:55:24,659 - trainer - INFO -   patience: 200
2022-10-17 14:55:24,660 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:24,661 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:24,661 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_242
2022-10-17 14:55:24,662 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_248
2022-10-17 14:55:24,667 - trainer - INFO - save model to path: tmp/mlp_digits\ck_248
2022-10-17 14:55:24,731 - trainer - INFO - 
*****************[epoch: 21, global step: 250] eval training set based on eval_every=2***************
2022-10-17 14:55:24,735 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       128
           1       0.90      0.68      0.77       131
           2       1.00      0.98      0.99       123
           3       0.93      0.94      0.94       126
           4       0.94      0.95      0.95       133
           5       0.98      0.96      0.97       133
           6       0.96      1.00      0.98       135
           7       0.95      0.95      0.95       133
           8       0.77      0.89      0.83       121
           9       0.85      0.90      0.87       137

    accuracy                           0.92      1300
   macro avg       0.93      0.92      0.92      1300
weighted avg       0.93      0.92      0.92      1300

2022-10-17 14:55:24,737 - trainer - INFO - {
  "train_accuracy_score": 0.9246153846153846,
  "train_loss": 0.22547754645347595
}
2022-10-17 14:55:25,054 - trainer - INFO - 
*****************[epoch: 21, global step: 250] eval development set based on eval_every=2***************
2022-10-17 14:55:25,058 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.72      1.00      0.84        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      1.00      1.00        34
         4.0       0.95      0.97      0.96        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.91      0.95        33
         8.0       1.00      0.66      0.79        41
         9.0       0.81      0.84      0.83        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:25,059 - trainer - INFO - {
  "dev_loss": 0.2449075455466906,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:25,059 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:55:25,060 - trainer - INFO -   patience: 200
2022-10-17 14:55:25,061 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:25,061 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:25,062 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_244
2022-10-17 14:55:25,063 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_250
2022-10-17 14:55:25,068 - trainer - INFO - save model to path: tmp/mlp_digits\ck_250
2022-10-17 14:55:25,110 - trainer - INFO - 
*****************[epoch: 21, global step: 252] eval training set based on eval_every=2***************
2022-10-17 14:55:25,114 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.86      0.70      0.77       140
           2       1.00      0.97      0.99       145
           3       0.94      0.95      0.95       149
           4       0.95      0.96      0.95       145
           5       0.98      0.96      0.97       142
           6       0.96      1.00      0.98       143
           7       0.95      0.95      0.95       146
           8       0.79      0.88      0.83       133
           9       0.85      0.89      0.87       149

    accuracy                           0.93      1437
   macro avg       0.93      0.93      0.93      1437
weighted avg       0.93      0.93      0.93      1437

2022-10-17 14:55:25,115 - trainer - INFO - {
  "train_accuracy_score": 0.9269311064718163,
  "train_loss": 0.07898787409067154
}
2022-10-17 14:55:25,392 - trainer - INFO - 
*****************[epoch: 21, global step: 252] eval development set based on eval_every=2***************
2022-10-17 14:55:25,396 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.71      0.98      0.82        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.97      0.99        34
         4.0       0.95      0.97      0.96        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.88      0.94        33
         8.0       0.97      0.68      0.80        41
         9.0       0.82      0.87      0.84        31

    accuracy                           0.92       360
   macro avg       0.94      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:25,396 - trainer - INFO - {
  "dev_loss": 0.20698972791433334,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:25,397 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:55:25,397 - trainer - INFO -   patience: 200
2022-10-17 14:55:25,398 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:25,399 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:25,399 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_246
2022-10-17 14:55:25,400 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_252
2022-10-17 14:55:25,404 - trainer - INFO - save model to path: tmp/mlp_digits\ck_252
2022-10-17 14:55:25,405 - trainer - INFO - 
*****************[epoch: 21, global step: 253] eval training set at end of epoch***************
2022-10-17 14:55:25,409 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.86      0.70      0.77       140
           2       1.00      0.97      0.99       145
           3       0.94      0.95      0.95       149
           4       0.95      0.96      0.95       145
           5       0.98      0.96      0.97       142
           6       0.96      1.00      0.98       143
           7       0.95      0.95      0.95       146
           8       0.79      0.88      0.83       133
           9       0.85      0.89      0.87       149

    accuracy                           0.93      1437
   macro avg       0.93      0.93      0.93      1437
weighted avg       0.93      0.93      0.93      1437

2022-10-17 14:55:25,410 - trainer - INFO - {
  "train_accuracy_score": 0.9269311064718163,
  "train_loss": 0.21356322119633356
}
2022-10-17 14:55:25,411 - trainer - INFO - start training epoch 22
2022-10-17 14:55:25,412 - trainer - INFO - training using device=cuda
2022-10-17 14:55:25,414 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:25,418 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:25,486 - trainer - INFO - 
*****************[epoch: 22, global step: 254] eval training set based on eval_every=2***************
2022-10-17 14:55:25,490 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        21
           1       0.69      1.00      0.82        29
           2       0.96      1.00      0.98        23
           3       1.00      0.95      0.97        37
           4       1.00      1.00      1.00        24
           5       1.00      0.95      0.98        21
           6       0.96      1.00      0.98        24
           7       1.00      0.92      0.96        25
           8       0.95      0.67      0.78        27
           9       0.93      0.86      0.89        29

    accuracy                           0.93       260
   macro avg       0.95      0.93      0.94       260
weighted avg       0.94      0.93      0.93       260

2022-10-17 14:55:25,492 - trainer - INFO - {
  "train_accuracy_score": 0.9307692307692308,
  "train_loss": 0.18512224406003952
}
2022-10-17 14:55:25,767 - trainer - INFO - 
*****************[epoch: 22, global step: 254] eval development set based on eval_every=2***************
2022-10-17 14:55:25,770 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.98      0.95        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.94      0.97        34
         4.0       0.94      0.92      0.93        36
         5.0       1.00      0.90      0.95        40
         6.0       0.95      1.00      0.97        38
         7.0       0.94      0.94      0.94        33
         8.0       0.93      0.90      0.91        41
         9.0       0.86      0.97      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:25,771 - trainer - INFO - {
  "dev_loss": 0.15559220624466738,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:25,771 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:55:25,772 - trainer - INFO -   patience: 200
2022-10-17 14:55:25,773 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:25,773 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:25,773 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_248
2022-10-17 14:55:25,775 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_254
2022-10-17 14:55:25,780 - trainer - INFO - save model to path: tmp/mlp_digits\ck_254
2022-10-17 14:55:25,850 - trainer - INFO - 
*****************[epoch: 22, global step: 256] eval training set based on eval_every=2***************
2022-10-17 14:55:25,853 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.94      0.97        49
           1       0.77      0.97      0.85        58
           2       0.96      1.00      0.98        53
           3       1.00      0.96      0.98        70
           4       0.98      0.98      0.98        46
           5       1.00      0.95      0.98        44
           6       0.98      0.98      0.98        48
           7       1.00      0.96      0.98        50
           8       0.88      0.76      0.81        46
           9       0.91      0.89      0.90        56

    accuracy                           0.94       520
   macro avg       0.95      0.94      0.94       520
weighted avg       0.95      0.94      0.94       520

2022-10-17 14:55:25,854 - trainer - INFO - {
  "train_accuracy_score": 0.9403846153846154,
  "train_loss": 0.16546019911766052
}
2022-10-17 14:55:26,169 - trainer - INFO - 
*****************[epoch: 22, global step: 256] eval development set based on eval_every=2***************
2022-10-17 14:55:26,173 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.79      0.88        42
         2.0       0.97      0.94      0.95        32
         3.0       0.94      0.94      0.94        34
         4.0       0.97      0.92      0.94        36
         5.0       1.00      0.93      0.96        40
         6.0       0.97      1.00      0.99        38
         7.0       0.94      0.97      0.96        33
         8.0       0.89      0.98      0.93        41
         9.0       0.75      0.97      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:26,174 - trainer - INFO - {
  "dev_loss": 0.19247531394163767,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:26,175 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:55:26,175 - trainer - INFO -   patience: 200
2022-10-17 14:55:26,176 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:26,177 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:26,177 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_250
2022-10-17 14:55:26,178 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_256
2022-10-17 14:55:26,183 - trainer - INFO - save model to path: tmp/mlp_digits\ck_256
2022-10-17 14:55:26,256 - trainer - INFO - 
*****************[epoch: 22, global step: 258] eval training set based on eval_every=2***************
2022-10-17 14:55:26,260 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        69
           1       0.81      0.91      0.86        78
           2       0.96      1.00      0.98        77
           3       1.00      0.97      0.98        98
           4       0.99      0.99      0.99        75
           5       1.00      0.95      0.97        78
           6       0.99      0.97      0.98        74
           7       0.99      0.97      0.98        77
           8       0.91      0.85      0.88        71
           9       0.87      0.92      0.89        83

    accuracy                           0.95       780
   macro avg       0.95      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:55:26,261 - trainer - INFO - {
  "train_accuracy_score": 0.9487179487179487,
  "train_loss": 0.1438990905880928
}
2022-10-17 14:55:26,554 - trainer - INFO - 
*****************[epoch: 22, global step: 258] eval development set based on eval_every=2***************
2022-10-17 14:55:26,559 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.83      0.91        42
         2.0       1.00      0.91      0.95        32
         3.0       0.91      0.94      0.93        34
         4.0       0.97      0.92      0.94        36
         5.0       1.00      0.93      0.96        40
         6.0       0.97      1.00      0.99        38
         7.0       0.91      0.97      0.94        33
         8.0       0.89      0.98      0.93        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:26,559 - trainer - INFO - {
  "dev_loss": 0.1981701428691546,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:26,561 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:55:26,562 - trainer - INFO -   patience: 200
2022-10-17 14:55:26,566 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:26,566 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:26,567 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_252
2022-10-17 14:55:26,568 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_258
2022-10-17 14:55:26,574 - trainer - INFO - save model to path: tmp/mlp_digits\ck_258
2022-10-17 14:55:26,639 - trainer - INFO - 
*****************[epoch: 22, global step: 260] eval training set based on eval_every=2***************
2022-10-17 14:55:26,643 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98       101
           1       0.85      0.90      0.87       105
           2       0.97      0.99      0.98       102
           3       0.99      0.98      0.98       123
           4       0.99      0.98      0.99       101
           5       1.00      0.95      0.98       104
           6       0.98      0.98      0.98       104
           7       0.98      0.97      0.97        99
           8       0.87      0.88      0.88        92
           9       0.88      0.91      0.90       109

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:26,645 - trainer - INFO - {
  "train_accuracy_score": 0.9509615384615384,
  "train_loss": 0.14512227848172188
}
2022-10-17 14:55:26,928 - trainer - INFO - 
*****************[epoch: 22, global step: 260] eval development set based on eval_every=2***************
2022-10-17 14:55:26,933 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.90      0.95        42
         2.0       1.00      0.91      0.95        32
         3.0       0.94      0.94      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.95      0.96        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       0.93      0.95      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:26,934 - trainer - INFO - {
  "dev_loss": 0.11985022823015849,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:26,934 - trainer - INFO -   no_improve_count: 24
2022-10-17 14:55:26,935 - trainer - INFO -   patience: 200
2022-10-17 14:55:26,936 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:26,937 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:26,937 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_254
2022-10-17 14:55:26,938 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_260
2022-10-17 14:55:26,943 - trainer - INFO - save model to path: tmp/mlp_digits\ck_260
2022-10-17 14:55:27,016 - trainer - INFO - 
*****************[epoch: 22, global step: 262] eval training set based on eval_every=2***************
2022-10-17 14:55:27,021 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       130
           1       0.84      0.91      0.87       127
           2       0.98      0.98      0.98       127
           3       0.98      0.97      0.97       140
           4       0.99      0.98      0.98       130
           5       1.00      0.96      0.98       131
           6       0.98      0.98      0.98       128
           7       0.98      0.98      0.98       131
           8       0.88      0.88      0.88       120
           9       0.90      0.89      0.89       136

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:27,022 - trainer - INFO - {
  "train_accuracy_score": 0.9507692307692308,
  "train_loss": 0.09869727864861488
}
2022-10-17 14:55:27,342 - trainer - INFO - 
*****************[epoch: 22, global step: 262] eval development set based on eval_every=2***************
2022-10-17 14:55:27,346 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.86      1.00      0.92        42
         2.0       1.00      0.88      0.93        32
         3.0       1.00      0.97      0.99        34
         4.0       0.92      1.00      0.96        36
         5.0       0.95      0.90      0.92        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.94      0.94        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:27,347 - trainer - INFO - {
  "dev_loss": 0.15730340157945952,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:27,347 - trainer - INFO -   no_improve_count: 25
2022-10-17 14:55:27,348 - trainer - INFO -   patience: 200
2022-10-17 14:55:27,349 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:27,349 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:27,349 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_256
2022-10-17 14:55:27,350 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_262
2022-10-17 14:55:27,355 - trainer - INFO - save model to path: tmp/mlp_digits\ck_262
2022-10-17 14:55:27,413 - trainer - INFO - 
*****************[epoch: 22, global step: 264] eval training set based on eval_every=2***************
2022-10-17 14:55:27,417 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.83      0.91      0.87       140
           2       0.98      0.96      0.97       145
           3       0.98      0.97      0.98       149
           4       0.99      0.98      0.98       145
           5       1.00      0.96      0.98       142
           6       0.97      0.99      0.98       143
           7       0.97      0.97      0.97       146
           8       0.89      0.88      0.88       133
           9       0.90      0.89      0.89       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:27,419 - trainer - INFO - {
  "train_accuracy_score": 0.9498956158663883,
  "train_loss": 0.244469553232193
}
2022-10-17 14:55:27,701 - trainer - INFO - 
*****************[epoch: 22, global step: 264] eval development set based on eval_every=2***************
2022-10-17 14:55:27,705 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.94      0.97        34
         4.0       0.92      1.00      0.96        36
         5.0       0.92      0.85      0.88        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.88      0.94        33
         8.0       1.00      0.83      0.91        41
         9.0       0.83      0.94      0.88        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:27,707 - trainer - INFO - {
  "dev_loss": 0.24184199422597885,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:27,708 - trainer - INFO -   no_improve_count: 26
2022-10-17 14:55:27,709 - trainer - INFO -   patience: 200
2022-10-17 14:55:27,713 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:27,713 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:27,713 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_258
2022-10-17 14:55:27,715 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_264
2022-10-17 14:55:27,720 - trainer - INFO - save model to path: tmp/mlp_digits\ck_264
2022-10-17 14:55:27,722 - trainer - INFO - 
*****************[epoch: 22, global step: 265] eval training set at end of epoch***************
2022-10-17 14:55:27,727 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.83      0.91      0.87       140
           2       0.98      0.96      0.97       145
           3       0.98      0.97      0.98       149
           4       0.99      0.98      0.98       145
           5       1.00      0.96      0.98       142
           6       0.97      0.99      0.98       143
           7       0.97      0.97      0.97       146
           8       0.89      0.88      0.88       133
           9       0.90      0.89      0.89       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:27,729 - trainer - INFO - {
  "train_accuracy_score": 0.9498956158663883,
  "train_loss": 0.16379510735472044
}
2022-10-17 14:55:27,730 - trainer - INFO - start training epoch 23
2022-10-17 14:55:27,730 - trainer - INFO - training using device=cuda
2022-10-17 14:55:27,730 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:27,731 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:27,793 - trainer - INFO - 
*****************[epoch: 23, global step: 266] eval training set based on eval_every=2***************
2022-10-17 14:55:27,796 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98        28
           1       0.76      1.00      0.87        29
           2       1.00      0.96      0.98        25
           3       1.00      0.94      0.97        32
           4       0.92      1.00      0.96        24
           5       1.00      0.94      0.97        18
           6       1.00      0.95      0.98        22
           7       1.00      0.85      0.92        27
           8       0.96      0.83      0.89        30
           9       0.85      0.88      0.86        25

    accuracy                           0.93       260
   macro avg       0.95      0.94      0.94       260
weighted avg       0.94      0.93      0.94       260

2022-10-17 14:55:27,797 - trainer - INFO - {
  "train_accuracy_score": 0.9346153846153846,
  "train_loss": 0.22343208640813828
}
2022-10-17 14:55:28,067 - trainer - INFO - 
*****************[epoch: 23, global step: 266] eval development set based on eval_every=2***************
2022-10-17 14:55:28,070 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.89      1.00      0.94        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.82      0.90        34
         4.0       0.92      0.97      0.95        36
         5.0       0.86      0.90      0.88        40
         6.0       0.97      0.92      0.95        38
         7.0       1.00      0.64      0.78        33
         8.0       0.94      0.83      0.88        41
         9.0       0.64      0.94      0.76        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.92      0.90      0.90       360

2022-10-17 14:55:28,071 - trainer - INFO - {
  "dev_loss": 0.3200607771674792,
  "dev_accuracy": 0.9,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:28,072 - trainer - INFO -   no_improve_count: 27
2022-10-17 14:55:28,072 - trainer - INFO -   patience: 200
2022-10-17 14:55:28,073 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:28,073 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:28,073 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_260
2022-10-17 14:55:28,074 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_266
2022-10-17 14:55:28,079 - trainer - INFO - save model to path: tmp/mlp_digits\ck_266
2022-10-17 14:55:28,142 - trainer - INFO - 
*****************[epoch: 23, global step: 268] eval training set based on eval_every=2***************
2022-10-17 14:55:28,145 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        52
           1       0.76      0.95      0.85        58
           2       1.00      0.96      0.98        45
           3       1.00      0.89      0.94        56
           4       0.91      0.98      0.94        52
           5       0.98      0.96      0.97        48
           6       1.00      0.96      0.98        53
           7       1.00      0.75      0.86        53
           8       0.92      0.86      0.89        56
           9       0.75      0.87      0.80        47

    accuracy                           0.92       520
   macro avg       0.93      0.92      0.92       520
weighted avg       0.93      0.92      0.92       520

2022-10-17 14:55:28,147 - trainer - INFO - {
  "train_accuracy_score": 0.9173076923076923,
  "train_loss": 0.2707362174987793
}
2022-10-17 14:55:28,474 - trainer - INFO - 
*****************[epoch: 23, global step: 268] eval development set based on eval_every=2***************
2022-10-17 14:55:28,478 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.71      0.82        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.94      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       0.89      0.97      0.93        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.73      0.84        33
         8.0       0.76      0.90      0.82        41
         9.0       0.76      1.00      0.86        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:28,479 - trainer - INFO - {
  "dev_loss": 0.23708467185497284,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:28,480 - trainer - INFO -   no_improve_count: 28
2022-10-17 14:55:28,481 - trainer - INFO -   patience: 200
2022-10-17 14:55:28,481 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:28,482 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:28,482 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_262
2022-10-17 14:55:28,483 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_268
2022-10-17 14:55:28,487 - trainer - INFO - save model to path: tmp/mlp_digits\ck_268
2022-10-17 14:55:28,564 - trainer - INFO - 
*****************[epoch: 23, global step: 270] eval training set based on eval_every=2***************
2022-10-17 14:55:28,568 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        80
           1       0.80      0.84      0.82        83
           2       1.00      0.97      0.99        74
           3       1.00      0.90      0.95        81
           4       0.94      0.97      0.96        77
           5       0.96      0.97      0.97        80
           6       1.00      0.96      0.98        80
           7       1.00      0.79      0.88        77
           8       0.80      0.88      0.84        69
           9       0.80      0.92      0.86        79

    accuracy                           0.92       780
   macro avg       0.93      0.92      0.92       780
weighted avg       0.93      0.92      0.92       780

2022-10-17 14:55:28,569 - trainer - INFO - {
  "train_accuracy_score": 0.9230769230769231,
  "train_loss": 0.17051354050636292
}
2022-10-17 14:55:28,837 - trainer - INFO - 
*****************[epoch: 23, global step: 270] eval development set based on eval_every=2***************
2022-10-17 14:55:28,840 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.92      0.86      0.89        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      0.89      0.93        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.91      0.91      0.91        33
         8.0       0.89      0.98      0.93        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:28,841 - trainer - INFO - {
  "dev_loss": 0.19261187749604383,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:28,841 - trainer - INFO -   no_improve_count: 29
2022-10-17 14:55:28,842 - trainer - INFO -   patience: 200
2022-10-17 14:55:28,843 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:28,843 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:28,843 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_264
2022-10-17 14:55:28,845 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_270
2022-10-17 14:55:28,849 - trainer - INFO - save model to path: tmp/mlp_digits\ck_270
2022-10-17 14:55:28,918 - trainer - INFO - 
*****************[epoch: 23, global step: 272] eval training set based on eval_every=2***************
2022-10-17 14:55:28,923 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       107
           1       0.79      0.80      0.80       102
           2       0.98      0.98      0.98       100
           3       1.00      0.93      0.96       107
           4       0.96      0.97      0.96       110
           5       0.96      0.98      0.97       109
           6       1.00      0.97      0.99       107
           7       1.00      0.82      0.90        91
           8       0.81      0.91      0.86        98
           9       0.84      0.89      0.87       109

    accuracy                           0.93      1040
   macro avg       0.93      0.92      0.93      1040
weighted avg       0.93      0.93      0.93      1040

2022-10-17 14:55:28,925 - trainer - INFO - {
  "train_accuracy_score": 0.926923076923077,
  "train_loss": 0.1867682784795761
}
2022-10-17 14:55:29,191 - trainer - INFO - 
*****************[epoch: 23, global step: 272] eval development set based on eval_every=2***************
2022-10-17 14:55:29,195 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.89      0.98      0.93        42
         2.0       0.97      1.00      0.98        32
         3.0       0.76      1.00      0.86        34
         4.0       1.00      0.75      0.86        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.75      1.00      0.86        33
         8.0       1.00      0.76      0.86        41
         9.0       0.96      0.81      0.88        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:29,196 - trainer - INFO - {
  "dev_loss": 0.2833798999587695,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:29,197 - trainer - INFO -   no_improve_count: 30
2022-10-17 14:55:29,197 - trainer - INFO -   patience: 200
2022-10-17 14:55:29,198 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:29,198 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:29,198 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_266
2022-10-17 14:55:29,200 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_272
2022-10-17 14:55:29,205 - trainer - INFO - save model to path: tmp/mlp_digits\ck_272
2022-10-17 14:55:29,272 - trainer - INFO - 
*****************[epoch: 23, global step: 274] eval training set based on eval_every=2***************
2022-10-17 14:55:29,276 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.99       135
           1       0.82      0.85      0.83       130
           2       0.98      0.98      0.98       130
           3       0.98      0.94      0.96       132
           4       0.96      0.93      0.94       136
           5       0.96      0.98      0.97       130
           6       1.00      0.98      0.99       127
           7       0.94      0.87      0.90       120
           8       0.84      0.92      0.88       124
           9       0.86      0.88      0.87       136

    accuracy                           0.93      1300
   macro avg       0.93      0.93      0.93      1300
weighted avg       0.93      0.93      0.93      1300

2022-10-17 14:55:29,277 - trainer - INFO - {
  "train_accuracy_score": 0.9315384615384615,
  "train_loss": 0.2529585063457489
}
2022-10-17 14:55:29,560 - trainer - INFO - 
*****************[epoch: 23, global step: 274] eval development set based on eval_every=2***************
2022-10-17 14:55:29,563 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       0.89      1.00      0.94        34
         4.0       1.00      0.94      0.97        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      1.00      0.99        38
         7.0       0.87      1.00      0.93        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.95       360
   macro avg       0.96      0.96      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:29,564 - trainer - INFO - {
  "dev_loss": 0.20903785899281502,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:29,565 - trainer - INFO -   no_improve_count: 31
2022-10-17 14:55:29,565 - trainer - INFO -   patience: 200
2022-10-17 14:55:29,567 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:29,568 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:29,568 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_268
2022-10-17 14:55:29,573 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_274
2022-10-17 14:55:29,578 - trainer - INFO - save model to path: tmp/mlp_digits\ck_274
2022-10-17 14:55:29,669 - trainer - INFO - 
*****************[epoch: 23, global step: 276] eval training set based on eval_every=2***************
2022-10-17 14:55:29,673 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.99       145
           1       0.83      0.86      0.84       140
           2       0.99      0.99      0.99       145
           3       0.97      0.95      0.96       149
           4       0.96      0.92      0.94       145
           5       0.97      0.98      0.97       142
           6       1.00      0.97      0.99       143
           7       0.95      0.89      0.92       146
           8       0.84      0.92      0.88       133
           9       0.87      0.89      0.88       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:55:29,676 - trainer - INFO - {
  "train_accuracy_score": 0.9352818371607515,
  "train_loss": 0.05961092531651957
}
2022-10-17 14:55:29,953 - trainer - INFO - 
*****************[epoch: 23, global step: 276] eval development set based on eval_every=2***************
2022-10-17 14:55:29,958 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.94      0.97        32
         3.0       0.92      0.97      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.78      0.87        40
         6.0       0.93      1.00      0.96        38
         7.0       0.89      0.97      0.93        33
         8.0       0.95      0.88      0.91        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:29,959 - trainer - INFO - {
  "dev_loss": 0.21022945332030454,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:29,960 - trainer - INFO -   no_improve_count: 32
2022-10-17 14:55:29,961 - trainer - INFO -   patience: 200
2022-10-17 14:55:29,962 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:29,962 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:29,962 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_270
2022-10-17 14:55:29,964 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_276
2022-10-17 14:55:29,969 - trainer - INFO - save model to path: tmp/mlp_digits\ck_276
2022-10-17 14:55:29,970 - trainer - INFO - 
*****************[epoch: 23, global step: 277] eval training set at end of epoch***************
2022-10-17 14:55:29,976 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.99      0.99       145
           1       0.83      0.86      0.84       140
           2       0.99      0.99      0.99       145
           3       0.97      0.95      0.96       149
           4       0.96      0.92      0.94       145
           5       0.97      0.98      0.97       142
           6       1.00      0.97      0.99       143
           7       0.95      0.89      0.92       146
           8       0.84      0.92      0.88       133
           9       0.87      0.89      0.88       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:55:29,978 - trainer - INFO - {
  "train_accuracy_score": 0.9352818371607515,
  "train_loss": 0.19400325909252084
}
2022-10-17 14:55:29,979 - trainer - INFO - start training epoch 24
2022-10-17 14:55:29,979 - trainer - INFO - training using device=cuda
2022-10-17 14:55:29,980 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:29,980 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:30,056 - trainer - INFO - 
*****************[epoch: 24, global step: 278] eval training set based on eval_every=2***************
2022-10-17 14:55:30,059 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        27
           1       0.81      0.86      0.83        29
           2       1.00      1.00      1.00        28
           3       1.00      1.00      1.00        22
           4       0.93      0.96      0.95        27
           5       1.00      0.82      0.90        22
           6       0.83      1.00      0.91        24
           7       0.96      0.96      0.96        25
           8       0.96      0.90      0.93        29
           9       0.92      0.89      0.91        27

    accuracy                           0.93       260
   macro avg       0.94      0.94      0.94       260
weighted avg       0.94      0.93      0.94       260

2022-10-17 14:55:30,060 - trainer - INFO - {
  "train_accuracy_score": 0.9346153846153846,
  "train_loss": 0.23787327110767365
}
2022-10-17 14:55:30,336 - trainer - INFO - 
*****************[epoch: 24, global step: 278] eval development set based on eval_every=2***************
2022-10-17 14:55:30,339 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.88      0.90        42
         2.0       1.00      0.94      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       0.90      1.00      0.95        36
         5.0       1.00      0.82      0.90        40
         6.0       0.88      1.00      0.94        38
         7.0       0.89      0.97      0.93        33
         8.0       0.88      0.93      0.90        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:30,341 - trainer - INFO - {
  "dev_loss": 0.266019639869531,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:30,342 - trainer - INFO -   no_improve_count: 33
2022-10-17 14:55:30,342 - trainer - INFO -   patience: 200
2022-10-17 14:55:30,343 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:30,344 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:30,344 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_272
2022-10-17 14:55:30,345 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_278
2022-10-17 14:55:30,350 - trainer - INFO - save model to path: tmp/mlp_digits\ck_278
2022-10-17 14:55:30,413 - trainer - INFO - 
*****************[epoch: 24, global step: 280] eval training set based on eval_every=2***************
2022-10-17 14:55:30,417 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        54
           1       0.83      0.86      0.84        50
           2       1.00      1.00      1.00        52
           3       1.00      0.98      0.99        55
           4       0.92      0.98      0.95        56
           5       1.00      0.89      0.94        44
           6       0.90      0.98      0.94        61
           7       0.98      0.98      0.98        49
           8       0.94      0.90      0.92        51
           9       0.93      0.90      0.91        48

    accuracy                           0.95       520
   macro avg       0.95      0.94      0.95       520
weighted avg       0.95      0.95      0.95       520

2022-10-17 14:55:30,418 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.14227917045354843
}
2022-10-17 14:55:30,699 - trainer - INFO - 
*****************[epoch: 24, global step: 280] eval development set based on eval_every=2***************
2022-10-17 14:55:30,702 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.93      0.93        42
         2.0       1.00      0.94      0.97        32
         3.0       1.00      0.85      0.92        34
         4.0       0.90      1.00      0.95        36
         5.0       1.00      0.90      0.95        40
         6.0       0.97      1.00      0.99        38
         7.0       0.89      0.97      0.93        33
         8.0       0.88      0.93      0.90        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:30,703 - trainer - INFO - {
  "dev_loss": 0.22818684577941895,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:30,704 - trainer - INFO -   no_improve_count: 34
2022-10-17 14:55:30,704 - trainer - INFO -   patience: 200
2022-10-17 14:55:30,705 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:30,706 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:30,706 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_274
2022-10-17 14:55:30,707 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_280
2022-10-17 14:55:30,712 - trainer - INFO - save model to path: tmp/mlp_digits\ck_280
2022-10-17 14:55:30,833 - trainer - INFO - 
*****************[epoch: 24, global step: 282] eval training set based on eval_every=2***************
2022-10-17 14:55:30,837 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        83
           1       0.83      0.86      0.85        74
           2       1.00      0.96      0.98        80
           3       1.00      0.95      0.97        77
           4       0.90      0.99      0.94        79
           5       1.00      0.92      0.96        79
           6       0.92      0.99      0.95        83
           7       0.99      0.96      0.98        82
           8       0.92      0.92      0.92        73
           9       0.91      0.91      0.91        70

    accuracy                           0.95       780
   macro avg       0.95      0.94      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:55:30,838 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.1822301559150219
}
2022-10-17 14:55:31,119 - trainer - INFO - 
*****************[epoch: 24, global step: 282] eval development set based on eval_every=2***************
2022-10-17 14:55:31,124 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.84      1.00      0.91        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       1.00      0.97      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.95      0.97        38
         7.0       0.91      0.94      0.93        33
         8.0       0.92      0.85      0.89        41
         9.0       0.88      0.90      0.89        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:31,125 - trainer - INFO - {
  "dev_loss": 0.1927200766901175,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:31,125 - trainer - INFO -   no_improve_count: 35
2022-10-17 14:55:31,126 - trainer - INFO -   patience: 200
2022-10-17 14:55:31,127 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:31,127 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:31,127 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_276
2022-10-17 14:55:31,128 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_282
2022-10-17 14:55:31,133 - trainer - INFO - save model to path: tmp/mlp_digits\ck_282
2022-10-17 14:55:31,205 - trainer - INFO - 
*****************[epoch: 24, global step: 284] eval training set based on eval_every=2***************
2022-10-17 14:55:31,209 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.98      0.99       110
           1       0.83      0.89      0.86        94
           2       1.00      0.95      0.98       108
           3       1.00      0.94      0.97       107
           4       0.92      0.98      0.95       102
           5       1.00      0.94      0.97       106
           6       0.93      0.99      0.96       100
           7       0.99      0.97      0.98       107
           8       0.90      0.93      0.91        98
           9       0.93      0.91      0.92       108

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:31,211 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.11838868260383606
}
2022-10-17 14:55:31,488 - trainer - INFO - 
*****************[epoch: 24, global step: 284] eval development set based on eval_every=2***************
2022-10-17 14:55:31,493 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.85      1.00      0.92        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      0.78      0.88        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.90      0.94        41
         9.0       0.90      0.90      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:31,494 - trainer - INFO - {
  "dev_loss": 0.23627912253141403,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:31,495 - trainer - INFO -   no_improve_count: 36
2022-10-17 14:55:31,495 - trainer - INFO -   patience: 200
2022-10-17 14:55:31,497 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:31,497 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:31,497 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_278
2022-10-17 14:55:31,499 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_284
2022-10-17 14:55:31,503 - trainer - INFO - save model to path: tmp/mlp_digits\ck_284
2022-10-17 14:55:31,590 - trainer - INFO - 
*****************[epoch: 24, global step: 286] eval training set based on eval_every=2***************
2022-10-17 14:55:31,593 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.98      0.97       128
           1       0.84      0.92      0.88       122
           2       1.00      0.95      0.98       133
           3       1.00      0.95      0.98       131
           4       0.93      0.95      0.94       129
           5       0.99      0.96      0.97       135
           6       0.95      0.98      0.96       128
           7       0.99      0.98      0.98       133
           8       0.91      0.93      0.92       125
           9       0.95      0.91      0.93       136

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:31,595 - trainer - INFO - {
  "train_accuracy_score": 0.9515384615384616,
  "train_loss": 0.12407764047384262
}
2022-10-17 14:55:31,906 - trainer - INFO - 
*****************[epoch: 24, global step: 286] eval development set based on eval_every=2***************
2022-10-17 14:55:31,909 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      1.00      1.00        32
         3.0       0.87      1.00      0.93        34
         4.0       1.00      0.78      0.88        36
         5.0       0.93      0.95      0.94        40
         6.0       0.97      0.87      0.92        38
         7.0       0.92      1.00      0.96        33
         8.0       0.92      0.85      0.89        41
         9.0       0.85      0.90      0.88        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:31,910 - trainer - INFO - {
  "dev_loss": 0.27810370177030563,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:31,911 - trainer - INFO -   no_improve_count: 37
2022-10-17 14:55:31,911 - trainer - INFO -   patience: 200
2022-10-17 14:55:31,913 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:31,913 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:31,913 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_280
2022-10-17 14:55:31,915 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_286
2022-10-17 14:55:31,920 - trainer - INFO - save model to path: tmp/mlp_digits\ck_286
2022-10-17 14:55:31,965 - trainer - INFO - 
*****************[epoch: 24, global step: 288] eval training set based on eval_every=2***************
2022-10-17 14:55:31,971 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.98      0.97       145
           1       0.84      0.93      0.88       140
           2       0.99      0.95      0.97       145
           3       1.00      0.95      0.98       149
           4       0.94      0.94      0.94       145
           5       0.98      0.96      0.97       142
           6       0.95      0.98      0.97       143
           7       0.99      0.97      0.98       146
           8       0.90      0.92      0.91       133
           9       0.94      0.91      0.92       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:31,972 - trainer - INFO - {
  "train_accuracy_score": 0.9491997216423104,
  "train_loss": 0.19235573709011078
}
2022-10-17 14:55:32,253 - trainer - INFO - 
*****************[epoch: 24, global step: 288] eval development set based on eval_every=2***************
2022-10-17 14:55:32,258 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.95      0.98        42
         2.0       1.00      0.81      0.90        32
         3.0       0.64      1.00      0.78        34
         4.0       1.00      0.78      0.88        36
         5.0       0.92      0.82      0.87        40
         6.0       0.97      0.92      0.95        38
         7.0       0.94      1.00      0.97        33
         8.0       0.91      0.76      0.83        41
         9.0       0.79      1.00      0.89        31

    accuracy                           0.90       360
   macro avg       0.92      0.90      0.90       360
weighted avg       0.92      0.90      0.90       360

2022-10-17 14:55:32,259 - trainer - INFO - {
  "dev_loss": 0.6028281450271606,
  "dev_accuracy": 0.9,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:32,260 - trainer - INFO -   no_improve_count: 38
2022-10-17 14:55:32,261 - trainer - INFO -   patience: 200
2022-10-17 14:55:32,262 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:32,262 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:32,262 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_282
2022-10-17 14:55:32,264 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_288
2022-10-17 14:55:32,268 - trainer - INFO - save model to path: tmp/mlp_digits\ck_288
2022-10-17 14:55:32,269 - trainer - INFO - 
*****************[epoch: 24, global step: 289] eval training set at end of epoch***************
2022-10-17 14:55:32,275 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.98      0.97       145
           1       0.84      0.93      0.88       140
           2       0.99      0.95      0.97       145
           3       1.00      0.95      0.98       149
           4       0.94      0.94      0.94       145
           5       0.98      0.96      0.97       142
           6       0.95      0.98      0.97       143
           7       0.99      0.97      0.98       146
           8       0.90      0.92      0.91       133
           9       0.94      0.91      0.92       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:32,277 - trainer - INFO - {
  "train_accuracy_score": 0.9491997216423104,
  "train_loss": 0.16620077627400556
}
2022-10-17 14:55:32,278 - trainer - INFO - start training epoch 25
2022-10-17 14:55:32,279 - trainer - INFO - training using device=cuda
2022-10-17 14:55:32,280 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:32,283 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:32,346 - trainer - INFO - 
*****************[epoch: 25, global step: 290] eval training set based on eval_every=2***************
2022-10-17 14:55:32,351 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.92      0.96        26
           1       0.85      0.96      0.90        24
           2       1.00      0.58      0.73        26
           3       0.64      1.00      0.78        27
           4       1.00      0.86      0.93        29
           5       0.90      0.90      0.90        31
           6       1.00      1.00      1.00        23
           7       0.87      1.00      0.93        20
           8       0.94      0.80      0.86        20
           9       0.88      0.85      0.87        34

    accuracy                           0.88       260
   macro avg       0.91      0.89      0.89       260
weighted avg       0.91      0.88      0.88       260

2022-10-17 14:55:32,352 - trainer - INFO - {
  "train_accuracy_score": 0.8846153846153846,
  "train_loss": 0.6733975857496262
}
2022-10-17 14:55:32,637 - trainer - INFO - 
*****************[epoch: 25, global step: 290] eval development set based on eval_every=2***************
2022-10-17 14:55:32,641 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      0.88      0.93        32
         3.0       0.94      0.88      0.91        34
         4.0       1.00      0.83      0.91        36
         5.0       0.93      0.97      0.95        40
         6.0       0.86      0.97      0.91        38
         7.0       1.00      0.94      0.97        33
         8.0       0.80      0.90      0.85        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:32,642 - trainer - INFO - {
  "dev_loss": 0.29318776975075406,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:32,643 - trainer - INFO -   no_improve_count: 39
2022-10-17 14:55:32,643 - trainer - INFO -   patience: 200
2022-10-17 14:55:32,645 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:32,645 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:32,645 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_284
2022-10-17 14:55:32,647 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_290
2022-10-17 14:55:32,654 - trainer - INFO - save model to path: tmp/mlp_digits\ck_290
2022-10-17 14:55:32,726 - trainer - INFO - 
*****************[epoch: 25, global step: 292] eval training set based on eval_every=2***************
2022-10-17 14:55:32,729 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        55
           1       0.90      0.94      0.92        48
           2       1.00      0.79      0.88        53
           3       0.77      0.89      0.83        56
           4       1.00      0.91      0.95        54
           5       0.95      0.95      0.95        60
           6       0.98      1.00      0.99        47
           7       0.94      0.96      0.95        47
           8       0.88      0.88      0.88        42
           9       0.84      0.91      0.88        58

    accuracy                           0.92       520
   macro avg       0.93      0.92      0.92       520
weighted avg       0.93      0.92      0.92       520

2022-10-17 14:55:32,731 - trainer - INFO - {
  "train_accuracy_score": 0.9192307692307692,
  "train_loss": 0.1660040281713009
}
2022-10-17 14:55:33,055 - trainer - INFO - 
*****************[epoch: 25, global step: 292] eval development set based on eval_every=2***************
2022-10-17 14:55:33,059 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      1.00      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.65      0.79        34
         4.0       0.97      0.92      0.94        36
         5.0       0.86      0.95      0.90        40
         6.0       0.79      1.00      0.88        38
         7.0       1.00      0.85      0.92        33
         8.0       0.79      0.76      0.77        41
         9.0       0.83      0.94      0.88        31

    accuracy                           0.90       360
   macro avg       0.92      0.90      0.90       360
weighted avg       0.91      0.90      0.90       360

2022-10-17 14:55:33,060 - trainer - INFO - {
  "dev_loss": 0.4748578021923701,
  "dev_accuracy": 0.9027777777777778,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:33,060 - trainer - INFO -   no_improve_count: 40
2022-10-17 14:55:33,061 - trainer - INFO -   patience: 200
2022-10-17 14:55:33,062 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:33,062 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:33,062 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_286
2022-10-17 14:55:33,063 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_292
2022-10-17 14:55:33,067 - trainer - INFO - save model to path: tmp/mlp_digits\ck_292
2022-10-17 14:55:33,139 - trainer - INFO - 
*****************[epoch: 25, global step: 294] eval training set based on eval_every=2***************
2022-10-17 14:55:33,142 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.98        87
           1       0.91      0.96      0.94        76
           2       1.00      0.84      0.91        73
           3       0.82      0.84      0.83        83
           4       0.94      0.92      0.93        74
           5       0.94      0.95      0.95        86
           6       0.91      1.00      0.95        71
           7       0.96      0.91      0.93        78
           8       0.79      0.88      0.83        67
           9       0.86      0.86      0.86        85

    accuracy                           0.91       780
   macro avg       0.91      0.91      0.91       780
weighted avg       0.92      0.91      0.91       780

2022-10-17 14:55:33,143 - trainer - INFO - {
  "train_accuracy_score": 0.9115384615384615,
  "train_loss": 0.5850915908813477
}
2022-10-17 14:55:33,423 - trainer - INFO - 
*****************[epoch: 25, global step: 294] eval development set based on eval_every=2***************
2022-10-17 14:55:33,426 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.89      1.00      0.94        42
         2.0       0.82      0.97      0.89        32
         3.0       1.00      0.65      0.79        34
         4.0       0.95      0.97      0.96        36
         5.0       0.94      0.82      0.88        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.88      0.88      0.88        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:33,428 - trainer - INFO - {
  "dev_loss": 0.36370151365796727,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:33,428 - trainer - INFO -   no_improve_count: 41
2022-10-17 14:55:33,429 - trainer - INFO -   patience: 200
2022-10-17 14:55:33,430 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:33,430 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:33,430 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_288
2022-10-17 14:55:33,432 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_294
2022-10-17 14:55:33,437 - trainer - INFO - save model to path: tmp/mlp_digits\ck_294
2022-10-17 14:55:33,505 - trainer - INFO - 
*****************[epoch: 25, global step: 296] eval training set based on eval_every=2***************
2022-10-17 14:55:33,508 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98       114
           1       0.87      0.97      0.92        99
           2       0.97      0.87      0.92       101
           3       0.86      0.81      0.83       110
           4       0.95      0.92      0.93        98
           5       0.95      0.95      0.95       108
           6       0.92      0.99      0.96        99
           7       0.97      0.92      0.94       109
           8       0.82      0.89      0.85        92
           9       0.86      0.88      0.87       110

    accuracy                           0.92      1040
   macro avg       0.92      0.92      0.92      1040
weighted avg       0.92      0.92      0.92      1040

2022-10-17 14:55:33,510 - trainer - INFO - {
  "train_accuracy_score": 0.9163461538461538,
  "train_loss": 0.28896038234233856
}
2022-10-17 14:55:33,794 - trainer - INFO - 
*****************[epoch: 25, global step: 296] eval development set based on eval_every=2***************
2022-10-17 14:55:33,797 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.90      0.88      0.89        42
         2.0       0.69      0.97      0.81        32
         3.0       1.00      0.74      0.85        34
         4.0       0.92      0.94      0.93        36
         5.0       1.00      0.72      0.84        40
         6.0       0.97      0.74      0.84        38
         7.0       0.87      1.00      0.93        33
         8.0       0.78      0.85      0.81        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.87       360
   macro avg       0.89      0.88      0.87       360
weighted avg       0.89      0.87      0.87       360

2022-10-17 14:55:33,798 - trainer - INFO - {
  "dev_loss": 0.6914931088685989,
  "dev_accuracy": 0.8722222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:33,799 - trainer - INFO -   no_improve_count: 42
2022-10-17 14:55:33,799 - trainer - INFO -   patience: 200
2022-10-17 14:55:33,800 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:33,801 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:33,801 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_290
2022-10-17 14:55:33,802 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_296
2022-10-17 14:55:33,807 - trainer - INFO - save model to path: tmp/mlp_digits\ck_296
2022-10-17 14:55:33,872 - trainer - INFO - 
*****************[epoch: 25, global step: 298] eval training set based on eval_every=2***************
2022-10-17 14:55:33,876 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       134
           1       0.85      0.95      0.90       128
           2       0.93      0.90      0.92       134
           3       0.86      0.80      0.83       137
           4       0.92      0.92      0.92       128
           5       0.96      0.96      0.96       127
           6       0.93      0.90      0.92       125
           7       0.98      0.93      0.95       129
           8       0.82      0.88      0.85       121
           9       0.87      0.88      0.87       137

    accuracy                           0.91      1300
   macro avg       0.91      0.91      0.91      1300
weighted avg       0.91      0.91      0.91      1300

2022-10-17 14:55:33,877 - trainer - INFO - {
  "train_accuracy_score": 0.91,
  "train_loss": 0.48034389317035675
}
2022-10-17 14:55:34,204 - trainer - INFO - 
*****************[epoch: 25, global step: 298] eval development set based on eval_every=2***************
2022-10-17 14:55:34,207 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.93      0.95        42
         2.0       0.88      0.91      0.89        32
         3.0       0.79      0.91      0.85        34
         4.0       0.97      0.83      0.90        36
         5.0       1.00      0.70      0.82        40
         6.0       1.00      0.89      0.94        38
         7.0       0.69      1.00      0.81        33
         8.0       0.86      0.78      0.82        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:55:34,208 - trainer - INFO - {
  "dev_loss": 0.6399792283773422,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:34,208 - trainer - INFO -   no_improve_count: 43
2022-10-17 14:55:34,209 - trainer - INFO -   patience: 200
2022-10-17 14:55:34,210 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:34,210 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:34,211 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_292
2022-10-17 14:55:34,212 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_298
2022-10-17 14:55:34,216 - trainer - INFO - save model to path: tmp/mlp_digits\ck_298
2022-10-17 14:55:34,269 - trainer - INFO - 
*****************[epoch: 25, global step: 300] eval training set based on eval_every=2***************
2022-10-17 14:55:34,273 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.86      0.96      0.91       140
           2       0.92      0.91      0.92       145
           3       0.87      0.81      0.84       149
           4       0.93      0.92      0.92       145
           5       0.96      0.95      0.96       142
           6       0.94      0.91      0.93       143
           7       0.97      0.94      0.95       146
           8       0.83      0.89      0.86       133
           9       0.87      0.89      0.88       149

    accuracy                           0.91      1437
   macro avg       0.92      0.91      0.91      1437
weighted avg       0.92      0.91      0.91      1437

2022-10-17 14:55:34,275 - trainer - INFO - {
  "train_accuracy_score": 0.9144050104384134,
  "train_loss": 0.18490520119667053
}
2022-10-17 14:55:34,573 - trainer - INFO - 
*****************[epoch: 25, global step: 300] eval development set based on eval_every=2***************
2022-10-17 14:55:34,576 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.83      0.89        42
         2.0       0.97      0.88      0.92        32
         3.0       0.82      0.91      0.86        34
         4.0       1.00      0.86      0.93        36
         5.0       1.00      0.78      0.87        40
         6.0       1.00      0.97      0.99        38
         7.0       0.72      1.00      0.84        33
         8.0       0.78      0.78      0.78        41
         9.0       0.81      0.94      0.87        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:55:34,578 - trainer - INFO - {
  "dev_loss": 0.5598544180393219,
  "dev_accuracy": 0.8888888888888888,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:34,578 - trainer - INFO -   no_improve_count: 44
2022-10-17 14:55:34,579 - trainer - INFO -   patience: 200
2022-10-17 14:55:34,580 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:34,580 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:34,580 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_294
2022-10-17 14:55:34,582 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_300
2022-10-17 14:55:34,586 - trainer - INFO - save model to path: tmp/mlp_digits\ck_300
2022-10-17 14:55:34,588 - trainer - INFO - 
*****************[epoch: 25, global step: 301] eval training set at end of epoch***************
2022-10-17 14:55:34,594 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.86      0.96      0.91       140
           2       0.92      0.91      0.92       145
           3       0.87      0.81      0.84       149
           4       0.93      0.92      0.92       145
           5       0.96      0.95      0.96       142
           6       0.94      0.91      0.93       143
           7       0.97      0.94      0.95       146
           8       0.83      0.89      0.86       133
           9       0.87      0.89      0.88       149

    accuracy                           0.91      1437
   macro avg       0.92      0.91      0.91      1437
weighted avg       0.92      0.91      0.91      1437

2022-10-17 14:55:34,596 - trainer - INFO - {
  "train_accuracy_score": 0.9144050104384134,
  "train_loss": 0.39645044691860676
}
2022-10-17 14:55:34,597 - trainer - INFO - start training epoch 26
2022-10-17 14:55:34,597 - trainer - INFO - training using device=cuda
2022-10-17 14:55:34,598 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:34,598 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:34,660 - trainer - INFO - 
*****************[epoch: 26, global step: 302] eval training set based on eval_every=2***************
2022-10-17 14:55:34,665 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      1.00      0.97        18
           1       0.80      0.80      0.80        25
           2       1.00      0.83      0.91        30
           3       0.92      0.94      0.93        36
           4       1.00      0.82      0.90        11
           5       1.00      0.96      0.98        26
           6       1.00      0.91      0.95        23
           7       0.89      1.00      0.94        32
           8       0.69      0.86      0.77        29
           9       0.93      0.83      0.88        30

    accuracy                           0.90       260
   macro avg       0.92      0.90      0.90       260
weighted avg       0.91      0.90      0.90       260

2022-10-17 14:55:34,666 - trainer - INFO - {
  "train_accuracy_score": 0.9,
  "train_loss": 0.34344838559627533
}
2022-10-17 14:55:34,946 - trainer - INFO - 
*****************[epoch: 26, global step: 302] eval development set based on eval_every=2***************
2022-10-17 14:55:34,949 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.89      0.98      0.93        42
         2.0       1.00      0.78      0.88        32
         3.0       0.88      0.82      0.85        34
         4.0       0.97      0.92      0.94        36
         5.0       1.00      0.88      0.93        40
         6.0       0.97      0.97      0.97        38
         7.0       0.86      0.97      0.91        33
         8.0       0.80      0.90      0.85        41
         9.0       0.88      0.90      0.89        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:55:34,950 - trainer - INFO - {
  "dev_loss": 0.3555714413523674,
  "dev_accuracy": 0.9138888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:34,950 - trainer - INFO -   no_improve_count: 45
2022-10-17 14:55:34,951 - trainer - INFO -   patience: 200
2022-10-17 14:55:34,952 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:34,952 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:34,952 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_296
2022-10-17 14:55:34,954 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_302
2022-10-17 14:55:34,958 - trainer - INFO - save model to path: tmp/mlp_digits\ck_302
2022-10-17 14:55:35,022 - trainer - INFO - 
*****************[epoch: 26, global step: 304] eval training set based on eval_every=2***************
2022-10-17 14:55:35,027 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.99        37
           1       0.85      0.91      0.88        55
           2       1.00      0.80      0.89        46
           3       0.93      0.96      0.94        69
           4       1.00      0.96      0.98        45
           5       1.00      0.98      0.99        52
           6       1.00      0.96      0.98        56
           7       0.93      1.00      0.96        52
           8       0.77      0.90      0.83        51
           9       0.94      0.84      0.89        57

    accuracy                           0.93       520
   macro avg       0.94      0.93      0.93       520
weighted avg       0.94      0.93      0.93       520

2022-10-17 14:55:35,028 - trainer - INFO - {
  "train_accuracy_score": 0.9307692307692308,
  "train_loss": 0.2066764459013939
}
2022-10-17 14:55:35,357 - trainer - INFO - 
*****************[epoch: 26, global step: 304] eval development set based on eval_every=2***************
2022-10-17 14:55:35,360 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.84      0.98      0.90        42
         2.0       1.00      0.78      0.88        32
         3.0       0.88      0.85      0.87        34
         4.0       0.97      0.92      0.94        36
         5.0       1.00      0.93      0.96        40
         6.0       0.82      0.97      0.89        38
         7.0       0.97      0.97      0.97        33
         8.0       0.76      0.71      0.73        41
         9.0       0.90      0.90      0.90        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.90      0.90      0.90       360

2022-10-17 14:55:35,361 - trainer - INFO - {
  "dev_loss": 0.3697739268342654,
  "dev_accuracy": 0.9,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:35,362 - trainer - INFO -   no_improve_count: 46
2022-10-17 14:55:35,363 - trainer - INFO -   patience: 200
2022-10-17 14:55:35,364 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:35,365 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:35,365 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_298
2022-10-17 14:55:35,370 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_304
2022-10-17 14:55:35,375 - trainer - INFO - save model to path: tmp/mlp_digits\ck_304
2022-10-17 14:55:35,444 - trainer - INFO - 
*****************[epoch: 26, global step: 306] eval training set based on eval_every=2***************
2022-10-17 14:55:35,447 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        71
           1       0.84      0.92      0.88        78
           2       1.00      0.77      0.87        71
           3       0.93      0.93      0.93        90
           4       1.00      0.94      0.97        69
           5       0.99      0.99      0.99        76
           6       0.94      0.98      0.96        85
           7       0.95      0.98      0.96        81
           8       0.79      0.88      0.83        74
           9       0.89      0.85      0.87        85

    accuracy                           0.92       780
   macro avg       0.93      0.92      0.92       780
weighted avg       0.93      0.92      0.92       780

2022-10-17 14:55:35,448 - trainer - INFO - {
  "train_accuracy_score": 0.9243589743589744,
  "train_loss": 0.3697969764471054
}
2022-10-17 14:55:35,732 - trainer - INFO - 
*****************[epoch: 26, global step: 306] eval development set based on eval_every=2***************
2022-10-17 14:55:35,736 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.89      0.98      0.93        42
         2.0       1.00      0.78      0.88        32
         3.0       0.86      0.88      0.87        34
         4.0       0.97      0.92      0.94        36
         5.0       1.00      0.97      0.99        40
         6.0       0.82      0.97      0.89        38
         7.0       0.97      0.94      0.95        33
         8.0       0.83      0.71      0.76        41
         9.0       0.86      0.97      0.91        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:55:35,737 - trainer - INFO - {
  "dev_loss": 0.38081109275420505,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:35,737 - trainer - INFO -   no_improve_count: 47
2022-10-17 14:55:35,738 - trainer - INFO -   patience: 200
2022-10-17 14:55:35,739 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:35,739 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:35,739 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_300
2022-10-17 14:55:35,741 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_306
2022-10-17 14:55:35,745 - trainer - INFO - save model to path: tmp/mlp_digits\ck_306
2022-10-17 14:55:35,805 - trainer - INFO - 
*****************[epoch: 26, global step: 308] eval training set based on eval_every=2***************
2022-10-17 14:55:35,809 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98       102
           1       0.85      0.94      0.89       103
           2       1.00      0.79      0.88        98
           3       0.93      0.95      0.94       112
           4       1.00      0.94      0.97        93
           5       0.99      0.99      0.99       102
           6       0.89      0.97      0.93       114
           7       0.96      0.98      0.97       103
           8       0.81      0.81      0.81       101
           9       0.91      0.88      0.90       112

    accuracy                           0.93      1040
   macro avg       0.93      0.92      0.93      1040
weighted avg       0.93      0.93      0.93      1040

2022-10-17 14:55:35,810 - trainer - INFO - {
  "train_accuracy_score": 0.9259615384615385,
  "train_loss": 0.3637489527463913
}
2022-10-17 14:55:36,092 - trainer - INFO - 
*****************[epoch: 26, global step: 308] eval development set based on eval_every=2***************
2022-10-17 14:55:36,096 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.97      0.97        33
         1.0       0.93      0.95      0.94        42
         2.0       1.00      0.78      0.88        32
         3.0       0.73      0.97      0.84        34
         4.0       0.97      0.89      0.93        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.94      0.97        33
         8.0       0.91      0.78      0.84        41
         9.0       0.75      0.97      0.85        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.93      0.91      0.92       360

2022-10-17 14:55:36,097 - trainer - INFO - {
  "dev_loss": 0.3440015986561775,
  "dev_accuracy": 0.9138888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:36,098 - trainer - INFO -   no_improve_count: 48
2022-10-17 14:55:36,098 - trainer - INFO -   patience: 200
2022-10-17 14:55:36,099 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:36,100 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:36,100 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_302
2022-10-17 14:55:36,101 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_308
2022-10-17 14:55:36,106 - trainer - INFO - save model to path: tmp/mlp_digits\ck_308
2022-10-17 14:55:36,172 - trainer - INFO - 
*****************[epoch: 26, global step: 310] eval training set based on eval_every=2***************
2022-10-17 14:55:36,176 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      1.00      0.98       126
           1       0.85      0.93      0.89       128
           2       1.00      0.81      0.89       131
           3       0.91      0.95      0.93       139
           4       1.00      0.92      0.96       130
           5       0.99      0.98      0.99       129
           6       0.90      0.96      0.93       135
           7       0.97      0.98      0.97       124
           8       0.82      0.82      0.82       122
           9       0.88      0.90      0.89       136

    accuracy                           0.92      1300
   macro avg       0.93      0.92      0.92      1300
weighted avg       0.93      0.92      0.92      1300

2022-10-17 14:55:36,177 - trainer - INFO - {
  "train_accuracy_score": 0.9246153846153846,
  "train_loss": 0.26333245635032654
}
2022-10-17 14:55:36,461 - trainer - INFO - 
*****************[epoch: 26, global step: 310] eval development set based on eval_every=2***************
2022-10-17 14:55:36,465 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.94      0.95        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.84      0.92        32
         3.0       0.69      1.00      0.82        34
         4.0       0.97      0.89      0.93        36
         5.0       0.93      0.93      0.93        40
         6.0       1.00      0.84      0.91        38
         7.0       1.00      0.97      0.98        33
         8.0       0.94      0.73      0.82        41
         9.0       0.74      0.90      0.81        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.92      0.90      0.90       360

2022-10-17 14:55:36,466 - trainer - INFO - {
  "dev_loss": 0.3410738358894984,
  "dev_accuracy": 0.9,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:36,466 - trainer - INFO -   no_improve_count: 49
2022-10-17 14:55:36,467 - trainer - INFO -   patience: 200
2022-10-17 14:55:36,468 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:36,468 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:36,468 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_304
2022-10-17 14:55:36,470 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_310
2022-10-17 14:55:36,474 - trainer - INFO - save model to path: tmp/mlp_digits\ck_310
2022-10-17 14:55:36,585 - trainer - INFO - 
*****************[epoch: 26, global step: 312] eval training set based on eval_every=2***************
2022-10-17 14:55:36,589 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.99      0.97       145
           1       0.85      0.93      0.89       140
           2       1.00      0.81      0.90       145
           3       0.90      0.95      0.93       149
           4       1.00      0.91      0.95       145
           5       0.99      0.99      0.99       142
           6       0.91      0.97      0.94       143
           7       0.97      0.97      0.97       146
           8       0.83      0.83      0.83       133
           9       0.86      0.91      0.88       149

    accuracy                           0.93      1437
   macro avg       0.93      0.92      0.92      1437
weighted avg       0.93      0.93      0.93      1437

2022-10-17 14:55:36,591 - trainer - INFO - {
  "train_accuracy_score": 0.9255393180236604,
  "train_loss": 0.11970383301377296
}
2022-10-17 14:55:36,880 - trainer - INFO - 
*****************[epoch: 26, global step: 312] eval development set based on eval_every=2***************
2022-10-17 14:55:36,884 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      0.97      0.97        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      0.91      0.95        32
         3.0       0.84      0.91      0.87        34
         4.0       0.92      0.97      0.95        36
         5.0       0.90      0.93      0.91        40
         6.0       1.00      0.84      0.91        38
         7.0       0.91      0.97      0.94        33
         8.0       0.88      0.90      0.89        41
         9.0       0.90      0.87      0.89        31

    accuracy                           0.93       360
   macro avg       0.93      0.92      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:55:36,885 - trainer - INFO - {
  "dev_loss": 0.29035741090774536,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:36,885 - trainer - INFO -   no_improve_count: 50
2022-10-17 14:55:36,886 - trainer - INFO -   patience: 200
2022-10-17 14:55:36,887 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:36,887 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:36,888 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_306
2022-10-17 14:55:36,889 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_312
2022-10-17 14:55:36,893 - trainer - INFO - save model to path: tmp/mlp_digits\ck_312
2022-10-17 14:55:36,894 - trainer - INFO - 
*****************[epoch: 26, global step: 313] eval training set at end of epoch***************
2022-10-17 14:55:36,899 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      0.99      0.97       145
           1       0.85      0.93      0.89       140
           2       1.00      0.81      0.90       145
           3       0.90      0.95      0.93       149
           4       1.00      0.91      0.95       145
           5       0.99      0.99      0.99       142
           6       0.91      0.97      0.94       143
           7       0.97      0.97      0.97       146
           8       0.83      0.83      0.83       133
           9       0.86      0.91      0.88       149

    accuracy                           0.93      1437
   macro avg       0.93      0.92      0.92      1437
weighted avg       0.93      0.93      0.93      1437

2022-10-17 14:55:36,900 - trainer - INFO - {
  "train_accuracy_score": 0.9255393180236604,
  "train_loss": 0.27778450834254426
}
2022-10-17 14:55:36,901 - trainer - INFO - start training epoch 27
2022-10-17 14:55:36,901 - trainer - INFO - training using device=cuda
2022-10-17 14:55:36,902 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:36,902 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:36,967 - trainer - INFO - 
*****************[epoch: 27, global step: 314] eval training set based on eval_every=2***************
2022-10-17 14:55:36,970 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       0.92      1.00      0.96        33
           2       1.00      0.88      0.94        25
           3       0.77      0.89      0.83        19
           4       0.96      1.00      0.98        27
           5       1.00      0.97      0.98        30
           6       0.96      1.00      0.98        23
           7       1.00      0.96      0.98        26
           8       0.85      0.88      0.87        26
           9       0.95      0.81      0.88        26

    accuracy                           0.94       260
   macro avg       0.94      0.94      0.94       260
weighted avg       0.95      0.94      0.94       260

2022-10-17 14:55:36,971 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.22447862476110458
}
2022-10-17 14:55:37,247 - trainer - INFO - 
*****************[epoch: 27, global step: 314] eval development set based on eval_every=2***************
2022-10-17 14:55:37,250 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.89      0.95      0.92        42
         2.0       0.91      0.91      0.91        32
         3.0       0.93      0.82      0.87        34
         4.0       0.95      0.97      0.96        36
         5.0       0.92      0.82      0.87        40
         6.0       1.00      0.82      0.90        38
         7.0       0.74      0.97      0.84        33
         8.0       0.83      0.83      0.83        41
         9.0       0.87      0.87      0.87        31

    accuracy                           0.89       360
   macro avg       0.90      0.90      0.90       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:55:37,251 - trainer - INFO - {
  "dev_loss": 0.40173617005348206,
  "dev_accuracy": 0.8944444444444445,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:37,252 - trainer - INFO -   no_improve_count: 51
2022-10-17 14:55:37,252 - trainer - INFO -   patience: 200
2022-10-17 14:55:37,253 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:37,254 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:37,256 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_308
2022-10-17 14:55:37,258 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_314
2022-10-17 14:55:37,264 - trainer - INFO - save model to path: tmp/mlp_digits\ck_314
2022-10-17 14:55:37,331 - trainer - INFO - 
*****************[epoch: 27, global step: 316] eval training set based on eval_every=2***************
2022-10-17 14:55:37,334 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        45
           1       0.90      0.95      0.93        60
           2       0.94      0.94      0.94        49
           3       0.91      0.89      0.90        57
           4       0.96      1.00      0.98        55
           5       1.00      0.96      0.98        55
           6       0.98      0.98      0.98        46
           7       0.96      0.98      0.97        55
           8       0.85      0.92      0.88        49
           9       0.93      0.82      0.87        49

    accuracy                           0.94       520
   macro avg       0.94      0.94      0.94       520
weighted avg       0.94      0.94      0.94       520

2022-10-17 14:55:37,335 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.22081606835126877
}
2022-10-17 14:55:37,624 - trainer - INFO - 
*****************[epoch: 27, global step: 316] eval development set based on eval_every=2***************
2022-10-17 14:55:37,627 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.98      0.94        42
         2.0       0.94      0.94      0.94        32
         3.0       0.97      0.88      0.92        34
         4.0       0.97      1.00      0.99        36
         5.0       0.91      0.80      0.85        40
         6.0       1.00      0.82      0.90        38
         7.0       0.73      1.00      0.85        33
         8.0       0.85      0.80      0.83        41
         9.0       0.87      0.87      0.87        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:55:37,628 - trainer - INFO - {
  "dev_loss": 0.4066167672475179,
  "dev_accuracy": 0.9055555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:37,629 - trainer - INFO -   no_improve_count: 52
2022-10-17 14:55:37,629 - trainer - INFO -   patience: 200
2022-10-17 14:55:37,630 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:37,631 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:37,631 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_310
2022-10-17 14:55:37,632 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_316
2022-10-17 14:55:37,636 - trainer - INFO - save model to path: tmp/mlp_digits\ck_316
2022-10-17 14:55:37,750 - trainer - INFO - 
*****************[epoch: 27, global step: 318] eval training set based on eval_every=2***************
2022-10-17 14:55:37,754 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99        81
           1       0.90      0.93      0.92        88
           2       0.93      0.96      0.95        81
           3       0.93      0.91      0.92        75
           4       0.97      0.97      0.97        80
           5       1.00      0.96      0.98        80
           6       0.99      0.93      0.96        75
           7       0.89      0.99      0.94        76
           8       0.88      0.95      0.91        73
           9       0.95      0.82      0.88        71

    accuracy                           0.94       780
   macro avg       0.94      0.94      0.94       780
weighted avg       0.94      0.94      0.94       780

2022-10-17 14:55:37,755 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.2286500334739685
}
2022-10-17 14:55:38,037 - trainer - INFO - 
*****************[epoch: 27, global step: 318] eval development set based on eval_every=2***************
2022-10-17 14:55:38,041 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.93      1.00      0.97        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.91      0.95        34
         4.0       0.95      1.00      0.97        36
         5.0       0.90      0.88      0.89        40
         6.0       1.00      0.84      0.91        38
         7.0       0.89      0.97      0.93        33
         8.0       0.85      0.80      0.83        41
         9.0       0.85      0.90      0.88        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:55:38,042 - trainer - INFO - {
  "dev_loss": 0.2686943784356117,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:38,043 - trainer - INFO -   no_improve_count: 53
2022-10-17 14:55:38,043 - trainer - INFO -   patience: 200
2022-10-17 14:55:38,044 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:38,048 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:38,048 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_312
2022-10-17 14:55:38,050 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_318
2022-10-17 14:55:38,055 - trainer - INFO - save model to path: tmp/mlp_digits\ck_318
2022-10-17 14:55:38,119 - trainer - INFO - 
*****************[epoch: 27, global step: 320] eval training set based on eval_every=2***************
2022-10-17 14:55:38,123 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       107
           1       0.91      0.94      0.93       105
           2       0.95      0.97      0.96       108
           3       0.95      0.93      0.94       100
           4       0.96      0.98      0.97       110
           5       0.99      0.97      0.98       106
           6       0.99      0.95      0.97        96
           7       0.89      0.99      0.94       101
           8       0.91      0.96      0.93        97
           9       0.97      0.82      0.89       110

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:55:38,124 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.08361013606190681
}
2022-10-17 14:55:38,412 - trainer - INFO - 
*****************[epoch: 27, global step: 320] eval development set based on eval_every=2***************
2022-10-17 14:55:38,415 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.93      0.98      0.95        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.91      0.95        34
         4.0       0.95      1.00      0.97        36
         5.0       0.92      0.88      0.90        40
         6.0       1.00      0.89      0.94        38
         7.0       0.94      0.97      0.96        33
         8.0       0.85      0.85      0.85        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:38,416 - trainer - INFO - {
  "dev_loss": 0.21034516269961992,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:38,417 - trainer - INFO -   no_improve_count: 54
2022-10-17 14:55:38,417 - trainer - INFO -   patience: 200
2022-10-17 14:55:38,419 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:38,419 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:38,419 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_314
2022-10-17 14:55:38,421 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_320
2022-10-17 14:55:38,426 - trainer - INFO - save model to path: tmp/mlp_digits\ck_320
2022-10-17 14:55:38,495 - trainer - INFO - 
*****************[epoch: 27, global step: 322] eval training set based on eval_every=2***************
2022-10-17 14:55:38,499 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       132
           1       0.89      0.94      0.92       126
           2       0.95      0.98      0.96       134
           3       0.96      0.92      0.94       133
           4       0.97      0.98      0.97       132
           5       0.98      0.97      0.98       133
           6       0.99      0.95      0.97       127
           7       0.91      0.98      0.94       127
           8       0.88      0.94      0.91       120
           9       0.96      0.83      0.89       136

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:55:38,501 - trainer - INFO - {
  "train_accuracy_score": 0.9484615384615385,
  "train_loss": 0.1778050772845745
}
2022-10-17 14:55:38,855 - trainer - INFO - 
*****************[epoch: 27, global step: 322] eval development set based on eval_every=2***************
2022-10-17 14:55:38,858 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.94      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.90      0.92        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      0.94      0.95        33
         8.0       0.88      0.93      0.90        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:38,859 - trainer - INFO - {
  "dev_loss": 0.1895312455793222,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:38,860 - trainer - INFO -   no_improve_count: 55
2022-10-17 14:55:38,860 - trainer - INFO -   patience: 200
2022-10-17 14:55:38,861 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:38,861 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:38,862 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_316
2022-10-17 14:55:38,863 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_322
2022-10-17 14:55:38,872 - trainer - INFO - save model to path: tmp/mlp_digits\ck_322
2022-10-17 14:55:38,928 - trainer - INFO - 
*****************[epoch: 27, global step: 324] eval training set based on eval_every=2***************
2022-10-17 14:55:38,934 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.90      0.94      0.92       140
           2       0.95      0.98      0.97       145
           3       0.96      0.92      0.94       149
           4       0.97      0.97      0.97       145
           5       0.98      0.97      0.98       142
           6       0.99      0.94      0.97       143
           7       0.92      0.98      0.95       146
           8       0.87      0.95      0.91       133
           9       0.95      0.85      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:38,935 - trainer - INFO - {
  "train_accuracy_score": 0.9491997216423104,
  "train_loss": 0.13165276870131493
}
2022-10-17 14:55:39,229 - trainer - INFO - 
*****************[epoch: 27, global step: 324] eval development set based on eval_every=2***************
2022-10-17 14:55:39,233 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      0.97      0.98        32
         3.0       0.92      0.97      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.85      0.91        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      0.94      0.95        33
         8.0       0.93      0.90      0.91        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.96      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:39,234 - trainer - INFO - {
  "dev_loss": 0.1653973733385404,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:39,235 - trainer - INFO -   no_improve_count: 56
2022-10-17 14:55:39,235 - trainer - INFO -   patience: 200
2022-10-17 14:55:39,237 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:39,238 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:39,238 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_318
2022-10-17 14:55:39,243 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_324
2022-10-17 14:55:39,249 - trainer - INFO - save model to path: tmp/mlp_digits\ck_324
2022-10-17 14:55:39,251 - trainer - INFO - 
*****************[epoch: 27, global step: 325] eval training set at end of epoch***************
2022-10-17 14:55:39,261 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.90      0.94      0.92       140
           2       0.95      0.98      0.97       145
           3       0.96      0.92      0.94       149
           4       0.97      0.97      0.97       145
           5       0.98      0.97      0.98       142
           6       0.99      0.94      0.97       143
           7       0.92      0.98      0.95       146
           8       0.87      0.95      0.91       133
           9       0.95      0.85      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:55:39,263 - trainer - INFO - {
  "train_accuracy_score": 0.9491997216423104,
  "train_loss": 0.17783545143902302
}
2022-10-17 14:55:39,264 - trainer - INFO - start training epoch 28
2022-10-17 14:55:39,264 - trainer - INFO - training using device=cuda
2022-10-17 14:55:39,264 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:39,264 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:39,340 - trainer - INFO - 
*****************[epoch: 28, global step: 326] eval training set based on eval_every=2***************
2022-10-17 14:55:39,343 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        17
           1       0.89      0.94      0.92        18
           2       1.00      0.97      0.98        30
           3       0.94      1.00      0.97        32
           4       1.00      0.97      0.98        29
           5       1.00      1.00      1.00        26
           6       0.96      1.00      0.98        23
           7       1.00      0.91      0.95        22
           8       0.93      0.90      0.92        31
           9       0.94      0.97      0.95        32

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:55:39,344 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.1979462280869484
}
2022-10-17 14:55:39,636 - trainer - INFO - 
*****************[epoch: 28, global step: 326] eval development set based on eval_every=2***************
2022-10-17 14:55:39,641 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.85      0.97      0.90        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      1.00      0.99        38
         7.0       0.97      0.97      0.97        33
         8.0       0.92      0.88      0.90        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.95       360
   macro avg       0.95      0.96      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:39,643 - trainer - INFO - {
  "dev_loss": 0.19623921439051628,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:39,644 - trainer - INFO -   no_improve_count: 57
2022-10-17 14:55:39,644 - trainer - INFO -   patience: 200
2022-10-17 14:55:39,646 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:39,646 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:39,646 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_320
2022-10-17 14:55:39,648 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_326
2022-10-17 14:55:39,653 - trainer - INFO - save model to path: tmp/mlp_digits\ck_326
2022-10-17 14:55:39,729 - trainer - INFO - 
*****************[epoch: 28, global step: 328] eval training set based on eval_every=2***************
2022-10-17 14:55:39,732 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        47
           1       0.94      0.96      0.95        48
           2       1.00      0.97      0.98        61
           3       0.95      1.00      0.97        55
           4       1.00      0.98      0.99        53
           5       1.00      0.98      0.99        51
           6       0.96      1.00      0.98        45
           7       0.98      0.96      0.97        47
           8       0.95      0.93      0.94        56
           9       0.96      0.96      0.96        57

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:55:39,734 - trainer - INFO - {
  "train_accuracy_score": 0.9730769230769231,
  "train_loss": 0.0807860791683197
}
2022-10-17 14:55:40,085 - trainer - INFO - 
*****************[epoch: 28, global step: 328] eval development set based on eval_every=2***************
2022-10-17 14:55:40,089 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.88      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       0.82      0.97      0.89        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.80      0.89        40
         6.0       0.93      1.00      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.94      0.80      0.87        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:40,090 - trainer - INFO - {
  "dev_loss": 0.2603963576257229,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:40,091 - trainer - INFO -   no_improve_count: 58
2022-10-17 14:55:40,091 - trainer - INFO -   patience: 200
2022-10-17 14:55:40,093 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:40,093 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:40,093 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_322
2022-10-17 14:55:40,094 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_328
2022-10-17 14:55:40,099 - trainer - INFO - save model to path: tmp/mlp_digits\ck_328
2022-10-17 14:55:40,166 - trainer - INFO - 
*****************[epoch: 28, global step: 330] eval training set based on eval_every=2***************
2022-10-17 14:55:40,169 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.97        79
           1       0.95      0.95      0.95        73
           2       1.00      0.98      0.99        87
           3       0.93      0.99      0.96        82
           4       0.97      0.99      0.98        77
           5       1.00      0.99      0.99        79
           6       0.94      1.00      0.97        75
           7       0.96      0.97      0.97        72
           8       0.94      0.93      0.94        73
           9       0.97      0.93      0.95        83

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:40,171 - trainer - INFO - {
  "train_accuracy_score": 0.9666666666666667,
  "train_loss": 0.15512195229530334
}
2022-10-17 14:55:40,467 - trainer - INFO - 
*****************[epoch: 28, global step: 330] eval development set based on eval_every=2***************
2022-10-17 14:55:40,471 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.91      0.94      0.93        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.78      0.87        40
         6.0       0.93      1.00      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.94      0.83      0.88        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:40,472 - trainer - INFO - {
  "dev_loss": 0.2609640086690585,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:40,473 - trainer - INFO -   no_improve_count: 59
2022-10-17 14:55:40,473 - trainer - INFO -   patience: 200
2022-10-17 14:55:40,474 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:40,475 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:40,475 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_324
2022-10-17 14:55:40,476 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_330
2022-10-17 14:55:40,481 - trainer - INFO - save model to path: tmp/mlp_digits\ck_330
2022-10-17 14:55:40,569 - trainer - INFO - 
*****************[epoch: 28, global step: 332] eval training set based on eval_every=2***************
2022-10-17 14:55:40,573 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.98       108
           1       0.94      0.95      0.94        97
           2       1.00      0.98      0.99       112
           3       0.95      0.99      0.97       112
           4       0.98      0.99      0.98        97
           5       1.00      0.93      0.97       104
           6       0.94      1.00      0.97       106
           7       0.96      0.98      0.97       103
           8       0.93      0.92      0.93        93
           9       0.95      0.93      0.94       108

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.97      0.96      0.96      1040

2022-10-17 14:55:40,575 - trainer - INFO - {
  "train_accuracy_score": 0.9644230769230769,
  "train_loss": 0.13540512323379517
}
2022-10-17 14:55:40,860 - trainer - INFO - 
*****************[epoch: 28, global step: 332] eval development set based on eval_every=2***************
2022-10-17 14:55:40,862 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       0.89      0.97      0.93        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.85      0.92        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.80      0.88        41
         9.0       0.78      1.00      0.87        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:40,863 - trainer - INFO - {
  "dev_loss": 0.23387079127132893,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:40,864 - trainer - INFO -   no_improve_count: 60
2022-10-17 14:55:40,864 - trainer - INFO -   patience: 200
2022-10-17 14:55:40,865 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:40,869 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:40,870 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_326
2022-10-17 14:55:40,871 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_332
2022-10-17 14:55:40,876 - trainer - INFO - save model to path: tmp/mlp_digits\ck_332
2022-10-17 14:55:40,942 - trainer - INFO - 
*****************[epoch: 28, global step: 334] eval training set based on eval_every=2***************
2022-10-17 14:55:40,946 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       128
           1       0.94      0.95      0.94       125
           2       1.00      0.99      0.99       135
           3       0.96      0.99      0.97       135
           4       0.98      0.98      0.98       130
           5       1.00      0.93      0.96       128
           6       0.95      1.00      0.97       131
           7       0.96      0.97      0.97       133
           8       0.94      0.94      0.94       120
           9       0.93      0.93      0.93       135

    accuracy                           0.96      1300
   macro avg       0.97      0.96      0.96      1300
weighted avg       0.97      0.96      0.96      1300

2022-10-17 14:55:40,947 - trainer - INFO - {
  "train_accuracy_score": 0.9646153846153847,
  "train_loss": 0.1276252157986164
}
2022-10-17 14:55:41,315 - trainer - INFO - 
*****************[epoch: 28, global step: 334] eval development set based on eval_every=2***************
2022-10-17 14:55:41,318 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.87      0.97      0.92        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.85      0.91        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      0.94      0.94        33
         8.0       1.00      0.80      0.89        41
         9.0       0.78      1.00      0.87        31

    accuracy                           0.94       360
   macro avg       0.94      0.95      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:41,320 - trainer - INFO - {
  "dev_loss": 0.19953093553582826,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:41,321 - trainer - INFO -   no_improve_count: 61
2022-10-17 14:55:41,322 - trainer - INFO -   patience: 200
2022-10-17 14:55:41,323 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:41,323 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:41,323 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_328
2022-10-17 14:55:41,325 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_334
2022-10-17 14:55:41,329 - trainer - INFO - save model to path: tmp/mlp_digits\ck_334
2022-10-17 14:55:41,380 - trainer - INFO - 
*****************[epoch: 28, global step: 336] eval training set based on eval_every=2***************
2022-10-17 14:55:41,385 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.94      0.94      0.94       140
           2       1.00      0.99      0.99       145
           3       0.95      0.99      0.97       149
           4       0.99      0.98      0.98       145
           5       1.00      0.94      0.97       142
           6       0.95      1.00      0.98       143
           7       0.97      0.97      0.97       146
           8       0.95      0.93      0.94       133
           9       0.91      0.93      0.92       149

    accuracy                           0.96      1437
   macro avg       0.97      0.96      0.96      1437
weighted avg       0.97      0.96      0.96      1437

2022-10-17 14:55:41,388 - trainer - INFO - {
  "train_accuracy_score": 0.964509394572025,
  "train_loss": 0.07318956279414124
}
2022-10-17 14:55:41,689 - trainer - INFO - 
*****************[epoch: 28, global step: 336] eval development set based on eval_every=2***************
2022-10-17 14:55:41,694 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.89      1.00      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.88      0.92        40
         6.0       0.97      0.95      0.96        38
         7.0       0.97      0.94      0.95        33
         8.0       1.00      0.83      0.91        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.95       360
   macro avg       0.95      0.96      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:41,695 - trainer - INFO - {
  "dev_loss": 0.1469571217894554,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:41,695 - trainer - INFO -   no_improve_count: 62
2022-10-17 14:55:41,696 - trainer - INFO -   patience: 200
2022-10-17 14:55:41,697 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:41,697 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:41,697 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_330
2022-10-17 14:55:41,698 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_336
2022-10-17 14:55:41,703 - trainer - INFO - save model to path: tmp/mlp_digits\ck_336
2022-10-17 14:55:41,707 - trainer - INFO - 
*****************[epoch: 28, global step: 337] eval training set at end of epoch***************
2022-10-17 14:55:41,713 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.94      0.94      0.94       140
           2       1.00      0.99      0.99       145
           3       0.95      0.99      0.97       149
           4       0.99      0.98      0.98       145
           5       1.00      0.94      0.97       142
           6       0.95      1.00      0.98       143
           7       0.97      0.97      0.97       146
           8       0.95      0.93      0.94       133
           9       0.91      0.93      0.92       149

    accuracy                           0.96      1437
   macro avg       0.97      0.96      0.96      1437
weighted avg       0.97      0.96      0.96      1437

2022-10-17 14:55:41,717 - trainer - INFO - {
  "train_accuracy_score": 0.964509394572025,
  "train_loss": 0.12834569356285405
}
2022-10-17 14:55:41,718 - trainer - INFO - start training epoch 29
2022-10-17 14:55:41,718 - trainer - INFO - training using device=cuda
2022-10-17 14:55:41,719 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:41,719 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:41,796 - trainer - INFO - 
*****************[epoch: 29, global step: 338] eval training set based on eval_every=2***************
2022-10-17 14:55:41,801 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       0.94      0.97      0.95        30
           2       1.00      1.00      1.00        25
           3       0.96      1.00      0.98        24
           4       1.00      1.00      1.00        20
           5       1.00      0.94      0.97        31
           6       0.90      1.00      0.95        26
           7       1.00      1.00      1.00        25
           8       0.94      0.89      0.91        18
           9       1.00      0.94      0.97        33

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:55:41,802 - trainer - INFO - {
  "train_accuracy_score": 0.9730769230769231,
  "train_loss": 0.12967781350016594
}
2022-10-17 14:55:42,089 - trainer - INFO - 
*****************[epoch: 29, global step: 338] eval development set based on eval_every=2***************
2022-10-17 14:55:42,093 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.82      1.00      0.90        42
         2.0       1.00      1.00      1.00        32
         3.0       0.92      1.00      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.86      0.77      0.81        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:42,094 - trainer - INFO - {
  "dev_loss": 0.1639707920451959,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:42,094 - trainer - INFO -   no_improve_count: 63
2022-10-17 14:55:42,095 - trainer - INFO -   patience: 200
2022-10-17 14:55:42,096 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:42,096 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:42,097 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_332
2022-10-17 14:55:42,098 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_338
2022-10-17 14:55:42,102 - trainer - INFO - save model to path: tmp/mlp_digits\ck_338
2022-10-17 14:55:42,175 - trainer - INFO - 
*****************[epoch: 29, global step: 340] eval training set based on eval_every=2***************
2022-10-17 14:55:42,178 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        54
           1       0.90      0.98      0.94        53
           2       1.00      1.00      1.00        53
           3       0.98      1.00      0.99        56
           4       1.00      1.00      1.00        45
           5       0.98      0.97      0.98        61
           6       0.94      0.98      0.96        50
           7       1.00      0.98      0.99        55
           8       0.97      0.95      0.96        41
           9       0.98      0.88      0.93        52

    accuracy                           0.97       520
   macro avg       0.98      0.97      0.97       520
weighted avg       0.98      0.97      0.97       520

2022-10-17 14:55:42,179 - trainer - INFO - {
  "train_accuracy_score": 0.975,
  "train_loss": 0.057927642948925495
}
2022-10-17 14:55:42,574 - trainer - INFO - 
*****************[epoch: 29, global step: 340] eval development set based on eval_every=2***************
2022-10-17 14:55:42,578 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.86      1.00      0.92        42
         2.0       1.00      1.00      1.00        32
         3.0       0.87      1.00      0.93        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.89      0.94        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.83      0.91        41
         9.0       0.96      0.77      0.86        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:42,579 - trainer - INFO - {
  "dev_loss": 0.22086423511306444,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:42,580 - trainer - INFO -   no_improve_count: 64
2022-10-17 14:55:42,580 - trainer - INFO -   patience: 200
2022-10-17 14:55:42,581 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:42,582 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:42,582 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_334
2022-10-17 14:55:42,583 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_340
2022-10-17 14:55:42,588 - trainer - INFO - save model to path: tmp/mlp_digits\ck_340
2022-10-17 14:55:42,667 - trainer - INFO - 
*****************[epoch: 29, global step: 342] eval training set based on eval_every=2***************
2022-10-17 14:55:42,670 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        81
           1       0.87      0.99      0.92        72
           2       1.00      1.00      1.00        73
           3       0.96      1.00      0.98        81
           4       1.00      0.97      0.99        72
           5       0.98      0.98      0.98        89
           6       0.96      0.99      0.98        81
           7       1.00      0.98      0.99        86
           8       0.98      0.94      0.96        67
           9       0.97      0.86      0.91        78

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:42,672 - trainer - INFO - {
  "train_accuracy_score": 0.9705128205128205,
  "train_loss": 0.11873773857951164
}
2022-10-17 14:55:42,961 - trainer - INFO - 
*****************[epoch: 29, global step: 342] eval development set based on eval_every=2***************
2022-10-17 14:55:42,965 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.89      1.00      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.89      0.94        38
         7.0       0.97      1.00      0.99        33
         8.0       0.95      0.85      0.90        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:42,966 - trainer - INFO - {
  "dev_loss": 0.21810617049535116,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:42,967 - trainer - INFO -   no_improve_count: 65
2022-10-17 14:55:42,968 - trainer - INFO -   patience: 200
2022-10-17 14:55:42,969 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:42,969 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:42,969 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_336
2022-10-17 14:55:42,971 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_342
2022-10-17 14:55:42,976 - trainer - INFO - save model to path: tmp/mlp_digits\ck_342
2022-10-17 14:55:43,053 - trainer - INFO - 
*****************[epoch: 29, global step: 344] eval training set based on eval_every=2***************
2022-10-17 14:55:43,057 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       106
           1       0.88      0.98      0.93        95
           2       1.00      1.00      1.00       100
           3       0.96      1.00      0.98       107
           4       1.00      0.95      0.97       101
           5       0.98      0.97      0.98       111
           6       0.97      0.99      0.98       109
           7       0.98      0.98      0.98       101
           8       0.98      0.95      0.97       102
           9       0.96      0.87      0.91       108

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:43,059 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.08919820189476013
}
2022-10-17 14:55:43,328 - trainer - INFO - 
*****************[epoch: 29, global step: 344] eval development set based on eval_every=2***************
2022-10-17 14:55:43,335 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       1.00      0.93      0.96        42
         2.0       1.00      0.97      0.98        32
         3.0       0.91      0.94      0.93        34
         4.0       1.00      1.00      1.00        36
         5.0       0.92      0.90      0.91        40
         6.0       1.00      0.89      0.94        38
         7.0       0.97      1.00      0.99        33
         8.0       0.86      0.93      0.89        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.95       360
   macro avg       0.96      0.96      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:43,335 - trainer - INFO - {
  "dev_loss": 0.19418778518835703,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:43,336 - trainer - INFO -   no_improve_count: 66
2022-10-17 14:55:43,337 - trainer - INFO -   patience: 200
2022-10-17 14:55:43,338 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:43,338 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:43,339 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_338
2022-10-17 14:55:43,340 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_344
2022-10-17 14:55:43,345 - trainer - INFO - save model to path: tmp/mlp_digits\ck_344
2022-10-17 14:55:43,417 - trainer - INFO - 
*****************[epoch: 29, global step: 346] eval training set based on eval_every=2***************
2022-10-17 14:55:43,420 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       130
           1       0.90      0.96      0.93       124
           2       1.00      1.00      1.00       130
           3       0.96      1.00      0.98       130
           4       1.00      0.95      0.97       134
           5       0.98      0.97      0.98       132
           6       0.98      0.99      0.99       137
           7       0.98      0.98      0.98       128
           8       0.95      0.96      0.95       119
           9       0.95      0.90      0.92       136

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:43,422 - trainer - INFO - {
  "train_accuracy_score": 0.97,
  "train_loss": 0.09481548890471458
}
2022-10-17 14:55:43,698 - trainer - INFO - 
*****************[epoch: 29, global step: 346] eval development set based on eval_every=2***************
2022-10-17 14:55:43,701 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       1.00      0.95      0.98        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.88      0.92        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.88      0.92        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.88      0.90      0.89        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:43,702 - trainer - INFO - {
  "dev_loss": 0.22541283071041107,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:43,703 - trainer - INFO -   no_improve_count: 67
2022-10-17 14:55:43,706 - trainer - INFO -   patience: 200
2022-10-17 14:55:43,707 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:43,707 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:43,708 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_340
2022-10-17 14:55:43,709 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_346
2022-10-17 14:55:43,714 - trainer - INFO - save model to path: tmp/mlp_digits\ck_346
2022-10-17 14:55:43,808 - trainer - INFO - 
*****************[epoch: 29, global step: 348] eval training set based on eval_every=2***************
2022-10-17 14:55:43,812 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.91      0.96      0.93       140
           2       1.00      0.99      1.00       145
           3       0.97      1.00      0.98       149
           4       1.00      0.95      0.98       145
           5       0.99      0.97      0.98       142
           6       0.98      0.99      0.99       143
           7       0.99      0.98      0.98       146
           8       0.95      0.96      0.96       133
           9       0.95      0.91      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:43,813 - trainer - INFO - {
  "train_accuracy_score": 0.9714683368128044,
  "train_loss": 0.028247277019545436
}
2022-10-17 14:55:44,095 - trainer - INFO - 
*****************[epoch: 29, global step: 348] eval development set based on eval_every=2***************
2022-10-17 14:55:44,098 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.85      0.91        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.80      0.88        40
         6.0       0.95      0.95      0.95        38
         7.0       0.92      1.00      0.96        33
         8.0       0.88      0.88      0.88        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:44,099 - trainer - INFO - {
  "dev_loss": 0.2877116824189822,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:44,099 - trainer - INFO -   no_improve_count: 68
2022-10-17 14:55:44,100 - trainer - INFO -   patience: 200
2022-10-17 14:55:44,101 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:44,101 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:44,101 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_342
2022-10-17 14:55:44,102 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_348
2022-10-17 14:55:44,109 - trainer - INFO - save model to path: tmp/mlp_digits\ck_348
2022-10-17 14:55:44,110 - trainer - INFO - 
*****************[epoch: 29, global step: 349] eval training set at end of epoch***************
2022-10-17 14:55:44,116 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.91      0.96      0.93       140
           2       1.00      0.99      1.00       145
           3       0.97      1.00      0.98       149
           4       1.00      0.95      0.98       145
           5       0.99      0.97      0.98       142
           6       0.98      0.99      0.99       143
           7       0.99      0.98      0.98       146
           8       0.95      0.96      0.96       133
           9       0.95      0.91      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:44,118 - trainer - INFO - {
  "train_accuracy_score": 0.9714683368128044,
  "train_loss": 0.08643402714127053
}
2022-10-17 14:55:44,119 - trainer - INFO - start training epoch 30
2022-10-17 14:55:44,121 - trainer - INFO - training using device=cuda
2022-10-17 14:55:44,121 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:44,121 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:44,195 - trainer - INFO - 
*****************[epoch: 30, global step: 350] eval training set based on eval_every=2***************
2022-10-17 14:55:44,198 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        32
           1       1.00      0.94      0.97        18
           2       1.00      1.00      1.00        25
           3       1.00      0.85      0.92        27
           4       0.95      1.00      0.98        21
           5       1.00      0.95      0.98        22
           6       1.00      1.00      1.00        29
           7       0.92      1.00      0.96        24
           8       0.89      1.00      0.94        33
           9       0.96      0.93      0.95        29

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:55:44,198 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.08480850607156754
}
2022-10-17 14:55:44,472 - trainer - INFO - 
*****************[epoch: 30, global step: 350] eval development set based on eval_every=2***************
2022-10-17 14:55:44,477 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.98      0.95      0.96        42
         2.0       0.94      1.00      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.80      0.88        40
         6.0       0.97      0.95      0.96        38
         7.0       0.92      1.00      0.96        33
         8.0       0.92      0.85      0.89        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:44,478 - trainer - INFO - {
  "dev_loss": 0.2987183729807536,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:44,478 - trainer - INFO -   no_improve_count: 69
2022-10-17 14:55:44,479 - trainer - INFO -   patience: 200
2022-10-17 14:55:44,480 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:44,480 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:44,481 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_344
2022-10-17 14:55:44,482 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_350
2022-10-17 14:55:44,487 - trainer - INFO - save model to path: tmp/mlp_digits\ck_350
2022-10-17 14:55:44,577 - trainer - INFO - 
*****************[epoch: 30, global step: 352] eval training set based on eval_every=2***************
2022-10-17 14:55:44,581 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        62
           1       0.97      0.92      0.95        38
           2       1.00      1.00      1.00        48
           3       1.00      0.93      0.97        61
           4       0.98      1.00      0.99        43
           5       1.00      0.93      0.96        44
           6       1.00      1.00      1.00        61
           7       0.96      0.98      0.97        46
           8       0.92      0.98      0.95        55
           9       0.94      0.97      0.95        62

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:55:44,582 - trainer - INFO - {
  "train_accuracy_score": 0.9730769230769231,
  "train_loss": 0.07905613165348768
}
2022-10-17 14:55:44,862 - trainer - INFO - 
*****************[epoch: 30, global step: 352] eval development set based on eval_every=2***************
2022-10-17 14:55:44,866 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      0.98      0.96        42
         2.0       0.94      1.00      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.88      0.91        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.92      0.83      0.87        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:44,868 - trainer - INFO - {
  "dev_loss": 0.2699018083512783,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:44,869 - trainer - INFO -   no_improve_count: 70
2022-10-17 14:55:44,869 - trainer - INFO -   patience: 200
2022-10-17 14:55:44,870 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:44,871 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:44,871 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_346
2022-10-17 14:55:44,872 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_352
2022-10-17 14:55:44,877 - trainer - INFO - save model to path: tmp/mlp_digits\ck_352
2022-10-17 14:55:44,994 - trainer - INFO - 
*****************[epoch: 30, global step: 354] eval training set based on eval_every=2***************
2022-10-17 14:55:44,998 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        92
           1       0.95      0.93      0.94        59
           2       0.99      1.00      0.99        80
           3       1.00      0.95      0.98        85
           4       0.99      1.00      0.99        72
           5       1.00      0.94      0.97        62
           6       1.00      1.00      1.00        81
           7       0.96      0.99      0.97        75
           8       0.94      0.97      0.95        75
           9       0.96      0.97      0.96        99

    accuracy                           0.98       780
   macro avg       0.98      0.98      0.98       780
weighted avg       0.98      0.98      0.98       780

2022-10-17 14:55:44,999 - trainer - INFO - {
  "train_accuracy_score": 0.9769230769230769,
  "train_loss": 0.07295330241322517
}
2022-10-17 14:55:45,280 - trainer - INFO - 
*****************[epoch: 30, global step: 354] eval development set based on eval_every=2***************
2022-10-17 14:55:45,283 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      1.00      0.97        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.94      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.92      0.90      0.91        40
         6.0       1.00      0.87      0.93        38
         7.0       0.94      0.97      0.96        33
         8.0       0.95      0.85      0.90        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:45,286 - trainer - INFO - {
  "dev_loss": 0.23250344643990198,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:45,287 - trainer - INFO -   no_improve_count: 71
2022-10-17 14:55:45,288 - trainer - INFO -   patience: 200
2022-10-17 14:55:45,289 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:45,289 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:45,290 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_348
2022-10-17 14:55:45,291 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_354
2022-10-17 14:55:45,296 - trainer - INFO - save model to path: tmp/mlp_digits\ck_354
2022-10-17 14:55:45,359 - trainer - INFO - 
*****************[epoch: 30, global step: 356] eval training set based on eval_every=2***************
2022-10-17 14:55:45,363 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       113
           1       0.94      0.96      0.95        97
           2       0.99      1.00      1.00       102
           3       1.00      0.96      0.98       112
           4       0.99      0.99      0.99        99
           5       0.98      0.95      0.96        93
           6       1.00      1.00      1.00       103
           7       0.97      0.99      0.98        98
           8       0.94      0.96      0.95        98
           9       0.95      0.95      0.95       125

    accuracy                           0.97      1040
   macro avg       0.98      0.98      0.97      1040
weighted avg       0.98      0.97      0.98      1040

2022-10-17 14:55:45,364 - trainer - INFO - {
  "train_accuracy_score": 0.975,
  "train_loss": 0.0697067454457283
}
2022-10-17 14:55:45,637 - trainer - INFO - 
*****************[epoch: 30, global step: 356] eval development set based on eval_every=2***************
2022-10-17 14:55:45,641 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      1.00      0.97        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.93      0.93        40
         6.0       1.00      0.89      0.94        38
         7.0       0.97      0.97      0.97        33
         8.0       0.97      0.85      0.91        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:45,642 - trainer - INFO - {
  "dev_loss": 0.18950514992078146,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9638888888888889
}
2022-10-17 14:55:45,643 - trainer - INFO -   no_improve_count: 72
2022-10-17 14:55:45,643 - trainer - INFO -   patience: 200
2022-10-17 14:55:45,644 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:45,644 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:45,645 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_350
2022-10-17 14:55:45,646 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_356
2022-10-17 14:55:45,651 - trainer - INFO - save model to path: tmp/mlp_digits\ck_356
2022-10-17 14:55:45,710 - trainer - INFO - 
*****************[epoch: 30, global step: 358] eval training set based on eval_every=2***************
2022-10-17 14:55:45,714 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       129
           1       0.92      0.97      0.95       125
           2       0.99      1.00      1.00       131
           3       1.00      0.96      0.98       140
           4       0.99      0.98      0.99       129
           5       0.98      0.96      0.97       125
           6       1.00      0.98      0.99       133
           7       0.98      0.98      0.98       132
           8       0.93      0.95      0.94       116
           9       0.94      0.95      0.95       140

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:45,716 - trainer - INFO - {
  "train_accuracy_score": 0.9738461538461538,
  "train_loss": 0.08601736649870872
}
2022-10-17 14:55:46,033 - trainer - INFO - 
*****************[epoch: 30, global step: 358] eval development set based on eval_every=2***************
2022-10-17 14:55:46,036 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.89      1.00      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.92      0.90      0.91        40
         6.0       1.00      0.92      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:55:46,037 - trainer - INFO - {
  "dev_loss": 0.12666080395380655,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:46,038 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:46,039 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:46,039 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:46,039 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_352
2022-10-17 14:55:46,040 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:46,047 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:46,048 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:46,048 - trainer - INFO -   patience: 200
2022-10-17 14:55:46,049 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:46,049 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_358
2022-10-17 14:55:46,053 - trainer - INFO - save model to path: tmp/mlp_digits\ck_358
2022-10-17 14:55:46,099 - trainer - INFO - 
*****************[epoch: 30, global step: 360] eval training set based on eval_every=2***************
2022-10-17 14:55:46,103 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.93      0.97      0.95       140
           2       0.99      0.99      0.99       145
           3       1.00      0.97      0.98       149
           4       0.99      0.98      0.99       145
           5       0.99      0.96      0.98       142
           6       1.00      0.98      0.99       143
           7       0.98      0.99      0.98       146
           8       0.93      0.95      0.94       133
           9       0.95      0.95      0.95       149

    accuracy                           0.97      1437
   macro avg       0.98      0.97      0.97      1437
weighted avg       0.98      0.97      0.98      1437

2022-10-17 14:55:46,105 - trainer - INFO - {
  "train_accuracy_score": 0.9749478079331941,
  "train_loss": 0.06465024687349796
}
2022-10-17 14:55:46,383 - trainer - INFO - 
*****************[epoch: 30, global step: 360] eval development set based on eval_every=2***************
2022-10-17 14:55:46,386 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.76      0.85        42
         2.0       1.00      0.97      0.98        32
         3.0       0.79      1.00      0.88        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.90      0.92        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.81      0.83      0.82        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:46,388 - trainer - INFO - {
  "dev_loss": 0.24518482945859432,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:46,389 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:46,389 - trainer - INFO -   patience: 200
2022-10-17 14:55:46,390 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:46,390 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:46,390 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_354
2022-10-17 14:55:46,392 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_360
2022-10-17 14:55:46,396 - trainer - INFO - save model to path: tmp/mlp_digits\ck_360
2022-10-17 14:55:46,397 - trainer - INFO - 
*****************[epoch: 30, global step: 361] eval training set at end of epoch***************
2022-10-17 14:55:46,403 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.93      0.97      0.95       140
           2       0.99      0.99      0.99       145
           3       1.00      0.97      0.98       149
           4       0.99      0.98      0.99       145
           5       0.99      0.96      0.98       142
           6       1.00      0.98      0.99       143
           7       0.98      0.99      0.98       146
           8       0.93      0.95      0.94       133
           9       0.95      0.95      0.95       149

    accuracy                           0.97      1437
   macro avg       0.98      0.97      0.97      1437
weighted avg       0.98      0.97      0.98      1437

2022-10-17 14:55:46,405 - trainer - INFO - {
  "train_accuracy_score": 0.9749478079331941,
  "train_loss": 0.07619871649270256
}
2022-10-17 14:55:46,406 - trainer - INFO - start training epoch 31
2022-10-17 14:55:46,406 - trainer - INFO - training using device=cuda
2022-10-17 14:55:46,407 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:46,407 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:46,477 - trainer - INFO - 
*****************[epoch: 31, global step: 362] eval training set based on eval_every=2***************
2022-10-17 14:55:46,482 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       1.00      0.69      0.82        26
           2       1.00      1.00      1.00        31
           3       0.96      1.00      0.98        27
           4       1.00      1.00      1.00        27
           5       1.00      1.00      1.00        25
           6       1.00      1.00      1.00        31
           7       1.00      0.95      0.97        20
           8       0.73      0.95      0.83        20
           9       0.93      1.00      0.97        28

    accuracy                           0.96       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.97      0.96      0.96       260

2022-10-17 14:55:46,483 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.14189374074339867
}
2022-10-17 14:55:46,784 - trainer - INFO - 
*****************[epoch: 31, global step: 362] eval development set based on eval_every=2***************
2022-10-17 14:55:46,788 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       1.00      0.81      0.89        42
         2.0       1.00      0.91      0.95        32
         3.0       0.83      1.00      0.91        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.93      0.94        40
         6.0       0.95      0.92      0.93        38
         7.0       1.00      0.97      0.98        33
         8.0       0.86      0.78      0.82        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:55:46,789 - trainer - INFO - {
  "dev_loss": 0.31191521510481834,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:46,790 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:46,790 - trainer - INFO -   patience: 200
2022-10-17 14:55:46,791 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:46,792 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:46,792 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_356
2022-10-17 14:55:46,793 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_362
2022-10-17 14:55:46,797 - trainer - INFO - save model to path: tmp/mlp_digits\ck_362
2022-10-17 14:55:46,860 - trainer - INFO - 
*****************[epoch: 31, global step: 364] eval training set based on eval_every=2***************
2022-10-17 14:55:46,864 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        54
           1       0.98      0.84      0.90        55
           2       1.00      0.98      0.99        49
           3       0.97      1.00      0.98        58
           4       1.00      0.98      0.99        57
           5       1.00      0.98      0.99        54
           6       1.00      1.00      1.00        52
           7       1.00      0.98      0.99        50
           8       0.80      0.97      0.88        38
           9       0.96      0.96      0.96        53

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:55:46,865 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.13794614374637604
}
2022-10-17 14:55:47,176 - trainer - INFO - 
*****************[epoch: 31, global step: 364] eval development set based on eval_every=2***************
2022-10-17 14:55:47,182 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.88      0.93        32
         3.0       0.82      0.97      0.89        34
         4.0       0.92      1.00      0.96        36
         5.0       0.97      0.85      0.91        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       0.97      0.76      0.85        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:47,183 - trainer - INFO - {
  "dev_loss": 0.39871063455939293,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:47,184 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:47,184 - trainer - INFO -   patience: 200
2022-10-17 14:55:47,185 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:47,185 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:47,186 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_358
2022-10-17 14:55:47,187 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_364
2022-10-17 14:55:47,191 - trainer - INFO - save model to path: tmp/mlp_digits\ck_364
2022-10-17 14:55:47,253 - trainer - INFO - 
*****************[epoch: 31, global step: 366] eval training set based on eval_every=2***************
2022-10-17 14:55:47,257 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.99        75
           1       0.95      0.90      0.92        88
           2       1.00      0.94      0.97        71
           3       0.96      1.00      0.98        77
           4       1.00      0.98      0.99        88
           5       1.00      0.97      0.99        77
           6       1.00      1.00      1.00        76
           7       0.98      0.99      0.98        82
           8       0.87      0.96      0.91        70
           9       0.95      0.95      0.95        76

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:47,259 - trainer - INFO - {
  "train_accuracy_score": 0.967948717948718,
  "train_loss": 0.15142330527305603
}
2022-10-17 14:55:47,535 - trainer - INFO - 
*****************[epoch: 31, global step: 366] eval development set based on eval_every=2***************
2022-10-17 14:55:47,539 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.91      0.98      0.94        42
         2.0       1.00      0.88      0.93        32
         3.0       0.89      0.94      0.91        34
         4.0       0.88      1.00      0.94        36
         5.0       1.00      0.85      0.92        40
         6.0       1.00      0.97      0.99        38
         7.0       0.91      0.97      0.94        33
         8.0       0.97      0.76      0.85        41
         9.0       0.81      0.94      0.87        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.92       360
weighted avg       0.93      0.93      0.92       360

2022-10-17 14:55:47,540 - trainer - INFO - {
  "dev_loss": 0.4537143061558406,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:47,541 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:47,542 - trainer - INFO -   patience: 200
2022-10-17 14:55:47,543 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:47,543 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:47,543 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_360
2022-10-17 14:55:47,545 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_366
2022-10-17 14:55:47,550 - trainer - INFO - save model to path: tmp/mlp_digits\ck_366
2022-10-17 14:55:47,621 - trainer - INFO - 
*****************[epoch: 31, global step: 368] eval training set based on eval_every=2***************
2022-10-17 14:55:47,625 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98       104
           1       0.93      0.91      0.92       111
           2       1.00      0.95      0.97        95
           3       0.96      1.00      0.98       109
           4       0.99      0.97      0.98       112
           5       1.00      0.98      0.99        99
           6       1.00      0.98      0.99       105
           7       0.98      0.99      0.99       103
           8       0.90      0.94      0.92        93
           9       0.95      0.95      0.95       109

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:47,627 - trainer - INFO - {
  "train_accuracy_score": 0.9673076923076923,
  "train_loss": 0.2085549533367157
}
2022-10-17 14:55:47,900 - trainer - INFO - 
*****************[epoch: 31, global step: 368] eval development set based on eval_every=2***************
2022-10-17 14:55:47,904 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      0.88      0.93        32
         3.0       0.89      0.94      0.91        34
         4.0       0.92      1.00      0.96        36
         5.0       1.00      0.82      0.90        40
         6.0       0.97      1.00      0.99        38
         7.0       0.91      0.97      0.94        33
         8.0       0.95      0.90      0.92        41
         9.0       0.88      0.94      0.91        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:55:47,906 - trainer - INFO - {
  "dev_loss": 0.23504764524598917,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:47,906 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:47,907 - trainer - INFO -   patience: 200
2022-10-17 14:55:47,908 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:47,908 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:47,909 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_362
2022-10-17 14:55:47,910 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_368
2022-10-17 14:55:47,915 - trainer - INFO - save model to path: tmp/mlp_digits\ck_368
2022-10-17 14:55:47,991 - trainer - INFO - 
*****************[epoch: 31, global step: 370] eval training set based on eval_every=2***************
2022-10-17 14:55:47,995 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.99       132
           1       0.90      0.92      0.91       132
           2       1.00      0.95      0.97       129
           3       0.96      1.00      0.98       133
           4       0.99      0.98      0.98       130
           5       1.00      0.97      0.98       128
           6       1.00      0.98      0.99       125
           7       0.98      0.99      0.99       135
           8       0.92      0.94      0.93       121
           9       0.95      0.93      0.94       135

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:47,996 - trainer - INFO - {
  "train_accuracy_score": 0.9669230769230769,
  "train_loss": 0.11989184468984604
}
2022-10-17 14:55:48,320 - trainer - INFO - 
*****************[epoch: 31, global step: 370] eval development set based on eval_every=2***************
2022-10-17 14:55:48,324 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.97      0.98        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      0.94      0.97        32
         3.0       0.91      0.91      0.91        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.88      0.93        40
         6.0       0.95      1.00      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       0.93      0.98      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:48,325 - trainer - INFO - {
  "dev_loss": 0.1320433939496676,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:48,325 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:48,326 - trainer - INFO -   patience: 200
2022-10-17 14:55:48,327 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:48,327 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:48,328 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_364
2022-10-17 14:55:48,329 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_370
2022-10-17 14:55:48,334 - trainer - INFO - save model to path: tmp/mlp_digits\ck_370
2022-10-17 14:55:48,380 - trainer - INFO - 
*****************[epoch: 31, global step: 372] eval training set based on eval_every=2***************
2022-10-17 14:55:48,385 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98       145
           1       0.91      0.92      0.91       140
           2       1.00      0.94      0.97       145
           3       0.96      0.99      0.98       149
           4       0.99      0.98      0.99       145
           5       1.00      0.97      0.99       142
           6       0.99      0.99      0.99       143
           7       0.98      0.99      0.99       146
           8       0.92      0.95      0.93       133
           9       0.95      0.94      0.95       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:48,386 - trainer - INFO - {
  "train_accuracy_score": 0.9672929714683368,
  "train_loss": 0.06963559193536639
}
2022-10-17 14:55:48,668 - trainer - INFO - 
*****************[epoch: 31, global step: 372] eval development set based on eval_every=2***************
2022-10-17 14:55:48,671 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.79      0.88        33
         1.0       0.97      0.93      0.95        42
         2.0       0.94      1.00      0.97        32
         3.0       0.97      0.91      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.90      0.95        40
         6.0       0.83      1.00      0.90        38
         7.0       1.00      1.00      1.00        33
         8.0       0.91      0.98      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:48,672 - trainer - INFO - {
  "dev_loss": 0.16599836945533752,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:48,672 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:55:48,673 - trainer - INFO -   patience: 200
2022-10-17 14:55:48,674 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:48,674 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:48,674 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_366
2022-10-17 14:55:48,675 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_372
2022-10-17 14:55:48,680 - trainer - INFO - save model to path: tmp/mlp_digits\ck_372
2022-10-17 14:55:48,681 - trainer - INFO - 
*****************[epoch: 31, global step: 373] eval training set at end of epoch***************
2022-10-17 14:55:48,685 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98       145
           1       0.91      0.92      0.91       140
           2       1.00      0.94      0.97       145
           3       0.96      0.99      0.98       149
           4       0.99      0.98      0.99       145
           5       1.00      0.97      0.99       142
           6       0.99      0.99      0.99       143
           7       0.98      0.99      0.99       146
           8       0.92      0.95      0.93       133
           9       0.95      0.94      0.95       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:48,686 - trainer - INFO - {
  "train_accuracy_score": 0.9672929714683368,
  "train_loss": 0.13822426328745982
}
2022-10-17 14:55:48,687 - trainer - INFO - start training epoch 32
2022-10-17 14:55:48,687 - trainer - INFO - training using device=cuda
2022-10-17 14:55:48,688 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:48,688 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:48,755 - trainer - INFO - 
*****************[epoch: 32, global step: 374] eval training set based on eval_every=2***************
2022-10-17 14:55:48,758 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.91      0.95        23
           1       1.00      0.88      0.94        25
           2       0.96      1.00      0.98        26
           3       0.94      1.00      0.97        32
           4       1.00      1.00      1.00        21
           5       1.00      1.00      1.00        24
           6       0.93      1.00      0.96        26
           7       1.00      1.00      1.00        38
           8       0.96      1.00      0.98        23
           9       0.90      0.86      0.88        22

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:55:48,759 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.11434114910662174
}
2022-10-17 14:55:49,033 - trainer - INFO - 
*****************[epoch: 32, global step: 374] eval development set based on eval_every=2***************
2022-10-17 14:55:49,037 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.76      0.85        42
         2.0       0.86      1.00      0.93        32
         3.0       0.92      0.97      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.93      0.94        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:49,039 - trainer - INFO - {
  "dev_loss": 0.1784382238984108,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:49,039 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:55:49,040 - trainer - INFO -   patience: 200
2022-10-17 14:55:49,041 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:49,041 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:49,041 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_368
2022-10-17 14:55:49,043 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_374
2022-10-17 14:55:49,047 - trainer - INFO - save model to path: tmp/mlp_digits\ck_374
2022-10-17 14:55:49,112 - trainer - INFO - 
*****************[epoch: 32, global step: 376] eval training set based on eval_every=2***************
2022-10-17 14:55:49,115 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.93      0.97        61
           1       0.98      0.89      0.93        55
           2       0.96      1.00      0.98        54
           3       0.97      1.00      0.98        60
           4       0.98      0.96      0.97        48
           5       1.00      1.00      1.00        47
           6       0.92      1.00      0.96        47
           7       1.00      1.00      1.00        61
           8       0.96      1.00      0.98        45
           9       0.93      0.93      0.93        42

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:55:49,116 - trainer - INFO - {
  "train_accuracy_score": 0.9711538461538461,
  "train_loss": 0.08003329113125801
}
2022-10-17 14:55:49,438 - trainer - INFO - 
*****************[epoch: 32, global step: 376] eval development set based on eval_every=2***************
2022-10-17 14:55:49,442 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      1.00      0.97        32
         3.0       0.94      0.88      0.91        34
         4.0       1.00      1.00      1.00        36
         5.0       0.90      0.95      0.93        40
         6.0       1.00      0.92      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.90      0.95        41
         9.0       0.78      1.00      0.87        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:49,443 - trainer - INFO - {
  "dev_loss": 0.1827596134195725,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:49,443 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:55:49,444 - trainer - INFO -   patience: 200
2022-10-17 14:55:49,445 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:49,445 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:49,445 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_370
2022-10-17 14:55:49,446 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_376
2022-10-17 14:55:49,451 - trainer - INFO - save model to path: tmp/mlp_digits\ck_376
2022-10-17 14:55:49,530 - trainer - INFO - 
*****************[epoch: 32, global step: 378] eval training set based on eval_every=2***************
2022-10-17 14:55:49,534 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        90
           1       0.99      0.89      0.94        82
           2       0.96      1.00      0.98        81
           3       0.97      0.98      0.97        87
           4       0.99      0.97      0.98        73
           5       0.99      1.00      0.99        72
           6       0.95      1.00      0.97        73
           7       1.00      0.98      0.99        92
           8       0.97      1.00      0.98        65
           9       0.88      0.94      0.91        65

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:49,535 - trainer - INFO - {
  "train_accuracy_score": 0.9705128205128205,
  "train_loss": 0.11644376814365387
}
2022-10-17 14:55:49,806 - trainer - INFO - 
*****************[epoch: 32, global step: 378] eval development set based on eval_every=2***************
2022-10-17 14:55:49,810 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.98      0.96        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.85      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.89      0.94        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.83      0.91        41
         9.0       0.72      1.00      0.84        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:55:49,811 - trainer - INFO - {
  "dev_loss": 0.28969881931940716,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:49,812 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:55:49,812 - trainer - INFO -   patience: 200
2022-10-17 14:55:49,814 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:49,814 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:49,814 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_372
2022-10-17 14:55:49,815 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_378
2022-10-17 14:55:49,820 - trainer - INFO - save model to path: tmp/mlp_digits\ck_378
2022-10-17 14:55:49,889 - trainer - INFO - 
*****************[epoch: 32, global step: 380] eval training set based on eval_every=2***************
2022-10-17 14:55:49,893 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98       110
           1       0.96      0.91      0.93       102
           2       0.97      0.99      0.98       106
           3       0.97      0.96      0.97       116
           4       0.99      0.96      0.97        94
           5       0.99      0.99      0.99       102
           6       0.96      1.00      0.98       100
           7       1.00      0.97      0.99       113
           8       0.98      0.99      0.98        99
           9       0.87      0.96      0.91        98

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:49,894 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.1515330672264099
}
2022-10-17 14:55:50,169 - trainer - INFO - 
*****************[epoch: 32, global step: 380] eval development set based on eval_every=2***************
2022-10-17 14:55:50,174 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.88      1.00      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.88      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.93      0.93        40
         6.0       1.00      0.89      0.94        38
         7.0       0.97      1.00      0.99        33
         8.0       0.97      0.83      0.89        41
         9.0       0.80      0.90      0.85        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:55:50,175 - trainer - INFO - {
  "dev_loss": 0.3170439228415489,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:50,176 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:55:50,176 - trainer - INFO -   patience: 200
2022-10-17 14:55:50,177 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:50,177 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:50,177 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_374
2022-10-17 14:55:50,178 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_380
2022-10-17 14:55:50,182 - trainer - INFO - save model to path: tmp/mlp_digits\ck_380
2022-10-17 14:55:50,244 - trainer - INFO - 
*****************[epoch: 32, global step: 382] eval training set based on eval_every=2***************
2022-10-17 14:55:50,249 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98       132
           1       0.91      0.93      0.92       131
           2       0.98      0.99      0.98       128
           3       0.98      0.95      0.96       136
           4       0.99      0.97      0.98       125
           5       0.98      0.98      0.98       125
           6       0.97      0.98      0.98       125
           7       1.00      0.98      0.99       137
           8       0.98      0.97      0.98       125
           9       0.89      0.94      0.91       136

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:50,251 - trainer - INFO - {
  "train_accuracy_score": 0.9661538461538461,
  "train_loss": 0.12591279111802578
}
2022-10-17 14:55:50,557 - trainer - INFO - 
*****************[epoch: 32, global step: 382] eval development set based on eval_every=2***************
2022-10-17 14:55:50,561 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      0.97      0.98        32
         3.0       0.91      0.94      0.93        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.90      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.92      1.00      0.96        33
         8.0       0.97      0.95      0.96        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:55:50,562 - trainer - INFO - {
  "dev_loss": 0.22954168062036237,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:50,562 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:55:50,563 - trainer - INFO -   patience: 200
2022-10-17 14:55:50,564 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:50,564 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:50,564 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_376
2022-10-17 14:55:50,566 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_382
2022-10-17 14:55:50,570 - trainer - INFO - save model to path: tmp/mlp_digits\ck_382
2022-10-17 14:55:50,659 - trainer - INFO - 
*****************[epoch: 32, global step: 384] eval training set based on eval_every=2***************
2022-10-17 14:55:50,663 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99       145
           1       0.90      0.94      0.92       140
           2       0.98      0.99      0.99       145
           3       0.98      0.95      0.97       149
           4       0.99      0.97      0.98       145
           5       0.98      0.99      0.98       142
           6       0.97      0.98      0.98       143
           7       1.00      0.98      0.99       146
           8       0.98      0.96      0.97       133
           9       0.90      0.95      0.92       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:50,664 - trainer - INFO - {
  "train_accuracy_score": 0.9679888656924147,
  "train_loss": 0.023237812391016632
}
2022-10-17 14:55:50,941 - trainer - INFO - 
*****************[epoch: 32, global step: 384] eval development set based on eval_every=2***************
2022-10-17 14:55:50,945 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.90      0.94        42
         2.0       1.00      0.91      0.95        32
         3.0       0.89      0.97      0.93        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.82      0.90        40
         6.0       0.95      0.97      0.96        38
         7.0       0.89      1.00      0.94        33
         8.0       0.89      0.95      0.92        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:50,946 - trainer - INFO - {
  "dev_loss": 0.3026454464221994,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:50,947 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:55:50,947 - trainer - INFO -   patience: 200
2022-10-17 14:55:50,948 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:50,948 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:50,949 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_378
2022-10-17 14:55:50,950 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_384
2022-10-17 14:55:50,954 - trainer - INFO - save model to path: tmp/mlp_digits\ck_384
2022-10-17 14:55:50,956 - trainer - INFO - 
*****************[epoch: 32, global step: 385] eval training set at end of epoch***************
2022-10-17 14:55:50,960 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99       145
           1       0.90      0.94      0.92       140
           2       0.98      0.99      0.99       145
           3       0.98      0.95      0.97       149
           4       0.99      0.97      0.98       145
           5       0.98      0.99      0.98       142
           6       0.97      0.98      0.98       143
           7       1.00      0.98      0.99       146
           8       0.98      0.96      0.97       133
           9       0.90      0.95      0.92       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:50,962 - trainer - INFO - {
  "train_accuracy_score": 0.9679888656924147,
  "train_loss": 0.10191697985283099
}
2022-10-17 14:55:50,963 - trainer - INFO - start training epoch 33
2022-10-17 14:55:50,963 - trainer - INFO - training using device=cuda
2022-10-17 14:55:50,963 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:50,963 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:51,027 - trainer - INFO - 
*****************[epoch: 33, global step: 386] eval training set based on eval_every=2***************
2022-10-17 14:55:51,030 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        25
           1       1.00      0.96      0.98        24
           2       1.00      0.95      0.98        22
           3       0.97      1.00      0.99        38
           4       1.00      0.97      0.98        30
           5       1.00      0.95      0.98        22
           6       1.00      1.00      1.00        24
           7       0.95      1.00      0.98        21
           8       0.96      1.00      0.98        24
           9       0.97      0.97      0.97        30

    accuracy                           0.98       260
   macro avg       0.98      0.98      0.98       260
weighted avg       0.98      0.98      0.98       260

2022-10-17 14:55:51,031 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.08379739709198475
}
2022-10-17 14:55:51,311 - trainer - INFO - 
*****************[epoch: 33, global step: 386] eval development set based on eval_every=2***************
2022-10-17 14:55:51,315 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.74      0.84        42
         2.0       1.00      0.94      0.97        32
         3.0       0.91      0.88      0.90        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.82      0.90        40
         6.0       0.95      0.97      0.96        38
         7.0       0.82      1.00      0.90        33
         8.0       0.75      0.98      0.85        41
         9.0       1.00      0.90      0.95        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:55:51,316 - trainer - INFO - {
  "dev_loss": 0.39794981231292087,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:51,317 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:55:51,317 - trainer - INFO -   patience: 200
2022-10-17 14:55:51,318 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:51,319 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:51,319 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_380
2022-10-17 14:55:51,320 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_386
2022-10-17 14:55:51,325 - trainer - INFO - save model to path: tmp/mlp_digits\ck_386
2022-10-17 14:55:51,388 - trainer - INFO - 
*****************[epoch: 33, global step: 388] eval training set based on eval_every=2***************
2022-10-17 14:55:51,391 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      0.98      0.97        43
           1       1.00      0.80      0.89        51
           2       1.00      0.96      0.98        55
           3       0.98      0.98      0.98        57
           4       0.98      0.97      0.97        58
           5       1.00      0.87      0.93        47
           6       0.98      0.98      0.98        62
           7       0.88      1.00      0.94        44
           8       0.79      1.00      0.88        49
           9       0.92      0.91      0.92        54

    accuracy                           0.95       520
   macro avg       0.95      0.95      0.94       520
weighted avg       0.95      0.95      0.95       520

2022-10-17 14:55:51,393 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.33180683106184006
}
2022-10-17 14:55:51,681 - trainer - INFO - 
*****************[epoch: 33, global step: 388] eval development set based on eval_every=2***************
2022-10-17 14:55:51,685 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      0.94      0.97        32
         3.0       0.94      0.94      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.88      0.93        40
         6.0       0.95      0.97      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.85      0.98      0.91        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:51,686 - trainer - INFO - {
  "dev_loss": 0.20871843149264654,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:51,687 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:55:51,690 - trainer - INFO -   patience: 200
2022-10-17 14:55:51,691 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:51,692 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:51,692 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_382
2022-10-17 14:55:51,693 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_388
2022-10-17 14:55:51,697 - trainer - INFO - save model to path: tmp/mlp_digits\ck_388
2022-10-17 14:55:51,818 - trainer - INFO - 
*****************[epoch: 33, global step: 390] eval training set based on eval_every=2***************
2022-10-17 14:55:51,822 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98        75
           1       0.97      0.85      0.91        68
           2       1.00      0.96      0.98        80
           3       0.95      0.99      0.97        81
           4       0.99      0.98      0.98        84
           5       1.00      0.88      0.94        69
           6       0.99      0.99      0.99        86
           7       0.93      0.99      0.95        75
           8       0.82      1.00      0.90        72
           9       0.94      0.89      0.91        90

    accuracy                           0.95       780
   macro avg       0.96      0.95      0.95       780
weighted avg       0.96      0.95      0.95       780

2022-10-17 14:55:51,823 - trainer - INFO - {
  "train_accuracy_score": 0.9525641025641025,
  "train_loss": 0.1062031164765358
}
2022-10-17 14:55:52,100 - trainer - INFO - 
*****************[epoch: 33, global step: 390] eval development set based on eval_every=2***************
2022-10-17 14:55:52,103 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      1.00      0.98        42
         2.0       0.97      0.97      0.97        32
         3.0       0.92      0.97      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.93      0.96        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.97      0.85      0.91        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.96       360
   macro avg       0.96      0.97      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:52,104 - trainer - INFO - {
  "dev_loss": 0.1474888127607604,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:52,105 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:55:52,106 - trainer - INFO -   patience: 200
2022-10-17 14:55:52,107 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:52,107 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:52,107 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_384
2022-10-17 14:55:52,109 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_390
2022-10-17 14:55:52,113 - trainer - INFO - save model to path: tmp/mlp_digits\ck_390
2022-10-17 14:55:52,181 - trainer - INFO - 
*****************[epoch: 33, global step: 392] eval training set based on eval_every=2***************
2022-10-17 14:55:52,186 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98        97
           1       0.95      0.89      0.92        92
           2       1.00      0.97      0.99       108
           3       0.96      0.99      0.97       115
           4       0.98      0.96      0.97       106
           5       1.00      0.91      0.95        91
           6       0.99      0.98      0.99       108
           7       0.94      0.98      0.96        98
           8       0.86      1.00      0.92       103
           9       0.96      0.90      0.93       122

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:55:52,188 - trainer - INFO - {
  "train_accuracy_score": 0.9586538461538462,
  "train_loss": 0.099555354565382
}
2022-10-17 14:55:52,465 - trainer - INFO - 
*****************[epoch: 33, global step: 392] eval development set based on eval_every=2***************
2022-10-17 14:55:52,468 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.93      1.00      0.97        42
         2.0       0.97      1.00      0.98        32
         3.0       0.94      0.94      0.94        34
         4.0       0.95      0.97      0.96        36
         5.0       0.76      0.97      0.86        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.73      0.84        33
         8.0       1.00      0.78      0.88        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:52,469 - trainer - INFO - {
  "dev_loss": 0.2463406647245089,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:52,470 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:55:52,470 - trainer - INFO -   patience: 200
2022-10-17 14:55:52,471 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:52,472 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:52,472 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_386
2022-10-17 14:55:52,473 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_392
2022-10-17 14:55:52,477 - trainer - INFO - save model to path: tmp/mlp_digits\ck_392
2022-10-17 14:55:52,551 - trainer - INFO - 
*****************[epoch: 33, global step: 394] eval training set based on eval_every=2***************
2022-10-17 14:55:52,556 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       130
           1       0.95      0.91      0.93       122
           2       1.00      0.97      0.98       134
           3       0.96      0.99      0.97       138
           4       0.98      0.96      0.97       132
           5       0.94      0.93      0.94       122
           6       0.98      0.98      0.98       132
           7       0.95      0.94      0.95       129
           8       0.87      0.98      0.93       120
           9       0.95      0.91      0.93       141

    accuracy                           0.96      1300
   macro avg       0.96      0.96      0.96      1300
weighted avg       0.96      0.96      0.96      1300

2022-10-17 14:55:52,557 - trainer - INFO - {
  "train_accuracy_score": 0.9569230769230769,
  "train_loss": 0.2415349744260311
}
2022-10-17 14:55:52,877 - trainer - INFO - 
*****************[epoch: 33, global step: 394] eval development set based on eval_every=2***************
2022-10-17 14:55:52,880 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.98      0.95        42
         2.0       0.94      1.00      0.97        32
         3.0       0.97      0.94      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.90      0.95        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      0.91      0.95        33
         8.0       1.00      0.80      0.89        41
         9.0       0.78      1.00      0.87        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:52,881 - trainer - INFO - {
  "dev_loss": 0.21461613848805428,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:52,882 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:55:52,882 - trainer - INFO -   patience: 200
2022-10-17 14:55:52,883 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:52,884 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:52,884 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_388
2022-10-17 14:55:52,885 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_394
2022-10-17 14:55:52,890 - trainer - INFO - save model to path: tmp/mlp_digits\ck_394
2022-10-17 14:55:52,933 - trainer - INFO - 
*****************[epoch: 33, global step: 396] eval training set based on eval_every=2***************
2022-10-17 14:55:52,937 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.95      0.92      0.93       140
           2       0.99      0.97      0.98       145
           3       0.97      0.98      0.97       149
           4       0.99      0.97      0.98       145
           5       0.95      0.94      0.95       142
           6       0.98      0.99      0.98       143
           7       0.96      0.94      0.95       146
           8       0.88      0.97      0.92       133
           9       0.94      0.91      0.93       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:55:52,939 - trainer - INFO - {
  "train_accuracy_score": 0.9582463465553236,
  "train_loss": 0.04869224992580712
}
2022-10-17 14:55:53,228 - trainer - INFO - 
*****************[epoch: 33, global step: 396] eval development set based on eval_every=2***************
2022-10-17 14:55:53,231 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.93      0.94        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       1.00      0.68      0.81        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.94      0.93        33
         8.0       1.00      0.80      0.89        41
         9.0       0.65      1.00      0.78        31

    accuracy                           0.92       360
   macro avg       0.93      0.93      0.92       360
weighted avg       0.94      0.92      0.92       360

2022-10-17 14:55:53,232 - trainer - INFO - {
  "dev_loss": 0.28389351939161617,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:53,233 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:55:53,233 - trainer - INFO -   patience: 200
2022-10-17 14:55:53,235 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:53,235 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:53,235 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_390
2022-10-17 14:55:53,236 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_396
2022-10-17 14:55:53,241 - trainer - INFO - save model to path: tmp/mlp_digits\ck_396
2022-10-17 14:55:53,242 - trainer - INFO - 
*****************[epoch: 33, global step: 397] eval training set at end of epoch***************
2022-10-17 14:55:53,247 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.95      0.92      0.93       140
           2       0.99      0.97      0.98       145
           3       0.97      0.98      0.97       149
           4       0.99      0.97      0.98       145
           5       0.95      0.94      0.95       142
           6       0.98      0.99      0.98       143
           7       0.96      0.94      0.95       146
           8       0.88      0.97      0.92       133
           9       0.94      0.91      0.93       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:55:53,250 - trainer - INFO - {
  "train_accuracy_score": 0.9582463465553236,
  "train_loss": 0.15193165392459682
}
2022-10-17 14:55:53,251 - trainer - INFO - start training epoch 34
2022-10-17 14:55:53,254 - trainer - INFO - training using device=cuda
2022-10-17 14:55:53,254 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:53,255 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:53,323 - trainer - INFO - 
*****************[epoch: 34, global step: 398] eval training set based on eval_every=2***************
2022-10-17 14:55:53,326 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        19
           1       0.95      0.90      0.93        21
           2       1.00      1.00      1.00        28
           3       0.87      1.00      0.93        27
           4       1.00      1.00      1.00        29
           5       1.00      0.76      0.86        29
           6       1.00      1.00      1.00        22
           7       1.00      1.00      1.00        30
           8       1.00      0.96      0.98        28
           9       0.84      1.00      0.92        27

    accuracy                           0.96       260
   macro avg       0.97      0.96      0.96       260
weighted avg       0.97      0.96      0.96       260

2022-10-17 14:55:53,328 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.11793939024209976
}
2022-10-17 14:55:53,612 - trainer - INFO - 
*****************[epoch: 34, global step: 398] eval development set based on eval_every=2***************
2022-10-17 14:55:53,616 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.93      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.94      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       1.00      0.65      0.79        40
         6.0       0.95      0.97      0.96        38
         7.0       0.85      1.00      0.92        33
         8.0       1.00      0.88      0.94        41
         9.0       0.72      1.00      0.84        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:55:53,617 - trainer - INFO - {
  "dev_loss": 0.2869442030787468,
  "dev_accuracy": 0.9305555555555556,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:53,618 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:55:53,618 - trainer - INFO -   patience: 200
2022-10-17 14:55:53,619 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:53,620 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:53,620 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_392
2022-10-17 14:55:53,621 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_398
2022-10-17 14:55:53,628 - trainer - INFO - save model to path: tmp/mlp_digits\ck_398
2022-10-17 14:55:53,703 - trainer - INFO - 
*****************[epoch: 34, global step: 400] eval training set based on eval_every=2***************
2022-10-17 14:55:53,706 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        32
           1       0.92      0.94      0.93        51
           2       0.96      1.00      0.98        49
           3       0.93      1.00      0.96        51
           4       1.00      1.00      1.00        52
           5       1.00      0.82      0.90        61
           6       1.00      0.96      0.98        52
           7       0.95      1.00      0.98        60
           8       0.98      0.96      0.97        55
           9       0.92      0.98      0.95        57

    accuracy                           0.96       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.96      0.96       520

2022-10-17 14:55:53,707 - trainer - INFO - {
  "train_accuracy_score": 0.9634615384615385,
  "train_loss": 0.14160320907831192
}
2022-10-17 14:55:54,021 - trainer - INFO - 
*****************[epoch: 34, global step: 400] eval development set based on eval_every=2***************
2022-10-17 14:55:54,025 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.95      0.96        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.94      0.80      0.86        40
         6.0       0.97      0.97      0.97        38
         7.0       0.89      1.00      0.94        33
         8.0       0.97      0.90      0.94        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:55:54,026 - trainer - INFO - {
  "dev_loss": 0.1603566575795412,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:54,027 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:55:54,030 - trainer - INFO -   patience: 200
2022-10-17 14:55:54,031 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:54,031 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:54,031 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_394
2022-10-17 14:55:54,032 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_400
2022-10-17 14:55:54,037 - trainer - INFO - save model to path: tmp/mlp_digits\ck_400
2022-10-17 14:55:54,110 - trainer - INFO - 
*****************[epoch: 34, global step: 402] eval training set based on eval_every=2***************
2022-10-17 14:55:54,113 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        66
           1       0.95      0.95      0.95        73
           2       0.97      1.00      0.99        77
           3       0.95      1.00      0.98        84
           4       1.00      1.00      1.00        76
           5       1.00      0.85      0.92        75
           6       1.00      0.97      0.99        79
           7       0.97      1.00      0.98        83
           8       0.96      0.98      0.97        83
           9       0.94      0.98      0.96        84

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:54,114 - trainer - INFO - {
  "train_accuracy_score": 0.9730769230769231,
  "train_loss": 0.03075678739696741
}
2022-10-17 14:55:54,379 - trainer - INFO - 
*****************[epoch: 34, global step: 402] eval development set based on eval_every=2***************
2022-10-17 14:55:54,382 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       0.91      0.98      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:55:54,383 - trainer - INFO - {
  "dev_loss": 0.13118505415817103,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:54,384 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:55:54,384 - trainer - INFO -   patience: 200
2022-10-17 14:55:54,385 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:54,386 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:54,386 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_396
2022-10-17 14:55:54,388 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_402
2022-10-17 14:55:54,392 - trainer - INFO - save model to path: tmp/mlp_digits\ck_402
2022-10-17 14:55:54,458 - trainer - INFO - 
*****************[epoch: 34, global step: 404] eval training set based on eval_every=2***************
2022-10-17 14:55:54,462 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        99
           1       0.95      0.93      0.94       104
           2       0.97      1.00      0.99       110
           3       0.96      0.98      0.97       111
           4       0.99      0.98      0.98        97
           5       0.97      0.87      0.91        99
           6       1.00      0.98      0.99       104
           7       0.97      1.00      0.99       109
           8       0.94      0.98      0.96        95
           9       0.93      0.96      0.95       112

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:54,463 - trainer - INFO - {
  "train_accuracy_score": 0.9682692307692308,
  "train_loss": 0.2410539835691452
}
2022-10-17 14:55:54,736 - trainer - INFO - 
*****************[epoch: 34, global step: 404] eval development set based on eval_every=2***************
2022-10-17 14:55:54,739 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.95      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.93      0.95      0.94        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:54,740 - trainer - INFO - {
  "dev_loss": 0.13630723456541696,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:54,741 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:55:54,744 - trainer - INFO -   patience: 200
2022-10-17 14:55:54,745 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:54,745 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:54,745 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_398
2022-10-17 14:55:54,747 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_404
2022-10-17 14:55:54,754 - trainer - INFO - save model to path: tmp/mlp_digits\ck_404
2022-10-17 14:55:54,827 - trainer - INFO - 
*****************[epoch: 34, global step: 406] eval training set based on eval_every=2***************
2022-10-17 14:55:54,830 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       127
           1       0.95      0.95      0.95       129
           2       0.98      1.00      0.99       135
           3       0.97      0.98      0.97       136
           4       0.98      0.98      0.98       126
           5       0.97      0.89      0.93       130
           6       0.99      0.98      0.99       129
           7       0.98      1.00      0.99       134
           8       0.94      0.97      0.96       120
           9       0.93      0.96      0.94       134

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:54,832 - trainer - INFO - {
  "train_accuracy_score": 0.97,
  "train_loss": 0.06503807287663221
}
2022-10-17 14:55:55,167 - trainer - INFO - 
*****************[epoch: 34, global step: 406] eval development set based on eval_every=2***************
2022-10-17 14:55:55,170 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.98      0.96        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.95      0.95        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:55,171 - trainer - INFO - {
  "dev_loss": 0.1264618138472239,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9666666666666667
}
2022-10-17 14:55:55,172 - trainer - INFO -   no_improve_count: 24
2022-10-17 14:55:55,173 - trainer - INFO -   patience: 200
2022-10-17 14:55:55,175 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:55,177 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:55,178 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_400
2022-10-17 14:55:55,179 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_406
2022-10-17 14:55:55,183 - trainer - INFO - save model to path: tmp/mlp_digits\ck_406
2022-10-17 14:55:55,223 - trainer - INFO - 
*****************[epoch: 34, global step: 408] eval training set based on eval_every=2***************
2022-10-17 14:55:55,227 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.98      0.99       145
           1       0.95      0.95      0.95       140
           2       0.98      1.00      0.99       145
           3       0.97      0.98      0.98       149
           4       0.98      0.97      0.98       145
           5       0.98      0.89      0.93       142
           6       0.99      0.98      0.99       143
           7       0.98      1.00      0.99       146
           8       0.94      0.98      0.96       133
           9       0.93      0.96      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:55,228 - trainer - INFO - {
  "train_accuracy_score": 0.9693806541405706,
  "train_loss": 0.12176446989178658
}
2022-10-17 14:55:55,529 - trainer - INFO - 
*****************[epoch: 34, global step: 408] eval development set based on eval_every=2***************
2022-10-17 14:55:55,533 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.98      0.96        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:55:55,535 - trainer - INFO - {
  "dev_loss": 0.10919098773350318,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:55,536 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:55,537 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:55,537 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:55,538 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_402
2022-10-17 14:55:55,539 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:55,543 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:55,543 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:55,544 - trainer - INFO -   patience: 200
2022-10-17 14:55:55,545 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:55,545 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_408
2022-10-17 14:55:55,549 - trainer - INFO - save model to path: tmp/mlp_digits\ck_408
2022-10-17 14:55:55,551 - trainer - INFO - 
*****************[epoch: 34, global step: 409] eval training set at end of epoch***************
2022-10-17 14:55:55,556 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.98      0.99       145
           1       0.95      0.95      0.95       140
           2       0.98      1.00      0.99       145
           3       0.97      0.98      0.98       149
           4       0.98      0.97      0.98       145
           5       0.98      0.89      0.93       142
           6       0.99      0.98      0.99       143
           7       0.98      1.00      0.99       146
           8       0.94      0.98      0.96       133
           9       0.93      0.96      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:55,558 - trainer - INFO - {
  "train_accuracy_score": 0.9693806541405706,
  "train_loss": 0.11969265217582385
}
2022-10-17 14:55:55,559 - trainer - INFO - start training epoch 35
2022-10-17 14:55:55,560 - trainer - INFO - training using device=cuda
2022-10-17 14:55:55,560 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:55,560 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:55,627 - trainer - INFO - 
*****************[epoch: 35, global step: 410] eval training set based on eval_every=2***************
2022-10-17 14:55:55,630 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        31
           1       1.00      0.96      0.98        23
           2       1.00      1.00      1.00        27
           3       1.00      1.00      1.00        29
           4       0.93      1.00      0.96        25
           5       1.00      0.89      0.94        27
           6       1.00      1.00      1.00        26
           7       0.96      1.00      0.98        25
           8       0.96      1.00      0.98        22
           9       0.96      1.00      0.98        25

    accuracy                           0.98       260
   macro avg       0.98      0.98      0.98       260
weighted avg       0.98      0.98      0.98       260

2022-10-17 14:55:55,631 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.0757627822458744
}
2022-10-17 14:55:55,899 - trainer - INFO - 
*****************[epoch: 35, global step: 410] eval development set based on eval_every=2***************
2022-10-17 14:55:55,902 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       1.00      0.92      0.96        36
         5.0       0.84      0.95      0.89        40
         6.0       0.93      0.97      0.95        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.90      0.94        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:55,903 - trainer - INFO - {
  "dev_loss": 0.15571386056641737,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:55,904 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:55,904 - trainer - INFO -   patience: 200
2022-10-17 14:55:55,905 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:55,906 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:55,906 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_404
2022-10-17 14:55:55,907 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_410
2022-10-17 14:55:55,911 - trainer - INFO - save model to path: tmp/mlp_digits\ck_410
2022-10-17 14:55:55,971 - trainer - INFO - 
*****************[epoch: 35, global step: 412] eval training set based on eval_every=2***************
2022-10-17 14:55:55,974 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        54
           1       0.97      0.98      0.97        57
           2       1.00      1.00      1.00        53
           3       0.98      0.96      0.97        55
           4       0.94      0.92      0.93        51
           5       0.88      0.92      0.90        49
           6       0.96      1.00      0.98        48
           7       0.98      1.00      0.99        55
           8       0.90      0.93      0.91        46
           9       0.98      0.90      0.94        52

    accuracy                           0.96       520
   macro avg       0.96      0.96      0.96       520
weighted avg       0.96      0.96      0.96       520

2022-10-17 14:55:55,975 - trainer - INFO - {
  "train_accuracy_score": 0.9596153846153846,
  "train_loss": 0.22518102079629898
}
2022-10-17 14:55:56,289 - trainer - INFO - 
*****************[epoch: 35, global step: 412] eval development set based on eval_every=2***************
2022-10-17 14:55:56,293 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.97      0.98        33
         1.0       0.97      0.93      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.90      0.95      0.93        40
         6.0       0.90      0.97      0.94        38
         7.0       1.00      1.00      1.00        33
         8.0       0.93      0.90      0.91        41
         9.0       0.94      0.94      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:56,294 - trainer - INFO - {
  "dev_loss": 0.14001047238707542,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:56,294 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:56,295 - trainer - INFO -   patience: 200
2022-10-17 14:55:56,296 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:56,296 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:56,296 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_406
2022-10-17 14:55:56,297 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_412
2022-10-17 14:55:56,301 - trainer - INFO - save model to path: tmp/mlp_digits\ck_412
2022-10-17 14:55:56,364 - trainer - INFO - 
*****************[epoch: 35, global step: 414] eval training set based on eval_every=2***************
2022-10-17 14:55:56,367 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.97        78
           1       0.96      0.97      0.97        80
           2       1.00      1.00      1.00        77
           3       0.95      0.96      0.96        81
           4       0.96      0.94      0.95        85
           5       0.91      0.94      0.93        72
           6       0.94      1.00      0.97        72
           7       0.99      1.00      0.99        80
           8       0.92      0.96      0.94        71
           9       0.99      0.89      0.94        84

    accuracy                           0.96       780
   macro avg       0.96      0.96      0.96       780
weighted avg       0.96      0.96      0.96       780

2022-10-17 14:55:56,368 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.2374493032693863
}
2022-10-17 14:55:56,663 - trainer - INFO - 
*****************[epoch: 35, global step: 414] eval development set based on eval_every=2***************
2022-10-17 14:55:56,667 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.98      0.99        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.94      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.93      0.93        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.86      0.97      0.91        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:56,668 - trainer - INFO - {
  "dev_loss": 0.1138999213774999,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:56,669 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:55:56,669 - trainer - INFO -   patience: 200
2022-10-17 14:55:56,670 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:56,671 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:56,671 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_408
2022-10-17 14:55:56,672 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_414
2022-10-17 14:55:56,677 - trainer - INFO - save model to path: tmp/mlp_digits\ck_414
2022-10-17 14:55:56,740 - trainer - INFO - 
*****************[epoch: 35, global step: 416] eval training set based on eval_every=2***************
2022-10-17 14:55:56,743 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98       112
           1       0.96      0.98      0.97       101
           2       0.99      1.00      1.00       101
           3       0.95      0.95      0.95       105
           4       0.96      0.95      0.96       102
           5       0.92      0.96      0.94       101
           6       0.95      1.00      0.98       101
           7       0.99      1.00      1.00       107
           8       0.94      0.97      0.95        95
           9       0.99      0.90      0.95       115

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:56,744 - trainer - INFO - {
  "train_accuracy_score": 0.9663461538461539,
  "train_loss": 0.06709983572363853
}
2022-10-17 14:55:57,018 - trainer - INFO - 
*****************[epoch: 35, global step: 416] eval development set based on eval_every=2***************
2022-10-17 14:55:57,024 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.97      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.82      0.89        40
         6.0       0.97      0.97      0.97        38
         7.0       0.89      1.00      0.94        33
         8.0       1.00      0.73      0.85        41
         9.0       0.67      1.00      0.81        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.95      0.93      0.93       360

2022-10-17 14:55:57,025 - trainer - INFO - {
  "dev_loss": 0.2138548449923595,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:57,025 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:55:57,026 - trainer - INFO -   patience: 200
2022-10-17 14:55:57,027 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:57,027 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:57,027 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_410
2022-10-17 14:55:57,029 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_416
2022-10-17 14:55:57,033 - trainer - INFO - save model to path: tmp/mlp_digits\ck_416
2022-10-17 14:55:57,096 - trainer - INFO - 
*****************[epoch: 35, global step: 418] eval training set based on eval_every=2***************
2022-10-17 14:55:57,100 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98       132
           1       0.96      0.98      0.97       129
           2       0.99      1.00      1.00       128
           3       0.96      0.96      0.96       137
           4       0.97      0.95      0.96       132
           5       0.94      0.95      0.95       129
           6       0.96      1.00      0.98       125
           7       0.97      1.00      0.99       137
           8       0.95      0.97      0.96       115
           9       0.97      0.91      0.94       136

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:57,102 - trainer - INFO - {
  "train_accuracy_score": 0.9676923076923077,
  "train_loss": 0.09627914056181908
}
2022-10-17 14:55:57,384 - trainer - INFO - 
*****************[epoch: 35, global step: 418] eval development set based on eval_every=2***************
2022-10-17 14:55:57,388 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.90      0.93        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.85      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.75      0.85        40
         6.0       0.95      0.97      0.96        38
         7.0       0.87      1.00      0.93        33
         8.0       1.00      0.73      0.85        41
         9.0       0.58      1.00      0.74        31

    accuracy                           0.91       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.94      0.91      0.91       360

2022-10-17 14:55:57,389 - trainer - INFO - {
  "dev_loss": 0.26872532193859416,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:57,389 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:55:57,390 - trainer - INFO -   patience: 200
2022-10-17 14:55:57,391 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:57,391 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:57,392 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_412
2022-10-17 14:55:57,393 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_418
2022-10-17 14:55:57,397 - trainer - INFO - save model to path: tmp/mlp_digits\ck_418
2022-10-17 14:55:57,493 - trainer - INFO - 
*****************[epoch: 35, global step: 420] eval training set based on eval_every=2***************
2022-10-17 14:55:57,496 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98       145
           1       0.96      0.97      0.97       140
           2       0.99      1.00      1.00       145
           3       0.97      0.97      0.97       149
           4       0.97      0.95      0.96       145
           5       0.94      0.94      0.94       142
           6       0.97      0.99      0.98       143
           7       0.97      1.00      0.98       146
           8       0.95      0.97      0.96       133
           9       0.96      0.92      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:57,498 - trainer - INFO - {
  "train_accuracy_score": 0.9679888656924147,
  "train_loss": 0.05151315964758396
}
2022-10-17 14:55:57,784 - trainer - INFO - 
*****************[epoch: 35, global step: 420] eval development set based on eval_every=2***************
2022-10-17 14:55:57,788 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.93      0.94        42
         2.0       1.00      0.94      0.97        32
         3.0       0.97      0.85      0.91        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.80      0.89        40
         6.0       0.95      1.00      0.97        38
         7.0       0.94      0.97      0.96        33
         8.0       1.00      0.76      0.86        41
         9.0       0.58      1.00      0.74        31

    accuracy                           0.92       360
   macro avg       0.94      0.92      0.92       360
weighted avg       0.94      0.92      0.92       360

2022-10-17 14:55:57,789 - trainer - INFO - {
  "dev_loss": 0.2856392338871956,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:57,789 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:55:57,790 - trainer - INFO -   patience: 200
2022-10-17 14:55:57,791 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:57,791 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:57,792 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_414
2022-10-17 14:55:57,794 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_420
2022-10-17 14:55:57,802 - trainer - INFO - save model to path: tmp/mlp_digits\ck_420
2022-10-17 14:55:57,803 - trainer - INFO - 
*****************[epoch: 35, global step: 421] eval training set at end of epoch***************
2022-10-17 14:55:57,809 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98       145
           1       0.96      0.97      0.97       140
           2       0.99      1.00      1.00       145
           3       0.97      0.97      0.97       149
           4       0.97      0.95      0.96       145
           5       0.94      0.94      0.94       142
           6       0.97      0.99      0.98       143
           7       0.97      1.00      0.98       146
           8       0.95      0.97      0.96       133
           9       0.96      0.92      0.94       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:57,811 - trainer - INFO - {
  "train_accuracy_score": 0.9679888656924147,
  "train_loss": 0.1255475403741002
}
2022-10-17 14:55:57,812 - trainer - INFO - start training epoch 36
2022-10-17 14:55:57,813 - trainer - INFO - training using device=cuda
2022-10-17 14:55:57,813 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:55:57,813 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:55:57,880 - trainer - INFO - 
*****************[epoch: 36, global step: 422] eval training set based on eval_every=2***************
2022-10-17 14:55:57,883 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       1.00      1.00      1.00        27
           2       1.00      0.96      0.98        23
           3       1.00      0.96      0.98        28
           4       1.00      1.00      1.00        25
           5       1.00      0.88      0.94        33
           6       1.00      1.00      1.00        23
           7       1.00      0.97      0.98        30
           8       0.92      0.92      0.92        24
           9       0.77      1.00      0.87        24

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:55:57,884 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.09813730791211128
}
2022-10-17 14:55:58,171 - trainer - INFO - 
*****************[epoch: 36, global step: 422] eval development set based on eval_every=2***************
2022-10-17 14:55:58,174 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      0.94      0.97        32
         3.0       0.94      0.94      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.85      0.92        40
         6.0       0.95      1.00      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.79      1.00      0.89        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:55:58,175 - trainer - INFO - {
  "dev_loss": 0.2004306772723794,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:58,176 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:55:58,176 - trainer - INFO -   patience: 200
2022-10-17 14:55:58,177 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:58,178 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:58,178 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_416
2022-10-17 14:55:58,180 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_422
2022-10-17 14:55:58,186 - trainer - INFO - save model to path: tmp/mlp_digits\ck_422
2022-10-17 14:55:58,254 - trainer - INFO - 
*****************[epoch: 36, global step: 424] eval training set based on eval_every=2***************
2022-10-17 14:55:58,257 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        52
           1       0.98      1.00      0.99        51
           2       1.00      0.98      0.99        52
           3       1.00      0.97      0.98        64
           4       0.98      0.98      0.98        48
           5       1.00      0.91      0.95        56
           6       0.98      0.98      0.98        56
           7       1.00      0.98      0.99        52
           8       0.93      0.93      0.93        41
           9       0.83      1.00      0.91        48

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:55:58,259 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.08931955136358738
}
2022-10-17 14:55:58,585 - trainer - INFO - 
*****************[epoch: 36, global step: 424] eval development set based on eval_every=2***************
2022-10-17 14:55:58,588 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.88      0.92        40
         6.0       0.95      0.97      0.96        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.86      1.00      0.93        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:55:58,589 - trainer - INFO - {
  "dev_loss": 0.12395581960057218,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9694444444444444
}
2022-10-17 14:55:58,590 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:55:58,590 - trainer - INFO -   patience: 200
2022-10-17 14:55:58,591 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:58,592 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:58,592 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_418
2022-10-17 14:55:58,593 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_424
2022-10-17 14:55:58,598 - trainer - INFO - save model to path: tmp/mlp_digits\ck_424
2022-10-17 14:55:58,718 - trainer - INFO - 
*****************[epoch: 36, global step: 426] eval training set based on eval_every=2***************
2022-10-17 14:55:58,721 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99        70
           1       0.95      1.00      0.97        72
           2       1.00      0.99      0.99        83
           3       1.00      0.98      0.99        84
           4       0.99      0.96      0.97        79
           5       1.00      0.93      0.96        84
           6       0.99      0.99      0.99        84
           7       1.00      0.99      0.99        79
           8       0.94      0.94      0.94        67
           9       0.88      0.99      0.93        78

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:55:58,723 - trainer - INFO - {
  "train_accuracy_score": 0.9730769230769231,
  "train_loss": 0.09083681553602219
}
2022-10-17 14:55:59,011 - trainer - INFO - 
*****************[epoch: 36, global step: 426] eval development set based on eval_every=2***************
2022-10-17 14:55:59,014 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:55:59,016 - trainer - INFO - {
  "dev_loss": 0.09183494156847398,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:55:59,016 - trainer - INFO -    save the model with best score so far
2022-10-17 14:55:59,018 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:59,018 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:59,019 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_420
2022-10-17 14:55:59,024 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:55:59,028 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:55:59,028 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:55:59,028 - trainer - INFO -   patience: 200
2022-10-17 14:55:59,029 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:55:59,029 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_426
2022-10-17 14:55:59,033 - trainer - INFO - save model to path: tmp/mlp_digits\ck_426
2022-10-17 14:55:59,119 - trainer - INFO - 
*****************[epoch: 36, global step: 428] eval training set based on eval_every=2***************
2022-10-17 14:55:59,124 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.98      0.98        95
           1       0.95      0.99      0.97       103
           2       1.00      0.99      1.00       105
           3       0.98      0.98      0.98       108
           4       0.99      0.97      0.98       105
           5       0.99      0.94      0.96       112
           6       0.99      0.99      0.99       111
           7       0.99      0.99      0.99       106
           8       0.95      0.96      0.95        94
           9       0.89      0.93      0.91       101

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:55:59,126 - trainer - INFO - {
  "train_accuracy_score": 0.9721153846153846,
  "train_loss": 0.10146410390734673
}
2022-10-17 14:55:59,456 - trainer - INFO - 
*****************[epoch: 36, global step: 428] eval development set based on eval_every=2***************
2022-10-17 14:55:59,460 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      0.94      0.96        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.98      0.99        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.97       360
   macro avg       0.97      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:55:59,461 - trainer - INFO - {
  "dev_loss": 0.09412466486295064,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:55:59,462 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:55:59,462 - trainer - INFO -   patience: 200
2022-10-17 14:55:59,463 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:59,463 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:59,463 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_422
2022-10-17 14:55:59,465 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_428
2022-10-17 14:55:59,471 - trainer - INFO - save model to path: tmp/mlp_digits\ck_428
2022-10-17 14:55:59,565 - trainer - INFO - 
*****************[epoch: 36, global step: 430] eval training set based on eval_every=2***************
2022-10-17 14:55:59,568 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      0.98      0.98       127
           1       0.96      0.99      0.98       131
           2       1.00      0.99      1.00       133
           3       0.98      0.99      0.98       134
           4       0.99      0.95      0.97       133
           5       0.99      0.94      0.97       123
           6       0.99      0.99      0.99       136
           7       0.99      0.99      0.99       130
           8       0.92      0.97      0.94       116
           9       0.91      0.91      0.91       137

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:55:59,570 - trainer - INFO - {
  "train_accuracy_score": 0.9715384615384616,
  "train_loss": 0.10020513832569122
}
2022-10-17 14:55:59,908 - trainer - INFO - 
*****************[epoch: 36, global step: 430] eval development set based on eval_every=2***************
2022-10-17 14:55:59,911 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:55:59,913 - trainer - INFO - {
  "dev_loss": 0.10514281348635753,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:55:59,914 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:55:59,915 - trainer - INFO -   patience: 200
2022-10-17 14:55:59,916 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:55:59,916 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:55:59,916 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_424
2022-10-17 14:55:59,918 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_430
2022-10-17 14:55:59,923 - trainer - INFO - save model to path: tmp/mlp_digits\ck_430
2022-10-17 14:55:59,974 - trainer - INFO - 
*****************[epoch: 36, global step: 432] eval training set based on eval_every=2***************
2022-10-17 14:55:59,980 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.97      0.99      0.98       140
           2       0.99      0.99      0.99       145
           3       0.98      0.99      0.98       149
           4       0.99      0.95      0.97       145
           5       0.99      0.95      0.97       142
           6       0.99      0.99      0.99       143
           7       0.99      0.99      0.99       146
           8       0.93      0.97      0.95       133
           9       0.92      0.92      0.92       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:55:59,982 - trainer - INFO - {
  "train_accuracy_score": 0.9728601252609603,
  "train_loss": 0.0367401335388422
}
2022-10-17 14:56:00,279 - trainer - INFO - 
*****************[epoch: 36, global step: 432] eval development set based on eval_every=2***************
2022-10-17 14:56:00,282 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:00,283 - trainer - INFO - {
  "dev_loss": 0.12233020551502705,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:00,283 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:56:00,284 - trainer - INFO -   patience: 200
2022-10-17 14:56:00,285 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:00,285 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:00,286 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_426
2022-10-17 14:56:00,288 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_432
2022-10-17 14:56:00,295 - trainer - INFO - save model to path: tmp/mlp_digits\ck_432
2022-10-17 14:56:00,297 - trainer - INFO - 
*****************[epoch: 36, global step: 433] eval training set at end of epoch***************
2022-10-17 14:56:00,311 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.99      0.98       145
           1       0.97      0.99      0.98       140
           2       0.99      0.99      0.99       145
           3       0.98      0.99      0.98       149
           4       0.99      0.95      0.97       145
           5       0.99      0.95      0.97       142
           6       0.99      0.99      0.99       143
           7       0.99      0.99      0.99       146
           8       0.93      0.97      0.95       133
           9       0.92      0.92      0.92       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:56:00,314 - trainer - INFO - {
  "train_accuracy_score": 0.9728601252609603,
  "train_loss": 0.08611717509726684
}
2022-10-17 14:56:00,315 - trainer - INFO - start training epoch 37
2022-10-17 14:56:00,315 - trainer - INFO - training using device=cuda
2022-10-17 14:56:00,316 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:00,316 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:00,392 - trainer - INFO - 
*****************[epoch: 37, global step: 434] eval training set based on eval_every=2***************
2022-10-17 14:56:00,395 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      1.00      0.97        18
           1       1.00      1.00      1.00        28
           2       1.00      1.00      1.00        29
           3       1.00      1.00      1.00        29
           4       1.00      0.93      0.96        27
           5       1.00      1.00      1.00        29
           6       1.00      1.00      1.00        23
           7       1.00      1.00      1.00        31
           8       0.96      1.00      0.98        26
           9       1.00      1.00      1.00        20

    accuracy                           0.99       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.99      0.99       260

2022-10-17 14:56:00,397 - trainer - INFO - {
  "train_accuracy_score": 0.9923076923076923,
  "train_loss": 0.02398216351866722
}
2022-10-17 14:56:00,684 - trainer - INFO - 
*****************[epoch: 37, global step: 434] eval development set based on eval_every=2***************
2022-10-17 14:56:00,687 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:00,688 - trainer - INFO - {
  "dev_loss": 0.14619067901124558,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:00,689 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:56:00,689 - trainer - INFO -   patience: 200
2022-10-17 14:56:00,691 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:00,692 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:00,692 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_428
2022-10-17 14:56:00,696 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_434
2022-10-17 14:56:00,700 - trainer - INFO - save model to path: tmp/mlp_digits\ck_434
2022-10-17 14:56:00,779 - trainer - INFO - 
*****************[epoch: 37, global step: 436] eval training set based on eval_every=2***************
2022-10-17 14:56:00,783 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        49
           1       1.00      1.00      1.00        44
           2       0.98      1.00      0.99        51
           3       1.00      1.00      1.00        62
           4       1.00      0.94      0.97        50
           5       1.00      1.00      1.00        51
           6       1.00      1.00      1.00        45
           7       1.00      1.00      1.00        58
           8       0.97      0.98      0.97        58
           9       1.00      1.00      1.00        52

    accuracy                           0.99       520
   macro avg       0.99      0.99      0.99       520
weighted avg       0.99      0.99      0.99       520

2022-10-17 14:56:00,785 - trainer - INFO - {
  "train_accuracy_score": 0.9923076923076923,
  "train_loss": 0.03503799997270107
}
2022-10-17 14:56:01,110 - trainer - INFO - 
*****************[epoch: 37, global step: 436] eval development set based on eval_every=2***************
2022-10-17 14:56:01,113 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.96       360
   macro avg       0.97      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:56:01,114 - trainer - INFO - {
  "dev_loss": 0.16198533431937298,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:01,115 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:56:01,115 - trainer - INFO -   patience: 200
2022-10-17 14:56:01,116 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:01,116 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:01,117 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_430
2022-10-17 14:56:01,118 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_436
2022-10-17 14:56:01,122 - trainer - INFO - save model to path: tmp/mlp_digits\ck_436
2022-10-17 14:56:01,202 - trainer - INFO - 
*****************[epoch: 37, global step: 438] eval training set based on eval_every=2***************
2022-10-17 14:56:01,206 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        79
           1       1.00      0.99      0.99        72
           2       0.99      1.00      0.99        73
           3       1.00      1.00      1.00        94
           4       1.00      0.96      0.98        77
           5       1.00      1.00      1.00        74
           6       0.99      1.00      0.99        70
           7       1.00      1.00      1.00        81
           8       0.97      0.99      0.98        76
           9       1.00      1.00      1.00        84

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:56:01,208 - trainer - INFO - {
  "train_accuracy_score": 0.9935897435897436,
  "train_loss": 0.028687529265880585
}
2022-10-17 14:56:01,481 - trainer - INFO - 
*****************[epoch: 37, global step: 438] eval development set based on eval_every=2***************
2022-10-17 14:56:01,485 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:01,487 - trainer - INFO - {
  "dev_loss": 0.18304816788683334,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:01,488 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:56:01,489 - trainer - INFO -   patience: 200
2022-10-17 14:56:01,490 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:01,490 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:01,491 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_432
2022-10-17 14:56:01,492 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_438
2022-10-17 14:56:01,497 - trainer - INFO - save model to path: tmp/mlp_digits\ck_438
2022-10-17 14:56:01,578 - trainer - INFO - 
*****************[epoch: 37, global step: 440] eval training set based on eval_every=2***************
2022-10-17 14:56:01,581 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       110
           1       0.99      0.99      0.99        97
           2       0.99      1.00      1.00       106
           3       1.00      0.98      0.99       123
           4       0.99      0.97      0.98       103
           5       1.00      0.98      0.99        95
           6       0.99      1.00      0.99        96
           7       1.00      1.00      1.00       107
           8       0.98      0.97      0.97        94
           9       0.96      1.00      0.98       109

    accuracy                           0.99      1040
   macro avg       0.99      0.99      0.99      1040
weighted avg       0.99      0.99      0.99      1040

2022-10-17 14:56:01,583 - trainer - INFO - {
  "train_accuracy_score": 0.989423076923077,
  "train_loss": 0.09104429371654987
}
2022-10-17 14:56:01,853 - trainer - INFO - 
*****************[epoch: 37, global step: 440] eval development set based on eval_every=2***************
2022-10-17 14:56:01,857 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.86      1.00      0.93        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:01,859 - trainer - INFO - {
  "dev_loss": 0.16185797013652822,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:01,859 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:56:01,860 - trainer - INFO -   patience: 200
2022-10-17 14:56:01,861 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:01,862 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:01,862 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_434
2022-10-17 14:56:01,863 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_440
2022-10-17 14:56:01,868 - trainer - INFO - save model to path: tmp/mlp_digits\ck_440
2022-10-17 14:56:01,935 - trainer - INFO - 
*****************[epoch: 37, global step: 442] eval training set based on eval_every=2***************
2022-10-17 14:56:01,938 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       134
           1       0.98      0.99      0.99       132
           2       0.99      1.00      1.00       130
           3       1.00      0.99      0.99       140
           4       0.99      0.97      0.98       126
           5       1.00      0.98      0.99       128
           6       0.99      1.00      1.00       124
           7       0.99      1.00      1.00       135
           8       0.97      0.97      0.97       115
           9       0.96      0.99      0.97       136

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:56:01,940 - trainer - INFO - {
  "train_accuracy_score": 0.9884615384615385,
  "train_loss": 0.0398232857696712
}
2022-10-17 14:56:02,276 - trainer - INFO - 
*****************[epoch: 37, global step: 442] eval development set based on eval_every=2***************
2022-10-17 14:56:02,279 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.92      1.00      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:02,280 - trainer - INFO - {
  "dev_loss": 0.146543637306119,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:02,281 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:56:02,281 - trainer - INFO -   patience: 200
2022-10-17 14:56:02,282 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:02,282 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:02,283 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_436
2022-10-17 14:56:02,284 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_442
2022-10-17 14:56:02,289 - trainer - INFO - save model to path: tmp/mlp_digits\ck_442
2022-10-17 14:56:02,342 - trainer - INFO - 
*****************[epoch: 37, global step: 444] eval training set based on eval_every=2***************
2022-10-17 14:56:02,346 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.99      0.99      0.99       140
           2       0.99      1.00      1.00       145
           3       1.00      0.99      0.99       149
           4       0.99      0.97      0.98       145
           5       1.00      0.98      0.99       142
           6       0.99      0.99      0.99       143
           7       0.99      1.00      1.00       146
           8       0.97      0.98      0.97       133
           9       0.97      0.99      0.98       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:02,348 - trainer - INFO - {
  "train_accuracy_score": 0.988169798190675,
  "train_loss": 0.0711248405277729
}
2022-10-17 14:56:02,639 - trainer - INFO - 
*****************[epoch: 37, global step: 444] eval development set based on eval_every=2***************
2022-10-17 14:56:02,642 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      0.97      0.98        32
         3.0       0.85      1.00      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       0.97      0.90      0.94        41
         9.0       0.94      0.94      0.94        31

    accuracy                           0.96       360
   macro avg       0.97      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:56:02,644 - trainer - INFO - {
  "dev_loss": 0.17512522156660756,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:02,644 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:56:02,645 - trainer - INFO -   patience: 200
2022-10-17 14:56:02,646 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:02,646 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:02,646 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_438
2022-10-17 14:56:02,647 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_444
2022-10-17 14:56:02,651 - trainer - INFO - save model to path: tmp/mlp_digits\ck_444
2022-10-17 14:56:02,652 - trainer - INFO - 
*****************[epoch: 37, global step: 445] eval training set at end of epoch***************
2022-10-17 14:56:02,656 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.99      0.99      0.99       140
           2       0.99      1.00      1.00       145
           3       1.00      0.99      0.99       149
           4       0.99      0.97      0.98       145
           5       1.00      0.98      0.99       142
           6       0.99      0.99      0.99       143
           7       0.99      1.00      1.00       146
           8       0.97      0.98      0.97       133
           9       0.97      0.99      0.98       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:02,658 - trainer - INFO - {
  "train_accuracy_score": 0.988169798190675,
  "train_loss": 0.04828335212854048
}
2022-10-17 14:56:02,659 - trainer - INFO - start training epoch 38
2022-10-17 14:56:02,659 - trainer - INFO - training using device=cuda
2022-10-17 14:56:02,660 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:02,660 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:02,729 - trainer - INFO - 
*****************[epoch: 38, global step: 446] eval training set based on eval_every=2***************
2022-10-17 14:56:02,732 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        32
           1       0.96      0.96      0.96        23
           2       1.00      1.00      1.00        24
           3       0.88      1.00      0.94        30
           4       1.00      0.93      0.97        30
           5       1.00      1.00      1.00        23
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        32
           8       0.94      1.00      0.97        16
           9       0.90      0.79      0.84        24

    accuracy                           0.97       260
   macro avg       0.97      0.97      0.97       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:56:02,733 - trainer - INFO - {
  "train_accuracy_score": 0.9692307692307692,
  "train_loss": 0.08126375917345285
}
2022-10-17 14:56:03,016 - trainer - INFO - 
*****************[epoch: 38, global step: 446] eval development set based on eval_every=2***************
2022-10-17 14:56:03,022 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.95      0.97        41
         9.0       0.86      1.00      0.93        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:03,023 - trainer - INFO - {
  "dev_loss": 0.12059174959237377,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:03,024 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:56:03,024 - trainer - INFO -   patience: 200
2022-10-17 14:56:03,026 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:03,026 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:03,026 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_440
2022-10-17 14:56:03,028 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_446
2022-10-17 14:56:03,032 - trainer - INFO - save model to path: tmp/mlp_digits\ck_446
2022-10-17 14:56:03,096 - trainer - INFO - 
*****************[epoch: 38, global step: 448] eval training set based on eval_every=2***************
2022-10-17 14:56:03,099 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        61
           1       0.96      0.96      0.96        53
           2       1.00      1.00      1.00        44
           3       0.93      1.00      0.96        53
           4       1.00      0.96      0.98        47
           5       1.00      0.98      0.99        50
           6       1.00      1.00      1.00        57
           7       1.00      1.00      1.00        58
           8       0.98      0.98      0.98        47
           9       0.92      0.90      0.91        50

    accuracy                           0.98       520
   macro avg       0.98      0.98      0.98       520
weighted avg       0.98      0.98      0.98       520

2022-10-17 14:56:03,100 - trainer - INFO - {
  "train_accuracy_score": 0.9788461538461538,
  "train_loss": 0.02354260627180338
}
2022-10-17 14:56:03,457 - trainer - INFO - 
*****************[epoch: 38, global step: 448] eval development set based on eval_every=2***************
2022-10-17 14:56:03,461 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.93      0.96        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.98       360

2022-10-17 14:56:03,462 - trainer - INFO - {
  "dev_loss": 0.12612947293867668,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:03,462 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:56:03,463 - trainer - INFO -   patience: 200
2022-10-17 14:56:03,464 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:03,466 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:03,467 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_442
2022-10-17 14:56:03,471 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_448
2022-10-17 14:56:03,476 - trainer - INFO - save model to path: tmp/mlp_digits\ck_448
2022-10-17 14:56:03,552 - trainer - INFO - 
*****************[epoch: 38, global step: 450] eval training set based on eval_every=2***************
2022-10-17 14:56:03,556 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        87
           1       0.97      0.97      0.97        77
           2       1.00      1.00      1.00        74
           3       0.95      0.99      0.97        76
           4       1.00      0.97      0.98        64
           5       1.00      0.99      0.99        73
           6       1.00      1.00      1.00        86
           7       1.00      0.99      0.99        88
           8       0.97      0.99      0.98        73
           9       0.94      0.94      0.94        82

    accuracy                           0.98       780
   macro avg       0.98      0.98      0.98       780
weighted avg       0.98      0.98      0.98       780

2022-10-17 14:56:03,558 - trainer - INFO - {
  "train_accuracy_score": 0.9833333333333333,
  "train_loss": 0.022260991856455803
}
2022-10-17 14:56:03,857 - trainer - INFO - 
*****************[epoch: 38, global step: 450] eval development set based on eval_every=2***************
2022-10-17 14:56:03,862 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.91      0.95        33
         8.0       1.00      0.93      0.96        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:03,863 - trainer - INFO - {
  "dev_loss": 0.1311977185929815,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:03,864 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:56:03,864 - trainer - INFO -   patience: 200
2022-10-17 14:56:03,866 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:03,866 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:03,866 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_444
2022-10-17 14:56:03,868 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_450
2022-10-17 14:56:03,873 - trainer - INFO - save model to path: tmp/mlp_digits\ck_450
2022-10-17 14:56:03,945 - trainer - INFO - 
*****************[epoch: 38, global step: 452] eval training set based on eval_every=2***************
2022-10-17 14:56:03,949 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       108
           1       0.98      0.98      0.98       101
           2       1.00      1.00      1.00        98
           3       0.97      0.99      0.98       113
           4       0.99      0.97      0.98        97
           5       1.00      0.98      0.99        97
           6       1.00      1.00      1.00       108
           7       1.00      0.98      0.99       113
           8       0.98      0.99      0.98        92
           9       0.94      0.96      0.95       113

    accuracy                           0.98      1040
   macro avg       0.99      0.98      0.98      1040
weighted avg       0.98      0.98      0.98      1040

2022-10-17 14:56:03,950 - trainer - INFO - {
  "train_accuracy_score": 0.9846153846153847,
  "train_loss": 0.028702614828944206
}
2022-10-17 14:56:04,223 - trainer - INFO - 
*****************[epoch: 38, global step: 452] eval development set based on eval_every=2***************
2022-10-17 14:56:04,227 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.90      0.95        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:04,229 - trainer - INFO - {
  "dev_loss": 0.13540572424729666,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:04,229 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:56:04,230 - trainer - INFO -   patience: 200
2022-10-17 14:56:04,231 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:04,232 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:04,232 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_446
2022-10-17 14:56:04,233 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_452
2022-10-17 14:56:04,238 - trainer - INFO - save model to path: tmp/mlp_digits\ck_452
2022-10-17 14:56:04,335 - trainer - INFO - 
*****************[epoch: 38, global step: 454] eval training set based on eval_every=2***************
2022-10-17 14:56:04,340 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       130
           1       0.98      0.98      0.98       132
           2       1.00      1.00      1.00       125
           3       0.97      0.99      0.98       139
           4       0.98      0.98      0.98       125
           5       1.00      0.98      0.99       131
           6       0.99      1.00      1.00       131
           7       1.00      0.98      0.99       133
           8       0.97      0.99      0.98       118
           9       0.94      0.96      0.95       136

    accuracy                           0.98      1300
   macro avg       0.98      0.98      0.98      1300
weighted avg       0.98      0.98      0.98      1300

2022-10-17 14:56:04,341 - trainer - INFO - {
  "train_accuracy_score": 0.9838461538461538,
  "train_loss": 0.09744270890951157
}
2022-10-17 14:56:04,672 - trainer - INFO - 
*****************[epoch: 38, global step: 454] eval development set based on eval_every=2***************
2022-10-17 14:56:04,677 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.98       360

2022-10-17 14:56:04,680 - trainer - INFO - {
  "dev_loss": 0.16547439868251482,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:04,681 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:56:04,681 - trainer - INFO -   patience: 200
2022-10-17 14:56:04,683 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:04,683 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:04,683 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_448
2022-10-17 14:56:04,685 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_454
2022-10-17 14:56:04,690 - trainer - INFO - save model to path: tmp/mlp_digits\ck_454
2022-10-17 14:56:04,801 - trainer - INFO - 
*****************[epoch: 38, global step: 456] eval training set based on eval_every=2***************
2022-10-17 14:56:04,806 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.99      0.98      0.98       140
           2       1.00      1.00      1.00       145
           3       0.97      0.99      0.98       149
           4       0.98      0.97      0.98       145
           5       1.00      0.98      0.99       142
           6       0.99      1.00      1.00       143
           7       1.00      0.99      0.99       146
           8       0.98      0.99      0.99       133
           9       0.94      0.97      0.95       149

    accuracy                           0.98      1437
   macro avg       0.98      0.98      0.98      1437
weighted avg       0.98      0.98      0.98      1437

2022-10-17 14:56:04,807 - trainer - INFO - {
  "train_accuracy_score": 0.9839944328462074,
  "train_loss": 0.01701785716932136
}
2022-10-17 14:56:05,103 - trainer - INFO - 
*****************[epoch: 38, global step: 456] eval development set based on eval_every=2***************
2022-10-17 14:56:05,107 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.92      0.96        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:05,108 - trainer - INFO - {
  "dev_loss": 0.1963707891603311,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:05,110 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:56:05,115 - trainer - INFO -   patience: 200
2022-10-17 14:56:05,115 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:05,116 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:05,116 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_450
2022-10-17 14:56:05,118 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_456
2022-10-17 14:56:05,123 - trainer - INFO - save model to path: tmp/mlp_digits\ck_456
2022-10-17 14:56:05,125 - trainer - INFO - 
*****************[epoch: 38, global step: 457] eval training set at end of epoch***************
2022-10-17 14:56:05,130 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.99      0.98      0.98       140
           2       1.00      1.00      1.00       145
           3       0.97      0.99      0.98       149
           4       0.98      0.97      0.98       145
           5       1.00      0.98      0.99       142
           6       0.99      1.00      1.00       143
           7       1.00      0.99      0.99       146
           8       0.98      0.99      0.99       133
           9       0.94      0.97      0.95       149

    accuracy                           0.98      1437
   macro avg       0.98      0.98      0.98      1437
weighted avg       0.98      0.98      0.98      1437

2022-10-17 14:56:05,133 - trainer - INFO - {
  "train_accuracy_score": 0.9839944328462074,
  "train_loss": 0.045038423034914864
}
2022-10-17 14:56:05,134 - trainer - INFO - start training epoch 39
2022-10-17 14:56:05,134 - trainer - INFO - training using device=cuda
2022-10-17 14:56:05,134 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:05,134 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:05,199 - trainer - INFO - 
*****************[epoch: 39, global step: 458] eval training set based on eval_every=2***************
2022-10-17 14:56:05,203 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       0.96      1.00      0.98        26
           2       1.00      1.00      1.00        26
           3       1.00      1.00      1.00        35
           4       1.00      0.95      0.97        20
           5       0.96      1.00      0.98        27
           6       1.00      1.00      1.00        29
           7       1.00      1.00      1.00        26
           8       1.00      1.00      1.00        25
           9       1.00      0.96      0.98        23

    accuracy                           0.99       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.99      0.99       260

2022-10-17 14:56:05,205 - trainer - INFO - {
  "train_accuracy_score": 0.9923076923076923,
  "train_loss": 0.019658313132822514
}
2022-10-17 14:56:05,487 - trainer - INFO - 
*****************[epoch: 39, global step: 458] eval development set based on eval_every=2***************
2022-10-17 14:56:05,490 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.92      0.96        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:05,491 - trainer - INFO - {
  "dev_loss": 0.21312145919849476,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:05,492 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:56:05,493 - trainer - INFO -   patience: 200
2022-10-17 14:56:05,494 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:05,495 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:05,497 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_452
2022-10-17 14:56:05,499 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_458
2022-10-17 14:56:05,507 - trainer - INFO - save model to path: tmp/mlp_digits\ck_458
2022-10-17 14:56:05,585 - trainer - INFO - 
*****************[epoch: 39, global step: 460] eval training set based on eval_every=2***************
2022-10-17 14:56:05,588 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       0.98      0.98      0.98        53
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        60
           4       1.00      0.98      0.99        50
           5       0.98      1.00      0.99        51
           6       1.00      1.00      1.00        51
           7       1.00      1.00      1.00        52
           8       1.00      1.00      1.00        51
           9       0.98      0.98      0.98        49

    accuracy                           0.99       520
   macro avg       0.99      0.99      0.99       520
weighted avg       0.99      0.99      0.99       520

2022-10-17 14:56:05,589 - trainer - INFO - {
  "train_accuracy_score": 0.9942307692307693,
  "train_loss": 0.02083777287043631
}
2022-10-17 14:56:05,932 - trainer - INFO - 
*****************[epoch: 39, global step: 460] eval development set based on eval_every=2***************
2022-10-17 14:56:05,935 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      1.00      0.99        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.89      0.94        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:56:05,936 - trainer - INFO - {
  "dev_loss": 0.21739713475108147,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:05,937 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:56:05,937 - trainer - INFO -   patience: 200
2022-10-17 14:56:05,938 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:05,939 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:05,939 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_454
2022-10-17 14:56:05,940 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_460
2022-10-17 14:56:05,946 - trainer - INFO - save model to path: tmp/mlp_digits\ck_460
2022-10-17 14:56:06,080 - trainer - INFO - 
*****************[epoch: 39, global step: 462] eval training set based on eval_every=2***************
2022-10-17 14:56:06,084 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        74
           1       0.99      0.99      0.99        79
           2       1.00      1.00      1.00        78
           3       1.00      1.00      1.00        91
           4       1.00      0.96      0.98        77
           5       0.99      1.00      0.99        74
           6       1.00      1.00      1.00        83
           7       1.00      1.00      1.00        71
           8       0.99      1.00      0.99        75
           9       0.97      0.99      0.98        78

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:56:06,085 - trainer - INFO - {
  "train_accuracy_score": 0.9935897435897436,
  "train_loss": 0.023331129923462868
}
2022-10-17 14:56:06,368 - trainer - INFO - 
*****************[epoch: 39, global step: 462] eval development set based on eval_every=2***************
2022-10-17 14:56:06,372 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.98      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.97      0.88      0.92        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:56:06,373 - trainer - INFO - {
  "dev_loss": 0.2016258186971148,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:06,374 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:56:06,374 - trainer - INFO -   patience: 200
2022-10-17 14:56:06,375 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:06,376 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:06,376 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_456
2022-10-17 14:56:06,377 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_462
2022-10-17 14:56:06,383 - trainer - INFO - save model to path: tmp/mlp_digits\ck_462
2022-10-17 14:56:06,459 - trainer - INFO - 
*****************[epoch: 39, global step: 464] eval training set based on eval_every=2***************
2022-10-17 14:56:06,462 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        99
           1       0.98      0.98      0.98        99
           2       1.00      1.00      1.00       107
           3       1.00      1.00      1.00       121
           4       1.00      0.96      0.98       107
           5       0.99      1.00      0.99        98
           6       1.00      1.00      1.00       100
           7       0.98      1.00      0.99       105
           8       0.98      1.00      0.99        98
           9       0.98      0.96      0.97       106

    accuracy                           0.99      1040
   macro avg       0.99      0.99      0.99      1040
weighted avg       0.99      0.99      0.99      1040

2022-10-17 14:56:06,464 - trainer - INFO - {
  "train_accuracy_score": 0.9903846153846154,
  "train_loss": 0.054727992974221706
}
2022-10-17 14:56:06,764 - trainer - INFO - 
*****************[epoch: 39, global step: 464] eval development set based on eval_every=2***************
2022-10-17 14:56:06,768 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.98      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       0.92      0.97      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.92      0.96        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.85      0.91        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:56:06,769 - trainer - INFO - {
  "dev_loss": 0.20183225441724062,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:06,770 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:56:06,771 - trainer - INFO -   patience: 200
2022-10-17 14:56:06,772 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:06,772 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:06,772 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_458
2022-10-17 14:56:06,774 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_464
2022-10-17 14:56:06,779 - trainer - INFO - save model to path: tmp/mlp_digits\ck_464
2022-10-17 14:56:06,851 - trainer - INFO - 
*****************[epoch: 39, global step: 466] eval training set based on eval_every=2***************
2022-10-17 14:56:06,855 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       127
           1       0.98      0.98      0.98       130
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       139
           4       1.00      0.97      0.98       129
           5       0.99      0.98      0.99       131
           6       1.00      1.00      1.00       124
           7       0.99      0.99      0.99       136
           8       0.98      1.00      0.99       123
           9       0.96      0.96      0.96       133

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:56:06,856 - trainer - INFO - {
  "train_accuracy_score": 0.9892307692307692,
  "train_loss": 0.05054926127195358
}
2022-10-17 14:56:07,186 - trainer - INFO - 
*****************[epoch: 39, global step: 466] eval development set based on eval_every=2***************
2022-10-17 14:56:07,190 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.98      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.90      0.94        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:07,191 - trainer - INFO - {
  "dev_loss": 0.206251448020339,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:07,192 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:56:07,192 - trainer - INFO -   patience: 200
2022-10-17 14:56:07,194 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:07,194 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:07,195 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_460
2022-10-17 14:56:07,196 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_466
2022-10-17 14:56:07,202 - trainer - INFO - save model to path: tmp/mlp_digits\ck_466
2022-10-17 14:56:07,248 - trainer - INFO - 
*****************[epoch: 39, global step: 468] eval training set based on eval_every=2***************
2022-10-17 14:56:07,252 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.98      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.97      0.99       145
           5       0.99      0.99      0.99       142
           6       1.00      0.99      1.00       143
           7       0.99      0.99      0.99       146
           8       0.99      1.00      0.99       133
           9       0.97      0.97      0.97       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:07,254 - trainer - INFO - {
  "train_accuracy_score": 0.9895615866388309,
  "train_loss": 0.06875436007976532
}
2022-10-17 14:56:07,534 - trainer - INFO - 
*****************[epoch: 39, global step: 468] eval development set based on eval_every=2***************
2022-10-17 14:56:07,538 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      1.00      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.94      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.85      0.92        33
         8.0       1.00      0.93      0.96        41
         9.0       0.79      0.97      0.87        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:56:07,539 - trainer - INFO - {
  "dev_loss": 0.18981449088702598,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:07,539 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:56:07,540 - trainer - INFO -   patience: 200
2022-10-17 14:56:07,541 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:07,542 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:07,542 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_462
2022-10-17 14:56:07,544 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_468
2022-10-17 14:56:07,548 - trainer - INFO - save model to path: tmp/mlp_digits\ck_468
2022-10-17 14:56:07,549 - trainer - INFO - 
*****************[epoch: 39, global step: 469] eval training set at end of epoch***************
2022-10-17 14:56:07,553 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.98      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.97      0.99       145
           5       0.99      0.99      0.99       142
           6       1.00      0.99      1.00       143
           7       0.99      0.99      0.99       146
           8       0.99      1.00      0.99       133
           9       0.97      0.97      0.97       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:07,555 - trainer - INFO - {
  "train_accuracy_score": 0.9895615866388309,
  "train_loss": 0.03964313837544372
}
2022-10-17 14:56:07,557 - trainer - INFO - start training epoch 40
2022-10-17 14:56:07,559 - trainer - INFO - training using device=cuda
2022-10-17 14:56:07,560 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:07,560 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:07,644 - trainer - INFO - 
*****************[epoch: 40, global step: 470] eval training set based on eval_every=2***************
2022-10-17 14:56:07,647 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.97        20
           1       1.00      1.00      1.00        38
           2       1.00      1.00      1.00        32
           3       1.00      1.00      1.00        24
           4       0.97      1.00      0.98        30
           5       1.00      0.96      0.98        24
           6       1.00      1.00      1.00        22
           7       1.00      0.93      0.96        27
           8       1.00      0.94      0.97        18
           9       0.86      1.00      0.93        25

    accuracy                           0.98       260
   macro avg       0.98      0.98      0.98       260
weighted avg       0.98      0.98      0.98       260

2022-10-17 14:56:07,649 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.05793305113911629
}
2022-10-17 14:56:07,945 - trainer - INFO - 
*****************[epoch: 40, global step: 470] eval development set based on eval_every=2***************
2022-10-17 14:56:07,950 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      1.00      0.97        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.73      0.84        33
         8.0       0.97      0.88      0.92        41
         9.0       0.75      0.97      0.85        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:56:07,952 - trainer - INFO - {
  "dev_loss": 0.24362575759490332,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:07,952 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:56:07,953 - trainer - INFO -   patience: 200
2022-10-17 14:56:07,954 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:07,955 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:07,955 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_464
2022-10-17 14:56:07,957 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_470
2022-10-17 14:56:07,962 - trainer - INFO - save model to path: tmp/mlp_digits\ck_470
2022-10-17 14:56:08,049 - trainer - INFO - 
*****************[epoch: 40, global step: 472] eval training set based on eval_every=2***************
2022-10-17 14:56:08,053 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        51
           1       0.97      1.00      0.98        63
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        47
           4       0.96      1.00      0.98        54
           5       0.98      0.98      0.98        44
           6       0.98      1.00      0.99        45
           7       1.00      0.86      0.93        59
           8       1.00      0.92      0.96        51
           9       0.85      0.98      0.91        52

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:56:08,055 - trainer - INFO - {
  "train_accuracy_score": 0.9711538461538461,
  "train_loss": 0.18089480698108673
}
2022-10-17 14:56:08,377 - trainer - INFO - 
*****************[epoch: 40, global step: 472] eval development set based on eval_every=2***************
2022-10-17 14:56:08,381 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.78      1.00      0.88        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.94      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:56:08,383 - trainer - INFO - {
  "dev_loss": 0.27814164850860834,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9777777777777777
}
2022-10-17 14:56:08,384 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:56:08,384 - trainer - INFO -   patience: 200
2022-10-17 14:56:08,386 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:08,386 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:08,386 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_466
2022-10-17 14:56:08,387 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_472
2022-10-17 14:56:08,392 - trainer - INFO - save model to path: tmp/mlp_digits\ck_472
2022-10-17 14:56:08,461 - trainer - INFO - 
*****************[epoch: 40, global step: 474] eval training set based on eval_every=2***************
2022-10-17 14:56:08,465 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99        75
           1       0.97      1.00      0.98        94
           2       1.00      1.00      1.00        82
           3       0.99      0.97      0.98        77
           4       0.98      0.99      0.98        81
           5       0.95      0.99      0.97        70
           6       0.99      1.00      0.99        70
           7       1.00      0.90      0.95        80
           8       0.97      0.93      0.95        73
           9       0.89      0.96      0.93        78

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:56:08,466 - trainer - INFO - {
  "train_accuracy_score": 0.9717948717948718,
  "train_loss": 0.07197906076908112
}
2022-10-17 14:56:08,735 - trainer - INFO - 
*****************[epoch: 40, global step: 474] eval development set based on eval_every=2***************
2022-10-17 14:56:08,738 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      1.00      1.00        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.97      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      1.00      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:08,740 - trainer - INFO - {
  "dev_loss": 0.1452033108410736,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:08,741 - trainer - INFO -    save the model with best score so far
2022-10-17 14:56:08,742 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:08,743 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:08,743 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_468
2022-10-17 14:56:08,744 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:56:08,748 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:56:08,748 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:56:08,748 - trainer - INFO -   patience: 200
2022-10-17 14:56:08,749 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:56:08,750 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_474
2022-10-17 14:56:08,754 - trainer - INFO - save model to path: tmp/mlp_digits\ck_474
2022-10-17 14:56:08,829 - trainer - INFO - 
*****************[epoch: 40, global step: 476] eval training set based on eval_every=2***************
2022-10-17 14:56:08,832 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99       111
           1       0.97      1.00      0.98       112
           2       1.00      1.00      1.00       103
           3       0.99      0.98      0.99       106
           4       0.98      0.99      0.98        99
           5       0.96      0.99      0.98        99
           6       0.98      1.00      0.99        97
           7       0.99      0.93      0.96       112
           8       0.98      0.95      0.96        91
           9       0.92      0.95      0.94       110

    accuracy                           0.98      1040
   macro avg       0.98      0.98      0.98      1040
weighted avg       0.98      0.98      0.98      1040

2022-10-17 14:56:08,834 - trainer - INFO - {
  "train_accuracy_score": 0.9759615384615384,
  "train_loss": 0.03944429801777005
}
2022-10-17 14:56:09,108 - trainer - INFO - 
*****************[epoch: 40, global step: 476] eval development set based on eval_every=2***************
2022-10-17 14:56:09,111 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.71      0.83        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.79      1.00      0.88        33
         8.0       0.86      0.90      0.88        41
         9.0       0.90      0.87      0.89        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:56:09,112 - trainer - INFO - {
  "dev_loss": 0.25088060709337395,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:09,113 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:56:09,114 - trainer - INFO -   patience: 200
2022-10-17 14:56:09,115 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:09,115 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:09,115 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_470
2022-10-17 14:56:09,117 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_476
2022-10-17 14:56:09,121 - trainer - INFO - save model to path: tmp/mlp_digits\ck_476
2022-10-17 14:56:09,208 - trainer - INFO - 
*****************[epoch: 40, global step: 478] eval training set based on eval_every=2***************
2022-10-17 14:56:09,212 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       136
           1       0.97      0.96      0.96       135
           2       1.00      1.00      1.00       131
           3       0.99      0.99      0.99       135
           4       0.98      0.98      0.98       127
           5       0.97      0.99      0.98       126
           6       0.98      0.98      0.98       123
           7       0.96      0.94      0.95       134
           8       0.94      0.96      0.95       115
           9       0.92      0.94      0.93       138

    accuracy                           0.97      1300
   macro avg       0.97      0.97      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:56:09,214 - trainer - INFO - {
  "train_accuracy_score": 0.9707692307692307,
  "train_loss": 0.10769722983241081
}
2022-10-17 14:56:09,557 - trainer - INFO - 
*****************[epoch: 40, global step: 478] eval development set based on eval_every=2***************
2022-10-17 14:56:09,560 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.90      0.94        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.85      1.00      0.92        33
         8.0       0.95      0.90      0.92        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:56:09,561 - trainer - INFO - {
  "dev_loss": 0.1453133550627778,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:09,562 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:56:09,562 - trainer - INFO -   patience: 200
2022-10-17 14:56:09,563 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:09,563 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:09,564 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_472
2022-10-17 14:56:09,565 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_478
2022-10-17 14:56:09,569 - trainer - INFO - save model to path: tmp/mlp_digits\ck_478
2022-10-17 14:56:09,617 - trainer - INFO - 
*****************[epoch: 40, global step: 480] eval training set based on eval_every=2***************
2022-10-17 14:56:09,622 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.97      0.96      0.96       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.98      0.98       145
           5       0.97      0.99      0.98       142
           6       0.99      0.99      0.99       143
           7       0.95      0.95      0.95       146
           8       0.95      0.96      0.96       133
           9       0.92      0.94      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:56:09,624 - trainer - INFO - {
  "train_accuracy_score": 0.9721642310368824,
  "train_loss": 0.019156554926667013
}
2022-10-17 14:56:09,917 - trainer - INFO - 
*****************[epoch: 40, global step: 480] eval development set based on eval_every=2***************
2022-10-17 14:56:09,921 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       0.97      1.00      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       0.95      0.93      0.94        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:09,923 - trainer - INFO - {
  "dev_loss": 0.10614830643559496,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:09,923 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:56:09,924 - trainer - INFO -   patience: 200
2022-10-17 14:56:09,925 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:09,925 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:09,925 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_474
2022-10-17 14:56:09,927 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_480
2022-10-17 14:56:09,932 - trainer - INFO - save model to path: tmp/mlp_digits\ck_480
2022-10-17 14:56:09,933 - trainer - INFO - 
*****************[epoch: 40, global step: 481] eval training set at end of epoch***************
2022-10-17 14:56:09,938 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.97      0.96      0.96       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.98      0.98       145
           5       0.97      0.99      0.98       142
           6       0.99      0.99      0.99       143
           7       0.95      0.95      0.95       146
           8       0.95      0.96      0.96       133
           9       0.92      0.94      0.93       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:56:09,941 - trainer - INFO - {
  "train_accuracy_score": 0.9721642310368824,
  "train_loss": 0.07951750027768867
}
2022-10-17 14:56:09,942 - trainer - INFO - start training epoch 41
2022-10-17 14:56:09,942 - trainer - INFO - training using device=cuda
2022-10-17 14:56:09,943 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:09,944 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:10,015 - trainer - INFO - 
*****************[epoch: 41, global step: 482] eval training set based on eval_every=2***************
2022-10-17 14:56:10,018 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        19
           1       0.96      1.00      0.98        26
           2       1.00      1.00      1.00        19
           3       0.96      1.00      0.98        25
           4       1.00      1.00      1.00        30
           5       1.00      0.93      0.96        28
           6       1.00      1.00      1.00        24
           7       1.00      1.00      1.00        35
           8       1.00      1.00      1.00        28
           9       0.96      0.96      0.96        26

    accuracy                           0.99       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.99      0.99       260

2022-10-17 14:56:10,019 - trainer - INFO - {
  "train_accuracy_score": 0.9884615384615385,
  "train_loss": 0.03617434576153755
}
2022-10-17 14:56:10,304 - trainer - INFO - 
*****************[epoch: 41, global step: 482] eval development set based on eval_every=2***************
2022-10-17 14:56:10,308 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.93      0.96        40
         6.0       0.97      1.00      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:10,309 - trainer - INFO - {
  "dev_loss": 0.09803704973698284,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:10,310 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:56:10,311 - trainer - INFO -   patience: 200
2022-10-17 14:56:10,312 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:10,312 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:10,312 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_476
2022-10-17 14:56:10,314 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_482
2022-10-17 14:56:10,319 - trainer - INFO - save model to path: tmp/mlp_digits\ck_482
2022-10-17 14:56:10,390 - trainer - INFO - 
*****************[epoch: 41, global step: 484] eval training set based on eval_every=2***************
2022-10-17 14:56:10,393 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        43
           1       0.95      1.00      0.97        55
           2       1.00      1.00      1.00        49
           3       0.98      0.96      0.97        48
           4       1.00      0.98      0.99        56
           5       1.00      0.92      0.96        50
           6       1.00      1.00      1.00        48
           7       1.00      1.00      1.00        68
           8       0.98      1.00      0.99        52
           9       0.92      0.96      0.94        51

    accuracy                           0.98       520
   macro avg       0.98      0.98      0.98       520
weighted avg       0.98      0.98      0.98       520

2022-10-17 14:56:10,395 - trainer - INFO - {
  "train_accuracy_score": 0.9826923076923076,
  "train_loss": 0.06478332541882992
}
2022-10-17 14:56:10,715 - trainer - INFO - 
*****************[epoch: 41, global step: 484] eval development set based on eval_every=2***************
2022-10-17 14:56:10,718 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.90      0.95        40
         6.0       0.95      1.00      0.97        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.90      0.95        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:10,720 - trainer - INFO - {
  "dev_loss": 0.09443348242590825,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:10,721 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:56:10,724 - trainer - INFO -   patience: 200
2022-10-17 14:56:10,725 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:10,725 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:10,725 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_478
2022-10-17 14:56:10,727 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_484
2022-10-17 14:56:10,731 - trainer - INFO - save model to path: tmp/mlp_digits\ck_484
2022-10-17 14:56:10,802 - trainer - INFO - 
*****************[epoch: 41, global step: 486] eval training set based on eval_every=2***************
2022-10-17 14:56:10,805 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        70
           1       0.96      1.00      0.98        86
           2       1.00      1.00      1.00        77
           3       0.99      0.97      0.98        74
           4       1.00      0.99      0.99        84
           5       1.00      0.94      0.97        69
           6       1.00      1.00      1.00        70
           7       1.00      1.00      1.00        90
           8       0.99      0.99      0.99        77
           9       0.95      0.98      0.96        83

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:56:10,807 - trainer - INFO - {
  "train_accuracy_score": 0.9871794871794872,
  "train_loss": 0.01578626688569784
}
2022-10-17 14:56:11,093 - trainer - INFO - 
*****************[epoch: 41, global step: 486] eval development set based on eval_every=2***************
2022-10-17 14:56:11,096 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.90      0.95        40
         6.0       0.95      1.00      0.97        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.90      0.95        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.98       360

2022-10-17 14:56:11,097 - trainer - INFO - {
  "dev_loss": 0.08830046840012074,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:11,098 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:56:11,098 - trainer - INFO -   patience: 200
2022-10-17 14:56:11,100 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:11,100 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:11,101 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_480
2022-10-17 14:56:11,102 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_486
2022-10-17 14:56:11,107 - trainer - INFO - save model to path: tmp/mlp_digits\ck_486
2022-10-17 14:56:11,196 - trainer - INFO - 
*****************[epoch: 41, global step: 488] eval training set based on eval_every=2***************
2022-10-17 14:56:11,201 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        97
           1       0.96      0.98      0.97       109
           2       1.00      1.00      1.00       100
           3       0.99      0.98      0.99       103
           4       0.98      0.97      0.98       110
           5       1.00      0.95      0.97        98
           6       1.00      1.00      1.00        95
           7       1.00      0.99      1.00       116
           8       0.98      0.98      0.98       102
           9       0.93      0.98      0.96       110

    accuracy                           0.98      1040
   macro avg       0.98      0.98      0.98      1040
weighted avg       0.98      0.98      0.98      1040

2022-10-17 14:56:11,202 - trainer - INFO - {
  "train_accuracy_score": 0.9836538461538461,
  "train_loss": 0.08494533225893974
}
2022-10-17 14:56:11,502 - trainer - INFO - 
*****************[epoch: 41, global step: 488] eval development set based on eval_every=2***************
2022-10-17 14:56:11,505 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.93      0.96        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:11,506 - trainer - INFO - {
  "dev_loss": 0.08231724185558657,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:11,507 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:56:11,507 - trainer - INFO -   patience: 200
2022-10-17 14:56:11,508 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:11,509 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:11,510 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_482
2022-10-17 14:56:11,512 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_488
2022-10-17 14:56:11,521 - trainer - INFO - save model to path: tmp/mlp_digits\ck_488
2022-10-17 14:56:11,603 - trainer - INFO - 
*****************[epoch: 41, global step: 490] eval training set based on eval_every=2***************
2022-10-17 14:56:11,608 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       131
           1       0.97      0.98      0.98       130
           2       1.00      1.00      1.00       130
           3       0.99      0.99      0.99       139
           4       0.98      0.98      0.98       134
           5       1.00      0.95      0.98       126
           6       0.99      1.00      1.00       118
           7       1.00      0.99      1.00       133
           8       0.98      0.98      0.98       121
           9       0.94      0.99      0.96       138

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:56:11,609 - trainer - INFO - {
  "train_accuracy_score": 0.9853846153846154,
  "train_loss": 0.018068646546453238
}
2022-10-17 14:56:11,897 - trainer - INFO - 
*****************[epoch: 41, global step: 490] eval development set based on eval_every=2***************
2022-10-17 14:56:11,900 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.97      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.94      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.98       360

2022-10-17 14:56:11,902 - trainer - INFO - {
  "dev_loss": 0.09507148099752764,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:11,902 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:56:11,903 - trainer - INFO -   patience: 200
2022-10-17 14:56:11,904 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:11,904 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:11,904 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_484
2022-10-17 14:56:11,906 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_490
2022-10-17 14:56:11,910 - trainer - INFO - save model to path: tmp/mlp_digits\ck_490
2022-10-17 14:56:12,013 - trainer - INFO - 
*****************[epoch: 41, global step: 492] eval training set based on eval_every=2***************
2022-10-17 14:56:12,017 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.98      0.98       145
           5       1.00      0.96      0.98       142
           6       0.99      1.00      1.00       143
           7       1.00      0.99      1.00       146
           8       0.98      0.98      0.98       133
           9       0.94      0.99      0.96       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:12,019 - trainer - INFO - {
  "train_accuracy_score": 0.9867780097425192,
  "train_loss": 0.0017316372527602653
}
2022-10-17 14:56:12,299 - trainer - INFO - 
*****************[epoch: 41, global step: 492] eval development set based on eval_every=2***************
2022-10-17 14:56:12,303 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.88      1.00      0.93        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.97      0.99        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.91      0.95        33
         8.0       1.00      0.88      0.94        41
         9.0       0.85      0.90      0.88        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:56:12,307 - trainer - INFO - {
  "dev_loss": 0.13168738596141338,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:12,308 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:56:12,308 - trainer - INFO -   patience: 200
2022-10-17 14:56:12,310 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:12,310 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:12,311 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_486
2022-10-17 14:56:12,313 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_492
2022-10-17 14:56:12,318 - trainer - INFO - save model to path: tmp/mlp_digits\ck_492
2022-10-17 14:56:12,320 - trainer - INFO - 
*****************[epoch: 41, global step: 493] eval training set at end of epoch***************
2022-10-17 14:56:12,326 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.98      0.98       145
           5       1.00      0.96      0.98       142
           6       0.99      1.00      1.00       143
           7       1.00      0.99      1.00       146
           8       0.98      0.98      0.98       133
           9       0.94      0.99      0.96       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:12,328 - trainer - INFO - {
  "train_accuracy_score": 0.9867780097425192,
  "train_loss": 0.03691492568736976
}
2022-10-17 14:56:12,329 - trainer - INFO - start training epoch 42
2022-10-17 14:56:12,331 - trainer - INFO - training using device=cuda
2022-10-17 14:56:12,331 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:12,331 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:12,408 - trainer - INFO - 
*****************[epoch: 42, global step: 494] eval training set based on eval_every=2***************
2022-10-17 14:56:12,411 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        35
           1       0.92      1.00      0.96        24
           2       1.00      1.00      1.00        22
           3       1.00      1.00      1.00        21
           4       1.00      1.00      1.00        23
           5       1.00      1.00      1.00        28
           6       1.00      1.00      1.00        29
           7       1.00      0.88      0.94        26
           8       1.00      1.00      1.00        29
           9       0.88      0.91      0.89        23

    accuracy                           0.98       260
   macro avg       0.98      0.98      0.98       260
weighted avg       0.98      0.98      0.98       260

2022-10-17 14:56:12,412 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.06878793891519308
}
2022-10-17 14:56:12,720 - trainer - INFO - 
*****************[epoch: 42, global step: 494] eval development set based on eval_every=2***************
2022-10-17 14:56:12,725 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      1.00      0.95        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.88      0.94        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:12,726 - trainer - INFO - {
  "dev_loss": 0.1124078705906868,
  "dev_accuracy": 0.9694444444444444,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:12,726 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:56:12,727 - trainer - INFO -   patience: 200
2022-10-17 14:56:12,728 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:12,728 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:12,728 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_488
2022-10-17 14:56:12,730 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_494
2022-10-17 14:56:12,734 - trainer - INFO - save model to path: tmp/mlp_digits\ck_494
2022-10-17 14:56:12,799 - trainer - INFO - 
*****************[epoch: 42, global step: 496] eval training set based on eval_every=2***************
2022-10-17 14:56:12,802 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        59
           1       0.93      1.00      0.96        53
           2       1.00      1.00      1.00        50
           3       1.00      1.00      1.00        50
           4       1.00      0.96      0.98        48
           5       1.00      0.98      0.99        57
           6       1.00      1.00      1.00        55
           7       1.00      0.94      0.97        51
           8       0.98      0.98      0.98        53
           9       0.91      0.95      0.93        44

    accuracy                           0.98       520
   macro avg       0.98      0.98      0.98       520
weighted avg       0.98      0.98      0.98       520

2022-10-17 14:56:12,803 - trainer - INFO - {
  "train_accuracy_score": 0.9826923076923076,
  "train_loss": 0.040603434666991234
}
2022-10-17 14:56:13,074 - trainer - INFO - 
*****************[epoch: 42, global step: 496] eval development set based on eval_every=2***************
2022-10-17 14:56:13,077 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      1.00      0.97        42
         2.0       0.97      1.00      0.98        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:13,078 - trainer - INFO - {
  "dev_loss": 0.11292245262302458,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:13,079 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:56:13,079 - trainer - INFO -   patience: 200
2022-10-17 14:56:13,080 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:13,081 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:13,081 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_490
2022-10-17 14:56:13,082 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_496
2022-10-17 14:56:13,087 - trainer - INFO - save model to path: tmp/mlp_digits\ck_496
2022-10-17 14:56:13,200 - trainer - INFO - 
*****************[epoch: 42, global step: 498] eval training set based on eval_every=2***************
2022-10-17 14:56:13,203 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        89
           1       0.94      1.00      0.97        80
           2       1.00      1.00      1.00        73
           3       1.00      1.00      1.00        77
           4       1.00      0.97      0.99        78
           5       1.00      0.99      0.99        77
           6       1.00      1.00      1.00        80
           7       1.00      0.96      0.98        79
           8       0.99      0.97      0.98        76
           9       0.95      0.97      0.96        71

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:56:13,205 - trainer - INFO - {
  "train_accuracy_score": 0.9871794871794872,
  "train_loss": 0.02052868064492941
}
2022-10-17 14:56:13,494 - trainer - INFO - 
*****************[epoch: 42, global step: 498] eval development set based on eval_every=2***************
2022-10-17 14:56:13,497 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:13,498 - trainer - INFO - {
  "dev_loss": 0.11254261697952946,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:13,499 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:56:13,499 - trainer - INFO -   patience: 200
2022-10-17 14:56:13,500 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:13,500 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:13,501 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_492
2022-10-17 14:56:13,502 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_498
2022-10-17 14:56:13,508 - trainer - INFO - save model to path: tmp/mlp_digits\ck_498
2022-10-17 14:56:13,598 - trainer - INFO - 
*****************[epoch: 42, global step: 500] eval training set based on eval_every=2***************
2022-10-17 14:56:13,602 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       111
           1       0.95      1.00      0.98       106
           2       1.00      1.00      1.00       103
           3       1.00      1.00      1.00       106
           4       1.00      0.96      0.98       103
           5       1.00      0.99      0.99        99
           6       1.00      1.00      1.00       107
           7       0.99      0.97      0.98       103
           8       0.97      0.98      0.97        99
           9       0.96      0.97      0.97       103

    accuracy                           0.99      1040
   macro avg       0.99      0.99      0.99      1040
weighted avg       0.99      0.99      0.99      1040

2022-10-17 14:56:13,604 - trainer - INFO - {
  "train_accuracy_score": 0.9875,
  "train_loss": 0.039492614567279816
}
2022-10-17 14:56:13,894 - trainer - INFO - 
*****************[epoch: 42, global step: 500] eval development set based on eval_every=2***************
2022-10-17 14:56:13,897 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:13,898 - trainer - INFO - {
  "dev_loss": 0.12285357791309555,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:13,899 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:56:13,899 - trainer - INFO -   patience: 200
2022-10-17 14:56:13,901 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:13,901 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:13,901 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_494
2022-10-17 14:56:13,902 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_500
2022-10-17 14:56:13,908 - trainer - INFO - save model to path: tmp/mlp_digits\ck_500
2022-10-17 14:56:13,992 - trainer - INFO - 
*****************[epoch: 42, global step: 502] eval training set based on eval_every=2***************
2022-10-17 14:56:13,996 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       0.96      0.99      0.98       133
           2       1.00      1.00      1.00       132
           3       1.00      1.00      1.00       136
           4       1.00      0.96      0.98       129
           5       1.00      0.98      0.99       128
           6       1.00      1.00      1.00       129
           7       0.98      0.98      0.98       129
           8       0.97      0.98      0.98       119
           9       0.96      0.98      0.97       135

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:56:13,998 - trainer - INFO - {
  "train_accuracy_score": 0.9876923076923076,
  "train_loss": 0.023235109634697437
}
2022-10-17 14:56:14,338 - trainer - INFO - 
*****************[epoch: 42, global step: 502] eval development set based on eval_every=2***************
2022-10-17 14:56:14,342 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.83      0.91        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.97      0.98      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:56:14,343 - trainer - INFO - {
  "dev_loss": 0.1280821974699696,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:14,344 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:56:14,344 - trainer - INFO -   patience: 200
2022-10-17 14:56:14,345 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:14,345 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:14,346 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_496
2022-10-17 14:56:14,347 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_502
2022-10-17 14:56:14,351 - trainer - INFO - save model to path: tmp/mlp_digits\ck_502
2022-10-17 14:56:14,399 - trainer - INFO - 
*****************[epoch: 42, global step: 504] eval training set based on eval_every=2***************
2022-10-17 14:56:14,403 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.97      0.98       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       0.99      0.98      0.98       146
           8       0.98      0.98      0.98       133
           9       0.95      0.98      0.97       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:14,405 - trainer - INFO - {
  "train_accuracy_score": 0.988169798190675,
  "train_loss": 0.007473413948900998
}
2022-10-17 14:56:14,694 - trainer - INFO - 
*****************[epoch: 42, global step: 504] eval development set based on eval_every=2***************
2022-10-17 14:56:14,697 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:14,698 - trainer - INFO - {
  "dev_loss": 0.12756794349600872,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:14,699 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:56:14,699 - trainer - INFO -   patience: 200
2022-10-17 14:56:14,700 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:14,700 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:14,701 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_498
2022-10-17 14:56:14,702 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_504
2022-10-17 14:56:14,709 - trainer - INFO - save model to path: tmp/mlp_digits\ck_504
2022-10-17 14:56:14,711 - trainer - INFO - 
*****************[epoch: 42, global step: 505] eval training set at end of epoch***************
2022-10-17 14:56:14,722 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.97      0.98       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       0.99      0.98      0.98       146
           8       0.98      0.98      0.98       133
           9       0.95      0.98      0.97       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:14,725 - trainer - INFO - {
  "train_accuracy_score": 0.988169798190675,
  "train_loss": 0.03335353206299866
}
2022-10-17 14:56:14,726 - trainer - INFO - start training epoch 43
2022-10-17 14:56:14,726 - trainer - INFO - training using device=cuda
2022-10-17 14:56:14,727 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:14,727 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:14,793 - trainer - INFO - 
*****************[epoch: 43, global step: 506] eval training set based on eval_every=2***************
2022-10-17 14:56:14,797 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        26
           1       1.00      0.90      0.95        20
           2       1.00      1.00      1.00        24
           3       1.00      1.00      1.00        34
           4       1.00      0.97      0.98        29
           5       1.00      1.00      1.00        27
           6       1.00      1.00      1.00        31
           7       1.00      1.00      1.00        27
           8       0.96      1.00      0.98        22
           9       0.91      1.00      0.95        20

    accuracy                           0.99       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.99      0.99       260

2022-10-17 14:56:14,798 - trainer - INFO - {
  "train_accuracy_score": 0.9884615384615385,
  "train_loss": 0.026352623477578163
}
2022-10-17 14:56:15,079 - trainer - INFO - 
*****************[epoch: 43, global step: 506] eval development set based on eval_every=2***************
2022-10-17 14:56:15,084 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:15,085 - trainer - INFO - {
  "dev_loss": 0.11113009477655093,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:15,086 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:56:15,086 - trainer - INFO -   patience: 200
2022-10-17 14:56:15,088 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:15,089 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:15,089 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_500
2022-10-17 14:56:15,091 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_506
2022-10-17 14:56:15,096 - trainer - INFO - save model to path: tmp/mlp_digits\ck_506
2022-10-17 14:56:15,169 - trainer - INFO - 
*****************[epoch: 43, global step: 508] eval training set based on eval_every=2***************
2022-10-17 14:56:15,173 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        50
           1       1.00      0.96      0.98        45
           2       1.00      1.00      1.00        56
           3       1.00      1.00      1.00        60
           4       1.00      0.98      0.99        56
           5       1.00      1.00      1.00        49
           6       1.00      1.00      1.00        61
           7       1.00      1.00      1.00        57
           8       0.98      1.00      0.99        41
           9       0.96      1.00      0.98        45

    accuracy                           0.99       520
   macro avg       0.99      0.99      0.99       520
weighted avg       0.99      0.99      0.99       520

2022-10-17 14:56:15,174 - trainer - INFO - {
  "train_accuracy_score": 0.9942307692307693,
  "train_loss": 0.008722416823729873
}
2022-10-17 14:56:15,520 - trainer - INFO - 
*****************[epoch: 43, global step: 508] eval development set based on eval_every=2***************
2022-10-17 14:56:15,529 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      1.00      0.97        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:15,530 - trainer - INFO - {
  "dev_loss": 0.1043495823784421,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:15,531 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:56:15,531 - trainer - INFO -   patience: 200
2022-10-17 14:56:15,533 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:15,533 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:15,533 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_502
2022-10-17 14:56:15,535 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_508
2022-10-17 14:56:15,540 - trainer - INFO - save model to path: tmp/mlp_digits\ck_508
2022-10-17 14:56:15,609 - trainer - INFO - 
*****************[epoch: 43, global step: 510] eval training set based on eval_every=2***************
2022-10-17 14:56:15,612 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        74
           1       0.99      0.97      0.98        71
           2       1.00      1.00      1.00        76
           3       1.00      1.00      1.00        87
           4       1.00      0.99      0.99        76
           5       1.00      0.99      0.99        75
           6       1.00      0.99      0.99        89
           7       1.00      1.00      1.00        86
           8       0.97      0.99      0.98        74
           9       0.96      1.00      0.98        72

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:56:15,613 - trainer - INFO - {
  "train_accuracy_score": 0.9923076923076923,
  "train_loss": 0.022826953791081905
}
2022-10-17 14:56:15,895 - trainer - INFO - 
*****************[epoch: 43, global step: 510] eval development set based on eval_every=2***************
2022-10-17 14:56:15,898 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:15,900 - trainer - INFO - {
  "dev_loss": 0.08910845177403341,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:15,901 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:56:15,901 - trainer - INFO -   patience: 200
2022-10-17 14:56:15,902 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:15,902 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:15,903 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_504
2022-10-17 14:56:15,904 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_510
2022-10-17 14:56:15,909 - trainer - INFO - save model to path: tmp/mlp_digits\ck_510
2022-10-17 14:56:15,979 - trainer - INFO - 
*****************[epoch: 43, global step: 512] eval training set based on eval_every=2***************
2022-10-17 14:56:15,983 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       101
           1       0.98      0.98      0.98        99
           2       1.00      1.00      1.00       100
           3       1.00      1.00      1.00       110
           4       1.00      0.98      0.99       102
           5       1.00      0.98      0.99       103
           6       1.00      0.99      1.00       113
           7       1.00      1.00      1.00       106
           8       0.97      0.99      0.98       100
           9       0.96      0.99      0.98       106

    accuracy                           0.99      1040
   macro avg       0.99      0.99      0.99      1040
weighted avg       0.99      0.99      0.99      1040

2022-10-17 14:56:15,984 - trainer - INFO - {
  "train_accuracy_score": 0.9913461538461539,
  "train_loss": 0.029659658670425415
}
2022-10-17 14:56:16,270 - trainer - INFO - 
*****************[epoch: 43, global step: 512] eval development set based on eval_every=2***************
2022-10-17 14:56:16,275 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:16,276 - trainer - INFO - {
  "dev_loss": 0.0797128402045928,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:16,277 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:56:16,277 - trainer - INFO -   patience: 200
2022-10-17 14:56:16,278 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:16,278 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:16,279 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_506
2022-10-17 14:56:16,280 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_512
2022-10-17 14:56:16,290 - trainer - INFO - save model to path: tmp/mlp_digits\ck_512
2022-10-17 14:56:16,359 - trainer - INFO - 
*****************[epoch: 43, global step: 514] eval training set based on eval_every=2***************
2022-10-17 14:56:16,364 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       127
           1       0.98      0.98      0.98       126
           2       1.00      1.00      1.00       133
           3       1.00      1.00      1.00       139
           4       1.00      0.98      0.99       128
           5       1.00      0.98      0.99       130
           6       1.00      0.99      1.00       134
           7       1.00      1.00      1.00       127
           8       0.98      0.99      0.98       120
           9       0.97      0.99      0.98       136

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:56:16,365 - trainer - INFO - {
  "train_accuracy_score": 0.9930769230769231,
  "train_loss": 0.00698134396225214
}
2022-10-17 14:56:16,706 - trainer - INFO - 
*****************[epoch: 43, global step: 514] eval development set based on eval_every=2***************
2022-10-17 14:56:16,710 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:16,711 - trainer - INFO - {
  "dev_loss": 0.08036799154554804,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:16,712 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:56:16,712 - trainer - INFO -   patience: 200
2022-10-17 14:56:16,713 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:16,713 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:16,714 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_508
2022-10-17 14:56:16,715 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_514
2022-10-17 14:56:16,719 - trainer - INFO - save model to path: tmp/mlp_digits\ck_514
2022-10-17 14:56:16,765 - trainer - INFO - 
*****************[epoch: 43, global step: 516] eval training set based on eval_every=2***************
2022-10-17 14:56:16,769 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      0.99      0.99       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      0.99       145
           5       1.00      0.99      0.99       142
           6       1.00      0.99      1.00       143
           7       1.00      1.00      1.00       146
           8       0.98      0.99      0.99       133
           9       0.97      0.99      0.98       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:16,770 - trainer - INFO - {
  "train_accuracy_score": 0.9937369519832986,
  "train_loss": 0.005273889051750302
}
2022-10-17 14:56:17,054 - trainer - INFO - 
*****************[epoch: 43, global step: 516] eval development set based on eval_every=2***************
2022-10-17 14:56:17,058 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.90      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:17,059 - trainer - INFO - {
  "dev_loss": 0.08875847964858015,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:17,060 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:56:17,060 - trainer - INFO -   patience: 200
2022-10-17 14:56:17,061 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:17,061 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:17,062 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_510
2022-10-17 14:56:17,063 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_516
2022-10-17 14:56:17,067 - trainer - INFO - save model to path: tmp/mlp_digits\ck_516
2022-10-17 14:56:17,068 - trainer - INFO - 
*****************[epoch: 43, global step: 517] eval training set at end of epoch***************
2022-10-17 14:56:17,072 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      0.99      0.99       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      0.99       145
           5       1.00      0.99      0.99       142
           6       1.00      0.99      1.00       143
           7       1.00      1.00      1.00       146
           8       0.98      0.99      0.99       133
           9       0.97      0.99      0.98       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:56:17,075 - trainer - INFO - {
  "train_accuracy_score": 0.9937369519832986,
  "train_loss": 0.016636147629469633
}
2022-10-17 14:56:17,076 - trainer - INFO - start training epoch 44
2022-10-17 14:56:17,076 - trainer - INFO - training using device=cuda
2022-10-17 14:56:17,076 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:17,077 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:17,140 - trainer - INFO - 
*****************[epoch: 44, global step: 518] eval training set based on eval_every=2***************
2022-10-17 14:56:17,143 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        31
           1       1.00      1.00      1.00        21
           2       1.00      1.00      1.00        29
           3       1.00      1.00      1.00        21
           4       1.00      1.00      1.00        27
           5       1.00      1.00      1.00        30
           6       1.00      1.00      1.00        30
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        26
           9       1.00      1.00      1.00        20

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:17,144 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0037939301691949368
}
2022-10-17 14:56:17,415 - trainer - INFO - 
*****************[epoch: 44, global step: 518] eval development set based on eval_every=2***************
2022-10-17 14:56:17,420 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       0.95      0.93      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:17,423 - trainer - INFO - {
  "dev_loss": 0.09419451141729951,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:17,424 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:56:17,424 - trainer - INFO -   patience: 200
2022-10-17 14:56:17,425 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:17,426 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:17,426 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_512
2022-10-17 14:56:17,427 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_518
2022-10-17 14:56:17,431 - trainer - INFO - save model to path: tmp/mlp_digits\ck_518
2022-10-17 14:56:17,498 - trainer - INFO - 
*****************[epoch: 44, global step: 520] eval training set based on eval_every=2***************
2022-10-17 14:56:17,502 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        53
           1       1.00      1.00      1.00        46
           2       1.00      1.00      1.00        59
           3       1.00      1.00      1.00        49
           4       1.00      1.00      1.00        55
           5       1.00      1.00      1.00        50
           6       1.00      1.00      1.00        56
           7       1.00      1.00      1.00        51
           8       1.00      1.00      1.00        48
           9       1.00      1.00      1.00        53

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:17,503 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.011783495545387268
}
2022-10-17 14:56:17,848 - trainer - INFO - 
*****************[epoch: 44, global step: 520] eval development set based on eval_every=2***************
2022-10-17 14:56:17,851 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:17,852 - trainer - INFO - {
  "dev_loss": 0.09661691387494405,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:17,853 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:56:17,853 - trainer - INFO -   patience: 200
2022-10-17 14:56:17,854 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:17,854 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:17,854 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_514
2022-10-17 14:56:17,856 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_520
2022-10-17 14:56:17,861 - trainer - INFO - save model to path: tmp/mlp_digits\ck_520
2022-10-17 14:56:17,928 - trainer - INFO - 
*****************[epoch: 44, global step: 522] eval training set based on eval_every=2***************
2022-10-17 14:56:17,934 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      0.99      0.99        83
           2       1.00      1.00      1.00        83
           3       1.00      1.00      1.00        73
           4       1.00      1.00      1.00        77
           5       1.00      1.00      1.00        66
           6       1.00      1.00      1.00        82
           7       1.00      1.00      1.00        79
           8       1.00      1.00      1.00        78
           9       0.99      1.00      0.99        79

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:17,935 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.010325651615858078
}
2022-10-17 14:56:18,224 - trainer - INFO - 
*****************[epoch: 44, global step: 522] eval development set based on eval_every=2***************
2022-10-17 14:56:18,228 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:18,229 - trainer - INFO - {
  "dev_loss": 0.10213411696410428,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:18,230 - trainer - INFO -   no_improve_count: 24
2022-10-17 14:56:18,231 - trainer - INFO -   patience: 200
2022-10-17 14:56:18,232 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:18,232 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:18,232 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_516
2022-10-17 14:56:18,234 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_522
2022-10-17 14:56:18,239 - trainer - INFO - save model to path: tmp/mlp_digits\ck_522
2022-10-17 14:56:18,314 - trainer - INFO - 
*****************[epoch: 44, global step: 524] eval training set based on eval_every=2***************
2022-10-17 14:56:18,321 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       110
           1       1.00      0.99      1.00       107
           2       1.00      1.00      1.00       108
           3       1.00      1.00      1.00        93
           4       1.00      1.00      1.00       106
           5       1.00      0.99      1.00       104
           6       1.00      1.00      1.00       101
           7       1.00      1.00      1.00       109
           8       1.00      1.00      1.00        97
           9       0.98      1.00      0.99       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:18,322 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.024238644167780876
}
2022-10-17 14:56:18,633 - trainer - INFO - 
*****************[epoch: 44, global step: 524] eval development set based on eval_every=2***************
2022-10-17 14:56:18,636 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:18,638 - trainer - INFO - {
  "dev_loss": 0.10662224904323618,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:18,639 - trainer - INFO -   no_improve_count: 25
2022-10-17 14:56:18,639 - trainer - INFO -   patience: 200
2022-10-17 14:56:18,643 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:18,644 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:18,644 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_518
2022-10-17 14:56:18,645 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_524
2022-10-17 14:56:18,649 - trainer - INFO - save model to path: tmp/mlp_digits\ck_524
2022-10-17 14:56:18,713 - trainer - INFO - 
*****************[epoch: 44, global step: 526] eval training set based on eval_every=2***************
2022-10-17 14:56:18,718 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       135
           1       0.99      0.99      0.99       128
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       132
           4       1.00      1.00      1.00       133
           5       1.00      0.98      0.99       128
           6       1.00      1.00      1.00       127
           7       1.00      1.00      1.00       132
           8       1.00      1.00      1.00       122
           9       0.98      0.99      0.99       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:18,720 - trainer - INFO - {
  "train_accuracy_score": 0.9969230769230769,
  "train_loss": 0.015130084473639727
}
2022-10-17 14:56:19,013 - trainer - INFO - 
*****************[epoch: 44, global step: 526] eval development set based on eval_every=2***************
2022-10-17 14:56:19,016 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:19,017 - trainer - INFO - {
  "dev_loss": 0.10699110455364765,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:19,017 - trainer - INFO -   no_improve_count: 26
2022-10-17 14:56:19,018 - trainer - INFO -   patience: 200
2022-10-17 14:56:19,019 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:19,019 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:19,019 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_520
2022-10-17 14:56:19,021 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_526
2022-10-17 14:56:19,025 - trainer - INFO - save model to path: tmp/mlp_digits\ck_526
2022-10-17 14:56:19,125 - trainer - INFO - 
*****************[epoch: 44, global step: 528] eval training set based on eval_every=2***************
2022-10-17 14:56:19,130 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      0.99      0.99       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.98      0.99      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:19,131 - trainer - INFO - {
  "train_accuracy_score": 0.9972164231036882,
  "train_loss": 0.003989143962296993
}
2022-10-17 14:56:19,420 - trainer - INFO - 
*****************[epoch: 44, global step: 528] eval development set based on eval_every=2***************
2022-10-17 14:56:19,424 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:19,425 - trainer - INFO - {
  "dev_loss": 0.11580825064932772,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:19,425 - trainer - INFO -   no_improve_count: 27
2022-10-17 14:56:19,426 - trainer - INFO -   patience: 200
2022-10-17 14:56:19,427 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:19,427 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:19,427 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_522
2022-10-17 14:56:19,428 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_528
2022-10-17 14:56:19,433 - trainer - INFO - save model to path: tmp/mlp_digits\ck_528
2022-10-17 14:56:19,434 - trainer - INFO - 
*****************[epoch: 44, global step: 529] eval training set at end of epoch***************
2022-10-17 14:56:19,438 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      0.99      0.99       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.98      0.99      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:19,440 - trainer - INFO - {
  "train_accuracy_score": 0.9972164231036882,
  "train_loss": 0.01154349165569298
}
2022-10-17 14:56:19,441 - trainer - INFO - start training epoch 45
2022-10-17 14:56:19,441 - trainer - INFO - training using device=cuda
2022-10-17 14:56:19,441 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:19,441 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:19,509 - trainer - INFO - 
*****************[epoch: 45, global step: 530] eval training set based on eval_every=2***************
2022-10-17 14:56:19,517 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       0.97      1.00      0.98        28
           2       1.00      1.00      1.00        23
           3       1.00      1.00      1.00        30
           4       1.00      0.96      0.98        26
           5       1.00      0.96      0.98        25
           6       1.00      1.00      1.00        29
           7       1.00      1.00      1.00        28
           8       1.00      1.00      1.00        20
           9       0.97      1.00      0.98        28

    accuracy                           0.99       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.99      0.99       260

2022-10-17 14:56:19,520 - trainer - INFO - {
  "train_accuracy_score": 0.9923076923076923,
  "train_loss": 0.030582411913201213
}
2022-10-17 14:56:19,815 - trainer - INFO - 
*****************[epoch: 45, global step: 530] eval development set based on eval_every=2***************
2022-10-17 14:56:19,818 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.85      0.92        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:56:19,820 - trainer - INFO - {
  "dev_loss": 0.11894172032771166,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:19,821 - trainer - INFO -   no_improve_count: 28
2022-10-17 14:56:19,821 - trainer - INFO -   patience: 200
2022-10-17 14:56:19,823 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:19,823 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:19,823 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_524
2022-10-17 14:56:19,825 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_530
2022-10-17 14:56:19,829 - trainer - INFO - save model to path: tmp/mlp_digits\ck_530
2022-10-17 14:56:19,892 - trainer - INFO - 
*****************[epoch: 45, global step: 532] eval training set based on eval_every=2***************
2022-10-17 14:56:19,895 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       0.98      1.00      0.99        55
           2       1.00      1.00      1.00        61
           3       1.00      1.00      1.00        58
           4       1.00      0.98      0.99        53
           5       1.00      0.96      0.98        53
           6       1.00      1.00      1.00        48
           7       1.00      1.00      1.00        54
           8       1.00      1.00      1.00        43
           9       0.96      1.00      0.98        46

    accuracy                           0.99       520
   macro avg       0.99      0.99      0.99       520
weighted avg       0.99      0.99      0.99       520

2022-10-17 14:56:19,897 - trainer - INFO - {
  "train_accuracy_score": 0.9942307692307693,
  "train_loss": 0.017914219002705067
}
2022-10-17 14:56:20,185 - trainer - INFO - 
*****************[epoch: 45, global step: 532] eval development set based on eval_every=2***************
2022-10-17 14:56:20,188 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:20,189 - trainer - INFO - {
  "dev_loss": 0.11187815848582734,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:20,193 - trainer - INFO -   no_improve_count: 29
2022-10-17 14:56:20,194 - trainer - INFO -   patience: 200
2022-10-17 14:56:20,195 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:20,195 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:20,195 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_526
2022-10-17 14:56:20,197 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_532
2022-10-17 14:56:20,201 - trainer - INFO - save model to path: tmp/mlp_digits\ck_532
2022-10-17 14:56:20,319 - trainer - INFO - 
*****************[epoch: 45, global step: 534] eval training set based on eval_every=2***************
2022-10-17 14:56:20,322 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        87
           1       0.99      1.00      0.99        77
           2       1.00      1.00      1.00        80
           3       1.00      1.00      1.00        89
           4       1.00      0.99      0.99        70
           5       1.00      0.97      0.99        75
           6       1.00      1.00      1.00        77
           7       1.00      1.00      1.00        78
           8       1.00      1.00      1.00        68
           9       0.98      1.00      0.99        79

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:20,323 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.003263204824179411
}
2022-10-17 14:56:20,632 - trainer - INFO - 
*****************[epoch: 45, global step: 534] eval development set based on eval_every=2***************
2022-10-17 14:56:20,635 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:20,636 - trainer - INFO - {
  "dev_loss": 0.10669904250729208,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:20,636 - trainer - INFO -   no_improve_count: 30
2022-10-17 14:56:20,637 - trainer - INFO -   patience: 200
2022-10-17 14:56:20,638 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:20,638 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:20,638 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_528
2022-10-17 14:56:20,640 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_534
2022-10-17 14:56:20,644 - trainer - INFO - save model to path: tmp/mlp_digits\ck_534
2022-10-17 14:56:20,708 - trainer - INFO - 
*****************[epoch: 45, global step: 536] eval training set based on eval_every=2***************
2022-10-17 14:56:20,712 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       110
           1       0.99      1.00      1.00       110
           2       1.00      1.00      1.00       102
           3       1.00      1.00      1.00       116
           4       1.00      0.99      0.99        95
           5       1.00      0.98      0.99       107
           6       1.00      1.00      1.00       103
           7       1.00      1.00      1.00       103
           8       1.00      1.00      1.00        89
           9       0.98      1.00      0.99       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:20,713 - trainer - INFO - {
  "train_accuracy_score": 0.9971153846153846,
  "train_loss": 0.003476182813756168
}
2022-10-17 14:56:21,006 - trainer - INFO - 
*****************[epoch: 45, global step: 536] eval development set based on eval_every=2***************
2022-10-17 14:56:21,011 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.90      0.95        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:21,012 - trainer - INFO - {
  "dev_loss": 0.10031071370273519,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:21,012 - trainer - INFO -   no_improve_count: 31
2022-10-17 14:56:21,013 - trainer - INFO -   patience: 200
2022-10-17 14:56:21,014 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:21,014 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:21,014 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_530
2022-10-17 14:56:21,015 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_536
2022-10-17 14:56:21,019 - trainer - INFO - save model to path: tmp/mlp_digits\ck_536
2022-10-17 14:56:21,090 - trainer - INFO - 
*****************[epoch: 45, global step: 538] eval training set based on eval_every=2***************
2022-10-17 14:56:21,094 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       129
           1       0.99      1.00      1.00       132
           2       1.00      1.00      1.00       129
           3       1.00      1.00      1.00       144
           4       1.00      0.99      1.00       131
           5       1.00      0.98      0.99       125
           6       1.00      1.00      1.00       132
           7       1.00      1.00      1.00       131
           8       1.00      1.00      1.00       120
           9       0.98      1.00      0.99       127

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:21,095 - trainer - INFO - {
  "train_accuracy_score": 0.9976923076923077,
  "train_loss": 0.007302950136363506
}
2022-10-17 14:56:21,466 - trainer - INFO - 
*****************[epoch: 45, global step: 538] eval development set based on eval_every=2***************
2022-10-17 14:56:21,469 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:21,470 - trainer - INFO - {
  "dev_loss": 0.09474157254832487,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:21,471 - trainer - INFO -   no_improve_count: 32
2022-10-17 14:56:21,472 - trainer - INFO -   patience: 200
2022-10-17 14:56:21,473 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:21,473 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:21,474 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_532
2022-10-17 14:56:21,476 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_538
2022-10-17 14:56:21,480 - trainer - INFO - save model to path: tmp/mlp_digits\ck_538
2022-10-17 14:56:21,542 - trainer - INFO - 
*****************[epoch: 45, global step: 540] eval training set based on eval_every=2***************
2022-10-17 14:56:21,546 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:21,548 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.005391300655901432
}
2022-10-17 14:56:21,845 - trainer - INFO - 
*****************[epoch: 45, global step: 540] eval development set based on eval_every=2***************
2022-10-17 14:56:21,849 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       0.97      0.93      0.95        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:21,850 - trainer - INFO - {
  "dev_loss": 0.09408836437311645,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:21,851 - trainer - INFO -   no_improve_count: 33
2022-10-17 14:56:21,852 - trainer - INFO -   patience: 200
2022-10-17 14:56:21,853 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:21,853 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:21,853 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_534
2022-10-17 14:56:21,855 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_540
2022-10-17 14:56:21,860 - trainer - INFO - save model to path: tmp/mlp_digits\ck_540
2022-10-17 14:56:21,861 - trainer - INFO - 
*****************[epoch: 45, global step: 541] eval training set at end of epoch***************
2022-10-17 14:56:21,867 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:21,869 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.011321711557684466
}
2022-10-17 14:56:21,870 - trainer - INFO - start training epoch 46
2022-10-17 14:56:21,870 - trainer - INFO - training using device=cuda
2022-10-17 14:56:21,870 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:21,871 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:21,939 - trainer - INFO - 
*****************[epoch: 46, global step: 542] eval training set based on eval_every=2***************
2022-10-17 14:56:21,943 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        16
           1       1.00      0.97      0.98        30
           2       1.00      1.00      1.00        21
           3       1.00      1.00      1.00        29
           4       1.00      1.00      1.00        29
           5       1.00      1.00      1.00        29
           6       1.00      1.00      1.00        28
           7       1.00      1.00      1.00        29
           8       0.95      1.00      0.98        21
           9       1.00      1.00      1.00        28

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:21,944 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.008856401545926929
}
2022-10-17 14:56:22,226 - trainer - INFO - 
*****************[epoch: 46, global step: 542] eval development set based on eval_every=2***************
2022-10-17 14:56:22,229 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:22,229 - trainer - INFO - {
  "dev_loss": 0.09337943706001776,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:22,230 - trainer - INFO -   no_improve_count: 34
2022-10-17 14:56:22,230 - trainer - INFO -   patience: 200
2022-10-17 14:56:22,231 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:22,231 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:22,231 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_536
2022-10-17 14:56:22,233 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_542
2022-10-17 14:56:22,238 - trainer - INFO - save model to path: tmp/mlp_digits\ck_542
2022-10-17 14:56:22,307 - trainer - INFO - 
*****************[epoch: 46, global step: 544] eval training set based on eval_every=2***************
2022-10-17 14:56:22,310 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        44
           1       1.00      0.98      0.99        55
           2       1.00      1.00      1.00        48
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        55
           5       1.00      1.00      1.00        56
           6       1.00      1.00      1.00        54
           7       1.00      1.00      1.00        52
           8       0.98      1.00      0.99        50
           9       1.00      1.00      1.00        53

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:22,311 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.004056478122947738
}
2022-10-17 14:56:22,660 - trainer - INFO - 
*****************[epoch: 46, global step: 544] eval development set based on eval_every=2***************
2022-10-17 14:56:22,663 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:22,664 - trainer - INFO - {
  "dev_loss": 0.09950340172993795,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:22,664 - trainer - INFO -   no_improve_count: 35
2022-10-17 14:56:22,665 - trainer - INFO -   patience: 200
2022-10-17 14:56:22,666 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:22,667 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:22,667 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_538
2022-10-17 14:56:22,668 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_544
2022-10-17 14:56:22,673 - trainer - INFO - save model to path: tmp/mlp_digits\ck_544
2022-10-17 14:56:22,737 - trainer - INFO - 
*****************[epoch: 46, global step: 546] eval training set based on eval_every=2***************
2022-10-17 14:56:22,741 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        72
           1       1.00      0.99      0.99        80
           2       1.00      1.00      1.00        63
           3       1.00      1.00      1.00        83
           4       1.00      1.00      1.00        88
           5       1.00      1.00      1.00        76
           6       1.00      1.00      1.00        75
           7       1.00      1.00      1.00        87
           8       0.99      1.00      0.99        74
           9       1.00      1.00      1.00        82

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:22,742 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.005192700540646911
}
2022-10-17 14:56:23,008 - trainer - INFO - 
*****************[epoch: 46, global step: 546] eval development set based on eval_every=2***************
2022-10-17 14:56:23,011 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:23,012 - trainer - INFO - {
  "dev_loss": 0.11073386243757948,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:23,013 - trainer - INFO -   no_improve_count: 36
2022-10-17 14:56:23,013 - trainer - INFO -   patience: 200
2022-10-17 14:56:23,015 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:23,015 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:23,015 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_540
2022-10-17 14:56:23,016 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_546
2022-10-17 14:56:23,021 - trainer - INFO - save model to path: tmp/mlp_digits\ck_546
2022-10-17 14:56:23,079 - trainer - INFO - 
*****************[epoch: 46, global step: 548] eval training set based on eval_every=2***************
2022-10-17 14:56:23,083 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        97
           1       1.00      0.99      1.00       103
           2       1.00      1.00      1.00        94
           3       1.00      1.00      1.00       102
           4       1.00      1.00      1.00       114
           5       1.00      1.00      1.00       102
           6       1.00      1.00      1.00       100
           7       1.00      1.00      1.00       110
           8       0.99      1.00      1.00       103
           9       1.00      1.00      1.00       115

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:23,084 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0060829686699435115
}
2022-10-17 14:56:23,364 - trainer - INFO - 
*****************[epoch: 46, global step: 548] eval development set based on eval_every=2***************
2022-10-17 14:56:23,368 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:23,370 - trainer - INFO - {
  "dev_loss": 0.12102619104553014,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:23,370 - trainer - INFO -   no_improve_count: 37
2022-10-17 14:56:23,371 - trainer - INFO -   patience: 200
2022-10-17 14:56:23,372 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:23,372 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:23,372 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_542
2022-10-17 14:56:23,373 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_548
2022-10-17 14:56:23,378 - trainer - INFO - save model to path: tmp/mlp_digits\ck_548
2022-10-17 14:56:23,441 - trainer - INFO - 
*****************[epoch: 46, global step: 550] eval training set based on eval_every=2***************
2022-10-17 14:56:23,447 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       126
           1       1.00      0.99      1.00       130
           2       1.00      1.00      1.00       119
           3       1.00      1.00      1.00       135
           4       1.00      1.00      1.00       130
           5       1.00      0.99      1.00       129
           6       1.00      1.00      1.00       132
           7       1.00      1.00      1.00       135
           8       0.99      1.00      1.00       125
           9       0.99      1.00      1.00       139

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:23,448 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.012212680885568261
}
2022-10-17 14:56:23,788 - trainer - INFO - 
*****************[epoch: 46, global step: 550] eval development set based on eval_every=2***************
2022-10-17 14:56:23,791 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:23,793 - trainer - INFO - {
  "dev_loss": 0.11927480157949806,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:23,793 - trainer - INFO -   no_improve_count: 38
2022-10-17 14:56:23,794 - trainer - INFO -   patience: 200
2022-10-17 14:56:23,795 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:23,795 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:23,795 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_544
2022-10-17 14:56:23,797 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_550
2022-10-17 14:56:23,801 - trainer - INFO - save model to path: tmp/mlp_digits\ck_550
2022-10-17 14:56:23,847 - trainer - INFO - 
*****************[epoch: 46, global step: 552] eval training set based on eval_every=2***************
2022-10-17 14:56:23,852 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      0.99      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:23,853 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.031804684549570084
}
2022-10-17 14:56:24,137 - trainer - INFO - 
*****************[epoch: 46, global step: 552] eval development set based on eval_every=2***************
2022-10-17 14:56:24,141 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:24,142 - trainer - INFO - {
  "dev_loss": 0.10451341413136106,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9833333333333333
}
2022-10-17 14:56:24,143 - trainer - INFO -   no_improve_count: 39
2022-10-17 14:56:24,143 - trainer - INFO -   patience: 200
2022-10-17 14:56:24,144 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:24,144 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:24,144 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_546
2022-10-17 14:56:24,146 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_552
2022-10-17 14:56:24,150 - trainer - INFO - save model to path: tmp/mlp_digits\ck_552
2022-10-17 14:56:24,151 - trainer - INFO - 
*****************[epoch: 46, global step: 553] eval training set at end of epoch***************
2022-10-17 14:56:24,156 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      0.99      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:24,158 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.011367652385767238
}
2022-10-17 14:56:24,159 - trainer - INFO - start training epoch 47
2022-10-17 14:56:24,159 - trainer - INFO - training using device=cuda
2022-10-17 14:56:24,159 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:24,160 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:24,225 - trainer - INFO - 
*****************[epoch: 47, global step: 554] eval training set based on eval_every=2***************
2022-10-17 14:56:24,228 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        26
           1       1.00      1.00      1.00        24
           2       1.00      1.00      1.00        25
           3       1.00      1.00      1.00        29
           4       1.00      1.00      1.00        25
           5       1.00      1.00      1.00        24
           6       1.00      1.00      1.00        31
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        20
           9       1.00      1.00      1.00        31

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:24,229 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.004251726786606014
}
2022-10-17 14:56:24,500 - trainer - INFO - 
*****************[epoch: 47, global step: 554] eval development set based on eval_every=2***************
2022-10-17 14:56:24,506 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:24,507 - trainer - INFO - {
  "dev_loss": 0.09221267698740121,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:24,508 - trainer - INFO -    save the model with best score so far
2022-10-17 14:56:24,511 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:24,511 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:24,512 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_548
2022-10-17 14:56:24,518 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:56:24,525 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:56:24,525 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:56:24,526 - trainer - INFO -   patience: 200
2022-10-17 14:56:24,526 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:56:24,527 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_554
2022-10-17 14:56:24,531 - trainer - INFO - save model to path: tmp/mlp_digits\ck_554
2022-10-17 14:56:24,595 - trainer - INFO - 
*****************[epoch: 47, global step: 556] eval training set based on eval_every=2***************
2022-10-17 14:56:24,598 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        50
           1       1.00      1.00      1.00        57
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        58
           4       1.00      0.98      0.99        49
           5       1.00      1.00      1.00        44
           6       1.00      1.00      1.00        52
           7       1.00      1.00      1.00        53
           8       0.98      1.00      0.99        45
           9       1.00      1.00      1.00        58

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:24,600 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.012022358423564583
}
2022-10-17 14:56:24,928 - trainer - INFO - 
*****************[epoch: 47, global step: 556] eval development set based on eval_every=2***************
2022-10-17 14:56:24,931 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:24,932 - trainer - INFO - {
  "dev_loss": 0.09242241709580412,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:24,934 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:56:24,935 - trainer - INFO -   patience: 200
2022-10-17 14:56:24,938 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:24,938 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:24,939 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_550
2022-10-17 14:56:24,940 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_556
2022-10-17 14:56:24,944 - trainer - INFO - save model to path: tmp/mlp_digits\ck_556
2022-10-17 14:56:25,014 - trainer - INFO - 
*****************[epoch: 47, global step: 558] eval training set based on eval_every=2***************
2022-10-17 14:56:25,018 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        76
           1       1.00      1.00      1.00        75
           2       1.00      1.00      1.00        77
           3       1.00      1.00      1.00        84
           4       1.00      0.99      0.99        77
           5       1.00      1.00      1.00        68
           6       1.00      1.00      1.00        89
           7       1.00      1.00      1.00        80
           8       0.98      1.00      0.99        65
           9       1.00      1.00      1.00        89

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:25,019 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.0013188404554966837
}
2022-10-17 14:56:25,286 - trainer - INFO - 
*****************[epoch: 47, global step: 558] eval development set based on eval_every=2***************
2022-10-17 14:56:25,290 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:25,291 - trainer - INFO - {
  "dev_loss": 0.1032483076802843,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:25,291 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:56:25,292 - trainer - INFO -   patience: 200
2022-10-17 14:56:25,293 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:25,294 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:25,294 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_552
2022-10-17 14:56:25,296 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_558
2022-10-17 14:56:25,301 - trainer - INFO - save model to path: tmp/mlp_digits\ck_558
2022-10-17 14:56:25,370 - trainer - INFO - 
*****************[epoch: 47, global step: 560] eval training set based on eval_every=2***************
2022-10-17 14:56:25,374 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00        97
           2       1.00      1.00      1.00       103
           3       1.00      1.00      1.00       114
           4       1.00      0.98      0.99       101
           5       1.00      0.99      0.99        90
           6       1.00      1.00      1.00       112
           7       1.00      1.00      1.00       109
           8       0.99      1.00      0.99        90
           9       0.98      1.00      0.99       117

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:25,376 - trainer - INFO - {
  "train_accuracy_score": 0.9971153846153846,
  "train_loss": 0.012775517534464598
}
2022-10-17 14:56:25,660 - trainer - INFO - 
*****************[epoch: 47, global step: 560] eval development set based on eval_every=2***************
2022-10-17 14:56:25,665 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:25,666 - trainer - INFO - {
  "dev_loss": 0.11044646344331947,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:25,667 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:56:25,667 - trainer - INFO -   patience: 200
2022-10-17 14:56:25,668 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:25,668 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:25,669 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_554
2022-10-17 14:56:25,670 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_560
2022-10-17 14:56:25,675 - trainer - INFO - save model to path: tmp/mlp_digits\ck_560
2022-10-17 14:56:25,745 - trainer - INFO - 
*****************[epoch: 47, global step: 562] eval training set based on eval_every=2***************
2022-10-17 14:56:25,749 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       1.00      1.00      1.00       125
           2       1.00      1.00      1.00       130
           3       1.00      1.00      1.00       136
           4       1.00      0.98      0.99       129
           5       1.00      0.98      0.99       123
           6       1.00      1.00      1.00       134
           7       1.00      1.00      1.00       131
           8       0.99      1.00      1.00       123
           9       0.98      1.00      0.99       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:25,750 - trainer - INFO - {
  "train_accuracy_score": 0.9969230769230769,
  "train_loss": 0.020237670745700598
}
2022-10-17 14:56:26,035 - trainer - INFO - 
*****************[epoch: 47, global step: 562] eval development set based on eval_every=2***************
2022-10-17 14:56:26,039 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:26,040 - trainer - INFO - {
  "dev_loss": 0.11372917943420664,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:26,041 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:56:26,042 - trainer - INFO -   patience: 200
2022-10-17 14:56:26,043 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:26,043 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:26,043 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_556
2022-10-17 14:56:26,044 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_562
2022-10-17 14:56:26,049 - trainer - INFO - save model to path: tmp/mlp_digits\ck_562
2022-10-17 14:56:26,147 - trainer - INFO - 
*****************[epoch: 47, global step: 564] eval training set based on eval_every=2***************
2022-10-17 14:56:26,151 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.98      0.99       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      0.99       133
           9       0.98      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:26,152 - trainer - INFO - {
  "train_accuracy_score": 0.9965205288796103,
  "train_loss": 0.006296035717241466
}
2022-10-17 14:56:26,423 - trainer - INFO - 
*****************[epoch: 47, global step: 564] eval development set based on eval_every=2***************
2022-10-17 14:56:26,426 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:26,427 - trainer - INFO - {
  "dev_loss": 0.11950754816401361,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:26,428 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:56:26,428 - trainer - INFO -   patience: 200
2022-10-17 14:56:26,429 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:26,429 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:26,430 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_558
2022-10-17 14:56:26,431 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_564
2022-10-17 14:56:26,436 - trainer - INFO - save model to path: tmp/mlp_digits\ck_564
2022-10-17 14:56:26,437 - trainer - INFO - 
*****************[epoch: 47, global step: 565] eval training set at end of epoch***************
2022-10-17 14:56:26,443 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.98      0.99       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      0.99       133
           9       0.98      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:26,445 - trainer - INFO - {
  "train_accuracy_score": 0.9965205288796103,
  "train_loss": 0.009483691610512324
}
2022-10-17 14:56:26,446 - trainer - INFO - start training epoch 48
2022-10-17 14:56:26,446 - trainer - INFO - training using device=cuda
2022-10-17 14:56:26,447 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:26,447 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:26,522 - trainer - INFO - 
*****************[epoch: 48, global step: 566] eval training set based on eval_every=2***************
2022-10-17 14:56:26,525 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        17
           3       1.00      1.00      1.00        23
           4       1.00      1.00      1.00        28
           5       1.00      1.00      1.00        30
           6       1.00      1.00      1.00        27
           7       1.00      1.00      1.00        33
           8       1.00      1.00      1.00        24
           9       1.00      1.00      1.00        29

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:26,526 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.005762830609455705
}
2022-10-17 14:56:26,825 - trainer - INFO - 
*****************[epoch: 48, global step: 566] eval development set based on eval_every=2***************
2022-10-17 14:56:26,829 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:26,830 - trainer - INFO - {
  "dev_loss": 0.12111100445084351,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:26,831 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:56:26,832 - trainer - INFO -   patience: 200
2022-10-17 14:56:26,833 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:26,833 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:26,834 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_560
2022-10-17 14:56:26,835 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_566
2022-10-17 14:56:26,840 - trainer - INFO - save model to path: tmp/mlp_digits\ck_566
2022-10-17 14:56:26,902 - trainer - INFO - 
*****************[epoch: 48, global step: 568] eval training set based on eval_every=2***************
2022-10-17 14:56:26,905 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       1.00      1.00      1.00        51
           2       1.00      1.00      1.00        43
           3       1.00      1.00      1.00        52
           4       1.00      1.00      1.00        47
           5       1.00      0.98      0.99        59
           6       1.00      1.00      1.00        52
           7       1.00      1.00      1.00        58
           8       1.00      1.00      1.00        50
           9       0.98      1.00      0.99        59

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:26,906 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.008104943262878805
}
2022-10-17 14:56:27,183 - trainer - INFO - 
*****************[epoch: 48, global step: 568] eval development set based on eval_every=2***************
2022-10-17 14:56:27,187 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:27,188 - trainer - INFO - {
  "dev_loss": 0.11944875712530727,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:27,189 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:56:27,189 - trainer - INFO -   patience: 200
2022-10-17 14:56:27,190 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:27,191 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:27,191 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_562
2022-10-17 14:56:27,192 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_568
2022-10-17 14:56:27,198 - trainer - INFO - save model to path: tmp/mlp_digits\ck_568
2022-10-17 14:56:27,320 - trainer - INFO - 
*****************[epoch: 48, global step: 570] eval training set based on eval_every=2***************
2022-10-17 14:56:27,323 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        85
           1       1.00      1.00      1.00        72
           2       1.00      1.00      1.00        73
           3       1.00      1.00      1.00        84
           4       1.00      0.99      0.99        73
           5       1.00      0.99      0.99        87
           6       1.00      1.00      1.00        74
           7       1.00      1.00      1.00        83
           8       1.00      1.00      1.00        74
           9       0.97      1.00      0.99        75

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:27,324 - trainer - INFO - {
  "train_accuracy_score": 0.9974358974358974,
  "train_loss": 0.007358339207712561
}
2022-10-17 14:56:27,612 - trainer - INFO - 
*****************[epoch: 48, global step: 570] eval development set based on eval_every=2***************
2022-10-17 14:56:27,615 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:27,616 - trainer - INFO - {
  "dev_loss": 0.11287657853002504,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:27,617 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:56:27,617 - trainer - INFO -   patience: 200
2022-10-17 14:56:27,618 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:27,618 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:27,619 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_564
2022-10-17 14:56:27,620 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_570
2022-10-17 14:56:27,625 - trainer - INFO - save model to path: tmp/mlp_digits\ck_570
2022-10-17 14:56:27,696 - trainer - INFO - 
*****************[epoch: 48, global step: 572] eval training set based on eval_every=2***************
2022-10-17 14:56:27,701 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       106
           1       1.00      1.00      1.00       102
           2       1.00      1.00      1.00       102
           3       1.00      1.00      1.00       110
           4       1.00      0.99      1.00       105
           5       1.00      0.98      0.99       110
           6       1.00      1.00      1.00       103
           7       1.00      1.00      1.00       101
           8       0.99      1.00      0.99        93
           9       0.97      0.99      0.98       108

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:27,702 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.026535965036600828
}
2022-10-17 14:56:27,966 - trainer - INFO - 
*****************[epoch: 48, global step: 572] eval development set based on eval_every=2***************
2022-10-17 14:56:27,969 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:27,970 - trainer - INFO - {
  "dev_loss": 0.10867906701605534,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:27,971 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:56:27,972 - trainer - INFO -   patience: 200
2022-10-17 14:56:27,999 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:27,999 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:27,999 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_566
2022-10-17 14:56:28,001 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_572
2022-10-17 14:56:28,006 - trainer - INFO - save model to path: tmp/mlp_digits\ck_572
2022-10-17 14:56:28,072 - trainer - INFO - 
*****************[epoch: 48, global step: 574] eval training set based on eval_every=2***************
2022-10-17 14:56:28,076 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       128
           1       1.00      1.00      1.00       128
           2       1.00      1.00      1.00       126
           3       1.00      1.00      1.00       138
           4       1.00      0.99      1.00       135
           5       1.00      0.98      0.99       125
           6       1.00      1.00      1.00       132
           7       1.00      1.00      1.00       130
           8       0.99      1.00      1.00       121
           9       0.98      0.99      0.99       137

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:28,077 - trainer - INFO - {
  "train_accuracy_score": 0.9969230769230769,
  "train_loss": 0.002376743475906551
}
2022-10-17 14:56:28,388 - trainer - INFO - 
*****************[epoch: 48, global step: 574] eval development set based on eval_every=2***************
2022-10-17 14:56:28,392 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:28,393 - trainer - INFO - {
  "dev_loss": 0.09725671972167522,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:28,394 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:56:28,395 - trainer - INFO -   patience: 200
2022-10-17 14:56:28,396 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:28,397 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:28,397 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_568
2022-10-17 14:56:28,398 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_574
2022-10-17 14:56:28,403 - trainer - INFO - save model to path: tmp/mlp_digits\ck_574
2022-10-17 14:56:28,452 - trainer - INFO - 
*****************[epoch: 48, global step: 576] eval training set based on eval_every=2***************
2022-10-17 14:56:28,456 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      1.00       133
           9       0.98      0.99      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:28,458 - trainer - INFO - {
  "train_accuracy_score": 0.9972164231036882,
  "train_loss": 0.0010815396381076425
}
2022-10-17 14:56:28,739 - trainer - INFO - 
*****************[epoch: 48, global step: 576] eval development set based on eval_every=2***************
2022-10-17 14:56:28,743 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:28,743 - trainer - INFO - {
  "dev_loss": 0.09433104316121899,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:28,744 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:56:28,744 - trainer - INFO -   patience: 200
2022-10-17 14:56:28,746 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:28,747 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:28,747 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_570
2022-10-17 14:56:28,748 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_576
2022-10-17 14:56:28,756 - trainer - INFO - save model to path: tmp/mlp_digits\ck_576
2022-10-17 14:56:28,758 - trainer - INFO - 
*****************[epoch: 48, global step: 577] eval training set at end of epoch***************
2022-10-17 14:56:28,764 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      0.99      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       0.99      1.00      1.00       133
           9       0.98      0.99      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:28,767 - trainer - INFO - {
  "train_accuracy_score": 0.9972164231036882,
  "train_loss": 0.008536726871777015
}
2022-10-17 14:56:28,768 - trainer - INFO - start training epoch 49
2022-10-17 14:56:28,768 - trainer - INFO - training using device=cuda
2022-10-17 14:56:28,768 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:28,768 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:28,840 - trainer - INFO - 
*****************[epoch: 49, global step: 578] eval training set based on eval_every=2***************
2022-10-17 14:56:28,844 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        22
           3       1.00      1.00      1.00        28
           4       1.00      1.00      1.00        27
           5       1.00      1.00      1.00        27
           6       1.00      1.00      1.00        27
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        24
           9       1.00      1.00      1.00        29

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:28,845 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.002943748142570257
}
2022-10-17 14:56:29,105 - trainer - INFO - 
*****************[epoch: 49, global step: 578] eval development set based on eval_every=2***************
2022-10-17 14:56:29,108 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:29,109 - trainer - INFO - {
  "dev_loss": 0.09707315026995882,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:29,109 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:56:29,110 - trainer - INFO -   patience: 200
2022-10-17 14:56:29,110 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:29,111 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:29,111 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_572
2022-10-17 14:56:29,112 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_578
2022-10-17 14:56:29,116 - trainer - INFO - save model to path: tmp/mlp_digits\ck_578
2022-10-17 14:56:29,194 - trainer - INFO - 
*****************[epoch: 49, global step: 580] eval training set based on eval_every=2***************
2022-10-17 14:56:29,198 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        45
           1       1.00      1.00      1.00        47
           2       1.00      1.00      1.00        48
           3       1.00      1.00      1.00        56
           4       1.00      1.00      1.00        53
           5       1.00      1.00      1.00        57
           6       1.00      1.00      1.00        54
           7       1.00      1.00      1.00        56
           8       1.00      1.00      1.00        45
           9       1.00      1.00      1.00        59

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:29,199 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.003489719470962882
}
2022-10-17 14:56:29,529 - trainer - INFO - 
*****************[epoch: 49, global step: 580] eval development set based on eval_every=2***************
2022-10-17 14:56:29,533 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:29,535 - trainer - INFO - {
  "dev_loss": 0.10249091097648488,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:29,535 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:56:29,536 - trainer - INFO -   patience: 200
2022-10-17 14:56:29,537 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:29,537 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:29,537 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_574
2022-10-17 14:56:29,539 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_580
2022-10-17 14:56:29,543 - trainer - INFO - save model to path: tmp/mlp_digits\ck_580
2022-10-17 14:56:29,617 - trainer - INFO - 
*****************[epoch: 49, global step: 582] eval training set based on eval_every=2***************
2022-10-17 14:56:29,620 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        74
           1       0.99      1.00      0.99        74
           2       1.00      1.00      1.00        73
           3       1.00      1.00      1.00        84
           4       1.00      1.00      1.00        83
           5       1.00      1.00      1.00        78
           6       1.00      1.00      1.00        78
           7       1.00      1.00      1.00        80
           8       1.00      0.99      0.99        72
           9       1.00      1.00      1.00        84

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:29,622 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.006563951610587537
}
2022-10-17 14:56:29,893 - trainer - INFO - 
*****************[epoch: 49, global step: 582] eval development set based on eval_every=2***************
2022-10-17 14:56:29,896 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:29,897 - trainer - INFO - {
  "dev_loss": 0.09322064569520687,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:29,898 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:56:29,899 - trainer - INFO -   patience: 200
2022-10-17 14:56:29,900 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:29,900 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:29,900 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_576
2022-10-17 14:56:29,902 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_582
2022-10-17 14:56:29,908 - trainer - INFO - save model to path: tmp/mlp_digits\ck_582
2022-10-17 14:56:29,971 - trainer - INFO - 
*****************[epoch: 49, global step: 584] eval training set based on eval_every=2***************
2022-10-17 14:56:29,975 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       0.99      1.00      0.99        92
           2       1.00      1.00      1.00        92
           3       1.00      1.00      1.00       115
           4       1.00      1.00      1.00       107
           5       1.00      0.99      1.00       106
           6       1.00      1.00      1.00       113
           7       1.00      1.00      1.00       109
           8       1.00      0.99      0.99        94
           9       0.99      1.00      1.00       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:29,976 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.01806061330717057
}
2022-10-17 14:56:30,261 - trainer - INFO - 
*****************[epoch: 49, global step: 584] eval development set based on eval_every=2***************
2022-10-17 14:56:30,265 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:30,266 - trainer - INFO - {
  "dev_loss": 0.08569640087080188,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:30,267 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:56:30,268 - trainer - INFO -   patience: 200
2022-10-17 14:56:30,269 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:30,269 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:30,269 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_578
2022-10-17 14:56:30,271 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_584
2022-10-17 14:56:30,276 - trainer - INFO - save model to path: tmp/mlp_digits\ck_584
2022-10-17 14:56:30,339 - trainer - INFO - 
*****************[epoch: 49, global step: 586] eval training set based on eval_every=2***************
2022-10-17 14:56:30,343 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       0.99      1.00      1.00       124
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       136
           4       1.00      1.00      1.00       134
           5       1.00      0.98      0.99       127
           6       1.00      1.00      1.00       133
           7       1.00      1.00      1.00       137
           8       1.00      0.99      1.00       119
           9       0.99      1.00      0.99       132

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:30,344 - trainer - INFO - {
  "train_accuracy_score": 0.9976923076923077,
  "train_loss": 0.009864467661827803
}
2022-10-17 14:56:30,668 - trainer - INFO - 
*****************[epoch: 49, global step: 586] eval development set based on eval_every=2***************
2022-10-17 14:56:30,671 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:30,673 - trainer - INFO - {
  "dev_loss": 0.08152560714127806,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:30,673 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:56:30,674 - trainer - INFO -   patience: 200
2022-10-17 14:56:30,675 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:30,675 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:30,675 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_580
2022-10-17 14:56:30,677 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_586
2022-10-17 14:56:30,681 - trainer - INFO - save model to path: tmp/mlp_digits\ck_586
2022-10-17 14:56:30,731 - trainer - INFO - 
*****************[epoch: 49, global step: 588] eval training set based on eval_every=2***************
2022-10-17 14:56:30,735 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      0.99      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:30,736 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.0013591084731388037
}
2022-10-17 14:56:31,006 - trainer - INFO - 
*****************[epoch: 49, global step: 588] eval development set based on eval_every=2***************
2022-10-17 14:56:31,009 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:31,010 - trainer - INFO - {
  "dev_loss": 0.08258170016051736,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:31,011 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:56:31,011 - trainer - INFO -   patience: 200
2022-10-17 14:56:31,012 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:31,012 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:31,013 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_582
2022-10-17 14:56:31,014 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_588
2022-10-17 14:56:31,018 - trainer - INFO - save model to path: tmp/mlp_digits\ck_588
2022-10-17 14:56:31,019 - trainer - INFO - 
*****************[epoch: 49, global step: 589] eval training set at end of epoch***************
2022-10-17 14:56:31,027 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.99      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      0.99      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:31,029 - trainer - INFO - {
  "train_accuracy_score": 0.9979123173277662,
  "train_loss": 0.007046934777709642
}
2022-10-17 14:56:31,030 - trainer - INFO - start training epoch 50
2022-10-17 14:56:31,030 - trainer - INFO - training using device=cuda
2022-10-17 14:56:31,030 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:31,031 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:31,094 - trainer - INFO - 
*****************[epoch: 50, global step: 590] eval training set based on eval_every=2***************
2022-10-17 14:56:31,097 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        27
           1       1.00      1.00      1.00        23
           2       1.00      1.00      1.00        26
           3       1.00      1.00      1.00        24
           4       1.00      1.00      1.00        34
           5       1.00      1.00      1.00        24
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        23
           8       1.00      1.00      1.00        26
           9       1.00      1.00      1.00        27

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:31,098 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.002908266265876591
}
2022-10-17 14:56:31,371 - trainer - INFO - 
*****************[epoch: 50, global step: 590] eval development set based on eval_every=2***************
2022-10-17 14:56:31,375 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:31,376 - trainer - INFO - {
  "dev_loss": 0.08681311133841518,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:31,377 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:56:31,377 - trainer - INFO -   patience: 200
2022-10-17 14:56:31,378 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:31,379 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:31,379 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_584
2022-10-17 14:56:31,381 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_590
2022-10-17 14:56:31,386 - trainer - INFO - save model to path: tmp/mlp_digits\ck_590
2022-10-17 14:56:31,452 - trainer - INFO - 
*****************[epoch: 50, global step: 592] eval training set based on eval_every=2***************
2022-10-17 14:56:31,455 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        60
           1       1.00      1.00      1.00        47
           2       1.00      1.00      1.00        59
           3       1.00      1.00      1.00        49
           4       1.00      1.00      1.00        58
           5       1.00      0.98      0.99        60
           6       1.00      1.00      1.00        50
           7       1.00      1.00      1.00        46
           8       1.00      1.00      1.00        42
           9       0.98      1.00      0.99        49

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:31,457 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.018063109600916505
}
2022-10-17 14:56:31,789 - trainer - INFO - 
*****************[epoch: 50, global step: 592] eval development set based on eval_every=2***************
2022-10-17 14:56:31,795 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:31,796 - trainer - INFO - {
  "dev_loss": 0.0948000059579499,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:31,797 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:56:31,798 - trainer - INFO -   patience: 200
2022-10-17 14:56:31,799 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:31,800 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:31,801 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_586
2022-10-17 14:56:31,805 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_592
2022-10-17 14:56:31,809 - trainer - INFO - save model to path: tmp/mlp_digits\ck_592
2022-10-17 14:56:31,873 - trainer - INFO - 
*****************[epoch: 50, global step: 594] eval training set based on eval_every=2***************
2022-10-17 14:56:31,877 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        86
           1       1.00      1.00      1.00        75
           2       1.00      1.00      1.00        80
           3       1.00      1.00      1.00        76
           4       1.00      1.00      1.00        79
           5       1.00      0.99      0.99        80
           6       1.00      1.00      1.00        79
           7       1.00      1.00      1.00        83
           8       1.00      1.00      1.00        62
           9       0.99      1.00      0.99        80

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:31,878 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.0019319486455060542
}
2022-10-17 14:56:32,146 - trainer - INFO - 
*****************[epoch: 50, global step: 594] eval development set based on eval_every=2***************
2022-10-17 14:56:32,149 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:32,150 - trainer - INFO - {
  "dev_loss": 0.1056374981465827,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:32,150 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:56:32,151 - trainer - INFO -   patience: 200
2022-10-17 14:56:32,152 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:32,152 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:32,152 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_588
2022-10-17 14:56:32,154 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_594
2022-10-17 14:56:32,159 - trainer - INFO - save model to path: tmp/mlp_digits\ck_594
2022-10-17 14:56:32,219 - trainer - INFO - 
*****************[epoch: 50, global step: 596] eval training set based on eval_every=2***************
2022-10-17 14:56:32,223 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00        99
           2       1.00      1.00      1.00       106
           3       1.00      1.00      1.00       114
           4       1.00      1.00      1.00       105
           5       1.00      0.99      1.00       105
           6       1.00      1.00      1.00       108
           7       1.00      1.00      1.00       109
           8       1.00      1.00      1.00        84
           9       0.99      1.00      1.00       103

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:32,224 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.002769227314274758
}
2022-10-17 14:56:32,520 - trainer - INFO - 
*****************[epoch: 50, global step: 596] eval development set based on eval_every=2***************
2022-10-17 14:56:32,523 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:32,523 - trainer - INFO - {
  "dev_loss": 0.11215820664559335,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:32,524 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:56:32,524 - trainer - INFO -   patience: 200
2022-10-17 14:56:32,525 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:32,525 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:32,526 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_590
2022-10-17 14:56:32,528 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_596
2022-10-17 14:56:32,533 - trainer - INFO - save model to path: tmp/mlp_digits\ck_596
2022-10-17 14:56:32,599 - trainer - INFO - 
*****************[epoch: 50, global step: 598] eval training set based on eval_every=2***************
2022-10-17 14:56:32,603 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       126
           1       1.00      1.00      1.00       128
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       139
           4       1.00      1.00      1.00       135
           5       1.00      0.98      0.99       131
           6       1.00      1.00      1.00       131
           7       1.00      1.00      1.00       131
           8       1.00      1.00      1.00       116
           9       0.99      1.00      0.99       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:32,604 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.008275871281512082
}
2022-10-17 14:56:32,877 - trainer - INFO - 
*****************[epoch: 50, global step: 598] eval development set based on eval_every=2***************
2022-10-17 14:56:32,880 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.90      0.95        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:32,881 - trainer - INFO - {
  "dev_loss": 0.11443723350627504,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:32,882 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:56:32,882 - trainer - INFO -   patience: 200
2022-10-17 14:56:32,883 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:32,884 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:32,884 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_592
2022-10-17 14:56:32,885 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_598
2022-10-17 14:56:32,889 - trainer - INFO - save model to path: tmp/mlp_digits\ck_598
2022-10-17 14:56:32,978 - trainer - INFO - 
*****************[epoch: 50, global step: 600] eval training set based on eval_every=2***************
2022-10-17 14:56:32,982 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:32,983 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.0028389018261805177
}
2022-10-17 14:56:33,261 - trainer - INFO - 
*****************[epoch: 50, global step: 600] eval development set based on eval_every=2***************
2022-10-17 14:56:33,264 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:33,265 - trainer - INFO - {
  "dev_loss": 0.1156466026295675,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:33,265 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:56:33,266 - trainer - INFO -   patience: 200
2022-10-17 14:56:33,267 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:33,267 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:33,267 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_594
2022-10-17 14:56:33,268 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_600
2022-10-17 14:56:33,274 - trainer - INFO - save model to path: tmp/mlp_digits\ck_600
2022-10-17 14:56:33,278 - trainer - INFO - 
*****************[epoch: 50, global step: 601] eval training set at end of epoch***************
2022-10-17 14:56:33,283 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:33,285 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.0061312208223777516
}
2022-10-17 14:56:33,286 - trainer - INFO - start training epoch 51
2022-10-17 14:56:33,287 - trainer - INFO - training using device=cuda
2022-10-17 14:56:33,287 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:33,287 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:33,348 - trainer - INFO - 
*****************[epoch: 51, global step: 602] eval training set based on eval_every=2***************
2022-10-17 14:56:33,351 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        31
           1       1.00      1.00      1.00        25
           2       1.00      1.00      1.00        27
           3       1.00      1.00      1.00        31
           4       1.00      1.00      1.00        23
           5       1.00      1.00      1.00        27
           6       1.00      1.00      1.00        30
           7       1.00      1.00      1.00        26
           8       1.00      1.00      1.00        15
           9       1.00      1.00      1.00        25

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:33,352 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0018951622769236565
}
2022-10-17 14:56:33,637 - trainer - INFO - 
*****************[epoch: 51, global step: 602] eval development set based on eval_every=2***************
2022-10-17 14:56:33,642 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:33,643 - trainer - INFO - {
  "dev_loss": 0.11664946639939444,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:33,643 - trainer - INFO -   no_improve_count: 24
2022-10-17 14:56:33,644 - trainer - INFO -   patience: 200
2022-10-17 14:56:33,645 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:33,645 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:33,645 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_596
2022-10-17 14:56:33,646 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_602
2022-10-17 14:56:33,651 - trainer - INFO - save model to path: tmp/mlp_digits\ck_602
2022-10-17 14:56:33,712 - trainer - INFO - 
*****************[epoch: 51, global step: 604] eval training set based on eval_every=2***************
2022-10-17 14:56:33,715 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        58
           1       1.00      1.00      1.00        51
           2       1.00      1.00      1.00        60
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        47
           5       1.00      1.00      1.00        45
           6       1.00      1.00      1.00        56
           7       1.00      1.00      1.00        48
           8       1.00      1.00      1.00        48
           9       1.00      1.00      1.00        54

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:33,716 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.003993151825852692
}
2022-10-17 14:56:33,995 - trainer - INFO - 
*****************[epoch: 51, global step: 604] eval development set based on eval_every=2***************
2022-10-17 14:56:33,998 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:33,999 - trainer - INFO - {
  "dev_loss": 0.1103707687119216,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:34,000 - trainer - INFO -   no_improve_count: 25
2022-10-17 14:56:34,002 - trainer - INFO -   patience: 200
2022-10-17 14:56:34,003 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:34,005 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:34,005 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_598
2022-10-17 14:56:34,007 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_604
2022-10-17 14:56:34,011 - trainer - INFO - save model to path: tmp/mlp_digits\ck_604
2022-10-17 14:56:34,129 - trainer - INFO - 
*****************[epoch: 51, global step: 606] eval training set based on eval_every=2***************
2022-10-17 14:56:34,132 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        85
           1       1.00      1.00      1.00        75
           2       1.00      1.00      1.00        87
           3       1.00      1.00      1.00        74
           4       1.00      1.00      1.00        72
           5       1.00      0.97      0.99        77
           6       1.00      1.00      1.00        82
           7       1.00      1.00      1.00        69
           8       1.00      1.00      1.00        71
           9       0.98      1.00      0.99        88

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:34,133 - trainer - INFO - {
  "train_accuracy_score": 0.9974358974358974,
  "train_loss": 0.02336288522928953
}
2022-10-17 14:56:34,413 - trainer - INFO - 
*****************[epoch: 51, global step: 606] eval development set based on eval_every=2***************
2022-10-17 14:56:34,416 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:34,417 - trainer - INFO - {
  "dev_loss": 0.10262895750929601,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:34,418 - trainer - INFO -   no_improve_count: 26
2022-10-17 14:56:34,419 - trainer - INFO -   patience: 200
2022-10-17 14:56:34,420 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:34,420 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:34,420 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_600
2022-10-17 14:56:34,422 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_606
2022-10-17 14:56:34,426 - trainer - INFO - save model to path: tmp/mlp_digits\ck_606
2022-10-17 14:56:34,496 - trainer - INFO - 
*****************[epoch: 51, global step: 608] eval training set based on eval_every=2***************
2022-10-17 14:56:34,500 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        99
           1       1.00      1.00      1.00       104
           2       1.00      1.00      1.00       105
           3       1.00      1.00      1.00       107
           4       1.00      1.00      1.00       103
           5       1.00      0.98      0.99       105
           6       1.00      1.00      1.00       104
           7       1.00      1.00      1.00       101
           8       1.00      1.00      1.00        96
           9       0.98      1.00      0.99       116

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:34,502 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.0006716496136505157
}
2022-10-17 14:56:34,782 - trainer - INFO - 
*****************[epoch: 51, global step: 608] eval development set based on eval_every=2***************
2022-10-17 14:56:34,785 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:34,786 - trainer - INFO - {
  "dev_loss": 0.09921494478961297,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:34,786 - trainer - INFO -   no_improve_count: 27
2022-10-17 14:56:34,787 - trainer - INFO -   patience: 200
2022-10-17 14:56:34,788 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:34,788 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:34,788 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_602
2022-10-17 14:56:34,789 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_608
2022-10-17 14:56:34,797 - trainer - INFO - save model to path: tmp/mlp_digits\ck_608
2022-10-17 14:56:34,863 - trainer - INFO - 
*****************[epoch: 51, global step: 610] eval training set based on eval_every=2***************
2022-10-17 14:56:34,867 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       1.00      1.00      1.00       126
           2       1.00      1.00      1.00       131
           3       1.00      1.00      1.00       131
           4       1.00      1.00      1.00       131
           5       1.00      0.99      0.99       134
           6       1.00      1.00      1.00       129
           7       1.00      1.00      1.00       128
           8       1.00      1.00      1.00       119
           9       0.99      1.00      0.99       137

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:34,869 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.002211582293966785
}
2022-10-17 14:56:35,193 - trainer - INFO - 
*****************[epoch: 51, global step: 610] eval development set based on eval_every=2***************
2022-10-17 14:56:35,196 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:35,197 - trainer - INFO - {
  "dev_loss": 0.09334212679580862,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:35,198 - trainer - INFO -   no_improve_count: 28
2022-10-17 14:56:35,198 - trainer - INFO -   patience: 200
2022-10-17 14:56:35,199 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:35,199 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:35,199 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_604
2022-10-17 14:56:35,201 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_610
2022-10-17 14:56:35,205 - trainer - INFO - save model to path: tmp/mlp_digits\ck_610
2022-10-17 14:56:35,251 - trainer - INFO - 
*****************[epoch: 51, global step: 612] eval training set based on eval_every=2***************
2022-10-17 14:56:35,255 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:35,257 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.002471295270424889
}
2022-10-17 14:56:35,534 - trainer - INFO - 
*****************[epoch: 51, global step: 612] eval development set based on eval_every=2***************
2022-10-17 14:56:35,540 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:35,541 - trainer - INFO - {
  "dev_loss": 0.0926308219350176,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:35,542 - trainer - INFO -   no_improve_count: 29
2022-10-17 14:56:35,542 - trainer - INFO -   patience: 200
2022-10-17 14:56:35,543 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:35,543 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:35,544 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_606
2022-10-17 14:56:35,545 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_612
2022-10-17 14:56:35,550 - trainer - INFO - save model to path: tmp/mlp_digits\ck_612
2022-10-17 14:56:35,551 - trainer - INFO - 
*****************[epoch: 51, global step: 613] eval training set at end of epoch***************
2022-10-17 14:56:35,557 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:35,559 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.005767621085018011
}
2022-10-17 14:56:35,560 - trainer - INFO - start training epoch 52
2022-10-17 14:56:35,560 - trainer - INFO - training using device=cuda
2022-10-17 14:56:35,560 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:35,560 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:35,629 - trainer - INFO - 
*****************[epoch: 52, global step: 614] eval training set based on eval_every=2***************
2022-10-17 14:56:35,631 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        20
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        32
           3       1.00      1.00      1.00        26
           4       1.00      1.00      1.00        21
           5       1.00      1.00      1.00        22
           6       1.00      1.00      1.00        20
           7       1.00      1.00      1.00        34
           8       1.00      1.00      1.00        23
           9       1.00      1.00      1.00        36

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:35,632 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0006945711502339691
}
2022-10-17 14:56:35,919 - trainer - INFO - 
*****************[epoch: 52, global step: 614] eval development set based on eval_every=2***************
2022-10-17 14:56:35,923 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:35,925 - trainer - INFO - {
  "dev_loss": 0.09315149297375076,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:35,925 - trainer - INFO -   no_improve_count: 30
2022-10-17 14:56:35,926 - trainer - INFO -   patience: 200
2022-10-17 14:56:35,927 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:35,927 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:35,927 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_608
2022-10-17 14:56:35,928 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_614
2022-10-17 14:56:35,933 - trainer - INFO - save model to path: tmp/mlp_digits\ck_614
2022-10-17 14:56:35,999 - trainer - INFO - 
*****************[epoch: 52, global step: 616] eval training set based on eval_every=2***************
2022-10-17 14:56:36,002 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        55
           1       1.00      1.00      1.00        49
           2       1.00      1.00      1.00        56
           3       1.00      1.00      1.00        48
           4       1.00      1.00      1.00        46
           5       1.00      1.00      1.00        42
           6       1.00      1.00      1.00        54
           7       1.00      1.00      1.00        58
           8       1.00      1.00      1.00        50
           9       1.00      1.00      1.00        62

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:36,003 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0016324897296726704
}
2022-10-17 14:56:36,349 - trainer - INFO - 
*****************[epoch: 52, global step: 616] eval development set based on eval_every=2***************
2022-10-17 14:56:36,352 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:36,354 - trainer - INFO - {
  "dev_loss": 0.09431314736139029,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:36,354 - trainer - INFO -   no_improve_count: 31
2022-10-17 14:56:36,355 - trainer - INFO -   patience: 200
2022-10-17 14:56:36,356 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:36,356 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:36,357 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_610
2022-10-17 14:56:36,358 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_616
2022-10-17 14:56:36,363 - trainer - INFO - save model to path: tmp/mlp_digits\ck_616
2022-10-17 14:56:36,424 - trainer - INFO - 
*****************[epoch: 52, global step: 618] eval training set based on eval_every=2***************
2022-10-17 14:56:36,427 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        87
           1       1.00      1.00      1.00        69
           2       1.00      1.00      1.00        81
           3       1.00      1.00      1.00        76
           4       1.00      1.00      1.00        71
           5       1.00      1.00      1.00        73
           6       1.00      1.00      1.00        80
           7       1.00      1.00      1.00        85
           8       1.00      1.00      1.00        71
           9       1.00      1.00      1.00        87

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:36,428 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.000691991561325267
}
2022-10-17 14:56:36,712 - trainer - INFO - 
*****************[epoch: 52, global step: 618] eval development set based on eval_every=2***************
2022-10-17 14:56:36,715 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:36,716 - trainer - INFO - {
  "dev_loss": 0.09557047824879798,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:36,716 - trainer - INFO -   no_improve_count: 32
2022-10-17 14:56:36,716 - trainer - INFO -   patience: 200
2022-10-17 14:56:36,717 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:36,718 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:36,718 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_612
2022-10-17 14:56:36,719 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_618
2022-10-17 14:56:36,723 - trainer - INFO - save model to path: tmp/mlp_digits\ck_618
2022-10-17 14:56:36,799 - trainer - INFO - 
*****************[epoch: 52, global step: 620] eval training set based on eval_every=2***************
2022-10-17 14:56:36,802 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       112
           1       1.00      1.00      1.00        93
           2       1.00      1.00      1.00       105
           3       1.00      1.00      1.00       104
           4       1.00      1.00      1.00       100
           5       1.00      0.99      0.99       100
           6       1.00      1.00      1.00       104
           7       1.00      1.00      1.00       102
           8       1.00      1.00      1.00       105
           9       0.99      1.00      1.00       115

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:36,803 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.018820077151758596
}
2022-10-17 14:56:37,099 - trainer - INFO - 
*****************[epoch: 52, global step: 620] eval development set based on eval_every=2***************
2022-10-17 14:56:37,104 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:37,105 - trainer - INFO - {
  "dev_loss": 0.09608241096308727,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:37,106 - trainer - INFO -   no_improve_count: 33
2022-10-17 14:56:37,107 - trainer - INFO -   patience: 200
2022-10-17 14:56:37,108 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:37,108 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:37,109 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_614
2022-10-17 14:56:37,110 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_620
2022-10-17 14:56:37,114 - trainer - INFO - save model to path: tmp/mlp_digits\ck_620
2022-10-17 14:56:37,179 - trainer - INFO - 
*****************[epoch: 52, global step: 622] eval training set based on eval_every=2***************
2022-10-17 14:56:37,183 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       136
           1       1.00      1.00      1.00       125
           2       1.00      1.00      1.00       130
           3       1.00      1.00      1.00       132
           4       1.00      1.00      1.00       128
           5       1.00      0.98      0.99       126
           6       1.00      1.00      1.00       135
           7       1.00      1.00      1.00       126
           8       1.00      1.00      1.00       127
           9       0.99      1.00      0.99       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:37,184 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.007600059383548796
}
2022-10-17 14:56:37,530 - trainer - INFO - 
*****************[epoch: 52, global step: 622] eval development set based on eval_every=2***************
2022-10-17 14:56:37,533 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:37,535 - trainer - INFO - {
  "dev_loss": 0.09748907046499274,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:37,537 - trainer - INFO -   no_improve_count: 34
2022-10-17 14:56:37,537 - trainer - INFO -   patience: 200
2022-10-17 14:56:37,538 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:37,543 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:37,543 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_616
2022-10-17 14:56:37,545 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_622
2022-10-17 14:56:37,550 - trainer - INFO - save model to path: tmp/mlp_digits\ck_622
2022-10-17 14:56:37,598 - trainer - INFO - 
*****************[epoch: 52, global step: 624] eval training set based on eval_every=2***************
2022-10-17 14:56:37,602 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:37,603 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.0012161204358562827
}
2022-10-17 14:56:37,903 - trainer - INFO - 
*****************[epoch: 52, global step: 624] eval development set based on eval_every=2***************
2022-10-17 14:56:37,906 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:37,907 - trainer - INFO - {
  "dev_loss": 0.1018770118583537,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:37,908 - trainer - INFO -   no_improve_count: 35
2022-10-17 14:56:37,909 - trainer - INFO -   patience: 200
2022-10-17 14:56:37,910 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:37,910 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:37,910 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_618
2022-10-17 14:56:37,912 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_624
2022-10-17 14:56:37,916 - trainer - INFO - save model to path: tmp/mlp_digits\ck_624
2022-10-17 14:56:37,917 - trainer - INFO - 
*****************[epoch: 52, global step: 625] eval training set at end of epoch***************
2022-10-17 14:56:37,922 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:37,924 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.005109218235399264
}
2022-10-17 14:56:37,925 - trainer - INFO - start training epoch 53
2022-10-17 14:56:37,925 - trainer - INFO - training using device=cuda
2022-10-17 14:56:37,926 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:37,926 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:37,996 - trainer - INFO - 
*****************[epoch: 53, global step: 626] eval training set based on eval_every=2***************
2022-10-17 14:56:37,999 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        30
           1       1.00      1.00      1.00        25
           2       1.00      1.00      1.00        34
           3       1.00      1.00      1.00        23
           4       1.00      1.00      1.00        22
           5       1.00      1.00      1.00        33
           6       1.00      1.00      1.00        24
           7       1.00      1.00      1.00        26
           8       1.00      1.00      1.00        22
           9       1.00      1.00      1.00        21

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:38,000 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005789330753032118
}
2022-10-17 14:56:38,287 - trainer - INFO - 
*****************[epoch: 53, global step: 626] eval development set based on eval_every=2***************
2022-10-17 14:56:38,291 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:38,293 - trainer - INFO - {
  "dev_loss": 0.10812026997155044,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:38,294 - trainer - INFO -   no_improve_count: 36
2022-10-17 14:56:38,294 - trainer - INFO -   patience: 200
2022-10-17 14:56:38,295 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:38,295 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:38,296 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_620
2022-10-17 14:56:38,297 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_626
2022-10-17 14:56:38,301 - trainer - INFO - save model to path: tmp/mlp_digits\ck_626
2022-10-17 14:56:38,372 - trainer - INFO - 
*****************[epoch: 53, global step: 628] eval training set based on eval_every=2***************
2022-10-17 14:56:38,375 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       1.00      1.00      1.00        56
           2       1.00      1.00      1.00        67
           3       1.00      1.00      1.00        55
           4       1.00      1.00      1.00        46
           5       1.00      1.00      1.00        53
           6       1.00      1.00      1.00        48
           7       1.00      1.00      1.00        53
           8       1.00      1.00      1.00        40
           9       1.00      1.00      1.00        53

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:38,376 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0016574342735111713
}
2022-10-17 14:56:38,717 - trainer - INFO - 
*****************[epoch: 53, global step: 628] eval development set based on eval_every=2***************
2022-10-17 14:56:38,720 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:38,721 - trainer - INFO - {
  "dev_loss": 0.11252725283702603,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:38,722 - trainer - INFO -   no_improve_count: 37
2022-10-17 14:56:38,722 - trainer - INFO -   patience: 200
2022-10-17 14:56:38,723 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:38,724 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:38,724 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_622
2022-10-17 14:56:38,725 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_628
2022-10-17 14:56:38,729 - trainer - INFO - save model to path: tmp/mlp_digits\ck_628
2022-10-17 14:56:38,797 - trainer - INFO - 
*****************[epoch: 53, global step: 630] eval training set based on eval_every=2***************
2022-10-17 14:56:38,800 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        81
           1       1.00      1.00      1.00        76
           2       1.00      1.00      1.00        88
           3       1.00      1.00      1.00        84
           4       1.00      1.00      1.00        76
           5       1.00      0.99      0.99        79
           6       1.00      1.00      1.00        77
           7       1.00      1.00      1.00        81
           8       1.00      1.00      1.00        62
           9       0.99      1.00      0.99        76

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:38,801 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.006590215256437659
}
2022-10-17 14:56:39,072 - trainer - INFO - 
*****************[epoch: 53, global step: 630] eval development set based on eval_every=2***************
2022-10-17 14:56:39,077 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:39,078 - trainer - INFO - {
  "dev_loss": 0.11645950540453971,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:39,079 - trainer - INFO -   no_improve_count: 38
2022-10-17 14:56:39,079 - trainer - INFO -   patience: 200
2022-10-17 14:56:39,080 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:39,080 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:39,081 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_624
2022-10-17 14:56:39,082 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_630
2022-10-17 14:56:39,089 - trainer - INFO - save model to path: tmp/mlp_digits\ck_630
2022-10-17 14:56:39,154 - trainer - INFO - 
*****************[epoch: 53, global step: 632] eval training set based on eval_every=2***************
2022-10-17 14:56:39,158 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       113
           1       1.00      1.00      1.00       105
           2       1.00      1.00      1.00       113
           3       1.00      1.00      1.00       102
           4       1.00      1.00      1.00       108
           5       1.00      0.99      0.99        99
           6       1.00      1.00      1.00       100
           7       1.00      1.00      1.00       105
           8       1.00      1.00      1.00        86
           9       0.99      1.00      1.00       109

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:39,159 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0014305457298178226
}
2022-10-17 14:56:39,441 - trainer - INFO - 
*****************[epoch: 53, global step: 632] eval development set based on eval_every=2***************
2022-10-17 14:56:39,444 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:39,445 - trainer - INFO - {
  "dev_loss": 0.11465656217963745,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9861111111111112
}
2022-10-17 14:56:39,446 - trainer - INFO -   no_improve_count: 39
2022-10-17 14:56:39,446 - trainer - INFO -   patience: 200
2022-10-17 14:56:39,447 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:39,448 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:39,448 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_626
2022-10-17 14:56:39,449 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_632
2022-10-17 14:56:39,453 - trainer - INFO - save model to path: tmp/mlp_digits\ck_632
2022-10-17 14:56:39,532 - trainer - INFO - 
*****************[epoch: 53, global step: 634] eval training set based on eval_every=2***************
2022-10-17 14:56:39,536 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       136
           1       1.00      1.00      1.00       126
           2       1.00      1.00      1.00       135
           3       1.00      1.00      1.00       134
           4       1.00      1.00      1.00       135
           5       1.00      0.98      0.99       125
           6       1.00      1.00      1.00       128
           7       1.00      1.00      1.00       132
           8       1.00      1.00      1.00       116
           9       0.99      1.00      0.99       133

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:39,537 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.01344789401628077
}
2022-10-17 14:56:39,840 - trainer - INFO - 
*****************[epoch: 53, global step: 634] eval development set based on eval_every=2***************
2022-10-17 14:56:39,844 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       1.00      1.00      1.00        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:39,845 - trainer - INFO - {
  "dev_loss": 0.1147353386550094,
  "dev_accuracy": 0.9888888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:39,846 - trainer - INFO -    save the model with best score so far
2022-10-17 14:56:39,847 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:39,847 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:39,847 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_628
2022-10-17 14:56:39,849 - trainer - INFO -   Save checkpoint to tmp/mlp_digits
2022-10-17 14:56:39,852 - trainer - INFO - save model to path: tmp/mlp_digits
2022-10-17 14:56:39,852 - trainer - INFO -   no_improve_count: 0
2022-10-17 14:56:39,853 - trainer - INFO -   patience: 200
2022-10-17 14:56:39,854 - trainer - INFO -    Check 2 checkpoints already saved
2022-10-17 14:56:39,854 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_634
2022-10-17 14:56:39,860 - trainer - INFO - save model to path: tmp/mlp_digits\ck_634
2022-10-17 14:56:39,960 - trainer - INFO - 
*****************[epoch: 53, global step: 636] eval training set based on eval_every=2***************
2022-10-17 14:56:39,964 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:39,965 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.0013888540308073516
}
2022-10-17 14:56:40,249 - trainer - INFO - 
*****************[epoch: 53, global step: 636] eval development set based on eval_every=2***************
2022-10-17 14:56:40,254 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.95      0.97        41
         9.0       1.00      1.00      1.00        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:40,255 - trainer - INFO - {
  "dev_loss": 0.11334999019406193,
  "dev_accuracy": 0.9888888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:40,256 - trainer - INFO -   no_improve_count: 1
2022-10-17 14:56:40,257 - trainer - INFO -   patience: 200
2022-10-17 14:56:40,258 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:40,259 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:40,259 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_630
2022-10-17 14:56:40,261 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_636
2022-10-17 14:56:40,267 - trainer - INFO - save model to path: tmp/mlp_digits\ck_636
2022-10-17 14:56:40,269 - trainer - INFO - 
*****************[epoch: 53, global step: 637] eval training set at end of epoch***************
2022-10-17 14:56:40,275 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:40,277 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.004182312730359665
}
2022-10-17 14:56:40,280 - trainer - INFO - start training epoch 54
2022-10-17 14:56:40,281 - trainer - INFO - training using device=cuda
2022-10-17 14:56:40,281 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:40,281 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:40,344 - trainer - INFO - 
*****************[epoch: 54, global step: 638] eval training set based on eval_every=2***************
2022-10-17 14:56:40,347 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       1.00      1.00      1.00        22
           2       1.00      1.00      1.00        27
           3       1.00      1.00      1.00        20
           4       1.00      1.00      1.00        31
           5       1.00      0.97      0.98        32
           6       1.00      1.00      1.00        31
           7       1.00      1.00      1.00        19
           8       1.00      1.00      1.00        32
           9       0.96      1.00      0.98        23

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:40,348 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.006157553201774135
}
2022-10-17 14:56:40,669 - trainer - INFO - 
*****************[epoch: 54, global step: 638] eval development set based on eval_every=2***************
2022-10-17 14:56:40,675 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:40,676 - trainer - INFO - {
  "dev_loss": 0.11424712980806362,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:40,677 - trainer - INFO -   no_improve_count: 2
2022-10-17 14:56:40,677 - trainer - INFO -   patience: 200
2022-10-17 14:56:40,678 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:40,678 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:40,679 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_632
2022-10-17 14:56:40,681 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_638
2022-10-17 14:56:40,685 - trainer - INFO - save model to path: tmp/mlp_digits\ck_638
2022-10-17 14:56:40,753 - trainer - INFO - 
*****************[epoch: 54, global step: 640] eval training set based on eval_every=2***************
2022-10-17 14:56:40,757 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        60
           1       1.00      1.00      1.00        47
           2       1.00      1.00      1.00        53
           3       1.00      1.00      1.00        46
           4       1.00      1.00      1.00        61
           5       1.00      0.96      0.98        54
           6       1.00      1.00      1.00        56
           7       1.00      1.00      1.00        48
           8       1.00      1.00      1.00        50
           9       0.96      1.00      0.98        45

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:40,758 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.012765427469275892
}
2022-10-17 14:56:41,064 - trainer - INFO - 
*****************[epoch: 54, global step: 640] eval development set based on eval_every=2***************
2022-10-17 14:56:41,067 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:41,068 - trainer - INFO - {
  "dev_loss": 0.11392748036936003,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:41,069 - trainer - INFO -   no_improve_count: 3
2022-10-17 14:56:41,069 - trainer - INFO -   patience: 200
2022-10-17 14:56:41,070 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:41,070 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:41,070 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_634
2022-10-17 14:56:41,072 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_640
2022-10-17 14:56:41,076 - trainer - INFO - save model to path: tmp/mlp_digits\ck_640
2022-10-17 14:56:41,202 - trainer - INFO - 
*****************[epoch: 54, global step: 642] eval training set based on eval_every=2***************
2022-10-17 14:56:41,205 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        85
           1       1.00      1.00      1.00        71
           2       1.00      1.00      1.00        72
           3       1.00      1.00      1.00        76
           4       1.00      1.00      1.00        87
           5       1.00      0.97      0.99        77
           6       1.00      1.00      1.00        81
           7       1.00      1.00      1.00        78
           8       1.00      1.00      1.00        73
           9       0.98      1.00      0.99        80

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:41,207 - trainer - INFO - {
  "train_accuracy_score": 0.9974358974358974,
  "train_loss": 0.0017959300603251904
}
2022-10-17 14:56:41,523 - trainer - INFO - 
*****************[epoch: 54, global step: 642] eval development set based on eval_every=2***************
2022-10-17 14:56:41,530 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:41,531 - trainer - INFO - {
  "dev_loss": 0.1144587340556124,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:41,533 - trainer - INFO -   no_improve_count: 4
2022-10-17 14:56:41,534 - trainer - INFO -   patience: 200
2022-10-17 14:56:41,535 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:41,535 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:41,536 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_636
2022-10-17 14:56:41,538 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_642
2022-10-17 14:56:41,543 - trainer - INFO - save model to path: tmp/mlp_digits\ck_642
2022-10-17 14:56:41,620 - trainer - INFO - 
*****************[epoch: 54, global step: 644] eval training set based on eval_every=2***************
2022-10-17 14:56:41,624 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       111
           1       1.00      1.00      1.00        88
           2       1.00      1.00      1.00       103
           3       1.00      1.00      1.00       113
           4       1.00      1.00      1.00       112
           5       1.00      0.98      0.99       102
           6       1.00      1.00      1.00       113
           7       1.00      1.00      1.00       103
           8       1.00      1.00      1.00        92
           9       0.98      1.00      0.99       103

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:41,626 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.0015659689670428634
}
2022-10-17 14:56:41,911 - trainer - INFO - 
*****************[epoch: 54, global step: 644] eval development set based on eval_every=2***************
2022-10-17 14:56:41,914 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:41,915 - trainer - INFO - {
  "dev_loss": 0.11402454773633508,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:41,916 - trainer - INFO -   no_improve_count: 5
2022-10-17 14:56:41,916 - trainer - INFO -   patience: 200
2022-10-17 14:56:41,917 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:41,917 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:41,918 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_638
2022-10-17 14:56:41,919 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_644
2022-10-17 14:56:41,925 - trainer - INFO - save model to path: tmp/mlp_digits\ck_644
2022-10-17 14:56:41,989 - trainer - INFO - 
*****************[epoch: 54, global step: 646] eval training set based on eval_every=2***************
2022-10-17 14:56:41,993 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       133
           1       1.00      1.00      1.00       116
           2       1.00      1.00      1.00       131
           3       1.00      1.00      1.00       136
           4       1.00      1.00      1.00       131
           5       1.00      0.98      0.99       125
           6       1.00      1.00      1.00       137
           7       1.00      1.00      1.00       129
           8       1.00      1.00      1.00       122
           9       0.99      1.00      0.99       140

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:41,995 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.000865451991558075
}
2022-10-17 14:56:42,331 - trainer - INFO - 
*****************[epoch: 54, global step: 646] eval development set based on eval_every=2***************
2022-10-17 14:56:42,334 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:42,335 - trainer - INFO - {
  "dev_loss": 0.11370429777404449,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:42,336 - trainer - INFO -   no_improve_count: 6
2022-10-17 14:56:42,337 - trainer - INFO -   patience: 200
2022-10-17 14:56:42,338 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:42,338 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:42,339 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_640
2022-10-17 14:56:42,340 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_646
2022-10-17 14:56:42,345 - trainer - INFO - save model to path: tmp/mlp_digits\ck_646
2022-10-17 14:56:42,390 - trainer - INFO - 
*****************[epoch: 54, global step: 648] eval training set based on eval_every=2***************
2022-10-17 14:56:42,394 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:42,396 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.0004537818531389348
}
2022-10-17 14:56:42,676 - trainer - INFO - 
*****************[epoch: 54, global step: 648] eval development set based on eval_every=2***************
2022-10-17 14:56:42,679 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:42,680 - trainer - INFO - {
  "dev_loss": 0.11258733142070317,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:42,684 - trainer - INFO -   no_improve_count: 7
2022-10-17 14:56:42,684 - trainer - INFO -   patience: 200
2022-10-17 14:56:42,685 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:42,685 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:42,686 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_642
2022-10-17 14:56:42,687 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_648
2022-10-17 14:56:42,692 - trainer - INFO - save model to path: tmp/mlp_digits\ck_648
2022-10-17 14:56:42,693 - trainer - INFO - 
*****************[epoch: 54, global step: 649] eval training set at end of epoch***************
2022-10-17 14:56:42,699 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:42,701 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.003934018923852515
}
2022-10-17 14:56:42,702 - trainer - INFO - start training epoch 55
2022-10-17 14:56:42,702 - trainer - INFO - training using device=cuda
2022-10-17 14:56:42,703 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:42,703 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:42,764 - trainer - INFO - 
*****************[epoch: 55, global step: 650] eval training set based on eval_every=2***************
2022-10-17 14:56:42,767 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        22
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        25
           3       1.00      1.00      1.00        31
           4       1.00      1.00      1.00        32
           5       1.00      1.00      1.00        18
           6       1.00      1.00      1.00        33
           7       1.00      1.00      1.00        33
           8       1.00      1.00      1.00        20
           9       1.00      1.00      1.00        20

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:42,768 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0008326401584781706
}
2022-10-17 14:56:43,056 - trainer - INFO - 
*****************[epoch: 55, global step: 650] eval development set based on eval_every=2***************
2022-10-17 14:56:43,059 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.97      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.99       360
   macro avg       0.99      0.99      0.99       360
weighted avg       0.99      0.99      0.99       360

2022-10-17 14:56:43,061 - trainer - INFO - {
  "dev_loss": 0.11258529135132751,
  "dev_accuracy": 0.9861111111111112,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:43,061 - trainer - INFO -   no_improve_count: 8
2022-10-17 14:56:43,062 - trainer - INFO -   patience: 200
2022-10-17 14:56:43,063 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:43,063 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:43,063 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_644
2022-10-17 14:56:43,065 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_650
2022-10-17 14:56:43,069 - trainer - INFO - save model to path: tmp/mlp_digits\ck_650
2022-10-17 14:56:43,142 - trainer - INFO - 
*****************[epoch: 55, global step: 652] eval training set based on eval_every=2***************
2022-10-17 14:56:43,146 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        45
           1       1.00      1.00      1.00        58
           2       1.00      1.00      1.00        53
           3       1.00      1.00      1.00        55
           4       1.00      1.00      1.00        50
           5       1.00      1.00      1.00        41
           6       1.00      1.00      1.00        62
           7       1.00      1.00      1.00        63
           8       1.00      1.00      1.00        38
           9       1.00      1.00      1.00        55

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:43,147 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0008124428277369589
}
2022-10-17 14:56:43,504 - trainer - INFO - 
*****************[epoch: 55, global step: 652] eval development set based on eval_every=2***************
2022-10-17 14:56:43,507 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:43,508 - trainer - INFO - {
  "dev_loss": 0.11176028781968246,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:43,510 - trainer - INFO -   no_improve_count: 9
2022-10-17 14:56:43,513 - trainer - INFO -   patience: 200
2022-10-17 14:56:43,518 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:43,519 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:43,520 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_646
2022-10-17 14:56:43,522 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_652
2022-10-17 14:56:43,533 - trainer - INFO - save model to path: tmp/mlp_digits\ck_652
2022-10-17 14:56:43,613 - trainer - INFO - 
*****************[epoch: 55, global step: 654] eval training set based on eval_every=2***************
2022-10-17 14:56:43,616 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        71
           1       1.00      1.00      1.00        86
           2       1.00      1.00      1.00        76
           3       1.00      1.00      1.00        78
           4       1.00      1.00      1.00        78
           5       1.00      1.00      1.00        69
           6       1.00      1.00      1.00        88
           7       1.00      1.00      1.00        87
           8       1.00      1.00      1.00        63
           9       1.00      1.00      1.00        84

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:43,617 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0007777515857014805
}
2022-10-17 14:56:43,908 - trainer - INFO - 
*****************[epoch: 55, global step: 654] eval development set based on eval_every=2***************
2022-10-17 14:56:43,913 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:43,914 - trainer - INFO - {
  "dev_loss": 0.11173083556786878,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:43,914 - trainer - INFO -   no_improve_count: 10
2022-10-17 14:56:43,915 - trainer - INFO -   patience: 200
2022-10-17 14:56:43,916 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:43,916 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:43,916 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_648
2022-10-17 14:56:43,918 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_654
2022-10-17 14:56:43,922 - trainer - INFO - save model to path: tmp/mlp_digits\ck_654
2022-10-17 14:56:43,987 - trainer - INFO - 
*****************[epoch: 55, global step: 656] eval training set based on eval_every=2***************
2022-10-17 14:56:43,991 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       104
           1       1.00      1.00      1.00       108
           2       1.00      1.00      1.00       107
           3       1.00      1.00      1.00       105
           4       1.00      1.00      1.00       110
           5       1.00      1.00      1.00        89
           6       1.00      1.00      1.00       106
           7       1.00      1.00      1.00       115
           8       1.00      1.00      1.00        91
           9       1.00      1.00      1.00       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:43,993 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.000243319427681854
}
2022-10-17 14:56:44,291 - trainer - INFO - 
*****************[epoch: 55, global step: 656] eval development set based on eval_every=2***************
2022-10-17 14:56:44,297 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:44,299 - trainer - INFO - {
  "dev_loss": 0.11106753661321515,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:44,299 - trainer - INFO -   no_improve_count: 11
2022-10-17 14:56:44,300 - trainer - INFO -   patience: 200
2022-10-17 14:56:44,301 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:44,301 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:44,301 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_650
2022-10-17 14:56:44,303 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_656
2022-10-17 14:56:44,308 - trainer - INFO - save model to path: tmp/mlp_digits\ck_656
2022-10-17 14:56:44,370 - trainer - INFO - 
*****************[epoch: 55, global step: 658] eval training set based on eval_every=2***************
2022-10-17 14:56:44,374 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       129
           1       1.00      1.00      1.00       132
           2       1.00      1.00      1.00       133
           3       1.00      1.00      1.00       132
           4       1.00      1.00      1.00       126
           5       1.00      0.99      1.00       127
           6       1.00      1.00      1.00       135
           7       1.00      1.00      1.00       137
           8       1.00      1.00      1.00       114
           9       0.99      1.00      1.00       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:44,375 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.006047976756235585
}
2022-10-17 14:56:44,708 - trainer - INFO - 
*****************[epoch: 55, global step: 658] eval development set based on eval_every=2***************
2022-10-17 14:56:44,711 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:44,712 - trainer - INFO - {
  "dev_loss": 0.11341352707677288,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:44,713 - trainer - INFO -   no_improve_count: 12
2022-10-17 14:56:44,713 - trainer - INFO -   patience: 200
2022-10-17 14:56:44,714 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:44,715 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:44,715 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_652
2022-10-17 14:56:44,716 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_658
2022-10-17 14:56:44,721 - trainer - INFO - save model to path: tmp/mlp_digits\ck_658
2022-10-17 14:56:44,766 - trainer - INFO - 
*****************[epoch: 55, global step: 660] eval training set based on eval_every=2***************
2022-10-17 14:56:44,770 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:44,771 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.015855122581342584
}
2022-10-17 14:56:45,054 - trainer - INFO - 
*****************[epoch: 55, global step: 660] eval development set based on eval_every=2***************
2022-10-17 14:56:45,058 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.93      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:45,059 - trainer - INFO - {
  "dev_loss": 0.11314820234353344,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:45,060 - trainer - INFO -   no_improve_count: 13
2022-10-17 14:56:45,060 - trainer - INFO -   patience: 200
2022-10-17 14:56:45,062 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:45,062 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:45,062 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_654
2022-10-17 14:56:45,063 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_660
2022-10-17 14:56:45,068 - trainer - INFO - save model to path: tmp/mlp_digits\ck_660
2022-10-17 14:56:45,069 - trainer - INFO - 
*****************[epoch: 55, global step: 661] eval training set at end of epoch***************
2022-10-17 14:56:45,074 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:45,076 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.004094875556196105
}
2022-10-17 14:56:45,076 - trainer - INFO - start training epoch 56
2022-10-17 14:56:45,077 - trainer - INFO - training using device=cuda
2022-10-17 14:56:45,077 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:45,077 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:45,147 - trainer - INFO - 
*****************[epoch: 56, global step: 662] eval training set based on eval_every=2***************
2022-10-17 14:56:45,150 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        24
           1       1.00      1.00      1.00        31
           2       1.00      1.00      1.00        33
           3       1.00      1.00      1.00        32
           4       1.00      1.00      1.00        27
           5       1.00      1.00      1.00        25
           6       1.00      1.00      1.00        22
           7       1.00      1.00      1.00        21
           8       1.00      1.00      1.00        22
           9       1.00      1.00      1.00        23

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:45,151 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0006472413224400952
}
2022-10-17 14:56:45,442 - trainer - INFO - 
*****************[epoch: 56, global step: 662] eval development set based on eval_every=2***************
2022-10-17 14:56:45,445 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:45,447 - trainer - INFO - {
  "dev_loss": 0.11377891602751333,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:45,447 - trainer - INFO -   no_improve_count: 14
2022-10-17 14:56:45,448 - trainer - INFO -   patience: 200
2022-10-17 14:56:45,449 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:45,449 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:45,449 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_656
2022-10-17 14:56:45,451 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_662
2022-10-17 14:56:45,461 - trainer - INFO - save model to path: tmp/mlp_digits\ck_662
2022-10-17 14:56:45,536 - trainer - INFO - 
*****************[epoch: 56, global step: 664] eval training set based on eval_every=2***************
2022-10-17 14:56:45,539 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       1.00      1.00      1.00        50
           2       1.00      1.00      1.00        58
           3       1.00      1.00      1.00        63
           4       1.00      1.00      1.00        47
           5       1.00      1.00      1.00        54
           6       1.00      1.00      1.00        47
           7       1.00      1.00      1.00        52
           8       1.00      1.00      1.00        51
           9       1.00      1.00      1.00        49

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:45,541 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0010053992591565475
}
2022-10-17 14:56:45,860 - trainer - INFO - 
*****************[epoch: 56, global step: 664] eval development set based on eval_every=2***************
2022-10-17 14:56:45,863 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:45,864 - trainer - INFO - {
  "dev_loss": 0.11561790355093156,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:45,864 - trainer - INFO -   no_improve_count: 15
2022-10-17 14:56:45,865 - trainer - INFO -   patience: 200
2022-10-17 14:56:45,866 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:45,866 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:45,867 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_658
2022-10-17 14:56:45,868 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_664
2022-10-17 14:56:45,874 - trainer - INFO - save model to path: tmp/mlp_digits\ck_664
2022-10-17 14:56:45,936 - trainer - INFO - 
*****************[epoch: 56, global step: 666] eval training set based on eval_every=2***************
2022-10-17 14:56:45,939 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      1.00      1.00        78
           2       1.00      1.00      1.00        78
           3       1.00      1.00      1.00        86
           4       1.00      1.00      1.00        73
           5       1.00      0.99      0.99        78
           6       1.00      1.00      1.00        81
           7       1.00      1.00      1.00        84
           8       1.00      1.00      1.00        68
           9       0.99      1.00      0.99        74

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:45,941 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.004358662583399564
}
2022-10-17 14:56:46,238 - trainer - INFO - 
*****************[epoch: 56, global step: 666] eval development set based on eval_every=2***************
2022-10-17 14:56:46,243 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:46,245 - trainer - INFO - {
  "dev_loss": 0.11916036821639864,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:46,245 - trainer - INFO -   no_improve_count: 16
2022-10-17 14:56:46,246 - trainer - INFO -   patience: 200
2022-10-17 14:56:46,247 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:46,247 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:46,247 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_660
2022-10-17 14:56:46,249 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_666
2022-10-17 14:56:46,253 - trainer - INFO - save model to path: tmp/mlp_digits\ck_666
2022-10-17 14:56:46,324 - trainer - INFO - 
*****************[epoch: 56, global step: 668] eval training set based on eval_every=2***************
2022-10-17 14:56:46,328 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       101
           1       1.00      1.00      1.00        97
           2       1.00      1.00      1.00       100
           3       1.00      1.00      1.00       108
           4       1.00      1.00      1.00       101
           5       1.00      0.98      0.99       105
           6       1.00      1.00      1.00       111
           7       1.00      1.00      1.00       114
           8       1.00      1.00      1.00        99
           9       0.98      1.00      0.99       104

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:46,330 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.012924374575959519
}
2022-10-17 14:56:46,624 - trainer - INFO - 
*****************[epoch: 56, global step: 668] eval development set based on eval_every=2***************
2022-10-17 14:56:46,627 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:46,628 - trainer - INFO - {
  "dev_loss": 0.12143285622247883,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:46,628 - trainer - INFO -   no_improve_count: 17
2022-10-17 14:56:46,629 - trainer - INFO -   patience: 200
2022-10-17 14:56:46,630 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:46,630 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:46,631 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_662
2022-10-17 14:56:46,632 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_668
2022-10-17 14:56:46,636 - trainer - INFO - save model to path: tmp/mlp_digits\ck_668
2022-10-17 14:56:46,697 - trainer - INFO - 
*****************[epoch: 56, global step: 670] eval training set based on eval_every=2***************
2022-10-17 14:56:46,701 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       133
           1       1.00      1.00      1.00       129
           2       1.00      1.00      1.00       125
           3       1.00      1.00      1.00       136
           4       1.00      1.00      1.00       129
           5       1.00      0.98      0.99       129
           6       1.00      1.00      1.00       133
           7       1.00      1.00      1.00       137
           8       1.00      1.00      1.00       117
           9       0.99      1.00      0.99       132

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:46,702 - trainer - INFO - {
  "train_accuracy_score": 0.9984615384615385,
  "train_loss": 0.0006102042680140585
}
2022-10-17 14:56:46,959 - trainer - INFO - 
*****************[epoch: 56, global step: 670] eval development set based on eval_every=2***************
2022-10-17 14:56:46,963 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:46,963 - trainer - INFO - {
  "dev_loss": 0.12437222518443984,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:46,964 - trainer - INFO -   no_improve_count: 18
2022-10-17 14:56:46,964 - trainer - INFO -   patience: 200
2022-10-17 14:56:46,965 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:46,965 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:46,965 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_664
2022-10-17 14:56:46,966 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_670
2022-10-17 14:56:46,970 - trainer - INFO - save model to path: tmp/mlp_digits\ck_670
2022-10-17 14:56:47,050 - trainer - INFO - 
*****************[epoch: 56, global step: 672] eval training set based on eval_every=2***************
2022-10-17 14:56:47,054 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:47,056 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.000758343558118213
}
2022-10-17 14:56:47,313 - trainer - INFO - 
*****************[epoch: 56, global step: 672] eval development set based on eval_every=2***************
2022-10-17 14:56:47,318 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:47,319 - trainer - INFO - {
  "dev_loss": 0.1254344977302632,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:47,319 - trainer - INFO -   no_improve_count: 19
2022-10-17 14:56:47,319 - trainer - INFO -   patience: 200
2022-10-17 14:56:47,320 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:47,320 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:47,321 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_666
2022-10-17 14:56:47,322 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_672
2022-10-17 14:56:47,326 - trainer - INFO - save model to path: tmp/mlp_digits\ck_672
2022-10-17 14:56:47,327 - trainer - INFO - 
*****************[epoch: 56, global step: 673] eval training set at end of epoch***************
2022-10-17 14:56:47,332 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      0.99       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      0.99       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:47,334 - trainer - INFO - {
  "train_accuracy_score": 0.9986082115518441,
  "train_loss": 0.003384037594514666
}
2022-10-17 14:56:47,335 - trainer - INFO - start training epoch 57
2022-10-17 14:56:47,335 - trainer - INFO - training using device=cuda
2022-10-17 14:56:47,336 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:47,336 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:47,407 - trainer - INFO - 
*****************[epoch: 57, global step: 674] eval training set based on eval_every=2***************
2022-10-17 14:56:47,410 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       1.00      1.00      1.00        27
           2       1.00      1.00      1.00        30
           3       1.00      1.00      1.00        20
           4       1.00      1.00      1.00        35
           5       1.00      1.00      1.00        21
           6       1.00      1.00      1.00        32
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        21
           9       1.00      1.00      1.00        21

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:47,411 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0010685044107958674
}
2022-10-17 14:56:47,677 - trainer - INFO - 
*****************[epoch: 57, global step: 674] eval development set based on eval_every=2***************
2022-10-17 14:56:47,679 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:47,680 - trainer - INFO - {
  "dev_loss": 0.12536893986301342,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:47,681 - trainer - INFO -   no_improve_count: 20
2022-10-17 14:56:47,681 - trainer - INFO -   patience: 200
2022-10-17 14:56:47,682 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:47,682 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:47,682 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_668
2022-10-17 14:56:47,683 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_674
2022-10-17 14:56:47,690 - trainer - INFO - save model to path: tmp/mlp_digits\ck_674
2022-10-17 14:56:47,750 - trainer - INFO - 
*****************[epoch: 57, global step: 676] eval training set based on eval_every=2***************
2022-10-17 14:56:47,754 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        54
           1       1.00      1.00      1.00        52
           2       1.00      1.00      1.00        49
           3       1.00      1.00      1.00        57
           4       1.00      1.00      1.00        61
           5       1.00      1.00      1.00        43
           6       1.00      1.00      1.00        58
           7       1.00      1.00      1.00        49
           8       1.00      1.00      1.00        46
           9       1.00      1.00      1.00        51

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:47,755 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.001704157330095768
}
2022-10-17 14:56:48,033 - trainer - INFO - 
*****************[epoch: 57, global step: 676] eval development set based on eval_every=2***************
2022-10-17 14:56:48,036 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:48,037 - trainer - INFO - {
  "dev_loss": 0.1242522213239378,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:48,037 - trainer - INFO -   no_improve_count: 21
2022-10-17 14:56:48,038 - trainer - INFO -   patience: 200
2022-10-17 14:56:48,039 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:48,039 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:48,039 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_670
2022-10-17 14:56:48,040 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_676
2022-10-17 14:56:48,047 - trainer - INFO - save model to path: tmp/mlp_digits\ck_676
2022-10-17 14:56:48,170 - trainer - INFO - 
*****************[epoch: 57, global step: 678] eval training set based on eval_every=2***************
2022-10-17 14:56:48,176 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        82
           1       1.00      1.00      1.00        76
           2       1.00      1.00      1.00        76
           3       1.00      1.00      1.00        87
           4       1.00      1.00      1.00        83
           5       1.00      0.99      0.99        69
           6       1.00      1.00      1.00        83
           7       1.00      1.00      1.00        80
           8       1.00      1.00      1.00        72
           9       0.99      1.00      0.99        72

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:48,177 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.012112557888031006
}
2022-10-17 14:56:48,457 - trainer - INFO - 
*****************[epoch: 57, global step: 678] eval development set based on eval_every=2***************
2022-10-17 14:56:48,460 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:48,462 - trainer - INFO - {
  "dev_loss": 0.1229180389685401,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:48,466 - trainer - INFO -   no_improve_count: 22
2022-10-17 14:56:48,466 - trainer - INFO -   patience: 200
2022-10-17 14:56:48,468 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:48,468 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:48,468 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_672
2022-10-17 14:56:48,470 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_678
2022-10-17 14:56:48,475 - trainer - INFO - save model to path: tmp/mlp_digits\ck_678
2022-10-17 14:56:48,540 - trainer - INFO - 
*****************[epoch: 57, global step: 680] eval training set based on eval_every=2***************
2022-10-17 14:56:48,545 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       110
           1       1.00      1.00      1.00       108
           2       1.00      1.00      1.00        98
           3       1.00      1.00      1.00       109
           4       1.00      1.00      1.00       105
           5       1.00      0.99      0.99        99
           6       1.00      1.00      1.00       112
           7       1.00      1.00      1.00        99
           8       1.00      1.00      1.00        99
           9       0.99      1.00      1.00       101

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:48,547 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0011643710604403168
}
2022-10-17 14:56:48,815 - trainer - INFO - 
*****************[epoch: 57, global step: 680] eval development set based on eval_every=2***************
2022-10-17 14:56:48,818 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:48,820 - trainer - INFO - {
  "dev_loss": 0.12114528448728379,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:48,821 - trainer - INFO -   no_improve_count: 23
2022-10-17 14:56:48,822 - trainer - INFO -   patience: 200
2022-10-17 14:56:48,823 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:48,823 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:48,823 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_674
2022-10-17 14:56:48,825 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_680
2022-10-17 14:56:48,830 - trainer - INFO - save model to path: tmp/mlp_digits\ck_680
2022-10-17 14:56:48,896 - trainer - INFO - 
*****************[epoch: 57, global step: 682] eval training set based on eval_every=2***************
2022-10-17 14:56:48,900 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       133
           1       1.00      1.00      1.00       130
           2       1.00      1.00      1.00       127
           3       1.00      1.00      1.00       131
           4       1.00      1.00      1.00       132
           5       1.00      0.99      1.00       129
           6       1.00      1.00      1.00       133
           7       1.00      1.00      1.00       136
           8       1.00      1.00      1.00       118
           9       0.99      1.00      1.00       131

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:48,901 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0033912493963725865
}
2022-10-17 14:56:49,230 - trainer - INFO - 
*****************[epoch: 57, global step: 682] eval development set based on eval_every=2***************
2022-10-17 14:56:49,233 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:49,234 - trainer - INFO - {
  "dev_loss": 0.1194907684645538,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:49,234 - trainer - INFO -   no_improve_count: 24
2022-10-17 14:56:49,235 - trainer - INFO -   patience: 200
2022-10-17 14:56:49,236 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:49,239 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:49,240 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_676
2022-10-17 14:56:49,241 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_682
2022-10-17 14:56:49,245 - trainer - INFO - save model to path: tmp/mlp_digits\ck_682
2022-10-17 14:56:49,295 - trainer - INFO - 
*****************[epoch: 57, global step: 684] eval training set based on eval_every=2***************
2022-10-17 14:56:49,299 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:49,300 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0015459607147363386
}
2022-10-17 14:56:49,574 - trainer - INFO - 
*****************[epoch: 57, global step: 684] eval development set based on eval_every=2***************
2022-10-17 14:56:49,577 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:49,580 - trainer - INFO - {
  "dev_loss": 0.12027321278583258,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:49,580 - trainer - INFO -   no_improve_count: 25
2022-10-17 14:56:49,580 - trainer - INFO -   patience: 200
2022-10-17 14:56:49,582 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:49,582 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:49,582 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_678
2022-10-17 14:56:49,584 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_684
2022-10-17 14:56:49,588 - trainer - INFO - save model to path: tmp/mlp_digits\ck_684
2022-10-17 14:56:49,590 - trainer - INFO - 
*****************[epoch: 57, global step: 685] eval training set at end of epoch***************
2022-10-17 14:56:49,596 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:49,598 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0034978001334119804
}
2022-10-17 14:56:49,599 - trainer - INFO - start training epoch 58
2022-10-17 14:56:49,599 - trainer - INFO - training using device=cuda
2022-10-17 14:56:49,599 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:49,599 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:49,662 - trainer - INFO - 
*****************[epoch: 58, global step: 686] eval training set based on eval_every=2***************
2022-10-17 14:56:49,665 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       1.00      1.00      1.00        21
           2       1.00      1.00      1.00        30
           3       1.00      1.00      1.00        23
           4       1.00      1.00      1.00        29
           5       1.00      1.00      1.00        20
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        26
           9       1.00      1.00      1.00        32

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:49,666 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0014109659241512418
}
2022-10-17 14:56:49,940 - trainer - INFO - 
*****************[epoch: 58, global step: 686] eval development set based on eval_every=2***************
2022-10-17 14:56:49,943 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:49,944 - trainer - INFO - {
  "dev_loss": 0.1203870447789086,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:49,945 - trainer - INFO -   no_improve_count: 26
2022-10-17 14:56:49,945 - trainer - INFO -   patience: 200
2022-10-17 14:56:49,946 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:49,946 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:49,946 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_680
2022-10-17 14:56:49,948 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_686
2022-10-17 14:56:49,952 - trainer - INFO - save model to path: tmp/mlp_digits\ck_686
2022-10-17 14:56:50,018 - trainer - INFO - 
*****************[epoch: 58, global step: 688] eval training set based on eval_every=2***************
2022-10-17 14:56:50,021 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        60
           1       1.00      1.00      1.00        48
           2       1.00      1.00      1.00        53
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        60
           5       1.00      0.98      0.99        48
           6       1.00      1.00      1.00        50
           7       1.00      1.00      1.00        45
           8       1.00      1.00      1.00        47
           9       0.98      1.00      0.99        56

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:50,023 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.012186771840788424
}
2022-10-17 14:56:50,336 - trainer - INFO - 
*****************[epoch: 58, global step: 688] eval development set based on eval_every=2***************
2022-10-17 14:56:50,338 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:50,340 - trainer - INFO - {
  "dev_loss": 0.12015991351897053,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:50,340 - trainer - INFO -   no_improve_count: 27
2022-10-17 14:56:50,341 - trainer - INFO -   patience: 200
2022-10-17 14:56:50,342 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:50,342 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:50,342 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_682
2022-10-17 14:56:50,343 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_688
2022-10-17 14:56:50,347 - trainer - INFO - save model to path: tmp/mlp_digits\ck_688
2022-10-17 14:56:50,411 - trainer - INFO - 
*****************[epoch: 58, global step: 690] eval training set based on eval_every=2***************
2022-10-17 14:56:50,414 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        84
           1       1.00      1.00      1.00        73
           2       1.00      1.00      1.00        75
           3       1.00      1.00      1.00        73
           4       1.00      1.00      1.00        86
           5       1.00      0.99      0.99        78
           6       1.00      1.00      1.00        72
           7       1.00      1.00      1.00        78
           8       1.00      1.00      1.00        72
           9       0.99      1.00      0.99        89

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:50,415 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.0012020037102047354
}
2022-10-17 14:56:50,703 - trainer - INFO - 
*****************[epoch: 58, global step: 690] eval development set based on eval_every=2***************
2022-10-17 14:56:50,706 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:50,708 - trainer - INFO - {
  "dev_loss": 0.11903441632603062,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:50,709 - trainer - INFO -   no_improve_count: 28
2022-10-17 14:56:50,709 - trainer - INFO -   patience: 200
2022-10-17 14:56:50,710 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:50,710 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:50,711 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_684
2022-10-17 14:56:50,712 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_690
2022-10-17 14:56:50,716 - trainer - INFO - save model to path: tmp/mlp_digits\ck_690
2022-10-17 14:56:50,781 - trainer - INFO - 
*****************[epoch: 58, global step: 692] eval training set based on eval_every=2***************
2022-10-17 14:56:50,785 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00       107
           2       1.00      1.00      1.00       102
           3       1.00      1.00      1.00       100
           4       1.00      1.00      1.00       112
           5       1.00      0.99      1.00       103
           6       1.00      1.00      1.00        95
           7       1.00      1.00      1.00       106
           8       1.00      1.00      1.00        99
           9       0.99      1.00      1.00       109

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:50,786 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0029230107611510903
}
2022-10-17 14:56:51,060 - trainer - INFO - 
*****************[epoch: 58, global step: 692] eval development set based on eval_every=2***************
2022-10-17 14:56:51,063 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:51,064 - trainer - INFO - {
  "dev_loss": 0.11993559793336317,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:51,065 - trainer - INFO -   no_improve_count: 29
2022-10-17 14:56:51,065 - trainer - INFO -   patience: 200
2022-10-17 14:56:51,067 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:51,070 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:51,070 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_686
2022-10-17 14:56:51,071 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_692
2022-10-17 14:56:51,076 - trainer - INFO - save model to path: tmp/mlp_digits\ck_692
2022-10-17 14:56:51,145 - trainer - INFO - 
*****************[epoch: 58, global step: 694] eval training set based on eval_every=2***************
2022-10-17 14:56:51,149 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       131
           1       1.00      1.00      1.00       134
           2       1.00      1.00      1.00       131
           3       1.00      1.00      1.00       132
           4       1.00      1.00      1.00       132
           5       1.00      0.99      1.00       129
           6       1.00      1.00      1.00       129
           7       1.00      1.00      1.00       133
           8       1.00      1.00      1.00       116
           9       0.99      1.00      1.00       133

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:51,150 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0006358711398206651
}
2022-10-17 14:56:51,452 - trainer - INFO - 
*****************[epoch: 58, global step: 694] eval development set based on eval_every=2***************
2022-10-17 14:56:51,457 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:51,458 - trainer - INFO - {
  "dev_loss": 0.1218332201121181,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:51,459 - trainer - INFO -   no_improve_count: 30
2022-10-17 14:56:51,459 - trainer - INFO -   patience: 200
2022-10-17 14:56:51,460 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:51,461 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:51,461 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_688
2022-10-17 14:56:51,462 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_694
2022-10-17 14:56:51,468 - trainer - INFO - save model to path: tmp/mlp_digits\ck_694
2022-10-17 14:56:51,530 - trainer - INFO - 
*****************[epoch: 58, global step: 696] eval training set based on eval_every=2***************
2022-10-17 14:56:51,534 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:51,536 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0012637868341016656
}
2022-10-17 14:56:51,817 - trainer - INFO - 
*****************[epoch: 58, global step: 696] eval development set based on eval_every=2***************
2022-10-17 14:56:51,820 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:51,821 - trainer - INFO - {
  "dev_loss": 0.123124816796917,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:51,822 - trainer - INFO -   no_improve_count: 31
2022-10-17 14:56:51,822 - trainer - INFO -   patience: 200
2022-10-17 14:56:51,824 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:51,824 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:51,824 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_690
2022-10-17 14:56:51,826 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_696
2022-10-17 14:56:51,831 - trainer - INFO - save model to path: tmp/mlp_digits\ck_696
2022-10-17 14:56:51,832 - trainer - INFO - 
*****************[epoch: 58, global step: 697] eval training set at end of epoch***************
2022-10-17 14:56:51,840 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:51,842 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0032704017017029705
}
2022-10-17 14:56:51,846 - trainer - INFO - start training epoch 59
2022-10-17 14:56:51,846 - trainer - INFO - training using device=cuda
2022-10-17 14:56:51,846 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:51,847 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:51,912 - trainer - INFO - 
*****************[epoch: 59, global step: 698] eval training set based on eval_every=2***************
2022-10-17 14:56:51,915 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        29
           1       1.00      1.00      1.00        27
           2       1.00      1.00      1.00        33
           3       1.00      1.00      1.00        16
           4       1.00      1.00      1.00        25
           5       1.00      0.96      0.98        25
           6       1.00      1.00      1.00        28
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        26
           9       0.96      1.00      0.98        26

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:51,917 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.010978062462527305
}
2022-10-17 14:56:52,192 - trainer - INFO - 
*****************[epoch: 59, global step: 698] eval development set based on eval_every=2***************
2022-10-17 14:56:52,196 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:52,197 - trainer - INFO - {
  "dev_loss": 0.12583784742309945,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:52,197 - trainer - INFO -   no_improve_count: 32
2022-10-17 14:56:52,198 - trainer - INFO -   patience: 200
2022-10-17 14:56:52,199 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:52,199 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:52,199 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_692
2022-10-17 14:56:52,201 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_698
2022-10-17 14:56:52,205 - trainer - INFO - save model to path: tmp/mlp_digits\ck_698
2022-10-17 14:56:52,275 - trainer - INFO - 
*****************[epoch: 59, global step: 700] eval training set based on eval_every=2***************
2022-10-17 14:56:52,280 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        55
           1       1.00      1.00      1.00        50
           2       1.00      1.00      1.00        55
           3       1.00      1.00      1.00        46
           4       1.00      1.00      1.00        56
           5       1.00      0.98      0.99        53
           6       1.00      1.00      1.00        49
           7       1.00      1.00      1.00        49
           8       1.00      1.00      1.00        51
           9       0.98      1.00      0.99        56

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:52,282 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.0013680267438758165
}
2022-10-17 14:56:52,604 - trainer - INFO - 
*****************[epoch: 59, global step: 700] eval development set based on eval_every=2***************
2022-10-17 14:56:52,607 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:52,608 - trainer - INFO - {
  "dev_loss": 0.12903303271256542,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:52,609 - trainer - INFO -   no_improve_count: 33
2022-10-17 14:56:52,609 - trainer - INFO -   patience: 200
2022-10-17 14:56:52,610 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:52,610 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:52,611 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_694
2022-10-17 14:56:52,612 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_700
2022-10-17 14:56:52,617 - trainer - INFO - save model to path: tmp/mlp_digits\ck_700
2022-10-17 14:56:52,692 - trainer - INFO - 
*****************[epoch: 59, global step: 702] eval training set based on eval_every=2***************
2022-10-17 14:56:52,697 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        85
           1       1.00      1.00      1.00        70
           2       1.00      1.00      1.00        80
           3       1.00      1.00      1.00        84
           4       1.00      1.00      1.00        82
           5       1.00      0.99      0.99        74
           6       1.00      1.00      1.00        75
           7       1.00      1.00      1.00        79
           8       1.00      1.00      1.00        74
           9       0.99      1.00      0.99        77

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:52,698 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.0010112479503732175
}
2022-10-17 14:56:52,972 - trainer - INFO - 
*****************[epoch: 59, global step: 702] eval development set based on eval_every=2***************
2022-10-17 14:56:52,975 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:52,976 - trainer - INFO - {
  "dev_loss": 0.13020698961918242,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:52,977 - trainer - INFO -   no_improve_count: 34
2022-10-17 14:56:52,977 - trainer - INFO -   patience: 200
2022-10-17 14:56:52,978 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:52,979 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:52,979 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_696
2022-10-17 14:56:52,980 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_702
2022-10-17 14:56:52,984 - trainer - INFO - save model to path: tmp/mlp_digits\ck_702
2022-10-17 14:56:53,046 - trainer - INFO - 
*****************[epoch: 59, global step: 704] eval training set based on eval_every=2***************
2022-10-17 14:56:53,049 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       109
           1       1.00      1.00      1.00       101
           2       1.00      1.00      1.00       108
           3       1.00      1.00      1.00       109
           4       1.00      1.00      1.00       111
           5       1.00      0.99      0.99        95
           6       1.00      1.00      1.00       102
           7       1.00      1.00      1.00       106
           8       1.00      1.00      1.00        95
           9       0.99      1.00      1.00       104

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:53,051 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0009870822832453996
}
2022-10-17 14:56:53,320 - trainer - INFO - 
*****************[epoch: 59, global step: 704] eval development set based on eval_every=2***************
2022-10-17 14:56:53,323 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:53,324 - trainer - INFO - {
  "dev_loss": 0.13053015065088402,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:53,325 - trainer - INFO -   no_improve_count: 35
2022-10-17 14:56:53,325 - trainer - INFO -   patience: 200
2022-10-17 14:56:53,326 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:53,327 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:53,327 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_698
2022-10-17 14:56:53,328 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_704
2022-10-17 14:56:53,332 - trainer - INFO - save model to path: tmp/mlp_digits\ck_704
2022-10-17 14:56:53,404 - trainer - INFO - 
*****************[epoch: 59, global step: 706] eval training set based on eval_every=2***************
2022-10-17 14:56:53,409 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       129
           1       1.00      1.00      1.00       129
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       135
           4       1.00      1.00      1.00       134
           5       1.00      0.99      1.00       121
           6       1.00      1.00      1.00       129
           7       1.00      1.00      1.00       136
           8       1.00      1.00      1.00       119
           9       0.99      1.00      1.00       140

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:53,410 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0013794871629215777
}
2022-10-17 14:56:53,742 - trainer - INFO - 
*****************[epoch: 59, global step: 706] eval development set based on eval_every=2***************
2022-10-17 14:56:53,746 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:53,747 - trainer - INFO - {
  "dev_loss": 0.1307474269803303,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:53,748 - trainer - INFO -   no_improve_count: 36
2022-10-17 14:56:53,748 - trainer - INFO -   patience: 200
2022-10-17 14:56:53,749 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:53,750 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:53,750 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_700
2022-10-17 14:56:53,751 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_706
2022-10-17 14:56:53,756 - trainer - INFO - save model to path: tmp/mlp_digits\ck_706
2022-10-17 14:56:53,843 - trainer - INFO - 
*****************[epoch: 59, global step: 708] eval training set based on eval_every=2***************
2022-10-17 14:56:53,846 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:53,848 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.002201493810844113
}
2022-10-17 14:56:54,115 - trainer - INFO - 
*****************[epoch: 59, global step: 708] eval development set based on eval_every=2***************
2022-10-17 14:56:54,118 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:54,119 - trainer - INFO - {
  "dev_loss": 0.13195578888310897,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:54,120 - trainer - INFO -   no_improve_count: 37
2022-10-17 14:56:54,120 - trainer - INFO -   patience: 200
2022-10-17 14:56:54,121 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:54,121 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:54,122 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_702
2022-10-17 14:56:54,123 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_708
2022-10-17 14:56:54,127 - trainer - INFO - save model to path: tmp/mlp_digits\ck_708
2022-10-17 14:56:54,128 - trainer - INFO - 
*****************[epoch: 59, global step: 709] eval training set at end of epoch***************
2022-10-17 14:56:54,134 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:54,136 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0029875667356312383
}
2022-10-17 14:56:54,136 - trainer - INFO - start training epoch 60
2022-10-17 14:56:54,137 - trainer - INFO - training using device=cuda
2022-10-17 14:56:54,137 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:54,137 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:54,207 - trainer - INFO - 
*****************[epoch: 60, global step: 710] eval training set based on eval_every=2***************
2022-10-17 14:56:54,209 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        30
           1       1.00      1.00      1.00        20
           2       1.00      1.00      1.00        24
           3       1.00      1.00      1.00        35
           4       1.00      1.00      1.00        30
           5       1.00      1.00      1.00        23
           6       1.00      1.00      1.00        25
           7       1.00      1.00      1.00        30
           8       1.00      1.00      1.00        18
           9       1.00      1.00      1.00        25

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:54,211 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00033600101596675813
}
2022-10-17 14:56:54,490 - trainer - INFO - 
*****************[epoch: 60, global step: 710] eval development set based on eval_every=2***************
2022-10-17 14:56:54,493 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:54,494 - trainer - INFO - {
  "dev_loss": 0.13271754827777235,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:54,495 - trainer - INFO -   no_improve_count: 38
2022-10-17 14:56:54,495 - trainer - INFO -   patience: 200
2022-10-17 14:56:54,496 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:54,497 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:54,497 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_704
2022-10-17 14:56:54,498 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_710
2022-10-17 14:56:54,502 - trainer - INFO - save model to path: tmp/mlp_digits\ck_710
2022-10-17 14:56:54,567 - trainer - INFO - 
*****************[epoch: 60, global step: 712] eval training set based on eval_every=2***************
2022-10-17 14:56:54,570 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        57
           1       1.00      1.00      1.00        40
           2       1.00      1.00      1.00        53
           3       1.00      1.00      1.00        63
           4       1.00      1.00      1.00        54
           5       1.00      0.98      0.99        44
           6       1.00      1.00      1.00        51
           7       1.00      1.00      1.00        61
           8       1.00      1.00      1.00        45
           9       0.98      1.00      0.99        52

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:54,572 - trainer - INFO - {
  "train_accuracy_score": 0.9980769230769231,
  "train_loss": 0.012115156860090792
}
2022-10-17 14:56:54,833 - trainer - INFO - 
*****************[epoch: 60, global step: 712] eval development set based on eval_every=2***************
2022-10-17 14:56:54,836 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:54,837 - trainer - INFO - {
  "dev_loss": 0.13098679837518526,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:54,838 - trainer - INFO -   no_improve_count: 39
2022-10-17 14:56:54,839 - trainer - INFO -   patience: 200
2022-10-17 14:56:54,840 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:54,840 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:54,840 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_706
2022-10-17 14:56:54,841 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_712
2022-10-17 14:56:54,845 - trainer - INFO - save model to path: tmp/mlp_digits\ck_712
2022-10-17 14:56:54,954 - trainer - INFO - 
*****************[epoch: 60, global step: 714] eval training set based on eval_every=2***************
2022-10-17 14:56:54,958 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        86
           1       1.00      1.00      1.00        67
           2       1.00      1.00      1.00        73
           3       1.00      1.00      1.00        94
           4       1.00      1.00      1.00        79
           5       1.00      0.99      0.99        73
           6       1.00      1.00      1.00        80
           7       1.00      1.00      1.00        76
           8       1.00      1.00      1.00        74
           9       0.99      1.00      0.99        78

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:54,959 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.0006239782378543168
}
2022-10-17 14:56:55,220 - trainer - INFO - 
*****************[epoch: 60, global step: 714] eval development set based on eval_every=2***************
2022-10-17 14:56:55,224 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:55,226 - trainer - INFO - {
  "dev_loss": 0.12673553337420648,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:55,226 - trainer - INFO -   no_improve_count: 40
2022-10-17 14:56:55,227 - trainer - INFO -   patience: 200
2022-10-17 14:56:55,228 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:55,228 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:55,228 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_708
2022-10-17 14:56:55,230 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_714
2022-10-17 14:56:55,234 - trainer - INFO - save model to path: tmp/mlp_digits\ck_714
2022-10-17 14:56:55,300 - trainer - INFO - 
*****************[epoch: 60, global step: 716] eval training set based on eval_every=2***************
2022-10-17 14:56:55,304 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       113
           1       1.00      1.00      1.00        98
           2       1.00      1.00      1.00       104
           3       1.00      1.00      1.00       123
           4       1.00      1.00      1.00       102
           5       1.00      0.99      1.00       102
           6       1.00      1.00      1.00        97
           7       1.00      1.00      1.00       102
           8       1.00      1.00      1.00        95
           9       0.99      1.00      1.00       104

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:55,305 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0007090425497153774
}
2022-10-17 14:56:55,585 - trainer - INFO - 
*****************[epoch: 60, global step: 716] eval development set based on eval_every=2***************
2022-10-17 14:56:55,588 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:55,589 - trainer - INFO - {
  "dev_loss": 0.12344846014699822,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:55,590 - trainer - INFO -   no_improve_count: 41
2022-10-17 14:56:55,590 - trainer - INFO -   patience: 200
2022-10-17 14:56:55,591 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:55,592 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:55,592 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_710
2022-10-17 14:56:55,593 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_716
2022-10-17 14:56:55,597 - trainer - INFO - save model to path: tmp/mlp_digits\ck_716
2022-10-17 14:56:55,660 - trainer - INFO - 
*****************[epoch: 60, global step: 718] eval training set based on eval_every=2***************
2022-10-17 14:56:55,664 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       1.00      1.00      1.00       123
           2       1.00      1.00      1.00       128
           3       1.00      1.00      1.00       139
           4       1.00      1.00      1.00       127
           5       1.00      0.99      1.00       130
           6       1.00      1.00      1.00       133
           7       1.00      1.00      1.00       136
           8       1.00      1.00      1.00       118
           9       0.99      1.00      1.00       132

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:55,665 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.002380233519943431
}
2022-10-17 14:56:55,975 - trainer - INFO - 
*****************[epoch: 60, global step: 718] eval development set based on eval_every=2***************
2022-10-17 14:56:55,979 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:55,980 - trainer - INFO - {
  "dev_loss": 0.12216918308210249,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:55,980 - trainer - INFO -   no_improve_count: 42
2022-10-17 14:56:55,981 - trainer - INFO -   patience: 200
2022-10-17 14:56:55,981 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:55,982 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:55,982 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_712
2022-10-17 14:56:55,983 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_718
2022-10-17 14:56:55,988 - trainer - INFO - save model to path: tmp/mlp_digits\ck_718
2022-10-17 14:56:56,041 - trainer - INFO - 
*****************[epoch: 60, global step: 720] eval training set based on eval_every=2***************
2022-10-17 14:56:56,045 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:56,047 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00029559171525761485
}
2022-10-17 14:56:56,342 - trainer - INFO - 
*****************[epoch: 60, global step: 720] eval development set based on eval_every=2***************
2022-10-17 14:56:56,345 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:56,346 - trainer - INFO - {
  "dev_loss": 0.12201852292006758,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:56,347 - trainer - INFO -   no_improve_count: 43
2022-10-17 14:56:56,347 - trainer - INFO -   patience: 200
2022-10-17 14:56:56,348 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:56,348 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:56,349 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_714
2022-10-17 14:56:56,351 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_720
2022-10-17 14:56:56,354 - trainer - INFO - save model to path: tmp/mlp_digits\ck_720
2022-10-17 14:56:56,356 - trainer - INFO - 
*****************[epoch: 60, global step: 721] eval training set at end of epoch***************
2022-10-17 14:56:56,360 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:56,362 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0027433339831380485
}
2022-10-17 14:56:56,363 - trainer - INFO - start training epoch 61
2022-10-17 14:56:56,363 - trainer - INFO - training using device=cuda
2022-10-17 14:56:56,363 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:56,364 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:56,433 - trainer - INFO - 
*****************[epoch: 61, global step: 722] eval training set based on eval_every=2***************
2022-10-17 14:56:56,436 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       1.00      1.00      1.00        20
           2       1.00      1.00      1.00        22
           3       1.00      1.00      1.00        26
           4       1.00      1.00      1.00        21
           5       1.00      1.00      1.00        28
           6       1.00      1.00      1.00        31
           7       1.00      1.00      1.00        31
           8       1.00      1.00      1.00        24
           9       1.00      1.00      1.00        29

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:56,437 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.002170724001189228
}
2022-10-17 14:56:56,719 - trainer - INFO - 
*****************[epoch: 61, global step: 722] eval development set based on eval_every=2***************
2022-10-17 14:56:56,723 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:56,724 - trainer - INFO - {
  "dev_loss": 0.12451483112818096,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:56,724 - trainer - INFO -   no_improve_count: 44
2022-10-17 14:56:56,725 - trainer - INFO -   patience: 200
2022-10-17 14:56:56,726 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:56,726 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:56,726 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_716
2022-10-17 14:56:56,728 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_722
2022-10-17 14:56:56,733 - trainer - INFO - save model to path: tmp/mlp_digits\ck_722
2022-10-17 14:56:56,800 - trainer - INFO - 
*****************[epoch: 61, global step: 724] eval training set based on eval_every=2***************
2022-10-17 14:56:56,803 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        52
           1       1.00      1.00      1.00        48
           2       1.00      1.00      1.00        53
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        50
           5       1.00      1.00      1.00        56
           6       1.00      1.00      1.00        57
           7       1.00      1.00      1.00        53
           8       1.00      1.00      1.00        45
           9       1.00      1.00      1.00        53

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:56,804 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0003714218473760411
}
2022-10-17 14:56:57,128 - trainer - INFO - 
*****************[epoch: 61, global step: 724] eval development set based on eval_every=2***************
2022-10-17 14:56:57,132 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:57,133 - trainer - INFO - {
  "dev_loss": 0.12601251291440954,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:57,133 - trainer - INFO -   no_improve_count: 45
2022-10-17 14:56:57,133 - trainer - INFO -   patience: 200
2022-10-17 14:56:57,135 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:57,135 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:57,135 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_718
2022-10-17 14:56:57,136 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_724
2022-10-17 14:56:57,141 - trainer - INFO - save model to path: tmp/mlp_digits\ck_724
2022-10-17 14:56:57,218 - trainer - INFO - 
*****************[epoch: 61, global step: 726] eval training set based on eval_every=2***************
2022-10-17 14:56:57,222 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        82
           1       1.00      1.00      1.00        72
           2       1.00      1.00      1.00        78
           3       1.00      1.00      1.00        79
           4       1.00      1.00      1.00        71
           5       1.00      1.00      1.00        86
           6       1.00      1.00      1.00        87
           7       1.00      1.00      1.00        78
           8       1.00      1.00      1.00        71
           9       1.00      1.00      1.00        76

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:57,223 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005806495464639738
}
2022-10-17 14:56:57,527 - trainer - INFO - 
*****************[epoch: 61, global step: 726] eval development set based on eval_every=2***************
2022-10-17 14:56:57,531 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:57,532 - trainer - INFO - {
  "dev_loss": 0.1273215111771909,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:57,533 - trainer - INFO -   no_improve_count: 46
2022-10-17 14:56:57,533 - trainer - INFO -   patience: 200
2022-10-17 14:56:57,534 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:57,534 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:57,534 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_720
2022-10-17 14:56:57,536 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_726
2022-10-17 14:56:57,540 - trainer - INFO - save model to path: tmp/mlp_digits\ck_726
2022-10-17 14:56:57,599 - trainer - INFO - 
*****************[epoch: 61, global step: 728] eval training set based on eval_every=2***************
2022-10-17 14:56:57,603 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       112
           1       1.00      1.00      1.00       102
           2       1.00      1.00      1.00       106
           3       1.00      1.00      1.00       114
           4       1.00      1.00      1.00        93
           5       1.00      1.00      1.00       113
           6       1.00      1.00      1.00       109
           7       1.00      1.00      1.00       104
           8       1.00      1.00      1.00        94
           9       1.00      1.00      1.00        93

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:57,604 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.000814010389149189
}
2022-10-17 14:56:57,866 - trainer - INFO - 
*****************[epoch: 61, global step: 728] eval development set based on eval_every=2***************
2022-10-17 14:56:57,869 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:57,870 - trainer - INFO - {
  "dev_loss": 0.12759543280117214,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:57,871 - trainer - INFO -   no_improve_count: 47
2022-10-17 14:56:57,871 - trainer - INFO -   patience: 200
2022-10-17 14:56:57,872 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:57,872 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:57,873 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_722
2022-10-17 14:56:57,874 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_728
2022-10-17 14:56:57,878 - trainer - INFO - save model to path: tmp/mlp_digits\ck_728
2022-10-17 14:56:57,945 - trainer - INFO - 
*****************[epoch: 61, global step: 730] eval training set based on eval_every=2***************
2022-10-17 14:56:57,949 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       135
           1       1.00      1.00      1.00       129
           2       1.00      1.00      1.00       130
           3       1.00      1.00      1.00       134
           4       1.00      1.00      1.00       123
           5       1.00      0.99      1.00       131
           6       1.00      1.00      1.00       136
           7       1.00      1.00      1.00       130
           8       1.00      1.00      1.00       126
           9       0.99      1.00      1.00       126

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:56:57,951 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.011510361335240304
}
2022-10-17 14:56:58,269 - trainer - INFO - 
*****************[epoch: 61, global step: 730] eval development set based on eval_every=2***************
2022-10-17 14:56:58,272 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:58,277 - trainer - INFO - {
  "dev_loss": 0.12641545873581586,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:58,277 - trainer - INFO -   no_improve_count: 48
2022-10-17 14:56:58,277 - trainer - INFO -   patience: 200
2022-10-17 14:56:58,279 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:58,279 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:58,279 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_724
2022-10-17 14:56:58,280 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_730
2022-10-17 14:56:58,285 - trainer - INFO - save model to path: tmp/mlp_digits\ck_730
2022-10-17 14:56:58,331 - trainer - INFO - 
*****************[epoch: 61, global step: 732] eval training set based on eval_every=2***************
2022-10-17 14:56:58,334 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:58,336 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00038384044455597177
}
2022-10-17 14:56:58,613 - trainer - INFO - 
*****************[epoch: 61, global step: 732] eval development set based on eval_every=2***************
2022-10-17 14:56:58,620 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:58,621 - trainer - INFO - {
  "dev_loss": 0.12582793360343203,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:58,622 - trainer - INFO -   no_improve_count: 49
2022-10-17 14:56:58,622 - trainer - INFO -   patience: 200
2022-10-17 14:56:58,624 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:58,624 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:58,624 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_726
2022-10-17 14:56:58,626 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_732
2022-10-17 14:56:58,634 - trainer - INFO - save model to path: tmp/mlp_digits\ck_732
2022-10-17 14:56:58,636 - trainer - INFO - 
*****************[epoch: 61, global step: 733] eval training set at end of epoch***************
2022-10-17 14:56:58,642 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:56:58,646 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0026385012606624514
}
2022-10-17 14:56:58,647 - trainer - INFO - start training epoch 62
2022-10-17 14:56:58,647 - trainer - INFO - training using device=cuda
2022-10-17 14:56:58,647 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:56:58,647 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:56:58,712 - trainer - INFO - 
*****************[epoch: 62, global step: 734] eval training set based on eval_every=2***************
2022-10-17 14:56:58,715 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       1.00      1.00      1.00        18
           2       1.00      1.00      1.00        28
           3       1.00      1.00      1.00        27
           4       1.00      1.00      1.00        37
           5       1.00      1.00      1.00        27
           6       1.00      1.00      1.00        36
           7       1.00      1.00      1.00        23
           8       1.00      1.00      1.00        13
           9       1.00      1.00      1.00        26

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:56:58,716 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.000878409919096157
}
2022-10-17 14:56:58,990 - trainer - INFO - 
*****************[epoch: 62, global step: 734] eval development set based on eval_every=2***************
2022-10-17 14:56:58,994 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:58,995 - trainer - INFO - {
  "dev_loss": 0.12656146938388702,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:58,995 - trainer - INFO -   no_improve_count: 50
2022-10-17 14:56:58,996 - trainer - INFO -   patience: 200
2022-10-17 14:56:58,997 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:58,997 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:58,997 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_728
2022-10-17 14:56:58,999 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_734
2022-10-17 14:56:59,003 - trainer - INFO - save model to path: tmp/mlp_digits\ck_734
2022-10-17 14:56:59,065 - trainer - INFO - 
*****************[epoch: 62, global step: 736] eval training set based on eval_every=2***************
2022-10-17 14:56:59,068 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        54
           1       1.00      1.00      1.00        51
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        57
           5       1.00      1.00      1.00        47
           6       1.00      1.00      1.00        72
           7       1.00      1.00      1.00        47
           8       1.00      1.00      1.00        34
           9       1.00      1.00      1.00        51

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:56:59,069 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00047096847265493125
}
2022-10-17 14:56:59,390 - trainer - INFO - 
*****************[epoch: 62, global step: 736] eval development set based on eval_every=2***************
2022-10-17 14:56:59,393 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:59,395 - trainer - INFO - {
  "dev_loss": 0.12760864635492908,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:59,395 - trainer - INFO -   no_improve_count: 51
2022-10-17 14:56:59,396 - trainer - INFO -   patience: 200
2022-10-17 14:56:59,397 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:59,397 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:59,397 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_730
2022-10-17 14:56:59,399 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_736
2022-10-17 14:56:59,403 - trainer - INFO - save model to path: tmp/mlp_digits\ck_736
2022-10-17 14:56:59,470 - trainer - INFO - 
*****************[epoch: 62, global step: 738] eval training set based on eval_every=2***************
2022-10-17 14:56:59,473 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        79
           1       1.00      1.00      1.00        83
           2       1.00      1.00      1.00        77
           3       1.00      1.00      1.00        81
           4       1.00      1.00      1.00        79
           5       1.00      1.00      1.00        67
           6       1.00      1.00      1.00        95
           7       1.00      1.00      1.00        80
           8       1.00      1.00      1.00        60
           9       1.00      1.00      1.00        79

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:56:59,475 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0006292246980592608
}
2022-10-17 14:56:59,760 - trainer - INFO - 
*****************[epoch: 62, global step: 738] eval development set based on eval_every=2***************
2022-10-17 14:56:59,764 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:56:59,765 - trainer - INFO - {
  "dev_loss": 0.12748833130171988,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:56:59,766 - trainer - INFO -   no_improve_count: 52
2022-10-17 14:56:59,766 - trainer - INFO -   patience: 200
2022-10-17 14:56:59,767 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:56:59,767 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:56:59,767 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_732
2022-10-17 14:56:59,769 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_738
2022-10-17 14:56:59,773 - trainer - INFO - save model to path: tmp/mlp_digits\ck_738
2022-10-17 14:56:59,838 - trainer - INFO - 
*****************[epoch: 62, global step: 740] eval training set based on eval_every=2***************
2022-10-17 14:56:59,842 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       112
           1       1.00      1.00      1.00       100
           2       1.00      1.00      1.00       106
           3       1.00      1.00      1.00       116
           4       1.00      1.00      1.00       105
           5       1.00      1.00      1.00        90
           6       1.00      1.00      1.00       115
           7       1.00      1.00      1.00       103
           8       1.00      1.00      1.00        81
           9       1.00      1.00      1.00       112

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:56:59,843 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0021551407990045846
}
2022-10-17 14:57:00,121 - trainer - INFO - 
*****************[epoch: 62, global step: 740] eval development set based on eval_every=2***************
2022-10-17 14:57:00,124 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:00,125 - trainer - INFO - {
  "dev_loss": 0.12622723839255437,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:00,126 - trainer - INFO -   no_improve_count: 53
2022-10-17 14:57:00,126 - trainer - INFO -   patience: 200
2022-10-17 14:57:00,127 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:00,128 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:00,128 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_734
2022-10-17 14:57:00,129 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_740
2022-10-17 14:57:00,134 - trainer - INFO - save model to path: tmp/mlp_digits\ck_740
2022-10-17 14:57:00,198 - trainer - INFO - 
*****************[epoch: 62, global step: 742] eval training set based on eval_every=2***************
2022-10-17 14:57:00,201 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       132
           1       1.00      1.00      1.00       126
           2       1.00      1.00      1.00       124
           3       1.00      1.00      1.00       142
           4       1.00      1.00      1.00       132
           5       1.00      1.00      1.00       126
           6       1.00      1.00      1.00       135
           7       1.00      1.00      1.00       129
           8       1.00      1.00      1.00       116
           9       1.00      1.00      1.00       138

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:00,202 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0010253132786601782
}
2022-10-17 14:57:00,474 - trainer - INFO - 
*****************[epoch: 62, global step: 742] eval development set based on eval_every=2***************
2022-10-17 14:57:00,480 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:00,481 - trainer - INFO - {
  "dev_loss": 0.12687725104236355,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:00,482 - trainer - INFO -   no_improve_count: 54
2022-10-17 14:57:00,482 - trainer - INFO -   patience: 200
2022-10-17 14:57:00,483 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:00,484 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:00,484 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_736
2022-10-17 14:57:00,485 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_742
2022-10-17 14:57:00,489 - trainer - INFO - save model to path: tmp/mlp_digits\ck_742
2022-10-17 14:57:00,578 - trainer - INFO - 
*****************[epoch: 62, global step: 744] eval training set based on eval_every=2***************
2022-10-17 14:57:00,581 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:00,582 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.009642476084991358
}
2022-10-17 14:57:00,868 - trainer - INFO - 
*****************[epoch: 62, global step: 744] eval development set based on eval_every=2***************
2022-10-17 14:57:00,871 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:00,872 - trainer - INFO - {
  "dev_loss": 0.1258311866937826,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:00,873 - trainer - INFO -   no_improve_count: 55
2022-10-17 14:57:00,873 - trainer - INFO -   patience: 200
2022-10-17 14:57:00,874 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:00,874 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:00,875 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_738
2022-10-17 14:57:00,877 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_744
2022-10-17 14:57:00,881 - trainer - INFO - save model to path: tmp/mlp_digits\ck_744
2022-10-17 14:57:00,883 - trainer - INFO - 
*****************[epoch: 62, global step: 745] eval training set at end of epoch***************
2022-10-17 14:57:00,889 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:00,891 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.002466922208744412
}
2022-10-17 14:57:00,895 - trainer - INFO - start training epoch 63
2022-10-17 14:57:00,896 - trainer - INFO - training using device=cuda
2022-10-17 14:57:00,896 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:00,896 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:00,961 - trainer - INFO - 
*****************[epoch: 63, global step: 746] eval training set based on eval_every=2***************
2022-10-17 14:57:00,964 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       1.00      1.00      1.00        24
           2       1.00      1.00      1.00        20
           3       1.00      1.00      1.00        26
           4       1.00      1.00      1.00        27
           5       1.00      1.00      1.00        28
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        27
           8       1.00      1.00      1.00        23
           9       1.00      1.00      1.00        31

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:00,965 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0010284892632625997
}
2022-10-17 14:57:01,224 - trainer - INFO - 
*****************[epoch: 63, global step: 746] eval development set based on eval_every=2***************
2022-10-17 14:57:01,229 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:01,230 - trainer - INFO - {
  "dev_loss": 0.12518130030851657,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:01,231 - trainer - INFO -   no_improve_count: 56
2022-10-17 14:57:01,231 - trainer - INFO -   patience: 200
2022-10-17 14:57:01,233 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:01,233 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:01,233 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_740
2022-10-17 14:57:01,235 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_746
2022-10-17 14:57:01,240 - trainer - INFO - save model to path: tmp/mlp_digits\ck_746
2022-10-17 14:57:01,305 - trainer - INFO - 
*****************[epoch: 63, global step: 748] eval training set based on eval_every=2***************
2022-10-17 14:57:01,308 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        48
           1       1.00      1.00      1.00        51
           2       1.00      1.00      1.00        52
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        48
           5       1.00      1.00      1.00        62
           6       1.00      1.00      1.00        58
           7       1.00      1.00      1.00        49
           8       1.00      1.00      1.00        41
           9       1.00      1.00      1.00        58

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:01,310 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0008517753449268639
}
2022-10-17 14:57:01,583 - trainer - INFO - 
*****************[epoch: 63, global step: 748] eval development set based on eval_every=2***************
2022-10-17 14:57:01,586 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:01,587 - trainer - INFO - {
  "dev_loss": 0.12485312878682937,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:01,587 - trainer - INFO -   no_improve_count: 57
2022-10-17 14:57:01,588 - trainer - INFO -   patience: 200
2022-10-17 14:57:01,589 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:01,593 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:01,593 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_742
2022-10-17 14:57:01,594 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_748
2022-10-17 14:57:01,599 - trainer - INFO - save model to path: tmp/mlp_digits\ck_748
2022-10-17 14:57:01,708 - trainer - INFO - 
*****************[epoch: 63, global step: 750] eval training set based on eval_every=2***************
2022-10-17 14:57:01,712 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        68
           1       1.00      1.00      1.00        75
           2       1.00      1.00      1.00        81
           3       1.00      1.00      1.00        89
           4       1.00      1.00      1.00        79
           5       1.00      0.99      0.99        84
           6       1.00      1.00      1.00        81
           7       1.00      1.00      1.00        75
           8       1.00      1.00      1.00        73
           9       0.99      1.00      0.99        75

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:01,713 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.00938313637743704
}
2022-10-17 14:57:01,978 - trainer - INFO - 
*****************[epoch: 63, global step: 750] eval development set based on eval_every=2***************
2022-10-17 14:57:01,981 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:01,982 - trainer - INFO - {
  "dev_loss": 0.12485490107549897,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:01,983 - trainer - INFO -   no_improve_count: 58
2022-10-17 14:57:01,983 - trainer - INFO -   patience: 200
2022-10-17 14:57:01,984 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:01,984 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:01,985 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_744
2022-10-17 14:57:01,986 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_750
2022-10-17 14:57:01,991 - trainer - INFO - save model to path: tmp/mlp_digits\ck_750
2022-10-17 14:57:02,056 - trainer - INFO - 
*****************[epoch: 63, global step: 752] eval training set based on eval_every=2***************
2022-10-17 14:57:02,060 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        97
           1       1.00      1.00      1.00        98
           2       1.00      1.00      1.00       109
           3       1.00      1.00      1.00       110
           4       1.00      1.00      1.00       112
           5       1.00      0.99      1.00       108
           6       1.00      1.00      1.00       100
           7       1.00      1.00      1.00        98
           8       1.00      1.00      1.00       105
           9       0.99      1.00      1.00       103

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:02,061 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0005916204681852832
}
2022-10-17 14:57:02,335 - trainer - INFO - 
*****************[epoch: 63, global step: 752] eval development set based on eval_every=2***************
2022-10-17 14:57:02,338 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:02,339 - trainer - INFO - {
  "dev_loss": 0.12470987227303947,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:02,339 - trainer - INFO -   no_improve_count: 59
2022-10-17 14:57:02,340 - trainer - INFO -   patience: 200
2022-10-17 14:57:02,341 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:02,341 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:02,341 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_746
2022-10-17 14:57:02,342 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_752
2022-10-17 14:57:02,346 - trainer - INFO - save model to path: tmp/mlp_digits\ck_752
2022-10-17 14:57:02,417 - trainer - INFO - 
*****************[epoch: 63, global step: 754] eval training set based on eval_every=2***************
2022-10-17 14:57:02,421 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       132
           1       1.00      1.00      1.00       128
           2       1.00      1.00      1.00       125
           3       1.00      1.00      1.00       140
           4       1.00      1.00      1.00       139
           5       1.00      0.99      1.00       134
           6       1.00      1.00      1.00       122
           7       1.00      1.00      1.00       126
           8       1.00      1.00      1.00       121
           9       0.99      1.00      1.00       133

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:02,422 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0013356244890019298
}
2022-10-17 14:57:02,746 - trainer - INFO - 
*****************[epoch: 63, global step: 754] eval development set based on eval_every=2***************
2022-10-17 14:57:02,749 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:02,749 - trainer - INFO - {
  "dev_loss": 0.1269794000594023,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:02,750 - trainer - INFO -   no_improve_count: 60
2022-10-17 14:57:02,751 - trainer - INFO -   patience: 200
2022-10-17 14:57:02,751 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:02,755 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:02,755 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_748
2022-10-17 14:57:02,756 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_754
2022-10-17 14:57:02,761 - trainer - INFO - save model to path: tmp/mlp_digits\ck_754
2022-10-17 14:57:02,804 - trainer - INFO - 
*****************[epoch: 63, global step: 756] eval training set based on eval_every=2***************
2022-10-17 14:57:02,809 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:02,811 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00014715569886902813
}
2022-10-17 14:57:03,091 - trainer - INFO - 
*****************[epoch: 63, global step: 756] eval development set based on eval_every=2***************
2022-10-17 14:57:03,095 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:03,096 - trainer - INFO - {
  "dev_loss": 0.12809113099016636,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:03,097 - trainer - INFO -   no_improve_count: 61
2022-10-17 14:57:03,097 - trainer - INFO -   patience: 200
2022-10-17 14:57:03,098 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:03,099 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:03,099 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_750
2022-10-17 14:57:03,100 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_756
2022-10-17 14:57:03,104 - trainer - INFO - save model to path: tmp/mlp_digits\ck_756
2022-10-17 14:57:03,106 - trainer - INFO - 
*****************[epoch: 63, global step: 757] eval training set at end of epoch***************
2022-10-17 14:57:03,111 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:03,115 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0022229669402804575
}
2022-10-17 14:57:03,116 - trainer - INFO - start training epoch 64
2022-10-17 14:57:03,116 - trainer - INFO - training using device=cuda
2022-10-17 14:57:03,117 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:03,117 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:03,179 - trainer - INFO - 
*****************[epoch: 64, global step: 758] eval training set based on eval_every=2***************
2022-10-17 14:57:03,181 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        31
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        25
           3       1.00      1.00      1.00        25
           4       1.00      1.00      1.00        31
           5       1.00      1.00      1.00        22
           6       1.00      1.00      1.00        25
           7       1.00      1.00      1.00        28
           8       1.00      1.00      1.00        27
           9       1.00      1.00      1.00        20

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:03,182 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0006049372022971511
}
2022-10-17 14:57:03,444 - trainer - INFO - 
*****************[epoch: 64, global step: 758] eval development set based on eval_every=2***************
2022-10-17 14:57:03,447 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:03,448 - trainer - INFO - {
  "dev_loss": 0.12950807839418607,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:03,449 - trainer - INFO -   no_improve_count: 62
2022-10-17 14:57:03,449 - trainer - INFO -   patience: 200
2022-10-17 14:57:03,453 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:03,453 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:03,453 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_752
2022-10-17 14:57:03,455 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_758
2022-10-17 14:57:03,459 - trainer - INFO - save model to path: tmp/mlp_digits\ck_758
2022-10-17 14:57:03,515 - trainer - INFO - 
*****************[epoch: 64, global step: 760] eval training set based on eval_every=2***************
2022-10-17 14:57:03,519 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        61
           1       1.00      1.00      1.00        47
           2       1.00      1.00      1.00        51
           3       1.00      1.00      1.00        53
           4       1.00      1.00      1.00        54
           5       1.00      1.00      1.00        44
           6       1.00      1.00      1.00        52
           7       1.00      1.00      1.00        54
           8       1.00      1.00      1.00        50
           9       1.00      1.00      1.00        54

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:03,520 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0012424215383362025
}
2022-10-17 14:57:03,868 - trainer - INFO - 
*****************[epoch: 64, global step: 760] eval development set based on eval_every=2***************
2022-10-17 14:57:03,871 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:03,872 - trainer - INFO - {
  "dev_loss": 0.13067802876563897,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:03,873 - trainer - INFO -   no_improve_count: 63
2022-10-17 14:57:03,874 - trainer - INFO -   patience: 200
2022-10-17 14:57:03,875 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:03,875 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:03,875 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_754
2022-10-17 14:57:03,877 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_760
2022-10-17 14:57:03,881 - trainer - INFO - save model to path: tmp/mlp_digits\ck_760
2022-10-17 14:57:03,954 - trainer - INFO - 
*****************[epoch: 64, global step: 762] eval training set based on eval_every=2***************
2022-10-17 14:57:03,958 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        83
           1       1.00      1.00      1.00        73
           2       1.00      1.00      1.00        70
           3       1.00      1.00      1.00        76
           4       1.00      1.00      1.00        78
           5       1.00      1.00      1.00        79
           6       1.00      1.00      1.00        78
           7       1.00      1.00      1.00        79
           8       1.00      1.00      1.00        79
           9       1.00      1.00      1.00        85

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:03,960 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0012381056585581973
}
2022-10-17 14:57:04,231 - trainer - INFO - 
*****************[epoch: 64, global step: 762] eval development set based on eval_every=2***************
2022-10-17 14:57:04,234 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:04,235 - trainer - INFO - {
  "dev_loss": 0.13184353399507623,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:04,236 - trainer - INFO -   no_improve_count: 64
2022-10-17 14:57:04,236 - trainer - INFO -   patience: 200
2022-10-17 14:57:04,237 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:04,237 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:04,237 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_756
2022-10-17 14:57:04,239 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_762
2022-10-17 14:57:04,245 - trainer - INFO - save model to path: tmp/mlp_digits\ck_762
2022-10-17 14:57:04,318 - trainer - INFO - 
*****************[epoch: 64, global step: 764] eval training set based on eval_every=2***************
2022-10-17 14:57:04,321 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       104
           1       1.00      1.00      1.00        94
           2       1.00      1.00      1.00        98
           3       1.00      1.00      1.00       101
           4       1.00      1.00      1.00       108
           5       1.00      0.99      1.00       106
           6       1.00      1.00      1.00       112
           7       1.00      1.00      1.00       106
           8       1.00      1.00      1.00       101
           9       0.99      1.00      1.00       110

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:04,323 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.00896745070349425
}
2022-10-17 14:57:04,601 - trainer - INFO - 
*****************[epoch: 64, global step: 764] eval development set based on eval_every=2***************
2022-10-17 14:57:04,604 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:04,605 - trainer - INFO - {
  "dev_loss": 0.13319005455317287,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:04,606 - trainer - INFO -   no_improve_count: 65
2022-10-17 14:57:04,606 - trainer - INFO -   patience: 200
2022-10-17 14:57:04,607 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:04,608 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:04,608 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_758
2022-10-17 14:57:04,609 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_764
2022-10-17 14:57:04,616 - trainer - INFO - save model to path: tmp/mlp_digits\ck_764
2022-10-17 14:57:04,689 - trainer - INFO - 
*****************[epoch: 64, global step: 766] eval training set based on eval_every=2***************
2022-10-17 14:57:04,693 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       1.00      1.00      1.00       123
           2       1.00      1.00      1.00       129
           3       1.00      1.00      1.00       135
           4       1.00      1.00      1.00       129
           5       1.00      0.99      1.00       131
           6       1.00      1.00      1.00       132
           7       1.00      1.00      1.00       132
           8       1.00      1.00      1.00       119
           9       0.99      1.00      1.00       136

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:04,695 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0004025312082376331
}
2022-10-17 14:57:05,003 - trainer - INFO - 
*****************[epoch: 64, global step: 766] eval development set based on eval_every=2***************
2022-10-17 14:57:05,008 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:05,009 - trainer - INFO - {
  "dev_loss": 0.13471590053328933,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:05,009 - trainer - INFO -   no_improve_count: 66
2022-10-17 14:57:05,010 - trainer - INFO -   patience: 200
2022-10-17 14:57:05,011 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:05,011 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:05,011 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_760
2022-10-17 14:57:05,013 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_766
2022-10-17 14:57:05,020 - trainer - INFO - save model to path: tmp/mlp_digits\ck_766
2022-10-17 14:57:05,068 - trainer - INFO - 
*****************[epoch: 64, global step: 768] eval training set based on eval_every=2***************
2022-10-17 14:57:05,072 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:05,074 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00020824402781727258
}
2022-10-17 14:57:05,324 - trainer - INFO - 
*****************[epoch: 64, global step: 768] eval development set based on eval_every=2***************
2022-10-17 14:57:05,329 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:05,330 - trainer - INFO - {
  "dev_loss": 0.1362029049244787,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:05,331 - trainer - INFO -   no_improve_count: 67
2022-10-17 14:57:05,331 - trainer - INFO -   patience: 200
2022-10-17 14:57:05,332 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:05,332 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:05,333 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_762
2022-10-17 14:57:05,334 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_768
2022-10-17 14:57:05,338 - trainer - INFO - save model to path: tmp/mlp_digits\ck_768
2022-10-17 14:57:05,345 - trainer - INFO - 
*****************[epoch: 64, global step: 769] eval training set at end of epoch***************
2022-10-17 14:57:05,352 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:05,355 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0021106150564567847
}
2022-10-17 14:57:05,356 - trainer - INFO - start training epoch 65
2022-10-17 14:57:05,356 - trainer - INFO - training using device=cuda
2022-10-17 14:57:05,356 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:05,357 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:05,422 - trainer - INFO - 
*****************[epoch: 65, global step: 770] eval training set based on eval_every=2***************
2022-10-17 14:57:05,425 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        24
           1       1.00      1.00      1.00        18
           2       1.00      1.00      1.00        31
           3       1.00      1.00      1.00        31
           4       1.00      1.00      1.00        22
           5       1.00      1.00      1.00        26
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        22
           8       1.00      1.00      1.00        30
           9       1.00      1.00      1.00        30

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:05,426 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005727809621021152
}
2022-10-17 14:57:05,727 - trainer - INFO - 
*****************[epoch: 65, global step: 770] eval development set based on eval_every=2***************
2022-10-17 14:57:05,730 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:05,733 - trainer - INFO - {
  "dev_loss": 0.13750217667499479,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:05,734 - trainer - INFO -   no_improve_count: 68
2022-10-17 14:57:05,734 - trainer - INFO -   patience: 200
2022-10-17 14:57:05,736 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:05,736 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:05,736 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_764
2022-10-17 14:57:05,738 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_770
2022-10-17 14:57:05,744 - trainer - INFO - save model to path: tmp/mlp_digits\ck_770
2022-10-17 14:57:05,809 - trainer - INFO - 
*****************[epoch: 65, global step: 772] eval training set based on eval_every=2***************
2022-10-17 14:57:05,812 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        48
           1       1.00      1.00      1.00        41
           2       1.00      1.00      1.00        59
           3       1.00      1.00      1.00        57
           4       1.00      1.00      1.00        59
           5       1.00      1.00      1.00        46
           6       1.00      1.00      1.00        55
           7       1.00      1.00      1.00        44
           8       1.00      1.00      1.00        53
           9       1.00      1.00      1.00        58

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:05,813 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.001720038999337703
}
2022-10-17 14:57:06,123 - trainer - INFO - 
*****************[epoch: 65, global step: 772] eval development set based on eval_every=2***************
2022-10-17 14:57:06,127 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:06,128 - trainer - INFO - {
  "dev_loss": 0.13748050807528975,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:06,129 - trainer - INFO -   no_improve_count: 69
2022-10-17 14:57:06,130 - trainer - INFO -   patience: 200
2022-10-17 14:57:06,131 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:06,135 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:06,135 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_766
2022-10-17 14:57:06,137 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_772
2022-10-17 14:57:06,142 - trainer - INFO - save model to path: tmp/mlp_digits\ck_772
2022-10-17 14:57:06,205 - trainer - INFO - 
*****************[epoch: 65, global step: 774] eval training set based on eval_every=2***************
2022-10-17 14:57:06,209 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      1.00      1.00        62
           2       1.00      1.00      1.00        80
           3       1.00      1.00      1.00        79
           4       1.00      1.00      1.00        83
           5       1.00      1.00      1.00        81
           6       1.00      1.00      1.00        82
           7       1.00      1.00      1.00        74
           8       1.00      1.00      1.00        74
           9       1.00      1.00      1.00        85

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:06,210 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0016311932704411447
}
2022-10-17 14:57:06,490 - trainer - INFO - 
*****************[epoch: 65, global step: 774] eval development set based on eval_every=2***************
2022-10-17 14:57:06,493 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:06,494 - trainer - INFO - {
  "dev_loss": 0.13838798479991965,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:06,495 - trainer - INFO -   no_improve_count: 70
2022-10-17 14:57:06,495 - trainer - INFO -   patience: 200
2022-10-17 14:57:06,497 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:06,497 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:06,497 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_768
2022-10-17 14:57:06,499 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_774
2022-10-17 14:57:06,503 - trainer - INFO - save model to path: tmp/mlp_digits\ck_774
2022-10-17 14:57:06,568 - trainer - INFO - 
*****************[epoch: 65, global step: 776] eval training set based on eval_every=2***************
2022-10-17 14:57:06,572 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00        98
           2       1.00      1.00      1.00       106
           3       1.00      1.00      1.00       105
           4       1.00      1.00      1.00       107
           5       1.00      1.00      1.00        98
           6       1.00      1.00      1.00       106
           7       1.00      1.00      1.00       105
           8       1.00      1.00      1.00        99
           9       1.00      1.00      1.00       109

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:06,573 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0004122266545891762
}
2022-10-17 14:57:06,865 - trainer - INFO - 
*****************[epoch: 65, global step: 776] eval development set based on eval_every=2***************
2022-10-17 14:57:06,869 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:06,870 - trainer - INFO - {
  "dev_loss": 0.13927828597661573,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:06,871 - trainer - INFO -   no_improve_count: 71
2022-10-17 14:57:06,872 - trainer - INFO -   patience: 200
2022-10-17 14:57:06,873 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:06,874 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:06,875 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_770
2022-10-17 14:57:06,877 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_776
2022-10-17 14:57:06,887 - trainer - INFO - save model to path: tmp/mlp_digits\ck_776
2022-10-17 14:57:06,963 - trainer - INFO - 
*****************[epoch: 65, global step: 778] eval training set based on eval_every=2***************
2022-10-17 14:57:06,967 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       129
           1       1.00      1.00      1.00       128
           2       1.00      1.00      1.00       134
           3       1.00      1.00      1.00       135
           4       1.00      1.00      1.00       132
           5       1.00      0.99      1.00       130
           6       1.00      1.00      1.00       125
           7       1.00      1.00      1.00       133
           8       1.00      1.00      1.00       119
           9       0.99      1.00      1.00       135

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:06,968 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.008117432123981416
}
2022-10-17 14:57:07,246 - trainer - INFO - 
*****************[epoch: 65, global step: 778] eval development set based on eval_every=2***************
2022-10-17 14:57:07,252 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:07,253 - trainer - INFO - {
  "dev_loss": 0.1390434247199058,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:07,253 - trainer - INFO -   no_improve_count: 72
2022-10-17 14:57:07,254 - trainer - INFO -   patience: 200
2022-10-17 14:57:07,255 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:07,256 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:07,256 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_772
2022-10-17 14:57:07,257 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_778
2022-10-17 14:57:07,262 - trainer - INFO - save model to path: tmp/mlp_digits\ck_778
2022-10-17 14:57:07,360 - trainer - INFO - 
*****************[epoch: 65, global step: 780] eval training set based on eval_every=2***************
2022-10-17 14:57:07,363 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:07,365 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00023050999925544602
}
2022-10-17 14:57:07,625 - trainer - INFO - 
*****************[epoch: 65, global step: 780] eval development set based on eval_every=2***************
2022-10-17 14:57:07,627 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:07,628 - trainer - INFO - {
  "dev_loss": 0.13884191954760658,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:07,628 - trainer - INFO -   no_improve_count: 73
2022-10-17 14:57:07,629 - trainer - INFO -   patience: 200
2022-10-17 14:57:07,629 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:07,630 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:07,630 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_774
2022-10-17 14:57:07,631 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_780
2022-10-17 14:57:07,638 - trainer - INFO - save model to path: tmp/mlp_digits\ck_780
2022-10-17 14:57:07,639 - trainer - INFO - 
*****************[epoch: 65, global step: 781] eval training set at end of epoch***************
2022-10-17 14:57:07,644 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:07,646 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.002114030334951167
}
2022-10-17 14:57:07,646 - trainer - INFO - start training epoch 66
2022-10-17 14:57:07,647 - trainer - INFO - training using device=cuda
2022-10-17 14:57:07,647 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:07,647 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:07,715 - trainer - INFO - 
*****************[epoch: 66, global step: 782] eval training set based on eval_every=2***************
2022-10-17 14:57:07,718 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        31
           1       1.00      1.00      1.00        26
           2       1.00      1.00      1.00        29
           3       1.00      1.00      1.00        22
           4       1.00      1.00      1.00        24
           5       1.00      1.00      1.00        29
           6       1.00      1.00      1.00        31
           7       1.00      1.00      1.00        21
           8       1.00      1.00      1.00        21
           9       1.00      1.00      1.00        26

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:07,719 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0012754436465911567
}
2022-10-17 14:57:07,975 - trainer - INFO - 
*****************[epoch: 66, global step: 782] eval development set based on eval_every=2***************
2022-10-17 14:57:07,978 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:07,978 - trainer - INFO - {
  "dev_loss": 0.13859597862998876,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:07,979 - trainer - INFO -   no_improve_count: 74
2022-10-17 14:57:07,979 - trainer - INFO -   patience: 200
2022-10-17 14:57:07,980 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:07,980 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:07,980 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_776
2022-10-17 14:57:07,982 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_782
2022-10-17 14:57:07,985 - trainer - INFO - save model to path: tmp/mlp_digits\ck_782
2022-10-17 14:57:08,053 - trainer - INFO - 
*****************[epoch: 66, global step: 784] eval training set based on eval_every=2***************
2022-10-17 14:57:08,056 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        55
           1       1.00      1.00      1.00        54
           2       1.00      1.00      1.00        42
           3       1.00      1.00      1.00        56
           4       1.00      1.00      1.00        53
           5       1.00      1.00      1.00        57
           6       1.00      1.00      1.00        58
           7       1.00      1.00      1.00        50
           8       1.00      1.00      1.00        44
           9       1.00      1.00      1.00        51

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:08,057 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00033767907007131726
}
2022-10-17 14:57:08,314 - trainer - INFO - 
*****************[epoch: 66, global step: 784] eval development set based on eval_every=2***************
2022-10-17 14:57:08,320 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:08,321 - trainer - INFO - {
  "dev_loss": 0.13861051168108438,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:08,322 - trainer - INFO -   no_improve_count: 75
2022-10-17 14:57:08,322 - trainer - INFO -   patience: 200
2022-10-17 14:57:08,323 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:08,324 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:08,324 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_778
2022-10-17 14:57:08,325 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_784
2022-10-17 14:57:08,329 - trainer - INFO - save model to path: tmp/mlp_digits\ck_784
2022-10-17 14:57:08,445 - trainer - INFO - 
*****************[epoch: 66, global step: 786] eval training set based on eval_every=2***************
2022-10-17 14:57:08,449 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        83
           1       1.00      1.00      1.00        85
           2       1.00      1.00      1.00        73
           3       1.00      1.00      1.00        77
           4       1.00      1.00      1.00        75
           5       1.00      1.00      1.00        75
           6       1.00      1.00      1.00        83
           7       1.00      1.00      1.00        77
           8       1.00      1.00      1.00        64
           9       1.00      1.00      1.00        88

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:08,450 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0009454483515582979
}
2022-10-17 14:57:08,717 - trainer - INFO - 
*****************[epoch: 66, global step: 786] eval development set based on eval_every=2***************
2022-10-17 14:57:08,721 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:08,723 - trainer - INFO - {
  "dev_loss": 0.14065303291620998,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:08,723 - trainer - INFO -   no_improve_count: 76
2022-10-17 14:57:08,724 - trainer - INFO -   patience: 200
2022-10-17 14:57:08,725 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:08,725 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:08,725 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_780
2022-10-17 14:57:08,726 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_786
2022-10-17 14:57:08,731 - trainer - INFO - save model to path: tmp/mlp_digits\ck_786
2022-10-17 14:57:08,799 - trainer - INFO - 
*****************[epoch: 66, global step: 788] eval training set based on eval_every=2***************
2022-10-17 14:57:08,802 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       104
           1       1.00      1.00      1.00       106
           2       1.00      1.00      1.00       104
           3       1.00      1.00      1.00       104
           4       1.00      1.00      1.00        93
           5       1.00      1.00      1.00       111
           6       1.00      1.00      1.00       114
           7       1.00      1.00      1.00       102
           8       1.00      1.00      1.00        97
           9       1.00      1.00      1.00       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:08,804 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0003489658120088279
}
2022-10-17 14:57:09,062 - trainer - INFO - 
*****************[epoch: 66, global step: 788] eval development set based on eval_every=2***************
2022-10-17 14:57:09,067 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:09,068 - trainer - INFO - {
  "dev_loss": 0.14179442206659587,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:09,068 - trainer - INFO -   no_improve_count: 77
2022-10-17 14:57:09,069 - trainer - INFO -   patience: 200
2022-10-17 14:57:09,070 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:09,070 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:09,070 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_782
2022-10-17 14:57:09,072 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_788
2022-10-17 14:57:09,077 - trainer - INFO - save model to path: tmp/mlp_digits\ck_788
2022-10-17 14:57:09,145 - trainer - INFO - 
*****************[epoch: 66, global step: 790] eval training set based on eval_every=2***************
2022-10-17 14:57:09,149 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       123
           1       1.00      1.00      1.00       131
           2       1.00      1.00      1.00       131
           3       1.00      1.00      1.00       130
           4       1.00      1.00      1.00       129
           5       1.00      0.99      1.00       131
           6       1.00      1.00      1.00       129
           7       1.00      1.00      1.00       141
           8       1.00      1.00      1.00       125
           9       0.99      1.00      1.00       130

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:09,150 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.007844757288694382
}
2022-10-17 14:57:09,458 - trainer - INFO - 
*****************[epoch: 66, global step: 790] eval development set based on eval_every=2***************
2022-10-17 14:57:09,461 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:09,462 - trainer - INFO - {
  "dev_loss": 0.14048083190088315,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:09,463 - trainer - INFO -   no_improve_count: 78
2022-10-17 14:57:09,463 - trainer - INFO -   patience: 200
2022-10-17 14:57:09,467 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:09,467 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:09,467 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_784
2022-10-17 14:57:09,469 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_790
2022-10-17 14:57:09,474 - trainer - INFO - save model to path: tmp/mlp_digits\ck_790
2022-10-17 14:57:09,527 - trainer - INFO - 
*****************[epoch: 66, global step: 792] eval training set based on eval_every=2***************
2022-10-17 14:57:09,531 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:09,532 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00018438926781527698
}
2022-10-17 14:57:09,797 - trainer - INFO - 
*****************[epoch: 66, global step: 792] eval development set based on eval_every=2***************
2022-10-17 14:57:09,801 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:09,801 - trainer - INFO - {
  "dev_loss": 0.13927707293623826,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:09,802 - trainer - INFO -   no_improve_count: 79
2022-10-17 14:57:09,802 - trainer - INFO -   patience: 200
2022-10-17 14:57:09,803 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:09,804 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:09,804 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_786
2022-10-17 14:57:09,806 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_792
2022-10-17 14:57:09,813 - trainer - INFO - save model to path: tmp/mlp_digits\ck_792
2022-10-17 14:57:09,814 - trainer - INFO - 
*****************[epoch: 66, global step: 793] eval training set at end of epoch***************
2022-10-17 14:57:09,820 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:09,823 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0018227805727898765
}
2022-10-17 14:57:09,824 - trainer - INFO - start training epoch 67
2022-10-17 14:57:09,824 - trainer - INFO - training using device=cuda
2022-10-17 14:57:09,824 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:09,825 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:09,886 - trainer - INFO - 
*****************[epoch: 67, global step: 794] eval training set based on eval_every=2***************
2022-10-17 14:57:09,889 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        30
           1       1.00      1.00      1.00        33
           2       1.00      1.00      1.00        34
           3       1.00      1.00      1.00        18
           4       1.00      1.00      1.00        18
           5       1.00      1.00      1.00        27
           6       1.00      1.00      1.00        23
           7       1.00      1.00      1.00        25
           8       1.00      1.00      1.00        22
           9       1.00      1.00      1.00        30

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:09,890 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00022769904535380192
}
2022-10-17 14:57:10,152 - trainer - INFO - 
*****************[epoch: 67, global step: 794] eval development set based on eval_every=2***************
2022-10-17 14:57:10,157 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:10,158 - trainer - INFO - {
  "dev_loss": 0.1393117589953666,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:10,159 - trainer - INFO -   no_improve_count: 80
2022-10-17 14:57:10,160 - trainer - INFO -   patience: 200
2022-10-17 14:57:10,161 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:10,161 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:10,161 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_788
2022-10-17 14:57:10,163 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_794
2022-10-17 14:57:10,167 - trainer - INFO - save model to path: tmp/mlp_digits\ck_794
2022-10-17 14:57:10,230 - trainer - INFO - 
*****************[epoch: 67, global step: 796] eval training set based on eval_every=2***************
2022-10-17 14:57:10,232 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        54
           1       1.00      1.00      1.00        61
           2       1.00      1.00      1.00        62
           3       1.00      1.00      1.00        47
           4       1.00      1.00      1.00        42
           5       1.00      1.00      1.00        50
           6       1.00      1.00      1.00        42
           7       1.00      1.00      1.00        49
           8       1.00      1.00      1.00        49
           9       1.00      1.00      1.00        64

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:10,234 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005685596552211791
}
2022-10-17 14:57:10,553 - trainer - INFO - 
*****************[epoch: 67, global step: 796] eval development set based on eval_every=2***************
2022-10-17 14:57:10,557 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:10,558 - trainer - INFO - {
  "dev_loss": 0.13937794380278015,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:10,559 - trainer - INFO -   no_improve_count: 81
2022-10-17 14:57:10,559 - trainer - INFO -   patience: 200
2022-10-17 14:57:10,560 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:10,560 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:10,560 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_790
2022-10-17 14:57:10,562 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_796
2022-10-17 14:57:10,568 - trainer - INFO - save model to path: tmp/mlp_digits\ck_796
2022-10-17 14:57:10,632 - trainer - INFO - 
*****************[epoch: 67, global step: 798] eval training set based on eval_every=2***************
2022-10-17 14:57:10,635 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        78
           1       1.00      1.00      1.00        85
           2       1.00      1.00      1.00        84
           3       1.00      1.00      1.00        79
           4       1.00      1.00      1.00        73
           5       1.00      0.99      0.99        74
           6       1.00      1.00      1.00        66
           7       1.00      1.00      1.00        74
           8       1.00      1.00      1.00        70
           9       0.99      1.00      0.99        97

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:10,637 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.007787841808749363
}
2022-10-17 14:57:10,891 - trainer - INFO - 
*****************[epoch: 67, global step: 798] eval development set based on eval_every=2***************
2022-10-17 14:57:10,894 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:10,895 - trainer - INFO - {
  "dev_loss": 0.14328979901135122,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:10,896 - trainer - INFO -   no_improve_count: 82
2022-10-17 14:57:10,896 - trainer - INFO -   patience: 200
2022-10-17 14:57:10,898 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:10,898 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:10,898 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_792
2022-10-17 14:57:10,900 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_798
2022-10-17 14:57:10,905 - trainer - INFO - save model to path: tmp/mlp_digits\ck_798
2022-10-17 14:57:10,976 - trainer - INFO - 
*****************[epoch: 67, global step: 800] eval training set based on eval_every=2***************
2022-10-17 14:57:10,979 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       103
           1       1.00      1.00      1.00       108
           2       1.00      1.00      1.00       114
           3       1.00      1.00      1.00       105
           4       1.00      1.00      1.00       103
           5       1.00      0.99      0.99        84
           6       1.00      1.00      1.00       104
           7       1.00      1.00      1.00       107
           8       1.00      1.00      1.00        95
           9       0.99      1.00      1.00       117

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:10,981 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0016581429081270471
}
2022-10-17 14:57:11,244 - trainer - INFO - 
*****************[epoch: 67, global step: 800] eval development set based on eval_every=2***************
2022-10-17 14:57:11,249 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:11,250 - trainer - INFO - {
  "dev_loss": 0.1461706179106841,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:11,250 - trainer - INFO -   no_improve_count: 83
2022-10-17 14:57:11,250 - trainer - INFO -   patience: 200
2022-10-17 14:57:11,251 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:11,252 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:11,252 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_794
2022-10-17 14:57:11,253 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_800
2022-10-17 14:57:11,257 - trainer - INFO - save model to path: tmp/mlp_digits\ck_800
2022-10-17 14:57:11,332 - trainer - INFO - 
*****************[epoch: 67, global step: 802] eval training set based on eval_every=2***************
2022-10-17 14:57:11,335 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       1.00      1.00      1.00       129
           2       1.00      1.00      1.00       135
           3       1.00      1.00      1.00       132
           4       1.00      1.00      1.00       129
           5       1.00      0.99      1.00       128
           6       1.00      1.00      1.00       133
           7       1.00      1.00      1.00       134
           8       1.00      1.00      1.00       118
           9       0.99      1.00      1.00       132

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:11,337 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.00045970428618602455
}
2022-10-17 14:57:11,648 - trainer - INFO - 
*****************[epoch: 67, global step: 802] eval development set based on eval_every=2***************
2022-10-17 14:57:11,653 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:11,654 - trainer - INFO - {
  "dev_loss": 0.14884985701549644,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:11,655 - trainer - INFO -   no_improve_count: 84
2022-10-17 14:57:11,655 - trainer - INFO -   patience: 200
2022-10-17 14:57:11,657 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:11,657 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:11,657 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_796
2022-10-17 14:57:11,659 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_802
2022-10-17 14:57:11,664 - trainer - INFO - save model to path: tmp/mlp_digits\ck_802
2022-10-17 14:57:11,713 - trainer - INFO - 
*****************[epoch: 67, global step: 804] eval training set based on eval_every=2***************
2022-10-17 14:57:11,716 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:11,718 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0016215034702327102
}
2022-10-17 14:57:11,970 - trainer - INFO - 
*****************[epoch: 67, global step: 804] eval development set based on eval_every=2***************
2022-10-17 14:57:11,973 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:11,974 - trainer - INFO - {
  "dev_loss": 0.1523039760553123,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:11,974 - trainer - INFO -   no_improve_count: 85
2022-10-17 14:57:11,977 - trainer - INFO -   patience: 200
2022-10-17 14:57:11,978 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:11,978 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:11,979 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_798
2022-10-17 14:57:11,980 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_804
2022-10-17 14:57:11,985 - trainer - INFO - save model to path: tmp/mlp_digits\ck_804
2022-10-17 14:57:11,986 - trainer - INFO - 
*****************[epoch: 67, global step: 805] eval training set at end of epoch***************
2022-10-17 14:57:11,991 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:11,993 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0020539085289783543
}
2022-10-17 14:57:11,994 - trainer - INFO - start training epoch 68
2022-10-17 14:57:11,994 - trainer - INFO - training using device=cuda
2022-10-17 14:57:11,994 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:11,995 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:12,062 - trainer - INFO - 
*****************[epoch: 68, global step: 806] eval training set based on eval_every=2***************
2022-10-17 14:57:12,065 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        29
           1       1.00      1.00      1.00        24
           2       1.00      1.00      1.00        28
           3       1.00      1.00      1.00        25
           4       1.00      1.00      1.00        21
           5       1.00      1.00      1.00        32
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        29
           8       1.00      1.00      1.00        20
           9       1.00      1.00      1.00        26

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:12,066 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0007517943158745766
}
2022-10-17 14:57:12,326 - trainer - INFO - 
*****************[epoch: 68, global step: 806] eval development set based on eval_every=2***************
2022-10-17 14:57:12,330 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:12,331 - trainer - INFO - {
  "dev_loss": 0.1572242894617375,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:12,331 - trainer - INFO -   no_improve_count: 86
2022-10-17 14:57:12,331 - trainer - INFO -   patience: 200
2022-10-17 14:57:12,332 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:12,333 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:12,333 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_800
2022-10-17 14:57:12,334 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_806
2022-10-17 14:57:12,338 - trainer - INFO - save model to path: tmp/mlp_digits\ck_806
2022-10-17 14:57:12,403 - trainer - INFO - 
*****************[epoch: 68, global step: 808] eval training set based on eval_every=2***************
2022-10-17 14:57:12,406 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        59
           1       1.00      1.00      1.00        49
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        49
           4       1.00      1.00      1.00        48
           5       1.00      1.00      1.00        57
           6       1.00      1.00      1.00        58
           7       1.00      1.00      1.00        54
           8       1.00      1.00      1.00        38
           9       1.00      1.00      1.00        54

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:12,408 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005256781150819734
}
2022-10-17 14:57:12,722 - trainer - INFO - 
*****************[epoch: 68, global step: 808] eval development set based on eval_every=2***************
2022-10-17 14:57:12,727 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:57:12,728 - trainer - INFO - {
  "dev_loss": 0.16108742418388525,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:12,729 - trainer - INFO -   no_improve_count: 87
2022-10-17 14:57:12,729 - trainer - INFO -   patience: 200
2022-10-17 14:57:12,730 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:12,731 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:12,731 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_802
2022-10-17 14:57:12,732 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_808
2022-10-17 14:57:12,737 - trainer - INFO - save model to path: tmp/mlp_digits\ck_808
2022-10-17 14:57:12,801 - trainer - INFO - 
*****************[epoch: 68, global step: 810] eval training set based on eval_every=2***************
2022-10-17 14:57:12,804 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      1.00      1.00        78
           2       1.00      1.00      1.00        79
           3       1.00      1.00      1.00        73
           4       1.00      1.00      1.00        81
           5       1.00      1.00      1.00        79
           6       1.00      1.00      1.00        77
           7       1.00      1.00      1.00        86
           8       1.00      1.00      1.00        64
           9       1.00      1.00      1.00        83

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:12,806 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0003564151265891269
}
2022-10-17 14:57:13,076 - trainer - INFO - 
*****************[epoch: 68, global step: 810] eval development set based on eval_every=2***************
2022-10-17 14:57:13,082 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.92      1.00      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.83      0.91        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:13,083 - trainer - INFO - {
  "dev_loss": 0.16488749527100785,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:13,083 - trainer - INFO -   no_improve_count: 88
2022-10-17 14:57:13,084 - trainer - INFO -   patience: 200
2022-10-17 14:57:13,085 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:13,085 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:13,085 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_804
2022-10-17 14:57:13,087 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_810
2022-10-17 14:57:13,092 - trainer - INFO - save model to path: tmp/mlp_digits\ck_810
2022-10-17 14:57:13,149 - trainer - INFO - 
*****************[epoch: 68, global step: 812] eval training set based on eval_every=2***************
2022-10-17 14:57:13,153 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       110
           1       1.00      1.00      1.00       102
           2       1.00      1.00      1.00       109
           3       1.00      1.00      1.00        99
           4       1.00      1.00      1.00       112
           5       1.00      1.00      1.00        99
           6       1.00      1.00      1.00       102
           7       1.00      1.00      1.00       110
           8       1.00      1.00      1.00        92
           9       1.00      1.00      1.00       105

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:13,155 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005235169519437477
}
2022-10-17 14:57:13,412 - trainer - INFO - 
*****************[epoch: 68, global step: 812] eval development set based on eval_every=2***************
2022-10-17 14:57:13,415 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.89      1.00      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.95      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.80      0.89        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:13,416 - trainer - INFO - {
  "dev_loss": 0.1668310369035074,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:13,417 - trainer - INFO -   no_improve_count: 89
2022-10-17 14:57:13,417 - trainer - INFO -   patience: 200
2022-10-17 14:57:13,418 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:13,418 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:13,418 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_806
2022-10-17 14:57:13,419 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_812
2022-10-17 14:57:13,424 - trainer - INFO - save model to path: tmp/mlp_digits\ck_812
2022-10-17 14:57:13,496 - trainer - INFO - 
*****************[epoch: 68, global step: 814] eval training set based on eval_every=2***************
2022-10-17 14:57:13,500 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       133
           1       1.00      1.00      1.00       124
           2       1.00      1.00      1.00       133
           3       1.00      1.00      1.00       134
           4       1.00      1.00      1.00       135
           5       1.00      0.99      1.00       131
           6       1.00      1.00      1.00       129
           7       1.00      1.00      1.00       135
           8       1.00      1.00      1.00       117
           9       0.99      1.00      1.00       129

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:13,501 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.012326909098192118
}
2022-10-17 14:57:13,771 - trainer - INFO - 
*****************[epoch: 68, global step: 814] eval development set based on eval_every=2***************
2022-10-17 14:57:13,774 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      1.00      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.83      0.91        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:13,775 - trainer - INFO - {
  "dev_loss": 0.15768547304711925,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:13,776 - trainer - INFO -   no_improve_count: 90
2022-10-17 14:57:13,777 - trainer - INFO -   patience: 200
2022-10-17 14:57:13,778 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:13,778 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:13,779 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_808
2022-10-17 14:57:13,780 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_814
2022-10-17 14:57:13,785 - trainer - INFO - save model to path: tmp/mlp_digits\ck_814
2022-10-17 14:57:13,884 - trainer - INFO - 
*****************[epoch: 68, global step: 816] eval training set based on eval_every=2***************
2022-10-17 14:57:13,888 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:13,890 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00010161338286707178
}
2022-10-17 14:57:14,150 - trainer - INFO - 
*****************[epoch: 68, global step: 816] eval development set based on eval_every=2***************
2022-10-17 14:57:14,153 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       0.97      1.00      0.99        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:14,154 - trainer - INFO - {
  "dev_loss": 0.14481951262375028,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:14,154 - trainer - INFO -   no_improve_count: 91
2022-10-17 14:57:14,155 - trainer - INFO -   patience: 200
2022-10-17 14:57:14,156 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:14,156 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:14,156 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_810
2022-10-17 14:57:14,158 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_816
2022-10-17 14:57:14,166 - trainer - INFO - save model to path: tmp/mlp_digits\ck_816
2022-10-17 14:57:14,167 - trainer - INFO - 
*****************[epoch: 68, global step: 817] eval training set at end of epoch***************
2022-10-17 14:57:14,174 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:14,176 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0024309878317581024
}
2022-10-17 14:57:14,177 - trainer - INFO - start training epoch 69
2022-10-17 14:57:14,177 - trainer - INFO - training using device=cuda
2022-10-17 14:57:14,178 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:14,178 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:14,246 - trainer - INFO - 
*****************[epoch: 69, global step: 818] eval training set based on eval_every=2***************
2022-10-17 14:57:14,248 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        33
           1       1.00      1.00      1.00        19
           2       1.00      1.00      1.00        25
           3       1.00      1.00      1.00        26
           4       1.00      1.00      1.00        32
           5       1.00      1.00      1.00        32
           6       1.00      1.00      1.00        20
           7       1.00      1.00      1.00        31
           8       1.00      1.00      1.00        18
           9       1.00      1.00      1.00        24

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:14,249 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0005141123110661283
}
2022-10-17 14:57:14,516 - trainer - INFO - 
*****************[epoch: 69, global step: 818] eval development set based on eval_every=2***************
2022-10-17 14:57:14,520 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:14,521 - trainer - INFO - {
  "dev_loss": 0.13721866694201404,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:14,521 - trainer - INFO -   no_improve_count: 92
2022-10-17 14:57:14,522 - trainer - INFO -   patience: 200
2022-10-17 14:57:14,524 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:14,524 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:14,524 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_812
2022-10-17 14:57:14,526 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_818
2022-10-17 14:57:14,531 - trainer - INFO - save model to path: tmp/mlp_digits\ck_818
2022-10-17 14:57:14,590 - trainer - INFO - 
*****************[epoch: 69, global step: 820] eval training set based on eval_every=2***************
2022-10-17 14:57:14,593 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        48
           1       1.00      1.00      1.00        44
           2       1.00      1.00      1.00        60
           3       1.00      1.00      1.00        49
           4       1.00      1.00      1.00        57
           5       1.00      1.00      1.00        61
           6       1.00      1.00      1.00        46
           7       1.00      1.00      1.00        60
           8       1.00      1.00      1.00        44
           9       1.00      1.00      1.00        51

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:14,594 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0007716188774793409
}
2022-10-17 14:57:14,857 - trainer - INFO - 
*****************[epoch: 69, global step: 820] eval development set based on eval_every=2***************
2022-10-17 14:57:14,863 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:14,864 - trainer - INFO - {
  "dev_loss": 0.1321314729138976,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:14,864 - trainer - INFO -   no_improve_count: 93
2022-10-17 14:57:14,865 - trainer - INFO -   patience: 200
2022-10-17 14:57:14,866 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:14,866 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:14,866 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_814
2022-10-17 14:57:14,867 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_820
2022-10-17 14:57:14,872 - trainer - INFO - save model to path: tmp/mlp_digits\ck_820
2022-10-17 14:57:14,978 - trainer - INFO - 
*****************[epoch: 69, global step: 822] eval training set based on eval_every=2***************
2022-10-17 14:57:14,982 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        79
           1       1.00      1.00      1.00        72
           2       1.00      1.00      1.00        85
           3       1.00      1.00      1.00        76
           4       1.00      1.00      1.00        79
           5       1.00      1.00      1.00        78
           6       1.00      1.00      1.00        76
           7       1.00      1.00      1.00        84
           8       1.00      1.00      1.00        69
           9       1.00      1.00      1.00        82

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:14,983 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0012350500037427992
}
2022-10-17 14:57:15,245 - trainer - INFO - 
*****************[epoch: 69, global step: 822] eval development set based on eval_every=2***************
2022-10-17 14:57:15,250 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:15,251 - trainer - INFO - {
  "dev_loss": 0.13139016358036315,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:15,252 - trainer - INFO -   no_improve_count: 94
2022-10-17 14:57:15,252 - trainer - INFO -   patience: 200
2022-10-17 14:57:15,254 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:15,254 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:15,254 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_816
2022-10-17 14:57:15,255 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_822
2022-10-17 14:57:15,263 - trainer - INFO - save model to path: tmp/mlp_digits\ck_822
2022-10-17 14:57:15,325 - trainer - INFO - 
*****************[epoch: 69, global step: 824] eval training set based on eval_every=2***************
2022-10-17 14:57:15,328 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       102
           1       1.00      1.00      1.00        90
           2       1.00      1.00      1.00       114
           3       1.00      1.00      1.00       109
           4       1.00      1.00      1.00       103
           5       1.00      0.99      0.99        96
           6       1.00      1.00      1.00       106
           7       1.00      1.00      1.00       112
           8       1.00      1.00      1.00       102
           9       0.99      1.00      1.00       106

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:15,329 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.0052775593649130315
}
2022-10-17 14:57:15,593 - trainer - INFO - 
*****************[epoch: 69, global step: 824] eval development set based on eval_every=2***************
2022-10-17 14:57:15,596 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:15,597 - trainer - INFO - {
  "dev_loss": 0.13002706672705244,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:15,598 - trainer - INFO -   no_improve_count: 95
2022-10-17 14:57:15,598 - trainer - INFO -   patience: 200
2022-10-17 14:57:15,599 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:15,599 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:15,600 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_818
2022-10-17 14:57:15,601 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_824
2022-10-17 14:57:15,609 - trainer - INFO - save model to path: tmp/mlp_digits\ck_824
2022-10-17 14:57:15,675 - trainer - INFO - 
*****************[epoch: 69, global step: 826] eval training set based on eval_every=2***************
2022-10-17 14:57:15,679 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       1.00      1.00      1.00       119
           2       1.00      1.00      1.00       135
           3       1.00      1.00      1.00       133
           4       1.00      1.00      1.00       130
           5       1.00      0.99      1.00       123
           6       1.00      1.00      1.00       130
           7       1.00      1.00      1.00       135
           8       1.00      1.00      1.00       124
           9       0.99      1.00      1.00       137

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:15,680 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0005913649220019579
}
2022-10-17 14:57:16,000 - trainer - INFO - 
*****************[epoch: 69, global step: 826] eval development set based on eval_every=2***************
2022-10-17 14:57:16,004 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:16,005 - trainer - INFO - {
  "dev_loss": 0.13153817497368436,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:16,005 - trainer - INFO -   no_improve_count: 96
2022-10-17 14:57:16,006 - trainer - INFO -   patience: 200
2022-10-17 14:57:16,007 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:16,007 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:16,007 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_820
2022-10-17 14:57:16,008 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_826
2022-10-17 14:57:16,012 - trainer - INFO - save model to path: tmp/mlp_digits\ck_826
2022-10-17 14:57:16,056 - trainer - INFO - 
*****************[epoch: 69, global step: 828] eval training set based on eval_every=2***************
2022-10-17 14:57:16,060 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:16,061 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00029345481198106427
}
2022-10-17 14:57:16,327 - trainer - INFO - 
*****************[epoch: 69, global step: 828] eval development set based on eval_every=2***************
2022-10-17 14:57:16,331 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:16,332 - trainer - INFO - {
  "dev_loss": 0.13302489420796823,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:16,332 - trainer - INFO -   no_improve_count: 97
2022-10-17 14:57:16,333 - trainer - INFO -   patience: 200
2022-10-17 14:57:16,334 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:16,334 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:16,334 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_822
2022-10-17 14:57:16,335 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_828
2022-10-17 14:57:16,339 - trainer - INFO - save model to path: tmp/mlp_digits\ck_828
2022-10-17 14:57:16,341 - trainer - INFO - 
*****************[epoch: 69, global step: 829] eval training set at end of epoch***************
2022-10-17 14:57:16,345 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:16,348 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0014471933818640537
}
2022-10-17 14:57:16,348 - trainer - INFO - start training epoch 70
2022-10-17 14:57:16,349 - trainer - INFO - training using device=cuda
2022-10-17 14:57:16,349 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:16,349 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:16,408 - trainer - INFO - 
*****************[epoch: 70, global step: 830] eval training set based on eval_every=2***************
2022-10-17 14:57:16,410 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        27
           1       1.00      1.00      1.00        20
           2       1.00      1.00      1.00        32
           3       1.00      1.00      1.00        23
           4       1.00      1.00      1.00        26
           5       1.00      1.00      1.00        28
           6       1.00      1.00      1.00        22
           7       1.00      1.00      1.00        30
           8       1.00      1.00      1.00        21
           9       1.00      1.00      1.00        31

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:16,411 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.001763624866725877
}
2022-10-17 14:57:16,694 - trainer - INFO - 
*****************[epoch: 70, global step: 830] eval development set based on eval_every=2***************
2022-10-17 14:57:16,697 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:16,698 - trainer - INFO - {
  "dev_loss": 0.13557654217098994,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:16,699 - trainer - INFO -   no_improve_count: 98
2022-10-17 14:57:16,699 - trainer - INFO -   patience: 200
2022-10-17 14:57:16,700 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:16,701 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:16,701 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_824
2022-10-17 14:57:16,702 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_830
2022-10-17 14:57:16,707 - trainer - INFO - save model to path: tmp/mlp_digits\ck_830
2022-10-17 14:57:16,765 - trainer - INFO - 
*****************[epoch: 70, global step: 832] eval training set based on eval_every=2***************
2022-10-17 14:57:16,768 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        47
           1       1.00      1.00      1.00        48
           2       1.00      1.00      1.00        57
           3       1.00      1.00      1.00        54
           4       1.00      1.00      1.00        52
           5       1.00      1.00      1.00        53
           6       1.00      1.00      1.00        46
           7       1.00      1.00      1.00        56
           8       1.00      1.00      1.00        54
           9       1.00      1.00      1.00        53

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:16,769 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0008184778562281281
}
2022-10-17 14:57:17,083 - trainer - INFO - 
*****************[epoch: 70, global step: 832] eval development set based on eval_every=2***************
2022-10-17 14:57:17,085 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.93      0.97      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.99      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:17,086 - trainer - INFO - {
  "dev_loss": 0.1377171905405703,
  "dev_accuracy": 0.9833333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:17,087 - trainer - INFO -   no_improve_count: 99
2022-10-17 14:57:17,087 - trainer - INFO -   patience: 200
2022-10-17 14:57:17,088 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:17,088 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:17,089 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_826
2022-10-17 14:57:17,090 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_832
2022-10-17 14:57:17,099 - trainer - INFO - save model to path: tmp/mlp_digits\ck_832
2022-10-17 14:57:17,162 - trainer - INFO - 
*****************[epoch: 70, global step: 834] eval training set based on eval_every=2***************
2022-10-17 14:57:17,166 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        71
           1       1.00      1.00      1.00        80
           2       1.00      1.00      1.00        84
           3       1.00      1.00      1.00        82
           4       1.00      1.00      1.00        73
           5       1.00      0.99      0.99        80
           6       1.00      1.00      1.00        68
           7       1.00      1.00      1.00        78
           8       1.00      1.00      1.00        82
           9       0.99      1.00      0.99        82

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:17,167 - trainer - INFO - {
  "train_accuracy_score": 0.9987179487179487,
  "train_loss": 0.005477760685607791
}
2022-10-17 14:57:17,446 - trainer - INFO - 
*****************[epoch: 70, global step: 834] eval development set based on eval_every=2***************
2022-10-17 14:57:17,451 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:17,453 - trainer - INFO - {
  "dev_loss": 0.14272281391216288,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:17,454 - trainer - INFO -   no_improve_count: 100
2022-10-17 14:57:17,455 - trainer - INFO -   patience: 200
2022-10-17 14:57:17,456 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:17,456 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:17,456 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_828
2022-10-17 14:57:17,458 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_834
2022-10-17 14:57:17,463 - trainer - INFO - save model to path: tmp/mlp_digits\ck_834
2022-10-17 14:57:17,529 - trainer - INFO - 
*****************[epoch: 70, global step: 836] eval training set based on eval_every=2***************
2022-10-17 14:57:17,532 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        94
           1       1.00      1.00      1.00       109
           2       1.00      1.00      1.00       107
           3       1.00      1.00      1.00       107
           4       1.00      1.00      1.00        96
           5       1.00      0.99      1.00       108
           6       1.00      1.00      1.00        94
           7       1.00      1.00      1.00       113
           8       1.00      1.00      1.00       103
           9       0.99      1.00      1.00       109

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:17,534 - trainer - INFO - {
  "train_accuracy_score": 0.9990384615384615,
  "train_loss": 0.00016718362167011946
}
2022-10-17 14:57:17,805 - trainer - INFO - 
*****************[epoch: 70, global step: 836] eval development set based on eval_every=2***************
2022-10-17 14:57:17,808 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:17,809 - trainer - INFO - {
  "dev_loss": 0.14876839400676545,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:17,810 - trainer - INFO -   no_improve_count: 101
2022-10-17 14:57:17,810 - trainer - INFO -   patience: 200
2022-10-17 14:57:17,811 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:17,811 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:17,812 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_830
2022-10-17 14:57:17,813 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_836
2022-10-17 14:57:17,817 - trainer - INFO - save model to path: tmp/mlp_digits\ck_836
2022-10-17 14:57:17,880 - trainer - INFO - 
*****************[epoch: 70, global step: 838] eval training set based on eval_every=2***************
2022-10-17 14:57:17,884 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       1.00      1.00      1.00       124
           2       1.00      1.00      1.00       130
           3       1.00      1.00      1.00       137
           4       1.00      1.00      1.00       131
           5       1.00      0.99      1.00       129
           6       1.00      1.00      1.00       130
           7       1.00      1.00      1.00       133
           8       1.00      1.00      1.00       116
           9       0.99      1.00      1.00       140

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:17,885 - trainer - INFO - {
  "train_accuracy_score": 0.9992307692307693,
  "train_loss": 0.0003280932651250623
}
2022-10-17 14:57:18,198 - trainer - INFO - 
*****************[epoch: 70, global step: 838] eval development set based on eval_every=2***************
2022-10-17 14:57:18,201 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:18,202 - trainer - INFO - {
  "dev_loss": 0.15375114891018407,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:18,202 - trainer - INFO -   no_improve_count: 102
2022-10-17 14:57:18,202 - trainer - INFO -   patience: 200
2022-10-17 14:57:18,203 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:18,204 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:18,204 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_832
2022-10-17 14:57:18,206 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_838
2022-10-17 14:57:18,213 - trainer - INFO - save model to path: tmp/mlp_digits\ck_838
2022-10-17 14:57:18,268 - trainer - INFO - 
*****************[epoch: 70, global step: 840] eval training set based on eval_every=2***************
2022-10-17 14:57:18,272 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:18,274 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.00025334419842693023
}
2022-10-17 14:57:18,540 - trainer - INFO - 
*****************[epoch: 70, global step: 840] eval development set based on eval_every=2***************
2022-10-17 14:57:18,543 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:18,544 - trainer - INFO - {
  "dev_loss": 0.1580889839970041,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:18,545 - trainer - INFO -   no_improve_count: 103
2022-10-17 14:57:18,545 - trainer - INFO -   patience: 200
2022-10-17 14:57:18,546 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:18,549 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:18,549 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_834
2022-10-17 14:57:18,550 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_840
2022-10-17 14:57:18,555 - trainer - INFO - save model to path: tmp/mlp_digits\ck_840
2022-10-17 14:57:18,556 - trainer - INFO - 
*****************[epoch: 70, global step: 841] eval training set at end of epoch***************
2022-10-17 14:57:18,563 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:18,565 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.0014680807489639847
}
2022-10-17 14:57:18,566 - trainer - INFO - start training epoch 71
2022-10-17 14:57:18,566 - trainer - INFO - training using device=cuda
2022-10-17 14:57:18,567 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:18,567 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:18,629 - trainer - INFO - 
*****************[epoch: 71, global step: 842] eval training set based on eval_every=2***************
2022-10-17 14:57:18,632 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        33
           1       1.00      1.00      1.00        22
           2       1.00      1.00      1.00        27
           3       1.00      1.00      1.00        28
           4       1.00      1.00      1.00        17
           5       1.00      1.00      1.00        21
           6       1.00      1.00      1.00        27
           7       1.00      1.00      1.00        27
           8       1.00      1.00      1.00        30
           9       1.00      1.00      1.00        28

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:18,633 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00032302258478011936
}
2022-10-17 14:57:18,890 - trainer - INFO - 
*****************[epoch: 71, global step: 842] eval development set based on eval_every=2***************
2022-10-17 14:57:18,893 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:18,894 - trainer - INFO - {
  "dev_loss": 0.16093220572414188,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:18,894 - trainer - INFO -   no_improve_count: 104
2022-10-17 14:57:18,895 - trainer - INFO -   patience: 200
2022-10-17 14:57:18,896 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:18,896 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:18,897 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_836
2022-10-17 14:57:18,898 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_842
2022-10-17 14:57:18,903 - trainer - INFO - save model to path: tmp/mlp_digits\ck_842
2022-10-17 14:57:18,974 - trainer - INFO - 
*****************[epoch: 71, global step: 844] eval training set based on eval_every=2***************
2022-10-17 14:57:18,977 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        51
           1       1.00      1.00      1.00        49
           2       1.00      1.00      1.00        54
           3       1.00      1.00      1.00        61
           4       1.00      1.00      1.00        44
           5       1.00      1.00      1.00        51
           6       1.00      1.00      1.00        52
           7       1.00      1.00      1.00        49
           8       1.00      1.00      1.00        59
           9       1.00      1.00      1.00        50

    accuracy                           1.00       520
   macro avg       1.00      1.00      1.00       520
weighted avg       1.00      1.00      1.00       520

2022-10-17 14:57:18,978 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0003239075012970716
}
2022-10-17 14:57:19,287 - trainer - INFO - 
*****************[epoch: 71, global step: 844] eval development set based on eval_every=2***************
2022-10-17 14:57:19,291 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:19,292 - trainer - INFO - {
  "dev_loss": 0.16170782129726527,
  "dev_accuracy": 0.9805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:19,293 - trainer - INFO -   no_improve_count: 105
2022-10-17 14:57:19,294 - trainer - INFO -   patience: 200
2022-10-17 14:57:19,295 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:19,295 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:19,295 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_838
2022-10-17 14:57:19,296 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_844
2022-10-17 14:57:19,300 - trainer - INFO - save model to path: tmp/mlp_digits\ck_844
2022-10-17 14:57:19,369 - trainer - INFO - 
*****************[epoch: 71, global step: 846] eval training set based on eval_every=2***************
2022-10-17 14:57:19,372 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      1.00      1.00        73
           2       1.00      1.00      1.00        85
           3       1.00      1.00      1.00        89
           4       1.00      1.00      1.00        66
           5       1.00      1.00      1.00        83
           6       1.00      1.00      1.00        77
           7       1.00      1.00      1.00        73
           8       1.00      1.00      1.00        75
           9       1.00      1.00      1.00        79

    accuracy                           1.00       780
   macro avg       1.00      1.00      1.00       780
weighted avg       1.00      1.00      1.00       780

2022-10-17 14:57:19,374 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.00036400083627086133
}
2022-10-17 14:57:19,632 - trainer - INFO - 
*****************[epoch: 71, global step: 846] eval development set based on eval_every=2***************
2022-10-17 14:57:19,635 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:19,636 - trainer - INFO - {
  "dev_loss": 0.1639230384947344,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:19,636 - trainer - INFO -   no_improve_count: 106
2022-10-17 14:57:19,637 - trainer - INFO -   patience: 200
2022-10-17 14:57:19,637 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:19,638 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:19,638 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_840
2022-10-17 14:57:19,639 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_846
2022-10-17 14:57:19,643 - trainer - INFO - save model to path: tmp/mlp_digits\ck_846
2022-10-17 14:57:19,714 - trainer - INFO - 
*****************[epoch: 71, global step: 848] eval training set based on eval_every=2***************
2022-10-17 14:57:19,718 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00       102
           2       1.00      1.00      1.00       109
           3       1.00      1.00      1.00       108
           4       1.00      1.00      1.00       100
           5       1.00      1.00      1.00       106
           6       1.00      1.00      1.00       101
           7       1.00      1.00      1.00        99
           8       1.00      1.00      1.00       105
           9       1.00      1.00      1.00       103

    accuracy                           1.00      1040
   macro avg       1.00      1.00      1.00      1040
weighted avg       1.00      1.00      1.00      1040

2022-10-17 14:57:19,719 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0002737083050305955
}
2022-10-17 14:57:19,972 - trainer - INFO - 
*****************[epoch: 71, global step: 848] eval development set based on eval_every=2***************
2022-10-17 14:57:19,975 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:19,977 - trainer - INFO - {
  "dev_loss": 0.1650882308895234,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:19,978 - trainer - INFO -   no_improve_count: 107
2022-10-17 14:57:19,978 - trainer - INFO -   patience: 200
2022-10-17 14:57:19,980 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:19,980 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:19,980 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_842
2022-10-17 14:57:19,982 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_848
2022-10-17 14:57:19,987 - trainer - INFO - save model to path: tmp/mlp_digits\ck_848
2022-10-17 14:57:20,051 - trainer - INFO - 
*****************[epoch: 71, global step: 850] eval training set based on eval_every=2***************
2022-10-17 14:57:20,055 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       1.00      1.00      1.00       128
           2       1.00      1.00      1.00       134
           3       1.00      1.00      1.00       136
           4       1.00      1.00      1.00       130
           5       1.00      1.00      1.00       125
           6       1.00      1.00      1.00       131
           7       1.00      1.00      1.00       132
           8       1.00      1.00      1.00       124
           9       1.00      1.00      1.00       130

    accuracy                           1.00      1300
   macro avg       1.00      1.00      1.00      1300
weighted avg       1.00      1.00      1.00      1300

2022-10-17 14:57:20,057 - trainer - INFO - {
  "train_accuracy_score": 1.0,
  "train_loss": 0.0002475391447660513
}
2022-10-17 14:57:20,309 - trainer - INFO - 
*****************[epoch: 71, global step: 850] eval development set based on eval_every=2***************
2022-10-17 14:57:20,312 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.85      0.92        41
         9.0       0.97      1.00      0.98        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:20,313 - trainer - INFO - {
  "dev_loss": 0.16449710359544648,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:20,314 - trainer - INFO -   no_improve_count: 108
2022-10-17 14:57:20,315 - trainer - INFO -   patience: 200
2022-10-17 14:57:20,316 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:20,316 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:20,316 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_844
2022-10-17 14:57:20,317 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_850
2022-10-17 14:57:20,321 - trainer - INFO - save model to path: tmp/mlp_digits\ck_850
2022-10-17 14:57:20,412 - trainer - INFO - 
*****************[epoch: 71, global step: 852] eval training set based on eval_every=2***************
2022-10-17 14:57:20,416 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:20,417 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.09040456323418766
}
2022-10-17 14:57:20,685 - trainer - INFO - 
*****************[epoch: 71, global step: 852] eval development set based on eval_every=2***************
2022-10-17 14:57:20,688 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.89      0.97      0.93        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.98       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.98      0.98       360

2022-10-17 14:57:20,690 - trainer - INFO - {
  "dev_loss": 0.16269553830109848,
  "dev_accuracy": 0.9777777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:20,690 - trainer - INFO -   no_improve_count: 109
2022-10-17 14:57:20,691 - trainer - INFO -   patience: 200
2022-10-17 14:57:20,692 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:20,692 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:20,693 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_846
2022-10-17 14:57:20,694 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_852
2022-10-17 14:57:20,699 - trainer - INFO - save model to path: tmp/mlp_digits\ck_852
2022-10-17 14:57:20,701 - trainer - INFO - 
*****************[epoch: 71, global step: 853] eval training set at end of epoch***************
2022-10-17 14:57:20,707 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       1.00      1.00      1.00       149
           4       1.00      1.00      1.00       145
           5       1.00      0.99      1.00       142
           6       1.00      1.00      1.00       143
           7       1.00      1.00      1.00       146
           8       1.00      1.00      1.00       133
           9       0.99      1.00      1.00       149

    accuracy                           1.00      1437
   macro avg       1.00      1.00      1.00      1437
weighted avg       1.00      1.00      1.00      1437

2022-10-17 14:57:20,709 - trainer - INFO - {
  "train_accuracy_score": 0.9993041057759221,
  "train_loss": 0.01532279026772206
}
2022-10-17 14:57:20,710 - trainer - INFO - start training epoch 72
2022-10-17 14:57:20,710 - trainer - INFO - training using device=cuda
2022-10-17 14:57:20,710 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:20,711 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:20,779 - trainer - INFO - 
*****************[epoch: 72, global step: 854] eval training set based on eval_every=2***************
2022-10-17 14:57:20,782 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       1.00      1.00      1.00        20
           2       1.00      1.00      1.00        29
           3       1.00      1.00      1.00        26
           4       1.00      1.00      1.00        25
           5       0.88      1.00      0.94        30
           6       1.00      1.00      1.00        27
           7       1.00      1.00      1.00        23
           8       1.00      1.00      1.00        25
           9       1.00      0.85      0.92        27

    accuracy                           0.98       260
   macro avg       0.99      0.99      0.99       260
weighted avg       0.99      0.98      0.98       260

2022-10-17 14:57:20,783 - trainer - INFO - {
  "train_accuracy_score": 0.9846153846153847,
  "train_loss": 0.03746406559366733
}
2022-10-17 14:57:21,054 - trainer - INFO - 
*****************[epoch: 72, global step: 854] eval development set based on eval_every=2***************
2022-10-17 14:57:21,059 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.78      0.97      0.87        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       1.00      0.77      0.87        31

    accuracy                           0.96       360
   macro avg       0.97      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:21,060 - trainer - INFO - {
  "dev_loss": 0.18799042329192162,
  "dev_accuracy": 0.9583333333333334,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:21,061 - trainer - INFO -   no_improve_count: 110
2022-10-17 14:57:21,061 - trainer - INFO -   patience: 200
2022-10-17 14:57:21,062 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:21,063 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:21,063 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_848
2022-10-17 14:57:21,064 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_854
2022-10-17 14:57:21,069 - trainer - INFO - save model to path: tmp/mlp_digits\ck_854
2022-10-17 14:57:21,139 - trainer - INFO - 
*****************[epoch: 72, global step: 856] eval training set based on eval_every=2***************
2022-10-17 14:57:21,142 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        55
           1       1.00      1.00      1.00        50
           2       1.00      1.00      1.00        57
           3       1.00      1.00      1.00        56
           4       1.00      1.00      1.00        47
           5       0.88      1.00      0.94        53
           6       1.00      1.00      1.00        52
           7       1.00      1.00      1.00        53
           8       0.98      1.00      0.99        48
           9       1.00      0.84      0.91        49

    accuracy                           0.98       520
   macro avg       0.99      0.98      0.98       520
weighted avg       0.99      0.98      0.98       520

2022-10-17 14:57:21,143 - trainer - INFO - {
  "train_accuracy_score": 0.9846153846153847,
  "train_loss": 0.05574136320501566
}
2022-10-17 14:57:21,407 - trainer - INFO - 
*****************[epoch: 72, global step: 856] eval development set based on eval_every=2***************
2022-10-17 14:57:21,411 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.94      1.00      0.97        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.90      0.95        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.97       360
   macro avg       0.98      0.98      0.98       360
weighted avg       0.98      0.97      0.97       360

2022-10-17 14:57:21,412 - trainer - INFO - {
  "dev_loss": 0.09913869252583633,
  "dev_accuracy": 0.975,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:21,413 - trainer - INFO -   no_improve_count: 111
2022-10-17 14:57:21,414 - trainer - INFO -   patience: 200
2022-10-17 14:57:21,418 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:21,419 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:21,419 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_850
2022-10-17 14:57:21,420 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_856
2022-10-17 14:57:21,425 - trainer - INFO - save model to path: tmp/mlp_digits\ck_856
2022-10-17 14:57:21,543 - trainer - INFO - 
*****************[epoch: 72, global step: 858] eval training set based on eval_every=2***************
2022-10-17 14:57:21,547 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        78
           1       1.00      1.00      1.00        70
           2       1.00      1.00      1.00        87
           3       1.00      1.00      1.00        78
           4       1.00      1.00      1.00        69
           5       0.92      1.00      0.96        79
           6       1.00      1.00      1.00        75
           7       1.00      1.00      1.00        88
           8       0.99      1.00      0.99        78
           9       1.00      0.90      0.95        78

    accuracy                           0.99       780
   macro avg       0.99      0.99      0.99       780
weighted avg       0.99      0.99      0.99       780

2022-10-17 14:57:21,548 - trainer - INFO - {
  "train_accuracy_score": 0.9897435897435898,
  "train_loss": 0.0054388262797147036
}
2022-10-17 14:57:21,814 - trainer - INFO - 
*****************[epoch: 72, global step: 858] eval development set based on eval_every=2***************
2022-10-17 14:57:21,818 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.95      0.95        42
         2.0       1.00      0.97      0.98        32
         3.0       0.87      1.00      0.93        34
         4.0       1.00      1.00      1.00        36
         5.0       1.00      0.88      0.93        40
         6.0       0.97      1.00      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       0.95      0.95      0.95        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:21,819 - trainer - INFO - {
  "dev_loss": 0.1530462110725542,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:21,820 - trainer - INFO -   no_improve_count: 112
2022-10-17 14:57:21,820 - trainer - INFO -   patience: 200
2022-10-17 14:57:21,821 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:21,822 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:21,822 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_852
2022-10-17 14:57:21,823 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_858
2022-10-17 14:57:21,828 - trainer - INFO - save model to path: tmp/mlp_digits\ck_858
2022-10-17 14:57:21,898 - trainer - INFO - 
*****************[epoch: 72, global step: 860] eval training set based on eval_every=2***************
2022-10-17 14:57:21,901 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       1.00      1.00      1.00        93
           2       1.00      1.00      1.00       107
           3       0.98      0.98      0.98       109
           4       0.99      0.99      0.99       102
           5       0.94      0.98      0.96       107
           6       1.00      1.00      1.00       105
           7       1.00      1.00      1.00       110
           8       0.97      1.00      0.99       103
           9       0.99      0.91      0.95        97

    accuracy                           0.99      1040
   macro avg       0.99      0.99      0.99      1040
weighted avg       0.99      0.99      0.99      1040

2022-10-17 14:57:21,903 - trainer - INFO - {
  "train_accuracy_score": 0.9865384615384616,
  "train_loss": 0.1096755675971508
}
2022-10-17 14:57:22,168 - trainer - INFO - 
*****************[epoch: 72, global step: 860] eval development set based on eval_every=2***************
2022-10-17 14:57:22,171 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.95      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      1.00      1.00        34
         4.0       1.00      1.00      1.00        36
         5.0       0.97      0.93      0.95        40
         6.0       0.95      0.97      0.96        38
         7.0       0.97      1.00      0.99        33
         8.0       0.95      0.93      0.94        41
         9.0       0.94      0.97      0.95        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:22,173 - trainer - INFO - {
  "dev_loss": 0.15230353739267835,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:22,174 - trainer - INFO -   no_improve_count: 113
2022-10-17 14:57:22,175 - trainer - INFO -   patience: 200
2022-10-17 14:57:22,176 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:22,176 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:22,177 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_854
2022-10-17 14:57:22,178 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_860
2022-10-17 14:57:22,183 - trainer - INFO - save model to path: tmp/mlp_digits\ck_860
2022-10-17 14:57:22,253 - trainer - INFO - 
*****************[epoch: 72, global step: 862] eval training set based on eval_every=2***************
2022-10-17 14:57:22,257 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       130
           1       1.00      1.00      1.00       126
           2       1.00      1.00      1.00       128
           3       0.99      0.99      0.99       137
           4       0.99      0.99      0.99       130
           5       0.95      0.98      0.97       130
           6       1.00      1.00      1.00       134
           7       0.99      1.00      1.00       133
           8       0.98      1.00      0.99       121
           9       0.99      0.92      0.96       131

    accuracy                           0.99      1300
   macro avg       0.99      0.99      0.99      1300
weighted avg       0.99      0.99      0.99      1300

2022-10-17 14:57:22,258 - trainer - INFO - {
  "train_accuracy_score": 0.9884615384615385,
  "train_loss": 0.017958112526685
}
2022-10-17 14:57:22,560 - trainer - INFO - 
*****************[epoch: 72, global step: 862] eval development set based on eval_every=2***************
2022-10-17 14:57:22,563 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.95      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.97      0.99        34
         4.0       0.95      1.00      0.97        36
         5.0       0.95      0.95      0.95        40
         6.0       0.93      0.97      0.95        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.88      0.94        41
         9.0       0.94      0.97      0.95        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:22,565 - trainer - INFO - {
  "dev_loss": 0.19750855397433043,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:22,566 - trainer - INFO -   no_improve_count: 114
2022-10-17 14:57:22,566 - trainer - INFO -   patience: 200
2022-10-17 14:57:22,567 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:22,568 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:22,568 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_856
2022-10-17 14:57:22,569 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_862
2022-10-17 14:57:22,574 - trainer - INFO - save model to path: tmp/mlp_digits\ck_862
2022-10-17 14:57:22,625 - trainer - INFO - 
*****************[epoch: 72, global step: 864] eval training set based on eval_every=2***************
2022-10-17 14:57:22,629 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.99      0.99       145
           5       0.95      0.99      0.97       142
           6       1.00      1.00      1.00       143
           7       0.99      1.00      1.00       146
           8       0.97      1.00      0.99       133
           9       0.99      0.93      0.96       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:57:22,630 - trainer - INFO - {
  "train_accuracy_score": 0.988865692414753,
  "train_loss": 0.00793151768448297
}
2022-10-17 14:57:22,889 - trainer - INFO - 
*****************[epoch: 72, global step: 864] eval development set based on eval_every=2***************
2022-10-17 14:57:22,892 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.88      0.95      0.92        40
         6.0       0.95      0.95      0.95        38
         7.0       0.97      1.00      0.99        33
         8.0       1.00      0.80      0.89        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:22,893 - trainer - INFO - {
  "dev_loss": 0.2883396528971692,
  "dev_accuracy": 0.9555555555555556,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:22,894 - trainer - INFO -   no_improve_count: 115
2022-10-17 14:57:22,894 - trainer - INFO -   patience: 200
2022-10-17 14:57:22,895 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:22,896 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:22,896 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_858
2022-10-17 14:57:22,898 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_864
2022-10-17 14:57:22,902 - trainer - INFO - save model to path: tmp/mlp_digits\ck_864
2022-10-17 14:57:22,907 - trainer - INFO - 
*****************[epoch: 72, global step: 865] eval training set at end of epoch***************
2022-10-17 14:57:22,913 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       1.00      1.00      1.00       140
           2       1.00      1.00      1.00       145
           3       0.99      0.99      0.99       149
           4       0.99      0.99      0.99       145
           5       0.95      0.99      0.97       142
           6       1.00      1.00      1.00       143
           7       0.99      1.00      1.00       146
           8       0.97      1.00      0.99       133
           9       0.99      0.93      0.96       149

    accuracy                           0.99      1437
   macro avg       0.99      0.99      0.99      1437
weighted avg       0.99      0.99      0.99      1437

2022-10-17 14:57:22,916 - trainer - INFO - {
  "train_accuracy_score": 0.988865692414753,
  "train_loss": 0.03903490881445274
}
2022-10-17 14:57:22,917 - trainer - INFO - start training epoch 73
2022-10-17 14:57:22,917 - trainer - INFO - training using device=cuda
2022-10-17 14:57:22,918 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:22,918 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:22,981 - trainer - INFO - 
*****************[epoch: 73, global step: 866] eval training set based on eval_every=2***************
2022-10-17 14:57:22,984 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        20
           1       1.00      1.00      1.00        29
           2       1.00      1.00      1.00        31
           3       1.00      1.00      1.00        27
           4       1.00      1.00      1.00        25
           5       1.00      1.00      1.00        27
           6       0.96      1.00      0.98        22
           7       1.00      1.00      1.00        18
           8       1.00      0.97      0.98        33
           9       1.00      1.00      1.00        28

    accuracy                           1.00       260
   macro avg       1.00      1.00      1.00       260
weighted avg       1.00      1.00      1.00       260

2022-10-17 14:57:22,985 - trainer - INFO - {
  "train_accuracy_score": 0.9961538461538462,
  "train_loss": 0.017817795276641846
}
2022-10-17 14:57:23,250 - trainer - INFO - 
*****************[epoch: 73, global step: 866] eval development set based on eval_every=2***************
2022-10-17 14:57:23,253 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      1.00      0.99        36
         5.0       0.84      0.95      0.89        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.78      0.88        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.95       360
   macro avg       0.95      0.96      0.95       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:57:23,254 - trainer - INFO - {
  "dev_loss": 0.3604549877345562,
  "dev_accuracy": 0.95,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:23,254 - trainer - INFO -   no_improve_count: 116
2022-10-17 14:57:23,255 - trainer - INFO -   patience: 200
2022-10-17 14:57:23,256 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:23,256 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:23,256 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_860
2022-10-17 14:57:23,257 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_866
2022-10-17 14:57:23,265 - trainer - INFO - save model to path: tmp/mlp_digits\ck_866
2022-10-17 14:57:23,338 - trainer - INFO - 
*****************[epoch: 73, global step: 868] eval training set based on eval_every=2***************
2022-10-17 14:57:23,341 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        53
           1       1.00      1.00      1.00        60
           2       1.00      1.00      1.00        45
           3       0.94      0.94      0.94        50
           4       1.00      0.98      0.99        50
           5       0.96      0.98      0.97        53
           6       0.98      1.00      0.99        49
           7       1.00      1.00      1.00        46
           8       1.00      0.93      0.96        56
           9       0.95      1.00      0.97        58

    accuracy                           0.98       520
   macro avg       0.98      0.98      0.98       520
weighted avg       0.98      0.98      0.98       520

2022-10-17 14:57:23,342 - trainer - INFO - {
  "train_accuracy_score": 0.9826923076923076,
  "train_loss": 0.1545107290148735
}
2022-10-17 14:57:23,654 - trainer - INFO - 
*****************[epoch: 73, global step: 868] eval development set based on eval_every=2***************
2022-10-17 14:57:23,658 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      1.00      0.99        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.93      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.97      0.83      0.89        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.96       360
   macro avg       0.96      0.97      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:23,659 - trainer - INFO - {
  "dev_loss": 0.27319065807387233,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:23,660 - trainer - INFO -   no_improve_count: 117
2022-10-17 14:57:23,661 - trainer - INFO -   patience: 200
2022-10-17 14:57:23,662 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:23,662 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:23,662 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_862
2022-10-17 14:57:23,664 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_868
2022-10-17 14:57:23,669 - trainer - INFO - save model to path: tmp/mlp_digits\ck_868
2022-10-17 14:57:23,734 - trainer - INFO - 
*****************[epoch: 73, global step: 870] eval training set based on eval_every=2***************
2022-10-17 14:57:23,737 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        80
           1       1.00      0.98      0.99        81
           2       1.00      1.00      1.00        68
           3       0.95      0.95      0.95        81
           4       1.00      0.99      0.99        81
           5       0.96      0.98      0.97        83
           6       0.97      1.00      0.99        69
           7       1.00      0.99      0.99        80
           8       1.00      0.93      0.96        72
           9       0.93      1.00      0.97        85

    accuracy                           0.98       780
   macro avg       0.98      0.98      0.98       780
weighted avg       0.98      0.98      0.98       780

2022-10-17 14:57:23,739 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.08704585768282413
}
2022-10-17 14:57:24,015 - trainer - INFO - 
*****************[epoch: 73, global step: 870] eval development set based on eval_every=2***************
2022-10-17 14:57:24,019 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.97      0.99        38
         7.0       0.97      1.00      0.99        33
         8.0       0.91      0.95      0.93        41
         9.0       0.97      0.97      0.97        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:24,020 - trainer - INFO - {
  "dev_loss": 0.22269788632790247,
  "dev_accuracy": 0.9722222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:24,021 - trainer - INFO -   no_improve_count: 118
2022-10-17 14:57:24,021 - trainer - INFO -   patience: 200
2022-10-17 14:57:24,022 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:24,023 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:24,023 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_864
2022-10-17 14:57:24,024 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_870
2022-10-17 14:57:24,028 - trainer - INFO - save model to path: tmp/mlp_digits\ck_870
2022-10-17 14:57:24,096 - trainer - INFO - 
*****************[epoch: 73, global step: 872] eval training set based on eval_every=2***************
2022-10-17 14:57:24,101 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99       106
           1       1.00      0.98      0.99       104
           2       1.00      1.00      1.00       103
           3       0.96      0.95      0.96       110
           4       1.00      0.97      0.99       106
           5       0.97      0.98      0.98       103
           6       0.98      1.00      0.99       100
           7       1.00      0.99      1.00       105
           8       0.97      0.95      0.96        98
           9       0.94      0.98      0.96       105

    accuracy                           0.98      1040
   macro avg       0.98      0.98      0.98      1040
weighted avg       0.98      0.98      0.98      1040

2022-10-17 14:57:24,102 - trainer - INFO - {
  "train_accuracy_score": 0.9807692307692307,
  "train_loss": 0.12498269323259592
}
2022-10-17 14:57:24,371 - trainer - INFO - 
*****************[epoch: 73, global step: 872] eval development set based on eval_every=2***************
2022-10-17 14:57:24,374 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.88      0.94        34
         4.0       0.95      1.00      0.97        36
         5.0       0.97      0.95      0.96        40
         6.0       1.00      0.95      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.88      0.93      0.90        41
         9.0       0.97      0.94      0.95        31

    accuracy                           0.96       360
   macro avg       0.97      0.96      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:57:24,376 - trainer - INFO - {
  "dev_loss": 0.31410033876697224,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:24,377 - trainer - INFO -   no_improve_count: 119
2022-10-17 14:57:24,377 - trainer - INFO -   patience: 200
2022-10-17 14:57:24,378 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:24,378 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:24,379 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_866
2022-10-17 14:57:24,380 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_872
2022-10-17 14:57:24,384 - trainer - INFO - save model to path: tmp/mlp_digits\ck_872
2022-10-17 14:57:24,450 - trainer - INFO - 
*****************[epoch: 73, global step: 874] eval training set based on eval_every=2***************
2022-10-17 14:57:24,454 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       136
           1       0.98      0.98      0.98       127
           2       1.00      1.00      1.00       130
           3       0.97      0.96      0.96       134
           4       1.00      0.98      0.99       130
           5       0.98      0.98      0.98       131
           6       0.98      0.98      0.98       130
           7       1.00      0.99      1.00       128
           8       0.93      0.94      0.94       120
           9       0.96      0.97      0.96       134

    accuracy                           0.98      1300
   macro avg       0.98      0.98      0.98      1300
weighted avg       0.98      0.98      0.98      1300

2022-10-17 14:57:24,455 - trainer - INFO - {
  "train_accuracy_score": 0.9784615384615385,
  "train_loss": 0.20034866780042648
}
2022-10-17 14:57:24,773 - trainer - INFO - 
*****************[epoch: 73, global step: 874] eval development set based on eval_every=2***************
2022-10-17 14:57:24,776 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.94      1.00      0.97        34
         4.0       0.95      1.00      0.97        36
         5.0       0.90      0.93      0.91        40
         6.0       1.00      0.92      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.90      0.90      0.90        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:24,777 - trainer - INFO - {
  "dev_loss": 0.2900828750183185,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:24,779 - trainer - INFO -   no_improve_count: 120
2022-10-17 14:57:24,780 - trainer - INFO -   patience: 200
2022-10-17 14:57:24,783 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:24,784 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:24,784 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_868
2022-10-17 14:57:24,785 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_874
2022-10-17 14:57:24,790 - trainer - INFO - save model to path: tmp/mlp_digits\ck_874
2022-10-17 14:57:24,835 - trainer - INFO - 
*****************[epoch: 73, global step: 876] eval training set based on eval_every=2***************
2022-10-17 14:57:24,839 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       0.97      0.96      0.97       149
           4       1.00      0.97      0.99       145
           5       0.97      0.99      0.98       142
           6       0.99      0.97      0.98       143
           7       0.99      0.99      0.99       146
           8       0.94      0.95      0.94       133
           9       0.95      0.96      0.96       149

    accuracy                           0.98      1437
   macro avg       0.98      0.98      0.98      1437
weighted avg       0.98      0.98      0.98      1437

2022-10-17 14:57:24,841 - trainer - INFO - {
  "train_accuracy_score": 0.9770354906054279,
  "train_loss": 0.05773093657830941
}
2022-10-17 14:57:25,104 - trainer - INFO - 
*****************[epoch: 73, global step: 876] eval development set based on eval_every=2***************
2022-10-17 14:57:25,108 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.93      0.96        42
         2.0       0.84      1.00      0.91        32
         3.0       0.82      0.97      0.89        34
         4.0       0.95      1.00      0.97        36
         5.0       0.92      0.85      0.88        40
         6.0       0.95      0.92      0.93        38
         7.0       0.97      0.97      0.97        33
         8.0       1.00      0.66      0.79        41
         9.0       0.79      0.97      0.87        31

    accuracy                           0.92       360
   macro avg       0.92      0.93      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:25,109 - trainer - INFO - {
  "dev_loss": 0.43025416135787964,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:25,109 - trainer - INFO -   no_improve_count: 121
2022-10-17 14:57:25,110 - trainer - INFO -   patience: 200
2022-10-17 14:57:25,112 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:25,112 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:25,112 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_870
2022-10-17 14:57:25,114 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_876
2022-10-17 14:57:25,119 - trainer - INFO - save model to path: tmp/mlp_digits\ck_876
2022-10-17 14:57:25,120 - trainer - INFO - 
*****************[epoch: 73, global step: 877] eval training set at end of epoch***************
2022-10-17 14:57:25,126 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.97      0.99      0.98       140
           2       1.00      1.00      1.00       145
           3       0.97      0.96      0.97       149
           4       1.00      0.97      0.99       145
           5       0.97      0.99      0.98       142
           6       0.99      0.97      0.98       143
           7       0.99      0.99      0.99       146
           8       0.94      0.95      0.94       133
           9       0.95      0.96      0.96       149

    accuracy                           0.98      1437
   macro avg       0.98      0.98      0.98      1437
weighted avg       0.98      0.98      0.98      1437

2022-10-17 14:57:25,128 - trainer - INFO - {
  "train_accuracy_score": 0.9770354906054279,
  "train_loss": 0.10707277993094522
}
2022-10-17 14:57:25,129 - trainer - INFO - start training epoch 74
2022-10-17 14:57:25,130 - trainer - INFO - training using device=cuda
2022-10-17 14:57:25,130 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:25,130 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:25,194 - trainer - INFO - 
*****************[epoch: 74, global step: 878] eval training set based on eval_every=2***************
2022-10-17 14:57:25,197 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        33
           1       1.00      0.89      0.94        18
           2       0.97      1.00      0.98        31
           3       0.89      1.00      0.94        16
           4       0.97      1.00      0.98        30
           5       0.96      0.92      0.94        26
           6       0.93      1.00      0.96        25
           7       1.00      1.00      1.00        27
           8       0.95      0.78      0.86        23
           9       0.97      1.00      0.98        31

    accuracy                           0.97       260
   macro avg       0.96      0.96      0.96       260
weighted avg       0.97      0.97      0.96       260

2022-10-17 14:57:25,198 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.18477313965559006
}
2022-10-17 14:57:25,464 - trainer - INFO - 
*****************[epoch: 74, global step: 878] eval development set based on eval_every=2***************
2022-10-17 14:57:25,467 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.79      0.88        42
         2.0       0.91      1.00      0.96        32
         3.0       0.97      0.94      0.96        34
         4.0       0.90      1.00      0.95        36
         5.0       0.95      0.95      0.95        40
         6.0       0.97      0.95      0.96        38
         7.0       1.00      0.97      0.98        33
         8.0       0.82      0.68      0.75        41
         9.0       0.72      1.00      0.84        31

    accuracy                           0.92       360
   macro avg       0.93      0.93      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:25,468 - trainer - INFO - {
  "dev_loss": 0.3868519241611163,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:25,468 - trainer - INFO -   no_improve_count: 122
2022-10-17 14:57:25,469 - trainer - INFO -   patience: 200
2022-10-17 14:57:25,470 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:25,470 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:25,470 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_872
2022-10-17 14:57:25,471 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_878
2022-10-17 14:57:25,475 - trainer - INFO - save model to path: tmp/mlp_digits\ck_878
2022-10-17 14:57:25,542 - trainer - INFO - 
*****************[epoch: 74, global step: 880] eval training set based on eval_every=2***************
2022-10-17 14:57:25,547 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        55
           1       0.98      0.91      0.95        47
           2       0.98      1.00      0.99        57
           3       0.96      1.00      0.98        46
           4       0.98      0.98      0.98        51
           5       0.98      0.96      0.97        53
           6       0.93      1.00      0.96        53
           7       1.00      0.96      0.98        56
           8       0.97      0.83      0.90        47
           9       0.90      1.00      0.95        55

    accuracy                           0.97       520
   macro avg       0.97      0.97      0.97       520
weighted avg       0.97      0.97      0.97       520

2022-10-17 14:57:25,548 - trainer - INFO - {
  "train_accuracy_score": 0.9673076923076923,
  "train_loss": 0.14700081199407578
}
2022-10-17 14:57:25,848 - trainer - INFO - 
*****************[epoch: 74, global step: 880] eval development set based on eval_every=2***************
2022-10-17 14:57:25,851 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.94      0.94      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.95      0.95      0.95        40
         6.0       1.00      0.97      0.99        38
         7.0       0.89      1.00      0.94        33
         8.0       0.95      0.88      0.91        41
         9.0       0.94      0.94      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:25,852 - trainer - INFO - {
  "dev_loss": 0.21825235523283482,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:25,853 - trainer - INFO -   no_improve_count: 123
2022-10-17 14:57:25,853 - trainer - INFO -   patience: 200
2022-10-17 14:57:25,855 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:25,855 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:25,855 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_874
2022-10-17 14:57:25,856 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_880
2022-10-17 14:57:25,861 - trainer - INFO - save model to path: tmp/mlp_digits\ck_880
2022-10-17 14:57:25,934 - trainer - INFO - 
*****************[epoch: 74, global step: 882] eval training set based on eval_every=2***************
2022-10-17 14:57:25,937 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        78
           1       0.95      0.95      0.95        75
           2       0.99      1.00      0.99        85
           3       0.97      0.99      0.98        72
           4       0.99      0.97      0.98        79
           5       0.99      0.96      0.97        80
           6       0.95      0.99      0.97        75
           7       1.00      0.97      0.99        80
           8       0.95      0.87      0.91        70
           9       0.92      0.99      0.96        86

    accuracy                           0.97       780
   macro avg       0.97      0.97      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:57:25,939 - trainer - INFO - {
  "train_accuracy_score": 0.9705128205128205,
  "train_loss": 0.1136665791273117
}
2022-10-17 14:57:26,201 - trainer - INFO - 
*****************[epoch: 74, global step: 882] eval development set based on eval_every=2***************
2022-10-17 14:57:26,204 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.85      0.92        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.82      0.89        34
         4.0       0.86      1.00      0.92        36
         5.0       0.95      0.93      0.94        40
         6.0       0.97      0.97      0.97        38
         7.0       0.77      1.00      0.87        33
         8.0       0.90      0.90      0.90        41
         9.0       0.96      0.81      0.88        31

    accuracy                           0.93       360
   macro avg       0.94      0.92      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:57:26,205 - trainer - INFO - {
  "dev_loss": 0.5011074195305506,
  "dev_accuracy": 0.9277777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:26,205 - trainer - INFO -   no_improve_count: 124
2022-10-17 14:57:26,206 - trainer - INFO -   patience: 200
2022-10-17 14:57:26,207 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:26,207 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:26,207 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_876
2022-10-17 14:57:26,209 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_882
2022-10-17 14:57:26,213 - trainer - INFO - save model to path: tmp/mlp_digits\ck_882
2022-10-17 14:57:26,283 - trainer - INFO - 
*****************[epoch: 74, global step: 884] eval training set based on eval_every=2***************
2022-10-17 14:57:26,286 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99       110
           1       0.93      0.96      0.95        99
           2       0.99      1.00      1.00       110
           3       0.98      0.97      0.98       108
           4       0.96      0.97      0.97       101
           5       0.99      0.96      0.98       102
           6       0.96      0.98      0.97       101
           7       0.94      0.98      0.96        95
           8       0.93      0.90      0.91        98
           9       0.94      0.93      0.94       116

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:57:26,288 - trainer - INFO - {
  "train_accuracy_score": 0.9625,
  "train_loss": 0.44422388821840286
}
2022-10-17 14:57:26,555 - trainer - INFO - 
*****************[epoch: 74, global step: 884] eval development set based on eval_every=2***************
2022-10-17 14:57:26,558 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      1.00      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.91      0.94        34
         4.0       0.90      1.00      0.95        36
         5.0       0.91      0.97      0.94        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.55      0.71        33
         8.0       0.95      0.95      0.95        41
         9.0       0.73      0.97      0.83        31

    accuracy                           0.93       360
   macro avg       0.94      0.93      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:57:26,559 - trainer - INFO - {
  "dev_loss": 0.39741108069817227,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:26,560 - trainer - INFO -   no_improve_count: 125
2022-10-17 14:57:26,561 - trainer - INFO -   patience: 200
2022-10-17 14:57:26,562 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:26,565 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:26,565 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_878
2022-10-17 14:57:26,566 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_884
2022-10-17 14:57:26,570 - trainer - INFO - save model to path: tmp/mlp_digits\ck_884
2022-10-17 14:57:26,638 - trainer - INFO - 
*****************[epoch: 74, global step: 886] eval training set based on eval_every=2***************
2022-10-17 14:57:26,642 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       132
           1       0.92      0.97      0.95       125
           2       0.99      1.00      1.00       132
           3       0.98      0.97      0.97       131
           4       0.96      0.97      0.96       133
           5       0.98      0.97      0.97       129
           6       0.96      0.97      0.97       130
           7       0.95      0.86      0.90       127
           8       0.92      0.91      0.91       123
           9       0.88      0.93      0.91       138

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:57:26,644 - trainer - INFO - {
  "train_accuracy_score": 0.953076923076923,
  "train_loss": 0.45063938200473785
}
2022-10-17 14:57:26,919 - trainer - INFO - 
*****************[epoch: 74, global step: 886] eval development set based on eval_every=2***************
2022-10-17 14:57:26,926 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       1.00      0.69      0.82        42
         2.0       0.97      1.00      0.98        32
         3.0       0.89      0.91      0.90        34
         4.0       0.92      0.92      0.92        36
         5.0       0.85      0.97      0.91        40
         6.0       1.00      0.97      0.99        38
         7.0       1.00      0.73      0.84        33
         8.0       0.84      0.93      0.88        41
         9.0       0.74      0.94      0.83        31

    accuracy                           0.90       360
   macro avg       0.91      0.91      0.90       360
weighted avg       0.91      0.90      0.90       360

2022-10-17 14:57:26,927 - trainer - INFO - {
  "dev_loss": 0.35490623613198596,
  "dev_accuracy": 0.9027777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:26,928 - trainer - INFO -   no_improve_count: 126
2022-10-17 14:57:26,928 - trainer - INFO -   patience: 200
2022-10-17 14:57:26,929 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:26,930 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:26,930 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_880
2022-10-17 14:57:26,931 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_886
2022-10-17 14:57:26,936 - trainer - INFO - save model to path: tmp/mlp_digits\ck_886
2022-10-17 14:57:27,025 - trainer - INFO - 
*****************[epoch: 74, global step: 888] eval training set based on eval_every=2***************
2022-10-17 14:57:27,029 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.93      0.94      0.93       140
           2       0.99      1.00      0.99       145
           3       0.98      0.97      0.97       149
           4       0.95      0.97      0.96       145
           5       0.97      0.97      0.97       142
           6       0.97      0.97      0.97       143
           7       0.95      0.86      0.90       146
           8       0.90      0.92      0.91       133
           9       0.87      0.94      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:57:27,030 - trainer - INFO - {
  "train_accuracy_score": 0.9505915100904663,
  "train_loss": 1.6030170321464539
}
2022-10-17 14:57:27,307 - trainer - INFO - 
*****************[epoch: 74, global step: 888] eval development set based on eval_every=2***************
2022-10-17 14:57:27,310 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.97      0.69      0.81        42
         2.0       1.00      1.00      1.00        32
         3.0       0.41      1.00      0.58        34
         4.0       0.89      0.92      0.90        36
         5.0       0.94      0.75      0.83        40
         6.0       1.00      0.95      0.97        38
         7.0       0.97      0.88      0.92        33
         8.0       0.92      0.54      0.68        41
         9.0       0.65      0.42      0.51        31

    accuracy                           0.81       360
   macro avg       0.87      0.81      0.82       360
weighted avg       0.87      0.81      0.82       360

2022-10-17 14:57:27,311 - trainer - INFO - {
  "dev_loss": 0.9866802878677845,
  "dev_accuracy": 0.8083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:27,312 - trainer - INFO -   no_improve_count: 127
2022-10-17 14:57:27,312 - trainer - INFO -   patience: 200
2022-10-17 14:57:27,313 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:27,313 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:27,313 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_882
2022-10-17 14:57:27,315 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_888
2022-10-17 14:57:27,319 - trainer - INFO - save model to path: tmp/mlp_digits\ck_888
2022-10-17 14:57:27,320 - trainer - INFO - 
*****************[epoch: 74, global step: 889] eval training set at end of epoch***************
2022-10-17 14:57:27,326 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       145
           1       0.93      0.94      0.93       140
           2       0.99      1.00      0.99       145
           3       0.98      0.97      0.97       149
           4       0.95      0.97      0.96       145
           5       0.97      0.97      0.97       142
           6       0.97      0.97      0.97       143
           7       0.95      0.86      0.90       146
           8       0.90      0.92      0.91       133
           9       0.87      0.94      0.90       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:57:27,328 - trainer - INFO - {
  "train_accuracy_score": 0.9505915100904663,
  "train_loss": 0.49055347219109535
}
2022-10-17 14:57:27,329 - trainer - INFO - start training epoch 75
2022-10-17 14:57:27,329 - trainer - INFO - training using device=cuda
2022-10-17 14:57:27,329 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:27,329 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:27,392 - trainer - INFO - 
*****************[epoch: 75, global step: 890] eval training set based on eval_every=2***************
2022-10-17 14:57:27,395 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        21
           1       1.00      0.58      0.73        19
           2       1.00      0.96      0.98        24
           3       0.54      1.00      0.70        30
           4       0.96      1.00      0.98        27
           5       0.94      0.62      0.74        26
           6       1.00      0.93      0.96        28
           7       0.93      0.90      0.91        29
           8       0.88      0.52      0.65        29
           9       0.58      0.70      0.63        27

    accuracy                           0.82       260
   macro avg       0.88      0.82      0.83       260
weighted avg       0.87      0.82      0.83       260

2022-10-17 14:57:27,396 - trainer - INFO - {
  "train_accuracy_score": 0.823076923076923,
  "train_loss": 0.8322660326957703
}
2022-10-17 14:57:27,672 - trainer - INFO - 
*****************[epoch: 75, global step: 890] eval development set based on eval_every=2***************
2022-10-17 14:57:27,676 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.79      0.71      0.75        42
         2.0       0.89      0.97      0.93        32
         3.0       0.65      0.94      0.77        34
         4.0       0.79      0.92      0.85        36
         5.0       0.88      0.17      0.29        40
         6.0       1.00      0.92      0.96        38
         7.0       0.87      0.79      0.83        33
         8.0       0.83      0.61      0.70        41
         9.0       0.50      0.90      0.64        31

    accuracy                           0.78       360
   macro avg       0.81      0.79      0.77       360
weighted avg       0.81      0.78      0.76       360

2022-10-17 14:57:27,677 - trainer - INFO - {
  "dev_loss": 1.1964125037193298,
  "dev_accuracy": 0.7777777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:27,678 - trainer - INFO -   no_improve_count: 128
2022-10-17 14:57:27,679 - trainer - INFO -   patience: 200
2022-10-17 14:57:27,680 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:27,680 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:27,680 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_884
2022-10-17 14:57:27,682 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_890
2022-10-17 14:57:27,686 - trainer - INFO - save model to path: tmp/mlp_digits\ck_890
2022-10-17 14:57:27,749 - trainer - INFO - 
*****************[epoch: 75, global step: 892] eval training set based on eval_every=2***************
2022-10-17 14:57:27,752 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        49
           1       0.88      0.71      0.78        41
           2       1.00      0.98      0.99        50
           3       0.59      0.98      0.73        52
           4       0.92      0.98      0.95        56
           5       0.94      0.35      0.52        48
           6       0.93      0.88      0.90        57
           7       0.96      0.87      0.91        52
           8       0.86      0.66      0.75        58
           9       0.62      0.84      0.71        57

    accuracy                           0.83       520
   macro avg       0.87      0.82      0.82       520
weighted avg       0.86      0.83      0.82       520

2022-10-17 14:57:27,754 - trainer - INFO - {
  "train_accuracy_score": 0.8288461538461539,
  "train_loss": 1.0653595626354218
}
2022-10-17 14:57:28,030 - trainer - INFO - 
*****************[epoch: 75, global step: 892] eval development set based on eval_every=2***************
2022-10-17 14:57:28,034 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.93      0.95      0.94        42
         2.0       0.91      0.94      0.92        32
         3.0       0.94      0.85      0.89        34
         4.0       0.97      0.81      0.88        36
         5.0       0.30      0.40      0.34        40
         6.0       0.92      0.95      0.94        38
         7.0       0.85      0.85      0.85        33
         8.0       0.72      0.95      0.82        41
         9.0       0.11      0.03      0.05        31

    accuracy                           0.78       360
   macro avg       0.76      0.77      0.76       360
weighted avg       0.76      0.78      0.77       360

2022-10-17 14:57:28,035 - trainer - INFO - {
  "dev_loss": 0.6840360164642334,
  "dev_accuracy": 0.7805555555555556,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:28,036 - trainer - INFO -   no_improve_count: 129
2022-10-17 14:57:28,036 - trainer - INFO -   patience: 200
2022-10-17 14:57:28,037 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:28,038 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:28,038 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_886
2022-10-17 14:57:28,039 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_892
2022-10-17 14:57:28,044 - trainer - INFO - save model to path: tmp/mlp_digits\ck_892
2022-10-17 14:57:28,154 - trainer - INFO - 
*****************[epoch: 75, global step: 894] eval training set based on eval_every=2***************
2022-10-17 14:57:28,157 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99        74
           1       0.87      0.82      0.84        72
           2       1.00      0.97      0.99        73
           3       0.63      0.90      0.74        78
           4       0.94      0.98      0.96        84
           5       0.64      0.39      0.49        74
           6       0.93      0.91      0.92        90
           7       0.96      0.88      0.92        82
           8       0.72      0.74      0.73        78
           9       0.59      0.64      0.62        75

    accuracy                           0.83       780
   macro avg       0.83      0.82      0.82       780
weighted avg       0.83      0.83      0.82       780

2022-10-17 14:57:28,158 - trainer - INFO - {
  "train_accuracy_score": 0.8256410256410256,
  "train_loss": 0.6268125176429749
}
2022-10-17 14:57:28,421 - trainer - INFO - 
*****************[epoch: 75, global step: 894] eval development set based on eval_every=2***************
2022-10-17 14:57:28,426 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.70      0.83      0.76        42
         2.0       0.89      0.97      0.93        32
         3.0       0.95      0.53      0.68        34
         4.0       1.00      0.61      0.76        36
         5.0       0.32      0.42      0.37        40
         6.0       0.90      0.95      0.92        38
         7.0       0.84      0.97      0.90        33
         8.0       0.54      0.85      0.66        41
         9.0       0.00      0.00      0.00        31

    accuracy                           0.72       360
   macro avg       0.71      0.71      0.70       360
weighted avg       0.71      0.72      0.70       360

2022-10-17 14:57:28,427 - trainer - INFO - {
  "dev_loss": 1.00545734167099,
  "dev_accuracy": 0.7194444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:28,428 - trainer - INFO -   no_improve_count: 130
2022-10-17 14:57:28,428 - trainer - INFO -   patience: 200
2022-10-17 14:57:28,429 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:28,429 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:28,430 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_888
2022-10-17 14:57:28,431 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_894
2022-10-17 14:57:28,436 - trainer - INFO - save model to path: tmp/mlp_digits\ck_894
2022-10-17 14:57:28,510 - trainer - INFO - 
*****************[epoch: 75, global step: 896] eval training set based on eval_every=2***************
2022-10-17 14:57:28,513 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98        99
           1       0.78      0.82      0.80        98
           2       0.98      0.96      0.97       102
           3       0.68      0.82      0.74       109
           4       0.94      0.90      0.92       109
           5       0.46      0.34      0.39        97
           6       0.94      0.93      0.93       112
           7       0.94      0.91      0.92       116
           8       0.61      0.76      0.68        98
           9       0.57      0.52      0.54       100

    accuracy                           0.80      1040
   macro avg       0.79      0.79      0.79      1040
weighted avg       0.80      0.80      0.79      1040

2022-10-17 14:57:28,514 - trainer - INFO - {
  "train_accuracy_score": 0.7971153846153847,
  "train_loss": 0.9752666056156158
}
2022-10-17 14:57:28,774 - trainer - INFO - 
*****************[epoch: 75, global step: 896] eval development set based on eval_every=2***************
2022-10-17 14:57:28,777 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.67      0.78        42
         2.0       0.91      0.97      0.94        32
         3.0       0.60      0.79      0.68        34
         4.0       0.74      0.81      0.77        36
         5.0       0.60      0.23      0.33        40
         6.0       0.97      0.89      0.93        38
         7.0       0.66      1.00      0.80        33
         8.0       0.73      0.73      0.73        41
         9.0       0.53      0.65      0.58        31

    accuracy                           0.76       360
   macro avg       0.77      0.77      0.75       360
weighted avg       0.77      0.76      0.75       360

2022-10-17 14:57:28,778 - trainer - INFO - {
  "dev_loss": 0.8842162291208903,
  "dev_accuracy": 0.7611111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:28,778 - trainer - INFO -   no_improve_count: 131
2022-10-17 14:57:28,779 - trainer - INFO -   patience: 200
2022-10-17 14:57:28,780 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:28,780 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:28,780 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_890
2022-10-17 14:57:28,782 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_896
2022-10-17 14:57:28,786 - trainer - INFO - save model to path: tmp/mlp_digits\ck_896
2022-10-17 14:57:28,855 - trainer - INFO - 
*****************[epoch: 75, global step: 898] eval training set based on eval_every=2***************
2022-10-17 14:57:28,859 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.96      0.98       128
           1       0.79      0.75      0.77       124
           2       0.98      0.97      0.97       130
           3       0.65      0.84      0.74       135
           4       0.87      0.89      0.88       133
           5       0.46      0.28      0.35       123
           6       0.94      0.90      0.92       136
           7       0.84      0.92      0.88       136
           8       0.63      0.75      0.68       122
           9       0.59      0.52      0.55       133

    accuracy                           0.78      1300
   macro avg       0.77      0.78      0.77      1300
weighted avg       0.78      0.78      0.77      1300

2022-10-17 14:57:28,861 - trainer - INFO - {
  "train_accuracy_score": 0.7823076923076923,
  "train_loss": 0.8203139901161194
}
2022-10-17 14:57:29,157 - trainer - INFO - 
*****************[epoch: 75, global step: 898] eval development set based on eval_every=2***************
2022-10-17 14:57:29,162 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.33      0.50        42
         2.0       0.94      1.00      0.97        32
         3.0       0.54      0.82      0.65        34
         4.0       0.61      0.83      0.71        36
         5.0       0.64      0.40      0.49        40
         6.0       0.97      0.97      0.97        38
         7.0       0.85      1.00      0.92        33
         8.0       0.74      0.85      0.80        41
         9.0       0.72      0.68      0.70        31

    accuracy                           0.78       360
   macro avg       0.80      0.79      0.77       360
weighted avg       0.80      0.78      0.76       360

2022-10-17 14:57:29,163 - trainer - INFO - {
  "dev_loss": 0.6429760108391444,
  "dev_accuracy": 0.775,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:29,164 - trainer - INFO -   no_improve_count: 132
2022-10-17 14:57:29,164 - trainer - INFO -   patience: 200
2022-10-17 14:57:29,165 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:29,165 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:29,166 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_892
2022-10-17 14:57:29,167 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_898
2022-10-17 14:57:29,171 - trainer - INFO - save model to path: tmp/mlp_digits\ck_898
2022-10-17 14:57:29,219 - trainer - INFO - 
*****************[epoch: 75, global step: 900] eval training set based on eval_every=2***************
2022-10-17 14:57:29,222 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.80      0.71      0.75       140
           2       0.98      0.97      0.98       145
           3       0.64      0.85      0.73       149
           4       0.84      0.90      0.87       145
           5       0.50      0.30      0.37       142
           6       0.94      0.90      0.92       143
           7       0.84      0.92      0.88       146
           8       0.63      0.77      0.69       133
           9       0.60      0.52      0.56       149

    accuracy                           0.78      1437
   macro avg       0.78      0.78      0.77      1437
weighted avg       0.78      0.78      0.77      1437

2022-10-17 14:57:29,224 - trainer - INFO - {
  "train_accuracy_score": 0.7821851078636047,
  "train_loss": 0.5346248000860214
}
2022-10-17 14:57:29,491 - trainer - INFO - 
*****************[epoch: 75, global step: 900] eval development set based on eval_every=2***************
2022-10-17 14:57:29,498 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.96      0.64      0.77        42
         2.0       0.94      1.00      0.97        32
         3.0       0.55      0.97      0.70        34
         4.0       0.97      0.83      0.90        36
         5.0       0.56      0.38      0.45        40
         6.0       0.92      0.92      0.92        38
         7.0       1.00      0.79      0.88        33
         8.0       0.75      0.88      0.81        41
         9.0       0.71      0.77      0.74        31

    accuracy                           0.81       360
   macro avg       0.83      0.82      0.81       360
weighted avg       0.83      0.81      0.81       360

2022-10-17 14:57:29,500 - trainer - INFO - {
  "dev_loss": 0.5887696743011475,
  "dev_accuracy": 0.8083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:29,500 - trainer - INFO -   no_improve_count: 133
2022-10-17 14:57:29,501 - trainer - INFO -   patience: 200
2022-10-17 14:57:29,502 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:29,502 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:29,502 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_894
2022-10-17 14:57:29,504 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_900
2022-10-17 14:57:29,509 - trainer - INFO - save model to path: tmp/mlp_digits\ck_900
2022-10-17 14:57:29,510 - trainer - INFO - 
*****************[epoch: 75, global step: 901] eval training set at end of epoch***************
2022-10-17 14:57:29,516 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.97      0.98       145
           1       0.80      0.71      0.75       140
           2       0.98      0.97      0.98       145
           3       0.64      0.85      0.73       149
           4       0.84      0.90      0.87       145
           5       0.50      0.30      0.37       142
           6       0.94      0.90      0.92       143
           7       0.84      0.92      0.88       146
           8       0.63      0.77      0.69       133
           9       0.60      0.52      0.56       149

    accuracy                           0.78      1437
   macro avg       0.78      0.78      0.77      1437
weighted avg       0.78      0.78      0.77      1437

2022-10-17 14:57:29,519 - trainer - INFO - {
  "train_accuracy_score": 0.7821851078636047,
  "train_loss": 0.8091072514653206
}
2022-10-17 14:57:29,520 - trainer - INFO - start training epoch 76
2022-10-17 14:57:29,521 - trainer - INFO - training using device=cuda
2022-10-17 14:57:29,521 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:29,521 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:29,588 - trainer - INFO - 
*****************[epoch: 76, global step: 902] eval training set based on eval_every=2***************
2022-10-17 14:57:29,590 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       0.81      0.62      0.70        21
           2       0.97      0.97      0.97        29
           3       0.57      0.96      0.72        28
           4       1.00      0.90      0.95        31
           5       0.40      0.26      0.31        31
           6       0.93      0.81      0.87        16
           7       0.94      0.67      0.78        24
           8       0.73      0.92      0.81        26
           9       0.82      0.87      0.84        31

    accuracy                           0.80       260
   macro avg       0.82      0.80      0.80       260
weighted avg       0.80      0.80      0.79       260

2022-10-17 14:57:29,592 - trainer - INFO - {
  "train_accuracy_score": 0.7961538461538461,
  "train_loss": 0.5348416268825531
}
2022-10-17 14:57:29,856 - trainer - INFO - 
*****************[epoch: 76, global step: 902] eval development set based on eval_every=2***************
2022-10-17 14:57:29,859 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.82      0.79      0.80        42
         2.0       0.94      0.97      0.95        32
         3.0       0.67      0.97      0.80        34
         4.0       0.94      0.86      0.90        36
         5.0       0.73      0.40      0.52        40
         6.0       0.78      0.92      0.84        38
         7.0       0.94      0.97      0.96        33
         8.0       0.85      0.71      0.77        41
         9.0       0.77      0.87      0.82        31

    accuracy                           0.83       360
   macro avg       0.84      0.85      0.83       360
weighted avg       0.84      0.83      0.83       360

2022-10-17 14:57:29,860 - trainer - INFO - {
  "dev_loss": 0.6435824185609818,
  "dev_accuracy": 0.8333333333333334,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:29,861 - trainer - INFO -   no_improve_count: 134
2022-10-17 14:57:29,861 - trainer - INFO -   patience: 200
2022-10-17 14:57:29,864 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:29,867 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:29,868 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_896
2022-10-17 14:57:29,869 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_902
2022-10-17 14:57:29,875 - trainer - INFO - save model to path: tmp/mlp_digits\ck_902
2022-10-17 14:57:29,940 - trainer - INFO - 
*****************[epoch: 76, global step: 904] eval training set based on eval_every=2***************
2022-10-17 14:57:29,944 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98        51
           1       0.69      0.72      0.70        43
           2       0.98      0.94      0.96        50
           3       0.69      0.95      0.80        57
           4       0.96      0.86      0.91        58
           5       0.53      0.41      0.46        56
           6       0.89      0.91      0.90        54
           7       0.98      0.85      0.91        55
           8       0.76      0.76      0.76        45
           9       0.79      0.82      0.81        51

    accuracy                           0.82       520
   macro avg       0.82      0.82      0.82       520
weighted avg       0.83      0.82      0.82       520

2022-10-17 14:57:29,945 - trainer - INFO - {
  "train_accuracy_score": 0.823076923076923,
  "train_loss": 0.6850345134735107
}
2022-10-17 14:57:30,248 - trainer - INFO - 
*****************[epoch: 76, global step: 904] eval development set based on eval_every=2***************
2022-10-17 14:57:30,251 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.66      0.88      0.76        42
         2.0       0.94      1.00      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      0.86      0.93        36
         5.0       0.70      0.53      0.60        40
         6.0       0.83      0.92      0.88        38
         7.0       0.91      0.97      0.94        33
         8.0       0.92      0.54      0.68        41
         9.0       0.67      0.94      0.78        31

    accuracy                           0.84       360
   macro avg       0.86      0.85      0.84       360
weighted avg       0.85      0.84      0.83       360

2022-10-17 14:57:30,252 - trainer - INFO - {
  "dev_loss": 0.7054415941238403,
  "dev_accuracy": 0.8388888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:30,253 - trainer - INFO -   no_improve_count: 135
2022-10-17 14:57:30,253 - trainer - INFO -   patience: 200
2022-10-17 14:57:30,254 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:30,254 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:30,254 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_898
2022-10-17 14:57:30,256 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_904
2022-10-17 14:57:30,260 - trainer - INFO - save model to path: tmp/mlp_digits\ck_904
2022-10-17 14:57:30,330 - trainer - INFO - 
*****************[epoch: 76, global step: 906] eval training set based on eval_every=2***************
2022-10-17 14:57:30,333 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      1.00      0.97        76
           1       0.69      0.79      0.74        77
           2       0.99      0.96      0.97        79
           3       0.72      0.94      0.82        78
           4       0.97      0.87      0.92        83
           5       0.59      0.46      0.51        81
           6       0.89      0.90      0.90        81
           7       0.99      0.86      0.92        77
           8       0.78      0.71      0.74        63
           9       0.77      0.81      0.79        85

    accuracy                           0.83       780
   macro avg       0.83      0.83      0.83       780
weighted avg       0.83      0.83      0.83       780

2022-10-17 14:57:30,334 - trainer - INFO - {
  "train_accuracy_score": 0.8307692307692308,
  "train_loss": 0.6634219884872437
}
2022-10-17 14:57:30,600 - trainer - INFO - 
*****************[epoch: 76, global step: 906] eval development set based on eval_every=2***************
2022-10-17 14:57:30,603 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.85      0.93      0.89        42
         2.0       0.94      1.00      0.97        32
         3.0       0.69      0.97      0.80        34
         4.0       1.00      0.86      0.93        36
         5.0       0.73      0.40      0.52        40
         6.0       0.97      0.87      0.92        38
         7.0       0.94      1.00      0.97        33
         8.0       0.83      0.61      0.70        41
         9.0       0.67      1.00      0.81        31

    accuracy                           0.85       360
   macro avg       0.86      0.86      0.85       360
weighted avg       0.86      0.85      0.84       360

2022-10-17 14:57:30,604 - trainer - INFO - {
  "dev_loss": 0.5518131951491038,
  "dev_accuracy": 0.85,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:30,605 - trainer - INFO -   no_improve_count: 136
2022-10-17 14:57:30,606 - trainer - INFO -   patience: 200
2022-10-17 14:57:30,607 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:30,607 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:30,607 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_900
2022-10-17 14:57:30,609 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_906
2022-10-17 14:57:30,613 - trainer - INFO - save model to path: tmp/mlp_digits\ck_906
2022-10-17 14:57:30,676 - trainer - INFO - 
*****************[epoch: 76, global step: 908] eval training set based on eval_every=2***************
2022-10-17 14:57:30,680 - trainer - INFO -               precision    recall  f1-score   support

           0       0.95      1.00      0.97        96
           1       0.74      0.84      0.79       103
           2       0.99      0.97      0.98       103
           3       0.72      0.95      0.82       106
           4       0.98      0.88      0.93       110
           5       0.61      0.43      0.50       101
           6       0.91      0.90      0.91       112
           7       0.99      0.89      0.94       104
           8       0.82      0.76      0.79        92
           9       0.78      0.83      0.80       113

    accuracy                           0.85      1040
   macro avg       0.85      0.85      0.84      1040
weighted avg       0.85      0.85      0.84      1040

2022-10-17 14:57:30,681 - trainer - INFO - {
  "train_accuracy_score": 0.8480769230769231,
  "train_loss": 0.4452381283044815
}
2022-10-17 14:57:30,953 - trainer - INFO - 
*****************[epoch: 76, global step: 908] eval development set based on eval_every=2***************
2022-10-17 14:57:30,959 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.90      0.93        42
         2.0       0.97      0.97      0.97        32
         3.0       0.51      0.97      0.67        34
         4.0       1.00      0.83      0.91        36
         5.0       0.48      0.28      0.35        40
         6.0       0.97      0.84      0.90        38
         7.0       0.82      1.00      0.90        33
         8.0       0.79      0.66      0.72        41
         9.0       0.83      0.77      0.80        31

    accuracy                           0.81       360
   macro avg       0.83      0.82      0.81       360
weighted avg       0.83      0.81      0.81       360

2022-10-17 14:57:30,960 - trainer - INFO - {
  "dev_loss": 0.5855646083752314,
  "dev_accuracy": 0.8111111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:30,961 - trainer - INFO -   no_improve_count: 137
2022-10-17 14:57:30,961 - trainer - INFO -   patience: 200
2022-10-17 14:57:30,962 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:30,963 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:30,963 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_902
2022-10-17 14:57:30,964 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_908
2022-10-17 14:57:30,969 - trainer - INFO - save model to path: tmp/mlp_digits\ck_908
2022-10-17 14:57:31,037 - trainer - INFO - 
*****************[epoch: 76, global step: 910] eval training set based on eval_every=2***************
2022-10-17 14:57:31,041 - trainer - INFO -               precision    recall  f1-score   support

           0       0.96      1.00      0.98       126
           1       0.75      0.83      0.79       125
           2       0.99      0.96      0.98       130
           3       0.66      0.96      0.79       130
           4       0.98      0.87      0.92       132
           5       0.62      0.42      0.50       130
           6       0.92      0.90      0.91       133
           7       0.99      0.91      0.95       132
           8       0.79      0.76      0.78       123
           9       0.79      0.80      0.79       139

    accuracy                           0.84      1300
   macro avg       0.85      0.84      0.84      1300
weighted avg       0.85      0.84      0.84      1300

2022-10-17 14:57:31,042 - trainer - INFO - {
  "train_accuracy_score": 0.8423076923076923,
  "train_loss": 0.6135967075824738
}
2022-10-17 14:57:31,348 - trainer - INFO - 
*****************[epoch: 76, global step: 910] eval development set based on eval_every=2***************
2022-10-17 14:57:31,351 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.81      0.88        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.94      0.97        34
         4.0       1.00      0.92      0.96        36
         5.0       0.67      0.72      0.70        40
         6.0       0.97      0.95      0.96        38
         7.0       0.80      1.00      0.89        33
         8.0       0.84      0.88      0.86        41
         9.0       0.83      0.77      0.80        31

    accuracy                           0.89       360
   macro avg       0.90      0.90      0.90       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:57:31,352 - trainer - INFO - {
  "dev_loss": 0.48359168072541553,
  "dev_accuracy": 0.8916666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:31,352 - trainer - INFO -   no_improve_count: 138
2022-10-17 14:57:31,353 - trainer - INFO -   patience: 200
2022-10-17 14:57:31,354 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:31,354 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:31,354 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_904
2022-10-17 14:57:31,355 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_910
2022-10-17 14:57:31,359 - trainer - INFO - save model to path: tmp/mlp_digits\ck_910
2022-10-17 14:57:31,408 - trainer - INFO - 
*****************[epoch: 76, global step: 912] eval training set based on eval_every=2***************
2022-10-17 14:57:31,414 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98       145
           1       0.76      0.83      0.79       140
           2       0.99      0.96      0.98       145
           3       0.70      0.97      0.81       149
           4       0.98      0.87      0.92       145
           5       0.64      0.46      0.53       142
           6       0.92      0.90      0.91       143
           7       0.97      0.92      0.94       146
           8       0.78      0.78      0.78       133
           9       0.80      0.79      0.79       149

    accuracy                           0.85      1437
   macro avg       0.85      0.85      0.84      1437
weighted avg       0.85      0.85      0.85      1437

2022-10-17 14:57:31,416 - trainer - INFO - {
  "train_accuracy_score": 0.848295059151009,
  "train_loss": 0.5591743290424347
}
2022-10-17 14:57:31,702 - trainer - INFO - 
*****************[epoch: 76, global step: 912] eval development set based on eval_every=2***************
2022-10-17 14:57:31,706 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.87      0.81      0.84        42
         2.0       0.94      0.94      0.94        32
         3.0       1.00      0.85      0.92        34
         4.0       0.97      0.92      0.94        36
         5.0       0.69      0.85      0.76        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.80      0.95      0.87        41
         9.0       0.96      0.71      0.81        31

    accuracy                           0.90       360
   macro avg       0.91      0.90      0.90       360
weighted avg       0.91      0.90      0.90       360

2022-10-17 14:57:31,707 - trainer - INFO - {
  "dev_loss": 0.44269875188668567,
  "dev_accuracy": 0.8972222222222223,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:31,708 - trainer - INFO -   no_improve_count: 139
2022-10-17 14:57:31,708 - trainer - INFO -   patience: 200
2022-10-17 14:57:31,710 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:31,710 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:31,710 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_906
2022-10-17 14:57:31,712 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_912
2022-10-17 14:57:31,716 - trainer - INFO - save model to path: tmp/mlp_digits\ck_912
2022-10-17 14:57:31,718 - trainer - INFO - 
*****************[epoch: 76, global step: 913] eval training set at end of epoch***************
2022-10-17 14:57:31,723 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98       145
           1       0.76      0.83      0.79       140
           2       0.99      0.96      0.98       145
           3       0.70      0.97      0.81       149
           4       0.98      0.87      0.92       145
           5       0.64      0.46      0.53       142
           6       0.92      0.90      0.91       143
           7       0.97      0.92      0.94       146
           8       0.78      0.78      0.78       133
           9       0.80      0.79      0.79       149

    accuracy                           0.85      1437
   macro avg       0.85      0.85      0.84      1437
weighted avg       0.85      0.85      0.85      1437

2022-10-17 14:57:31,725 - trainer - INFO - {
  "train_accuracy_score": 0.848295059151009,
  "train_loss": 0.5835512156287829
}
2022-10-17 14:57:31,726 - trainer - INFO - start training epoch 77
2022-10-17 14:57:31,726 - trainer - INFO - training using device=cuda
2022-10-17 14:57:31,727 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:31,727 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:31,789 - trainer - INFO - 
*****************[epoch: 77, global step: 914] eval training set based on eval_every=2***************
2022-10-17 14:57:31,791 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        29
           1       0.79      0.82      0.81        33
           2       1.00      1.00      1.00        28
           3       1.00      0.88      0.94        17
           4       1.00      0.90      0.95        31
           5       0.68      0.86      0.76        22
           6       1.00      1.00      1.00        18
           7       0.94      1.00      0.97        31
           8       0.59      0.94      0.72        18
           9       1.00      0.58      0.73        33

    accuracy                           0.88       260
   macro avg       0.90      0.90      0.89       260
weighted avg       0.91      0.88      0.89       260

2022-10-17 14:57:31,793 - trainer - INFO - {
  "train_accuracy_score": 0.8846153846153846,
  "train_loss": 0.4824620932340622
}
2022-10-17 14:57:32,084 - trainer - INFO - 
*****************[epoch: 77, global step: 914] eval development set based on eval_every=2***************
2022-10-17 14:57:32,088 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.78      1.00      0.88        42
         2.0       0.94      1.00      0.97        32
         3.0       0.79      0.88      0.83        34
         4.0       0.97      0.94      0.96        36
         5.0       0.67      0.60      0.63        40
         6.0       0.97      0.95      0.96        38
         7.0       0.92      1.00      0.96        33
         8.0       0.90      0.88      0.89        41
         9.0       1.00      0.55      0.71        31

    accuracy                           0.88       360
   macro avg       0.89      0.88      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:57:32,089 - trainer - INFO - {
  "dev_loss": 0.4412398785352707,
  "dev_accuracy": 0.8805555555555555,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:32,090 - trainer - INFO -   no_improve_count: 140
2022-10-17 14:57:32,090 - trainer - INFO -   patience: 200
2022-10-17 14:57:32,091 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:32,092 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:32,093 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_908
2022-10-17 14:57:32,094 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_914
2022-10-17 14:57:32,099 - trainer - INFO - save model to path: tmp/mlp_digits\ck_914
2022-10-17 14:57:32,160 - trainer - INFO - 
*****************[epoch: 77, global step: 916] eval training set based on eval_every=2***************
2022-10-17 14:57:32,164 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98        55
           1       0.78      0.88      0.82        56
           2       1.00      1.00      1.00        53
           3       0.85      0.93      0.89        42
           4       0.98      0.94      0.96        54
           5       0.75      0.77      0.76        47
           6       1.00      0.98      0.99        46
           7       0.97      1.00      0.98        62
           8       0.75      0.91      0.83        47
           9       0.95      0.64      0.76        58

    accuracy                           0.90       520
   macro avg       0.90      0.90      0.90       520
weighted avg       0.91      0.90      0.90       520

2022-10-17 14:57:32,165 - trainer - INFO - {
  "train_accuracy_score": 0.9,
  "train_loss": 0.30630481243133545
}
2022-10-17 14:57:32,466 - trainer - INFO - 
*****************[epoch: 77, global step: 916] eval development set based on eval_every=2***************
2022-10-17 14:57:32,471 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.82      0.98      0.89        42
         2.0       0.89      1.00      0.94        32
         3.0       0.78      0.91      0.84        34
         4.0       0.97      0.97      0.97        36
         5.0       0.65      0.55      0.59        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.94      0.93        33
         8.0       1.00      0.80      0.89        41
         9.0       0.96      0.77      0.86        31

    accuracy                           0.89       360
   macro avg       0.89      0.89      0.89       360
weighted avg       0.89      0.89      0.88       360

2022-10-17 14:57:32,473 - trainer - INFO - {
  "dev_loss": 0.4916914403438568,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:32,473 - trainer - INFO -   no_improve_count: 141
2022-10-17 14:57:32,474 - trainer - INFO -   patience: 200
2022-10-17 14:57:32,475 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:32,475 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:32,476 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_910
2022-10-17 14:57:32,477 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_916
2022-10-17 14:57:32,483 - trainer - INFO - save model to path: tmp/mlp_digits\ck_916
2022-10-17 14:57:32,565 - trainer - INFO - 
*****************[epoch: 77, global step: 918] eval training set based on eval_every=2***************
2022-10-17 14:57:32,568 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.95      0.97        81
           1       0.73      0.90      0.81        82
           2       1.00      1.00      1.00        75
           3       0.81      0.95      0.88        74
           4       0.96      0.95      0.96        84
           5       0.76      0.71      0.73        79
           6       1.00      0.97      0.98        65
           7       0.97      0.97      0.97        80
           8       0.80      0.88      0.84        75
           9       0.95      0.66      0.78        85

    accuracy                           0.89       780
   macro avg       0.90      0.89      0.89       780
weighted avg       0.90      0.89      0.89       780

2022-10-17 14:57:32,569 - trainer - INFO - {
  "train_accuracy_score": 0.8910256410256411,
  "train_loss": 0.4975367337465286
}
2022-10-17 14:57:32,843 - trainer - INFO - 
*****************[epoch: 77, global step: 918] eval development set based on eval_every=2***************
2022-10-17 14:57:32,848 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.83      0.89        42
         2.0       0.89      1.00      0.94        32
         3.0       0.84      0.94      0.89        34
         4.0       1.00      1.00      1.00        36
         5.0       0.61      0.55      0.58        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.91      0.91        33
         8.0       0.94      0.80      0.87        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.89       360
   macro avg       0.89      0.90      0.89       360
weighted avg       0.89      0.89      0.89       360

2022-10-17 14:57:32,849 - trainer - INFO - {
  "dev_loss": 0.47242727130651474,
  "dev_accuracy": 0.8888888888888888,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:32,849 - trainer - INFO -   no_improve_count: 142
2022-10-17 14:57:32,850 - trainer - INFO -   patience: 200
2022-10-17 14:57:32,851 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:32,851 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:32,852 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_912
2022-10-17 14:57:32,854 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_918
2022-10-17 14:57:32,860 - trainer - INFO - save model to path: tmp/mlp_digits\ck_918
2022-10-17 14:57:32,934 - trainer - INFO - 
*****************[epoch: 77, global step: 920] eval training set based on eval_every=2***************
2022-10-17 14:57:32,937 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.96      0.98       107
           1       0.78      0.89      0.83       108
           2       0.99      0.99      0.99       107
           3       0.82      0.96      0.88        99
           4       0.97      0.96      0.97       106
           5       0.72      0.68      0.70       103
           6       1.00      0.98      0.99        94
           7       0.97      0.95      0.96       105
           8       0.85      0.89      0.87       102
           9       0.90      0.72      0.80       109

    accuracy                           0.90      1040
   macro avg       0.90      0.90      0.90      1040
weighted avg       0.90      0.90      0.90      1040

2022-10-17 14:57:32,938 - trainer - INFO - {
  "train_accuracy_score": 0.8971153846153846,
  "train_loss": 0.34343819320201874
}
2022-10-17 14:57:33,192 - trainer - INFO - 
*****************[epoch: 77, global step: 920] eval development set based on eval_every=2***************
2022-10-17 14:57:33,195 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.97      0.71      0.82        42
         2.0       0.89      0.97      0.93        32
         3.0       0.91      0.91      0.91        34
         4.0       1.00      0.94      0.97        36
         5.0       0.57      0.57      0.57        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.91      0.91        33
         8.0       0.92      0.80      0.86        41
         9.0       0.73      0.97      0.83        31

    accuracy                           0.87       360
   macro avg       0.87      0.88      0.87       360
weighted avg       0.87      0.87      0.87       360

2022-10-17 14:57:33,195 - trainer - INFO - {
  "dev_loss": 0.4511138126254082,
  "dev_accuracy": 0.8666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:33,196 - trainer - INFO -   no_improve_count: 143
2022-10-17 14:57:33,196 - trainer - INFO -   patience: 200
2022-10-17 14:57:33,197 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:33,197 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:33,197 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_914
2022-10-17 14:57:33,198 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_920
2022-10-17 14:57:33,202 - trainer - INFO - save model to path: tmp/mlp_digits\ck_920
2022-10-17 14:57:33,271 - trainer - INFO - 
*****************[epoch: 77, global step: 922] eval training set based on eval_every=2***************
2022-10-17 14:57:33,275 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97       134
           1       0.80      0.86      0.83       128
           2       0.99      0.99      0.99       133
           3       0.86      0.96      0.91       132
           4       0.98      0.93      0.95       135
           5       0.69      0.72      0.70       127
           6       0.99      0.98      0.99       127
           7       0.97      0.94      0.95       128
           8       0.86      0.88      0.87       120
           9       0.90      0.75      0.82       136

    accuracy                           0.90      1300
   macro avg       0.90      0.90      0.90      1300
weighted avg       0.90      0.90      0.90      1300

2022-10-17 14:57:33,276 - trainer - INFO - {
  "train_accuracy_score": 0.8992307692307693,
  "train_loss": 0.3394647240638733
}
2022-10-17 14:57:33,540 - trainer - INFO - 
*****************[epoch: 77, global step: 922] eval development set based on eval_every=2***************
2022-10-17 14:57:33,543 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       1.00      0.81      0.89        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.88      0.92        34
         4.0       1.00      0.92      0.96        36
         5.0       0.59      0.65      0.62        40
         6.0       0.95      0.97      0.96        38
         7.0       0.91      0.94      0.93        33
         8.0       0.91      0.76      0.83        41
         9.0       0.71      0.97      0.82        31

    accuracy                           0.88       360
   macro avg       0.89      0.89      0.88       360
weighted avg       0.89      0.88      0.88       360

2022-10-17 14:57:33,544 - trainer - INFO - {
  "dev_loss": 0.37795676042636234,
  "dev_accuracy": 0.8777777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:33,544 - trainer - INFO -   no_improve_count: 144
2022-10-17 14:57:33,545 - trainer - INFO -   patience: 200
2022-10-17 14:57:33,546 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:33,546 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:33,546 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_916
2022-10-17 14:57:33,547 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_922
2022-10-17 14:57:33,552 - trainer - INFO - save model to path: tmp/mlp_digits\ck_922
2022-10-17 14:57:33,653 - trainer - INFO - 
*****************[epoch: 77, global step: 924] eval training set based on eval_every=2***************
2022-10-17 14:57:33,657 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97       145
           1       0.81      0.84      0.82       140
           2       0.99      0.99      0.99       145
           3       0.84      0.94      0.89       149
           4       0.98      0.94      0.96       145
           5       0.69      0.71      0.70       142
           6       0.99      0.99      0.99       143
           7       0.97      0.95      0.96       146
           8       0.87      0.89      0.88       133
           9       0.88      0.77      0.82       149

    accuracy                           0.90      1437
   macro avg       0.90      0.90      0.90      1437
weighted avg       0.90      0.90      0.90      1437

2022-10-17 14:57:33,658 - trainer - INFO - {
  "train_accuracy_score": 0.8977035490605428,
  "train_loss": 0.2669895477592945
}
2022-10-17 14:57:33,919 - trainer - INFO - 
*****************[epoch: 77, global step: 924] eval development set based on eval_every=2***************
2022-10-17 14:57:33,922 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.90      0.94        42
         2.0       0.97      0.97      0.97        32
         3.0       0.87      0.97      0.92        34
         4.0       1.00      0.94      0.97        36
         5.0       0.71      0.80      0.75        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.94      0.80      0.87        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.92       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:33,924 - trainer - INFO - {
  "dev_loss": 0.22764198233683905,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:33,925 - trainer - INFO -   no_improve_count: 145
2022-10-17 14:57:33,928 - trainer - INFO -   patience: 200
2022-10-17 14:57:33,929 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:33,929 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:33,929 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_918
2022-10-17 14:57:33,930 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_924
2022-10-17 14:57:33,936 - trainer - INFO - save model to path: tmp/mlp_digits\ck_924
2022-10-17 14:57:33,939 - trainer - INFO - 
*****************[epoch: 77, global step: 925] eval training set at end of epoch***************
2022-10-17 14:57:33,946 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      0.97      0.97       145
           1       0.81      0.84      0.82       140
           2       0.99      0.99      0.99       145
           3       0.84      0.94      0.89       149
           4       0.98      0.94      0.96       145
           5       0.69      0.71      0.70       142
           6       0.99      0.99      0.99       143
           7       0.97      0.95      0.96       146
           8       0.87      0.89      0.88       133
           9       0.88      0.77      0.82       149

    accuracy                           0.90      1437
   macro avg       0.90      0.90      0.90      1437
weighted avg       0.90      0.90      0.90      1437

2022-10-17 14:57:33,948 - trainer - INFO - {
  "train_accuracy_score": 0.8977035490605428,
  "train_loss": 0.3726993507395188
}
2022-10-17 14:57:33,949 - trainer - INFO - start training epoch 78
2022-10-17 14:57:33,949 - trainer - INFO - training using device=cuda
2022-10-17 14:57:33,950 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:33,950 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:34,017 - trainer - INFO - 
*****************[epoch: 78, global step: 926] eval training set based on eval_every=2***************
2022-10-17 14:57:34,020 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        26
           1       0.92      0.92      0.92        24
           2       1.00      1.00      1.00        20
           3       0.96      1.00      0.98        24
           4       1.00      0.93      0.96        28
           5       0.68      0.92      0.78        25
           6       1.00      1.00      1.00        25
           7       1.00      0.94      0.97        33
           8       1.00      0.91      0.95        33
           9       0.89      0.77      0.83        22

    accuracy                           0.94       260
   macro avg       0.94      0.94      0.94       260
weighted avg       0.95      0.94      0.94       260

2022-10-17 14:57:34,021 - trainer - INFO - {
  "train_accuracy_score": 0.9384615384615385,
  "train_loss": 0.210628904402256
}
2022-10-17 14:57:34,294 - trainer - INFO - 
*****************[epoch: 78, global step: 926] eval development set based on eval_every=2***************
2022-10-17 14:57:34,297 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.84      1.00      0.91        42
         2.0       1.00      0.94      0.97        32
         3.0       0.94      1.00      0.97        34
         4.0       1.00      0.92      0.96        36
         5.0       0.68      0.85      0.76        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.92      0.88      0.90        41
         9.0       1.00      0.48      0.65        31

    accuracy                           0.91       360
   macro avg       0.93      0.90      0.90       360
weighted avg       0.92      0.91      0.90       360

2022-10-17 14:57:34,300 - trainer - INFO - {
  "dev_loss": 0.2985803037881851,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:34,300 - trainer - INFO -   no_improve_count: 146
2022-10-17 14:57:34,301 - trainer - INFO -   patience: 200
2022-10-17 14:57:34,302 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:34,302 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:34,302 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_920
2022-10-17 14:57:34,303 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_926
2022-10-17 14:57:34,309 - trainer - INFO - save model to path: tmp/mlp_digits\ck_926
2022-10-17 14:57:34,379 - trainer - INFO - 
*****************[epoch: 78, global step: 928] eval training set based on eval_every=2***************
2022-10-17 14:57:34,382 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        54
           1       0.84      0.94      0.89        52
           2       1.00      0.98      0.99        48
           3       0.98      0.90      0.94        52
           4       1.00      0.92      0.96        49
           5       0.71      0.96      0.82        52
           6       1.00      0.98      0.99        51
           7       1.00      0.96      0.98        56
           8       0.88      0.93      0.90        56
           9       0.94      0.66      0.78        50

    accuracy                           0.93       520
   macro avg       0.94      0.92      0.93       520
weighted avg       0.94      0.93      0.93       520

2022-10-17 14:57:34,383 - trainer - INFO - {
  "train_accuracy_score": 0.925,
  "train_loss": 0.33996298909187317
}
2022-10-17 14:57:34,667 - trainer - INFO - 
*****************[epoch: 78, global step: 928] eval development set based on eval_every=2***************
2022-10-17 14:57:34,670 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.88      1.00      0.93        42
         2.0       1.00      0.94      0.97        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.94      0.97        36
         5.0       0.62      0.82      0.71        40
         6.0       0.97      1.00      0.99        38
         7.0       0.92      1.00      0.96        33
         8.0       0.95      0.90      0.92        41
         9.0       1.00      0.45      0.62        31

    accuracy                           0.91       360
   macro avg       0.93      0.90      0.90       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:57:34,671 - trainer - INFO - {
  "dev_loss": 0.3038218667109807,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:34,672 - trainer - INFO -   no_improve_count: 147
2022-10-17 14:57:34,672 - trainer - INFO -   patience: 200
2022-10-17 14:57:34,673 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:34,674 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:34,674 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_922
2022-10-17 14:57:34,675 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_928
2022-10-17 14:57:34,680 - trainer - INFO - save model to path: tmp/mlp_digits\ck_928
2022-10-17 14:57:34,802 - trainer - INFO - 
*****************[epoch: 78, global step: 930] eval training set based on eval_every=2***************
2022-10-17 14:57:34,805 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        75
           1       0.82      0.96      0.88        75
           2       1.00      0.96      0.98        78
           3       0.97      0.92      0.94        83
           4       1.00      0.91      0.95        78
           5       0.66      0.95      0.78        76
           6       1.00      0.96      0.98        74
           7       0.98      0.98      0.98        81
           8       0.85      0.94      0.89        78
           9       0.96      0.54      0.69        82

    accuracy                           0.91       780
   macro avg       0.92      0.91      0.91       780
weighted avg       0.92      0.91      0.91       780

2022-10-17 14:57:34,807 - trainer - INFO - {
  "train_accuracy_score": 0.9076923076923077,
  "train_loss": 0.4681856781244278
}
2022-10-17 14:57:35,079 - trainer - INFO - 
*****************[epoch: 78, global step: 930] eval development set based on eval_every=2***************
2022-10-17 14:57:35,082 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      0.94      0.97        32
         3.0       0.97      0.94      0.96        34
         4.0       1.00      0.97      0.99        36
         5.0       0.69      0.85      0.76        40
         6.0       0.95      0.97      0.96        38
         7.0       0.92      1.00      0.96        33
         8.0       1.00      0.85      0.92        41
         9.0       1.00      0.87      0.93        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:35,083 - trainer - INFO - {
  "dev_loss": 0.21561426545182863,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:35,084 - trainer - INFO -   no_improve_count: 148
2022-10-17 14:57:35,085 - trainer - INFO -   patience: 200
2022-10-17 14:57:35,086 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:35,086 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:35,086 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_924
2022-10-17 14:57:35,087 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_930
2022-10-17 14:57:35,091 - trainer - INFO - save model to path: tmp/mlp_digits\ck_930
2022-10-17 14:57:35,163 - trainer - INFO - 
*****************[epoch: 78, global step: 932] eval training set based on eval_every=2***************
2022-10-17 14:57:35,167 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       100
           1       0.86      0.92      0.89       105
           2       1.00      0.96      0.98       100
           3       0.98      0.92      0.95       106
           4       1.00      0.92      0.96       105
           5       0.70      0.93      0.80       106
           6       1.00      0.96      0.98       106
           7       0.98      0.98      0.98       106
           8       0.86      0.94      0.90        98
           9       0.87      0.63      0.73       108

    accuracy                           0.92      1040
   macro avg       0.93      0.92      0.92      1040
weighted avg       0.92      0.92      0.92      1040

2022-10-17 14:57:35,168 - trainer - INFO - {
  "train_accuracy_score": 0.9163461538461538,
  "train_loss": 0.19951137155294418
}
2022-10-17 14:57:35,441 - trainer - INFO - 
*****************[epoch: 78, global step: 932] eval development set based on eval_every=2***************
2022-10-17 14:57:35,445 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.86      0.91        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.85      0.91        34
         4.0       1.00      1.00      1.00        36
         5.0       0.67      0.75      0.71        40
         6.0       0.95      0.97      0.96        38
         7.0       0.85      1.00      0.92        33
         8.0       1.00      0.76      0.86        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.91       360
   macro avg       0.92      0.92      0.91       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:57:35,447 - trainer - INFO - {
  "dev_loss": 0.3288116653760274,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:35,448 - trainer - INFO -   no_improve_count: 149
2022-10-17 14:57:35,448 - trainer - INFO -   patience: 200
2022-10-17 14:57:35,450 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:35,450 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:35,450 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_926
2022-10-17 14:57:35,451 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_932
2022-10-17 14:57:35,457 - trainer - INFO - save model to path: tmp/mlp_digits\ck_932
2022-10-17 14:57:35,526 - trainer - INFO - 
*****************[epoch: 78, global step: 934] eval training set based on eval_every=2***************
2022-10-17 14:57:35,530 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       129
           1       0.88      0.93      0.91       132
           2       1.00      0.97      0.98       123
           3       0.98      0.92      0.95       134
           4       0.99      0.93      0.96       133
           5       0.69      0.91      0.79       129
           6       0.99      0.97      0.98       127
           7       0.96      0.98      0.97       134
           8       0.88      0.92      0.90       125
           9       0.89      0.66      0.76       134

    accuracy                           0.92      1300
   macro avg       0.93      0.92      0.92      1300
weighted avg       0.93      0.92      0.92      1300

2022-10-17 14:57:35,531 - trainer - INFO - {
  "train_accuracy_score": 0.9184615384615384,
  "train_loss": 0.23255615681409836
}
2022-10-17 14:57:35,838 - trainer - INFO - 
*****************[epoch: 78, global step: 934] eval development set based on eval_every=2***************
2022-10-17 14:57:35,842 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.88      0.91        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.85      0.92        34
         4.0       0.92      1.00      0.96        36
         5.0       0.67      0.75      0.71        40
         6.0       0.95      0.97      0.96        38
         7.0       0.89      0.97      0.93        33
         8.0       1.00      0.78      0.88        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.91       360
   macro avg       0.91      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:57:35,844 - trainer - INFO - {
  "dev_loss": 0.35440488159656525,
  "dev_accuracy": 0.9055555555555556,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:35,845 - trainer - INFO -   no_improve_count: 150
2022-10-17 14:57:35,846 - trainer - INFO -   patience: 200
2022-10-17 14:57:35,847 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:35,850 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:35,850 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_928
2022-10-17 14:57:35,852 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_934
2022-10-17 14:57:35,857 - trainer - INFO - save model to path: tmp/mlp_digits\ck_934
2022-10-17 14:57:35,898 - trainer - INFO - 
*****************[epoch: 78, global step: 936] eval training set based on eval_every=2***************
2022-10-17 14:57:35,902 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.88      0.93      0.90       140
           2       1.00      0.97      0.99       145
           3       0.99      0.93      0.96       149
           4       0.99      0.94      0.96       145
           5       0.70      0.91      0.79       142
           6       0.99      0.97      0.98       143
           7       0.95      0.98      0.97       146
           8       0.89      0.91      0.90       133
           9       0.90      0.69      0.78       149

    accuracy                           0.92      1437
   macro avg       0.93      0.92      0.92      1437
weighted avg       0.93      0.92      0.92      1437

2022-10-17 14:57:35,903 - trainer - INFO - {
  "train_accuracy_score": 0.9220598469032707,
  "train_loss": 0.12841426208615303
}
2022-10-17 14:57:36,182 - trainer - INFO - 
*****************[epoch: 78, global step: 936] eval development set based on eval_every=2***************
2022-10-17 14:57:36,185 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.91      0.94        34
         4.0       0.92      1.00      0.96        36
         5.0       0.66      0.78      0.71        40
         6.0       0.93      0.97      0.95        38
         7.0       0.94      0.94      0.94        33
         8.0       1.00      0.78      0.88        41
         9.0       0.90      0.87      0.89        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:57:36,187 - trainer - INFO - {
  "dev_loss": 0.3923852468530337,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:36,188 - trainer - INFO -   no_improve_count: 151
2022-10-17 14:57:36,188 - trainer - INFO -   patience: 200
2022-10-17 14:57:36,189 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:36,190 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:36,190 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_930
2022-10-17 14:57:36,191 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_936
2022-10-17 14:57:36,196 - trainer - INFO - save model to path: tmp/mlp_digits\ck_936
2022-10-17 14:57:36,197 - trainer - INFO - 
*****************[epoch: 78, global step: 937] eval training set at end of epoch***************
2022-10-17 14:57:36,201 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.88      0.93      0.90       140
           2       1.00      0.97      0.99       145
           3       0.99      0.93      0.96       149
           4       0.99      0.94      0.96       145
           5       0.70      0.91      0.79       142
           6       0.99      0.97      0.98       143
           7       0.95      0.98      0.97       146
           8       0.89      0.91      0.90       133
           9       0.90      0.69      0.78       149

    accuracy                           0.92      1437
   macro avg       0.93      0.92      0.92      1437
weighted avg       0.93      0.92      0.92      1437

2022-10-17 14:57:36,203 - trainer - INFO - {
  "train_accuracy_score": 0.9220598469032707,
  "train_loss": 0.2632098936786254
}
2022-10-17 14:57:36,204 - trainer - INFO - start training epoch 79
2022-10-17 14:57:36,204 - trainer - INFO - training using device=cuda
2022-10-17 14:57:36,204 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:36,204 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:36,269 - trainer - INFO - 
*****************[epoch: 79, global step: 938] eval training set based on eval_every=2***************
2022-10-17 14:57:36,272 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        35
           1       0.97      0.97      0.97        30
           2       1.00      0.96      0.98        25
           3       0.96      0.96      0.96        25
           4       0.93      1.00      0.97        28
           5       0.71      0.85      0.77        20
           6       0.96      1.00      0.98        27
           7       1.00      0.83      0.91        29
           8       1.00      0.84      0.91        19
           9       0.79      0.86      0.83        22

    accuracy                           0.93       260
   macro avg       0.93      0.93      0.93       260
weighted avg       0.94      0.93      0.94       260

2022-10-17 14:57:36,274 - trainer - INFO - {
  "train_accuracy_score": 0.9346153846153846,
  "train_loss": 0.25828681141138077
}
2022-10-17 14:57:36,543 - trainer - INFO - 
*****************[epoch: 79, global step: 938] eval development set based on eval_every=2***************
2022-10-17 14:57:36,549 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.94      0.96        34
         4.0       0.95      1.00      0.97        36
         5.0       0.71      0.75      0.73        40
         6.0       0.95      0.97      0.96        38
         7.0       0.97      0.94      0.95        33
         8.0       1.00      0.80      0.89        41
         9.0       0.81      0.94      0.87        31

    accuracy                           0.92       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.92      0.92       360

2022-10-17 14:57:36,550 - trainer - INFO - {
  "dev_loss": 0.37562615672747296,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:36,550 - trainer - INFO -   no_improve_count: 152
2022-10-17 14:57:36,551 - trainer - INFO -   patience: 200
2022-10-17 14:57:36,552 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:36,552 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:36,552 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_932
2022-10-17 14:57:36,553 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_938
2022-10-17 14:57:36,559 - trainer - INFO - save model to path: tmp/mlp_digits\ck_938
2022-10-17 14:57:36,617 - trainer - INFO - 
*****************[epoch: 79, global step: 940] eval training set based on eval_every=2***************
2022-10-17 14:57:36,620 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        51
           1       0.96      0.96      0.96        53
           2       0.98      0.98      0.98        52
           3       0.95      0.98      0.96        54
           4       0.94      1.00      0.97        63
           5       0.74      0.83      0.79        42
           6       0.97      1.00      0.98        58
           7       1.00      0.85      0.92        53
           8       1.00      0.89      0.94        44
           9       0.90      0.90      0.90        50

    accuracy                           0.94       520
   macro avg       0.94      0.94      0.94       520
weighted avg       0.95      0.94      0.94       520

2022-10-17 14:57:36,621 - trainer - INFO - {
  "train_accuracy_score": 0.9442307692307692,
  "train_loss": 0.1967911422252655
}
2022-10-17 14:57:36,926 - trainer - INFO - 
*****************[epoch: 79, global step: 940] eval development set based on eval_every=2***************
2022-10-17 14:57:36,929 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.94      1.00      0.97        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.89      0.94      0.91        34
         4.0       1.00      1.00      1.00        36
         5.0       0.72      0.57      0.64        40
         6.0       0.95      0.97      0.96        38
         7.0       0.97      0.94      0.95        33
         8.0       1.00      0.85      0.92        41
         9.0       0.72      1.00      0.84        31

    accuracy                           0.91       360
   macro avg       0.91      0.92      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:57:36,930 - trainer - INFO - {
  "dev_loss": 0.3550512095292409,
  "dev_accuracy": 0.9083333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:36,931 - trainer - INFO -   no_improve_count: 153
2022-10-17 14:57:36,931 - trainer - INFO -   patience: 200
2022-10-17 14:57:36,932 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:36,932 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:36,933 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_934
2022-10-17 14:57:36,934 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_940
2022-10-17 14:57:36,939 - trainer - INFO - save model to path: tmp/mlp_digits\ck_940
2022-10-17 14:57:37,000 - trainer - INFO - 
*****************[epoch: 79, global step: 942] eval training set based on eval_every=2***************
2022-10-17 14:57:37,006 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        85
           1       0.95      0.96      0.95        73
           2       0.99      0.99      0.99        88
           3       0.91      0.97      0.94        74
           4       0.96      0.99      0.97        88
           5       0.80      0.80      0.80        69
           6       0.97      1.00      0.98        83
           7       1.00      0.89      0.94        76
           8       1.00      0.91      0.95        68
           9       0.90      0.92      0.91        76

    accuracy                           0.95       780
   macro avg       0.95      0.94      0.94       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:57:37,007 - trainer - INFO - {
  "train_accuracy_score": 0.9474358974358974,
  "train_loss": 0.16500861942768097
}
2022-10-17 14:57:37,265 - trainer - INFO - 
*****************[epoch: 79, global step: 942] eval development set based on eval_every=2***************
2022-10-17 14:57:37,268 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.85      0.97      0.90        34
         4.0       1.00      0.97      0.99        36
         5.0       0.80      0.60      0.69        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.90      0.95        41
         9.0       0.76      1.00      0.86        31

    accuracy                           0.92       360
   macro avg       0.92      0.93      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:37,269 - trainer - INFO - {
  "dev_loss": 0.3583595057328542,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:37,270 - trainer - INFO -   no_improve_count: 154
2022-10-17 14:57:37,270 - trainer - INFO -   patience: 200
2022-10-17 14:57:37,274 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:37,274 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:37,275 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_936
2022-10-17 14:57:37,276 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_942
2022-10-17 14:57:37,279 - trainer - INFO - save model to path: tmp/mlp_digits\ck_942
2022-10-17 14:57:37,343 - trainer - INFO - 
*****************[epoch: 79, global step: 944] eval training set based on eval_every=2***************
2022-10-17 14:57:37,346 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       107
           1       0.95      0.96      0.95        95
           2       0.99      0.98      0.99       109
           3       0.88      0.98      0.93        99
           4       0.96      0.96      0.96       114
           5       0.82      0.75      0.78       103
           6       0.97      0.98      0.98       100
           7       0.98      0.93      0.95       112
           8       0.99      0.92      0.95        91
           9       0.86      0.92      0.89       110

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.94      0.94      0.94      1040

2022-10-17 14:57:37,348 - trainer - INFO - {
  "train_accuracy_score": 0.9384615384615385,
  "train_loss": 0.26976800709962845
}
2022-10-17 14:57:37,618 - trainer - INFO - 
*****************[epoch: 79, global step: 944] eval development set based on eval_every=2***************
2022-10-17 14:57:37,621 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.93      0.94        42
         2.0       0.97      0.97      0.97        32
         3.0       0.94      0.94      0.94        34
         4.0       1.00      0.97      0.99        36
         5.0       0.78      0.88      0.82        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.88      0.92        41
         9.0       0.94      0.94      0.94        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.95       360

2022-10-17 14:57:37,622 - trainer - INFO - {
  "dev_loss": 0.18506397555271784,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:37,623 - trainer - INFO -   no_improve_count: 155
2022-10-17 14:57:37,623 - trainer - INFO -   patience: 200
2022-10-17 14:57:37,624 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:37,625 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:37,625 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_938
2022-10-17 14:57:37,626 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_944
2022-10-17 14:57:37,630 - trainer - INFO - save model to path: tmp/mlp_digits\ck_944
2022-10-17 14:57:37,693 - trainer - INFO - 
*****************[epoch: 79, global step: 946] eval training set based on eval_every=2***************
2022-10-17 14:57:37,696 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       133
           1       0.94      0.96      0.95       121
           2       0.99      0.98      0.98       134
           3       0.91      0.99      0.95       135
           4       0.97      0.97      0.97       131
           5       0.82      0.79      0.80       131
           6       0.98      0.98      0.98       129
           7       0.98      0.93      0.96       133
           8       0.96      0.92      0.94       116
           9       0.87      0.89      0.88       137

    accuracy                           0.94      1300
   macro avg       0.94      0.94      0.94      1300
weighted avg       0.94      0.94      0.94      1300

2022-10-17 14:57:37,698 - trainer - INFO - {
  "train_accuracy_score": 0.94,
  "train_loss": 0.20449955761432648
}
2022-10-17 14:57:38,008 - trainer - INFO - 
*****************[epoch: 79, global step: 946] eval development set based on eval_every=2***************
2022-10-17 14:57:38,010 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.87      0.95      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      0.97      0.99        36
         5.0       0.65      0.93      0.76        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.88      0.92        41
         9.0       0.94      0.55      0.69        31

    accuracy                           0.92       360
   macro avg       0.94      0.91      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:38,011 - trainer - INFO - {
  "dev_loss": 0.23891430720686913,
  "dev_accuracy": 0.9166666666666666,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:38,012 - trainer - INFO -   no_improve_count: 156
2022-10-17 14:57:38,013 - trainer - INFO -   patience: 200
2022-10-17 14:57:38,014 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:38,014 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:38,014 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_940
2022-10-17 14:57:38,016 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_946
2022-10-17 14:57:38,020 - trainer - INFO - save model to path: tmp/mlp_digits\ck_946
2022-10-17 14:57:38,069 - trainer - INFO - 
*****************[epoch: 79, global step: 948] eval training set based on eval_every=2***************
2022-10-17 14:57:38,073 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.91      0.96      0.94       140
           2       0.99      0.98      0.99       145
           3       0.92      0.97      0.94       149
           4       0.97      0.96      0.97       145
           5       0.80      0.80      0.80       142
           6       0.98      0.98      0.98       143
           7       0.99      0.94      0.96       146
           8       0.96      0.93      0.95       133
           9       0.88      0.86      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:57:38,074 - trainer - INFO - {
  "train_accuracy_score": 0.9387613082811412,
  "train_loss": 0.16263218224048615
}
2022-10-17 14:57:38,334 - trainer - INFO - 
*****************[epoch: 79, global step: 948] eval development set based on eval_every=2***************
2022-10-17 14:57:38,339 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.93      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.64      0.93      0.76        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.88      0.92        41
         9.0       1.00      0.65      0.78        31

    accuracy                           0.93       360
   macro avg       0.95      0.92      0.93       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:57:38,340 - trainer - INFO - {
  "dev_loss": 0.25884054228663445,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:38,341 - trainer - INFO -   no_improve_count: 157
2022-10-17 14:57:38,341 - trainer - INFO -   patience: 200
2022-10-17 14:57:38,343 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:38,343 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:38,343 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_942
2022-10-17 14:57:38,344 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_948
2022-10-17 14:57:38,348 - trainer - INFO - save model to path: tmp/mlp_digits\ck_948
2022-10-17 14:57:38,350 - trainer - INFO - 
*****************[epoch: 79, global step: 949] eval training set at end of epoch***************
2022-10-17 14:57:38,353 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       145
           1       0.91      0.96      0.94       140
           2       0.99      0.98      0.99       145
           3       0.92      0.97      0.94       149
           4       0.97      0.96      0.97       145
           5       0.80      0.80      0.80       142
           6       0.98      0.98      0.98       143
           7       0.99      0.94      0.96       146
           8       0.96      0.93      0.95       133
           9       0.88      0.86      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:57:38,355 - trainer - INFO - {
  "train_accuracy_score": 0.9387613082811412,
  "train_loss": 0.20949772000312805
}
2022-10-17 14:57:38,356 - trainer - INFO - start training epoch 80
2022-10-17 14:57:38,356 - trainer - INFO - training using device=cuda
2022-10-17 14:57:38,357 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:38,357 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:38,425 - trainer - INFO - 
*****************[epoch: 80, global step: 950] eval training set based on eval_every=2***************
2022-10-17 14:57:38,428 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        29
           1       0.92      1.00      0.96        24
           2       1.00      1.00      1.00        26
           3       1.00      0.89      0.94        19
           4       1.00      0.96      0.98        26
           5       0.68      0.96      0.79        26
           6       1.00      1.00      1.00        29
           7       0.96      1.00      0.98        25
           8       1.00      0.89      0.94        28
           9       1.00      0.71      0.83        28

    accuracy                           0.94       260
   macro avg       0.96      0.94      0.94       260
weighted avg       0.96      0.94      0.94       260

2022-10-17 14:57:38,429 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.2073892280459404
}
2022-10-17 14:57:38,690 - trainer - INFO - 
*****************[epoch: 80, global step: 950] eval development set based on eval_every=2***************
2022-10-17 14:57:38,694 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       0.91      0.97      0.94        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      0.94      0.97        36
         5.0       0.61      0.90      0.73        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      1.00      1.00        33
         8.0       1.00      0.88      0.94        41
         9.0       1.00      0.71      0.83        31

    accuracy                           0.92       360
   macro avg       0.95      0.92      0.93       360
weighted avg       0.94      0.92      0.93       360

2022-10-17 14:57:38,696 - trainer - INFO - {
  "dev_loss": 0.29925661782423657,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:38,697 - trainer - INFO -   no_improve_count: 158
2022-10-17 14:57:38,697 - trainer - INFO -   patience: 200
2022-10-17 14:57:38,698 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:38,702 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:38,702 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_944
2022-10-17 14:57:38,704 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_950
2022-10-17 14:57:38,710 - trainer - INFO - save model to path: tmp/mlp_digits\ck_950
2022-10-17 14:57:38,781 - trainer - INFO - 
*****************[epoch: 80, global step: 952] eval training set based on eval_every=2***************
2022-10-17 14:57:38,784 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        51
           1       0.94      0.94      0.94        50
           2       1.00      1.00      1.00        40
           3       0.96      0.94      0.95        52
           4       1.00      0.96      0.98        52
           5       0.75      0.97      0.84        59
           6       0.98      1.00      0.99        51
           7       0.93      1.00      0.96        51
           8       0.95      0.93      0.94        56
           9       1.00      0.69      0.82        58

    accuracy                           0.94       520
   macro avg       0.95      0.94      0.94       520
weighted avg       0.95      0.94      0.94       520

2022-10-17 14:57:38,785 - trainer - INFO - {
  "train_accuracy_score": 0.9384615384615385,
  "train_loss": 0.22358028963208199
}
2022-10-17 14:57:39,096 - trainer - INFO - 
*****************[epoch: 80, global step: 952] eval development set based on eval_every=2***************
2022-10-17 14:57:39,101 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.93      0.94        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.91      0.94        34
         4.0       1.00      0.94      0.97        36
         5.0       0.73      0.93      0.81        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       0.97      0.93      0.95        41
         9.0       1.00      0.87      0.93        31

    accuracy                           0.94       360
   macro avg       0.96      0.94      0.95       360
weighted avg       0.95      0.94      0.95       360

2022-10-17 14:57:39,102 - trainer - INFO - {
  "dev_loss": 0.2235343630115191,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:39,103 - trainer - INFO -   no_improve_count: 159
2022-10-17 14:57:39,103 - trainer - INFO -   patience: 200
2022-10-17 14:57:39,105 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:39,105 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:39,105 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_946
2022-10-17 14:57:39,107 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_952
2022-10-17 14:57:39,112 - trainer - INFO - save model to path: tmp/mlp_digits\ck_952
2022-10-17 14:57:39,181 - trainer - INFO - 
*****************[epoch: 80, global step: 954] eval training set based on eval_every=2***************
2022-10-17 14:57:39,184 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        81
           1       0.94      0.93      0.93        80
           2       1.00      1.00      1.00        63
           3       0.97      0.93      0.95        76
           4       1.00      0.91      0.95        79
           5       0.76      0.97      0.85        80
           6       0.98      1.00      0.99        82
           7       0.94      1.00      0.97        77
           8       0.89      0.93      0.91        82
           9       1.00      0.72      0.84        80

    accuracy                           0.94       780
   macro avg       0.95      0.94      0.94       780
weighted avg       0.95      0.94      0.94       780

2022-10-17 14:57:39,185 - trainer - INFO - {
  "train_accuracy_score": 0.9384615384615385,
  "train_loss": 0.23329070210456848
}
2022-10-17 14:57:39,462 - trainer - INFO - 
*****************[epoch: 80, global step: 954] eval development set based on eval_every=2***************
2022-10-17 14:57:39,466 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.93      0.94        42
         2.0       0.97      0.94      0.95        32
         3.0       1.00      0.85      0.92        34
         4.0       1.00      0.94      0.97        36
         5.0       0.84      0.90      0.87        40
         6.0       0.90      1.00      0.95        38
         7.0       1.00      0.94      0.97        33
         8.0       0.91      0.95      0.93        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:39,467 - trainer - INFO - {
  "dev_loss": 0.20806373159090677,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:39,468 - trainer - INFO -   no_improve_count: 160
2022-10-17 14:57:39,468 - trainer - INFO -   patience: 200
2022-10-17 14:57:39,469 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:39,469 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:39,471 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_948
2022-10-17 14:57:39,472 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_954
2022-10-17 14:57:39,477 - trainer - INFO - save model to path: tmp/mlp_digits\ck_954
2022-10-17 14:57:39,547 - trainer - INFO - 
*****************[epoch: 80, global step: 956] eval training set based on eval_every=2***************
2022-10-17 14:57:39,551 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       107
           1       0.92      0.92      0.92       101
           2       1.00      0.97      0.98        98
           3       0.98      0.95      0.96       100
           4       1.00      0.92      0.96       110
           5       0.78      0.96      0.86       105
           6       0.98      1.00      0.99       108
           7       0.95      0.98      0.97       105
           8       0.87      0.93      0.90       101
           9       0.96      0.76      0.85       105

    accuracy                           0.94      1040
   macro avg       0.94      0.94      0.94      1040
weighted avg       0.95      0.94      0.94      1040

2022-10-17 14:57:39,552 - trainer - INFO - {
  "train_accuracy_score": 0.9394230769230769,
  "train_loss": 0.26227912306785583
}
2022-10-17 14:57:39,840 - trainer - INFO - 
*****************[epoch: 80, global step: 956] eval development set based on eval_every=2***************
2022-10-17 14:57:39,844 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.90      0.94        42
         2.0       1.00      0.94      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       1.00      1.00      1.00        36
         5.0       0.81      0.85      0.83        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      0.94      0.97        33
         8.0       0.93      0.95      0.94        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:57:39,845 - trainer - INFO - {
  "dev_loss": 0.22891719887653986,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:39,846 - trainer - INFO -   no_improve_count: 161
2022-10-17 14:57:39,847 - trainer - INFO -   patience: 200
2022-10-17 14:57:39,848 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:39,848 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:39,848 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_950
2022-10-17 14:57:39,849 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_956
2022-10-17 14:57:39,854 - trainer - INFO - save model to path: tmp/mlp_digits\ck_956
2022-10-17 14:57:39,932 - trainer - INFO - 
*****************[epoch: 80, global step: 958] eval training set based on eval_every=2***************
2022-10-17 14:57:39,936 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       134
           1       0.93      0.91      0.92       128
           2       1.00      0.97      0.98       122
           3       0.98      0.95      0.96       129
           4       1.00      0.92      0.96       128
           5       0.79      0.95      0.86       129
           6       0.99      1.00      0.99       132
           7       0.96      0.99      0.97       134
           8       0.89      0.94      0.91       124
           9       0.92      0.82      0.87       140

    accuracy                           0.94      1300
   macro avg       0.95      0.94      0.94      1300
weighted avg       0.95      0.94      0.94      1300

2022-10-17 14:57:39,938 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.1404036283493042
}
2022-10-17 14:57:40,195 - trainer - INFO - 
*****************[epoch: 80, global step: 958] eval development set based on eval_every=2***************
2022-10-17 14:57:40,198 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.90      0.94        42
         2.0       0.97      0.94      0.95        32
         3.0       1.00      0.85      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.76      0.88      0.81        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.90      0.95        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:57:40,199 - trainer - INFO - {
  "dev_loss": 0.2482418268918991,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:40,199 - trainer - INFO -   no_improve_count: 162
2022-10-17 14:57:40,200 - trainer - INFO -   patience: 200
2022-10-17 14:57:40,201 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:40,203 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:40,204 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_952
2022-10-17 14:57:40,205 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_958
2022-10-17 14:57:40,209 - trainer - INFO - save model to path: tmp/mlp_digits\ck_958
2022-10-17 14:57:40,312 - trainer - INFO - 
*****************[epoch: 80, global step: 960] eval training set based on eval_every=2***************
2022-10-17 14:57:40,316 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.93      0.90      0.92       140
           2       1.00      0.94      0.97       145
           3       0.97      0.94      0.95       149
           4       1.00      0.93      0.96       145
           5       0.79      0.95      0.87       142
           6       0.99      1.00      0.99       143
           7       0.97      0.98      0.97       146
           8       0.89      0.94      0.92       133
           9       0.91      0.83      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.95      0.94      0.94      1437

2022-10-17 14:57:40,318 - trainer - INFO - {
  "train_accuracy_score": 0.941544885177453,
  "train_loss": 0.11796811240492389
}
2022-10-17 14:57:40,591 - trainer - INFO - 
*****************[epoch: 80, global step: 960] eval development set based on eval_every=2***************
2022-10-17 14:57:40,594 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.93      0.93      0.93        42
         2.0       0.97      1.00      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       1.00      1.00      1.00        36
         5.0       0.78      0.88      0.82        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.80      0.89        41
         9.0       0.83      0.97      0.90        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:57:40,595 - trainer - INFO - {
  "dev_loss": 0.2270142858227094,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:40,595 - trainer - INFO -   no_improve_count: 163
2022-10-17 14:57:40,596 - trainer - INFO -   patience: 200
2022-10-17 14:57:40,597 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:40,597 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:40,597 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_954
2022-10-17 14:57:40,598 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_960
2022-10-17 14:57:40,603 - trainer - INFO - save model to path: tmp/mlp_digits\ck_960
2022-10-17 14:57:40,608 - trainer - INFO - 
*****************[epoch: 80, global step: 961] eval training set at end of epoch***************
2022-10-17 14:57:40,614 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00       145
           1       0.93      0.90      0.92       140
           2       1.00      0.94      0.97       145
           3       0.97      0.94      0.95       149
           4       1.00      0.93      0.96       145
           5       0.79      0.95      0.87       142
           6       0.99      1.00      0.99       143
           7       0.97      0.98      0.97       146
           8       0.89      0.94      0.92       133
           9       0.91      0.83      0.87       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.95      0.94      0.94      1437

2022-10-17 14:57:40,616 - trainer - INFO - {
  "train_accuracy_score": 0.941544885177453,
  "train_loss": 0.19748518060077913
}
2022-10-17 14:57:40,618 - trainer - INFO - start training epoch 81
2022-10-17 14:57:40,618 - trainer - INFO - training using device=cuda
2022-10-17 14:57:40,618 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:40,619 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:40,680 - trainer - INFO - 
*****************[epoch: 81, global step: 962] eval training set based on eval_every=2***************
2022-10-17 14:57:40,682 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        24
           1       0.82      0.92      0.87        25
           2       0.96      1.00      0.98        23
           3       0.91      0.95      0.93        21
           4       1.00      1.00      1.00        21
           5       0.94      0.92      0.93        36
           6       1.00      0.97      0.98        31
           7       1.00      1.00      1.00        25
           8       1.00      0.82      0.90        28
           9       0.89      0.96      0.93        26

    accuracy                           0.95       260
   macro avg       0.95      0.95      0.95       260
weighted avg       0.95      0.95      0.95       260

2022-10-17 14:57:40,684 - trainer - INFO - {
  "train_accuracy_score": 0.95,
  "train_loss": 0.17921318858861923
}
2022-10-17 14:57:40,950 - trainer - INFO - 
*****************[epoch: 81, global step: 962] eval development set based on eval_every=2***************
2022-10-17 14:57:40,953 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      0.93      0.92        42
         2.0       0.89      1.00      0.94        32
         3.0       0.91      0.88      0.90        34
         4.0       1.00      1.00      1.00        36
         5.0       0.67      0.82      0.74        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.66      0.79        41
         9.0       0.88      0.90      0.89        31

    accuracy                           0.91       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.91      0.91       360

2022-10-17 14:57:40,954 - trainer - INFO - {
  "dev_loss": 0.34440544123450917,
  "dev_accuracy": 0.9111111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:40,954 - trainer - INFO -   no_improve_count: 164
2022-10-17 14:57:40,955 - trainer - INFO -   patience: 200
2022-10-17 14:57:40,956 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:40,956 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:40,956 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_956
2022-10-17 14:57:40,957 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_962
2022-10-17 14:57:40,963 - trainer - INFO - save model to path: tmp/mlp_digits\ck_962
2022-10-17 14:57:41,022 - trainer - INFO - 
*****************[epoch: 81, global step: 964] eval training set based on eval_every=2***************
2022-10-17 14:57:41,025 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       0.90      0.96      0.93        54
           2       0.96      1.00      0.98        50
           3       0.94      0.98      0.96        46
           4       1.00      0.98      0.99        46
           5       0.88      0.94      0.91        63
           6       1.00      0.97      0.98        61
           7       0.98      0.98      0.98        46
           8       1.00      0.85      0.92        52
           9       0.92      0.91      0.91        53

    accuracy                           0.95       520
   macro avg       0.96      0.96      0.96       520
weighted avg       0.96      0.95      0.95       520

2022-10-17 14:57:41,026 - trainer - INFO - {
  "train_accuracy_score": 0.9538461538461539,
  "train_loss": 0.17768990248441696
}
2022-10-17 14:57:41,296 - trainer - INFO - 
*****************[epoch: 81, global step: 964] eval development set based on eval_every=2***************
2022-10-17 14:57:41,300 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      0.93      0.92        42
         2.0       0.89      1.00      0.94        32
         3.0       0.94      0.88      0.91        34
         4.0       0.97      1.00      0.99        36
         5.0       0.67      0.82      0.74        40
         6.0       0.95      1.00      0.97        38
         7.0       0.97      0.97      0.97        33
         8.0       1.00      0.68      0.81        41
         9.0       0.86      0.81      0.83        31

    accuracy                           0.91       360
   macro avg       0.92      0.91      0.91       360
weighted avg       0.91      0.91      0.91       360

2022-10-17 14:57:41,301 - trainer - INFO - {
  "dev_loss": 0.3445370631913344,
  "dev_accuracy": 0.9055555555555556,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:41,301 - trainer - INFO -   no_improve_count: 165
2022-10-17 14:57:41,301 - trainer - INFO -   patience: 200
2022-10-17 14:57:41,303 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:41,303 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:41,303 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_958
2022-10-17 14:57:41,304 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_964
2022-10-17 14:57:41,308 - trainer - INFO - save model to path: tmp/mlp_digits\ck_964
2022-10-17 14:57:41,416 - trainer - INFO - 
*****************[epoch: 81, global step: 966] eval training set based on eval_every=2***************
2022-10-17 14:57:41,419 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        72
           1       0.89      0.97      0.93        74
           2       0.96      1.00      0.98        86
           3       0.94      0.96      0.95        78
           4       0.96      0.99      0.97        69
           5       0.86      0.94      0.90        88
           6       0.99      0.98      0.98        82
           7       0.99      0.95      0.97        75
           8       1.00      0.81      0.90        81
           9       0.93      0.88      0.90        75

    accuracy                           0.95       780
   macro avg       0.95      0.95      0.95       780
weighted avg       0.95      0.95      0.95       780

2022-10-17 14:57:41,421 - trainer - INFO - {
  "train_accuracy_score": 0.9461538461538461,
  "train_loss": 0.27613961696624756
}
2022-10-17 14:57:41,692 - trainer - INFO - 
*****************[epoch: 81, global step: 966] eval development set based on eval_every=2***************
2022-10-17 14:57:41,695 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.95      0.96        42
         2.0       0.94      1.00      0.97        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.74      0.85      0.79        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.88      0.94        41
         9.0       0.87      0.87      0.87        31

    accuracy                           0.94       360
   macro avg       0.95      0.94      0.94       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:57:41,696 - trainer - INFO - {
  "dev_loss": 0.20492160568634668,
  "dev_accuracy": 0.9416666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:41,696 - trainer - INFO -   no_improve_count: 166
2022-10-17 14:57:41,696 - trainer - INFO -   patience: 200
2022-10-17 14:57:41,697 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:41,698 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:41,698 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_960
2022-10-17 14:57:41,699 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_966
2022-10-17 14:57:41,707 - trainer - INFO - save model to path: tmp/mlp_digits\ck_966
2022-10-17 14:57:41,770 - trainer - INFO - 
*****************[epoch: 81, global step: 968] eval training set based on eval_every=2***************
2022-10-17 14:57:41,774 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       103
           1       0.90      0.95      0.93        98
           2       0.97      1.00      0.98       111
           3       0.94      0.97      0.95       106
           4       0.96      0.98      0.97        97
           5       0.85      0.95      0.89       110
           6       0.98      0.98      0.98       104
           7       0.99      0.95      0.97        99
           8       0.98      0.83      0.90       105
           9       0.95      0.90      0.92       107

    accuracy                           0.95      1040
   macro avg       0.95      0.95      0.95      1040
weighted avg       0.95      0.95      0.95      1040

2022-10-17 14:57:41,775 - trainer - INFO - {
  "train_accuracy_score": 0.948076923076923,
  "train_loss": 0.15686141699552536
}
2022-10-17 14:57:42,042 - trainer - INFO - 
*****************[epoch: 81, global step: 968] eval development set based on eval_every=2***************
2022-10-17 14:57:42,045 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.88      0.91        42
         2.0       0.97      0.97      0.97        32
         3.0       0.97      0.88      0.92        34
         4.0       1.00      1.00      1.00        36
         5.0       0.79      0.85      0.82        40
         6.0       0.97      1.00      0.99        38
         7.0       1.00      0.97      0.98        33
         8.0       0.93      0.93      0.93        41
         9.0       0.85      0.94      0.89        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:42,046 - trainer - INFO - {
  "dev_loss": 0.19447736690441766,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:42,047 - trainer - INFO -   no_improve_count: 167
2022-10-17 14:57:42,047 - trainer - INFO -   patience: 200
2022-10-17 14:57:42,048 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:42,049 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:42,049 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_962
2022-10-17 14:57:42,050 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_968
2022-10-17 14:57:42,053 - trainer - INFO - save model to path: tmp/mlp_digits\ck_968
2022-10-17 14:57:42,115 - trainer - INFO - 
*****************[epoch: 81, global step: 970] eval training set based on eval_every=2***************
2022-10-17 14:57:42,119 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       127
           1       0.91      0.93      0.92       126
           2       0.97      1.00      0.99       136
           3       0.95      0.96      0.96       135
           4       0.97      0.98      0.98       129
           5       0.83      0.94      0.88       131
           6       0.98      0.98      0.98       132
           7       0.98      0.95      0.97       128
           8       0.96      0.86      0.90       126
           9       0.95      0.89      0.92       130

    accuracy                           0.95      1300
   macro avg       0.95      0.95      0.95      1300
weighted avg       0.95      0.95      0.95      1300

2022-10-17 14:57:42,120 - trainer - INFO - {
  "train_accuracy_score": 0.9492307692307692,
  "train_loss": 0.14804062247276306
}
2022-10-17 14:57:42,432 - trainer - INFO - 
*****************[epoch: 81, global step: 970] eval development set based on eval_every=2***************
2022-10-17 14:57:42,435 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      0.94      0.97        32
         3.0       0.94      0.85      0.89        34
         4.0       1.00      1.00      1.00        36
         5.0       0.85      0.85      0.85        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.87      0.95      0.91        41
         9.0       0.94      0.97      0.95        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:57:42,436 - trainer - INFO - {
  "dev_loss": 0.19448651497562727,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:42,437 - trainer - INFO -   no_improve_count: 168
2022-10-17 14:57:42,437 - trainer - INFO -   patience: 200
2022-10-17 14:57:42,438 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:42,438 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:42,438 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_964
2022-10-17 14:57:42,440 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_970
2022-10-17 14:57:42,444 - trainer - INFO - save model to path: tmp/mlp_digits\ck_970
2022-10-17 14:57:42,489 - trainer - INFO - 
*****************[epoch: 81, global step: 972] eval training set based on eval_every=2***************
2022-10-17 14:57:42,494 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99       145
           1       0.91      0.93      0.92       140
           2       0.97      0.99      0.98       145
           3       0.95      0.97      0.96       149
           4       0.97      0.98      0.98       145
           5       0.82      0.94      0.88       142
           6       0.99      0.99      0.99       143
           7       0.99      0.96      0.97       146
           8       0.93      0.86      0.89       133
           9       0.96      0.87      0.91       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:57:42,495 - trainer - INFO - {
  "train_accuracy_score": 0.9471120389700766,
  "train_loss": 0.26580509543418884
}
2022-10-17 14:57:42,788 - trainer - INFO - 
*****************[epoch: 81, global step: 972] eval development set based on eval_every=2***************
2022-10-17 14:57:42,792 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.96      0.57      0.72        42
         2.0       1.00      0.91      0.95        32
         3.0       0.91      0.85      0.88        34
         4.0       1.00      0.97      0.99        36
         5.0       0.90      0.88      0.89        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.62      1.00      0.77        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.90       360
   macro avg       0.93      0.91      0.91       360
weighted avg       0.93      0.90      0.90       360

2022-10-17 14:57:42,793 - trainer - INFO - {
  "dev_loss": 0.5831680099169413,
  "dev_accuracy": 0.9027777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:42,793 - trainer - INFO -   no_improve_count: 169
2022-10-17 14:57:42,794 - trainer - INFO -   patience: 200
2022-10-17 14:57:42,795 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:42,795 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:42,795 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_966
2022-10-17 14:57:42,797 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_972
2022-10-17 14:57:42,801 - trainer - INFO - save model to path: tmp/mlp_digits\ck_972
2022-10-17 14:57:42,802 - trainer - INFO - 
*****************[epoch: 81, global step: 973] eval training set at end of epoch***************
2022-10-17 14:57:42,807 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99       145
           1       0.91      0.93      0.92       140
           2       0.97      0.99      0.98       145
           3       0.95      0.97      0.96       149
           4       0.97      0.98      0.98       145
           5       0.82      0.94      0.88       142
           6       0.99      0.99      0.99       143
           7       0.99      0.96      0.97       146
           8       0.93      0.86      0.89       133
           9       0.96      0.87      0.91       149

    accuracy                           0.95      1437
   macro avg       0.95      0.95      0.95      1437
weighted avg       0.95      0.95      0.95      1437

2022-10-17 14:57:42,811 - trainer - INFO - {
  "train_accuracy_score": 0.9471120389700766,
  "train_loss": 0.20062497382362685
}
2022-10-17 14:57:42,811 - trainer - INFO - start training epoch 82
2022-10-17 14:57:42,812 - trainer - INFO - training using device=cuda
2022-10-17 14:57:42,812 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:42,812 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:42,881 - trainer - INFO - 
*****************[epoch: 82, global step: 974] eval training set based on eval_every=2***************
2022-10-17 14:57:42,886 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        25
           1       0.91      0.38      0.54        26
           2       1.00      0.88      0.94        26
           3       1.00      1.00      1.00        25
           4       1.00      1.00      1.00        26
           5       0.93      1.00      0.96        27
           6       1.00      1.00      1.00        22
           7       1.00      1.00      1.00        34
           8       0.59      1.00      0.74        24
           9       0.96      0.92      0.94        25

    accuracy                           0.92       260
   macro avg       0.94      0.92      0.91       260
weighted avg       0.94      0.92      0.91       260

2022-10-17 14:57:42,888 - trainer - INFO - {
  "train_accuracy_score": 0.9192307692307692,
  "train_loss": 0.5800108462572098
}
2022-10-17 14:57:43,182 - trainer - INFO - 
*****************[epoch: 82, global step: 974] eval development set based on eval_every=2***************
2022-10-17 14:57:43,187 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.43      0.60        42
         2.0       1.00      0.94      0.97        32
         3.0       0.91      0.91      0.91        34
         4.0       1.00      0.94      0.97        36
         5.0       0.81      0.88      0.84        40
         6.0       0.97      0.97      0.97        38
         7.0       0.94      1.00      0.97        33
         8.0       0.63      0.93      0.75        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.89       360
   macro avg       0.92      0.90      0.89       360
weighted avg       0.91      0.89      0.88       360

2022-10-17 14:57:43,188 - trainer - INFO - {
  "dev_loss": 0.7555923809607824,
  "dev_accuracy": 0.8888888888888888,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:43,189 - trainer - INFO -   no_improve_count: 170
2022-10-17 14:57:43,189 - trainer - INFO -   patience: 200
2022-10-17 14:57:43,190 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:43,191 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:43,194 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_968
2022-10-17 14:57:43,195 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_974
2022-10-17 14:57:43,200 - trainer - INFO - save model to path: tmp/mlp_digits\ck_974
2022-10-17 14:57:43,264 - trainer - INFO - 
*****************[epoch: 82, global step: 976] eval training set based on eval_every=2***************
2022-10-17 14:57:43,267 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        46
           1       0.95      0.37      0.54        51
           2       1.00      0.89      0.94        56
           3       0.96      1.00      0.98        50
           4       1.00      0.98      0.99        51
           5       0.87      0.98      0.92        54
           6       1.00      0.98      0.99        60
           7       1.00      1.00      1.00        59
           8       0.58      1.00      0.73        42
           9       0.94      0.92      0.93        51

    accuracy                           0.91       520
   macro avg       0.93      0.91      0.90       520
weighted avg       0.94      0.91      0.91       520

2022-10-17 14:57:43,268 - trainer - INFO - {
  "train_accuracy_score": 0.9134615384615384,
  "train_loss": 0.4692663997411728
}
2022-10-17 14:57:43,589 - trainer - INFO - 
*****************[epoch: 82, global step: 976] eval development set based on eval_every=2***************
2022-10-17 14:57:43,592 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.92      0.81      0.86        42
         2.0       0.49      1.00      0.66        32
         3.0       1.00      0.82      0.90        34
         4.0       1.00      1.00      1.00        36
         5.0       0.78      0.88      0.82        40
         6.0       1.00      0.92      0.96        38
         7.0       0.87      1.00      0.93        33
         8.0       0.50      0.05      0.09        41
         9.0       0.82      1.00      0.90        31

    accuracy                           0.83       360
   macro avg       0.83      0.85      0.81       360
weighted avg       0.83      0.83      0.80       360

2022-10-17 14:57:43,594 - trainer - INFO - {
  "dev_loss": 0.586204374829928,
  "dev_accuracy": 0.8305555555555556,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:43,595 - trainer - INFO -   no_improve_count: 171
2022-10-17 14:57:43,599 - trainer - INFO -   patience: 200
2022-10-17 14:57:43,600 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:43,600 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:43,601 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_970
2022-10-17 14:57:43,602 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_976
2022-10-17 14:57:43,607 - trainer - INFO - save model to path: tmp/mlp_digits\ck_976
2022-10-17 14:57:43,669 - trainer - INFO - 
*****************[epoch: 82, global step: 978] eval training set based on eval_every=2***************
2022-10-17 14:57:43,673 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        76
           1       0.88      0.56      0.68        81
           2       0.89      0.93      0.91        86
           3       0.97      0.93      0.95        81
           4       0.97      0.97      0.97        76
           5       0.84      0.99      0.91        76
           6       1.00      0.98      0.99        83
           7       0.98      1.00      0.99        84
           8       0.61      0.75      0.68        65
           9       0.91      0.94      0.93        72

    accuracy                           0.91       780
   macro avg       0.91      0.90      0.90       780
weighted avg       0.91      0.91      0.90       780

2022-10-17 14:57:43,674 - trainer - INFO - {
  "train_accuracy_score": 0.9051282051282051,
  "train_loss": 0.4497837871313095
}
2022-10-17 14:57:43,948 - trainer - INFO - 
*****************[epoch: 82, global step: 978] eval development set based on eval_every=2***************
2022-10-17 14:57:43,951 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.91      0.93      0.92        42
         2.0       0.78      1.00      0.88        32
         3.0       0.96      0.71      0.81        34
         4.0       1.00      0.97      0.99        36
         5.0       0.61      0.82      0.70        40
         6.0       1.00      0.95      0.97        38
         7.0       0.87      1.00      0.93        33
         8.0       1.00      0.54      0.70        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.88       360
   macro avg       0.90      0.89      0.88       360
weighted avg       0.90      0.88      0.88       360

2022-10-17 14:57:43,952 - trainer - INFO - {
  "dev_loss": 0.5239281952381134,
  "dev_accuracy": 0.8777777777777778,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:43,953 - trainer - INFO -   no_improve_count: 172
2022-10-17 14:57:43,953 - trainer - INFO -   patience: 200
2022-10-17 14:57:43,955 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:43,955 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:43,955 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_972
2022-10-17 14:57:43,956 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_978
2022-10-17 14:57:43,961 - trainer - INFO - save model to path: tmp/mlp_digits\ck_978
2022-10-17 14:57:44,028 - trainer - INFO - 
*****************[epoch: 82, global step: 980] eval training set based on eval_every=2***************
2022-10-17 14:57:44,034 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        96
           1       0.86      0.63      0.73       100
           2       0.89      0.95      0.92       112
           3       0.98      0.89      0.93       109
           4       0.97      0.96      0.97       106
           5       0.78      0.99      0.87        95
           6       0.99      0.97      0.98       103
           7       0.95      1.00      0.97       112
           8       0.69      0.74      0.71        99
           9       0.93      0.89      0.91       108

    accuracy                           0.90      1040
   macro avg       0.90      0.90      0.90      1040
weighted avg       0.91      0.90      0.90      1040

2022-10-17 14:57:44,035 - trainer - INFO - {
  "train_accuracy_score": 0.9019230769230769,
  "train_loss": 0.4407857805490494
}
2022-10-17 14:57:44,305 - trainer - INFO - 
*****************[epoch: 82, global step: 980] eval development set based on eval_every=2***************
2022-10-17 14:57:44,308 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.87      0.95      0.91        42
         2.0       1.00      1.00      1.00        32
         3.0       0.90      0.79      0.84        34
         4.0       1.00      0.92      0.96        36
         5.0       0.59      0.85      0.69        40
         6.0       1.00      0.89      0.94        38
         7.0       0.89      1.00      0.94        33
         8.0       0.96      0.61      0.75        41
         9.0       0.93      0.90      0.92        31

    accuracy                           0.89       360
   macro avg       0.91      0.89      0.89       360
weighted avg       0.91      0.89      0.89       360

2022-10-17 14:57:44,310 - trainer - INFO - {
  "dev_loss": 0.4674752652645111,
  "dev_accuracy": 0.8861111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:44,311 - trainer - INFO -   no_improve_count: 173
2022-10-17 14:57:44,311 - trainer - INFO -   patience: 200
2022-10-17 14:57:44,312 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:44,312 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:44,313 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_974
2022-10-17 14:57:44,314 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_980
2022-10-17 14:57:44,318 - trainer - INFO - save model to path: tmp/mlp_digits\ck_980
2022-10-17 14:57:44,383 - trainer - INFO - 
*****************[epoch: 82, global step: 982] eval training set based on eval_every=2***************
2022-10-17 14:57:44,388 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       128
           1       0.85      0.70      0.77       132
           2       0.91      0.95      0.93       133
           3       0.98      0.91      0.94       131
           4       0.98      0.95      0.96       129
           5       0.78      0.96      0.86       121
           6       0.98      0.97      0.98       126
           7       0.93      1.00      0.96       137
           8       0.73      0.74      0.73       125
           9       0.93      0.88      0.90       138

    accuracy                           0.90      1300
   macro avg       0.91      0.90      0.90      1300
weighted avg       0.91      0.90      0.90      1300

2022-10-17 14:57:44,389 - trainer - INFO - {
  "train_accuracy_score": 0.9046153846153846,
  "train_loss": 0.2879336178302765
}
2022-10-17 14:57:44,716 - trainer - INFO - 
*****************[epoch: 82, global step: 982] eval development set based on eval_every=2***************
2022-10-17 14:57:44,719 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.89      0.95      0.92        42
         2.0       1.00      0.97      0.98        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.69      0.93      0.79        40
         6.0       1.00      0.92      0.96        38
         7.0       0.97      0.88      0.92        33
         8.0       0.94      0.73      0.82        41
         9.0       0.84      0.87      0.86        31

    accuracy                           0.91       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.91      0.92       360

2022-10-17 14:57:44,720 - trainer - INFO - {
  "dev_loss": 0.3667437459031741,
  "dev_accuracy": 0.9138888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:44,721 - trainer - INFO -   no_improve_count: 174
2022-10-17 14:57:44,721 - trainer - INFO -   patience: 200
2022-10-17 14:57:44,723 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:44,723 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:44,723 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_976
2022-10-17 14:57:44,725 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_982
2022-10-17 14:57:44,731 - trainer - INFO - save model to path: tmp/mlp_digits\ck_982
2022-10-17 14:57:44,776 - trainer - INFO - 
*****************[epoch: 82, global step: 984] eval training set based on eval_every=2***************
2022-10-17 14:57:44,781 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.82      0.72      0.77       140
           2       0.91      0.96      0.94       145
           3       0.99      0.92      0.95       149
           4       0.98      0.94      0.96       145
           5       0.80      0.96      0.87       142
           6       0.99      0.97      0.98       143
           7       0.94      1.00      0.97       146
           8       0.74      0.73      0.73       133
           9       0.94      0.89      0.91       149

    accuracy                           0.91      1437
   macro avg       0.91      0.91      0.91      1437
weighted avg       0.91      0.91      0.91      1437

2022-10-17 14:57:44,783 - trainer - INFO - {
  "train_accuracy_score": 0.9088378566457899,
  "train_loss": 0.16678079590201378
}
2022-10-17 14:57:45,078 - trainer - INFO - 
*****************[epoch: 82, global step: 984] eval development set based on eval_every=2***************
2022-10-17 14:57:45,081 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.91      0.69      0.78        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.94      0.96        34
         4.0       0.97      1.00      0.99        36
         5.0       0.71      0.93      0.80        40
         6.0       0.93      0.97      0.95        38
         7.0       1.00      0.79      0.88        33
         8.0       0.76      0.78      0.77        41
         9.0       0.79      0.87      0.83        31

    accuracy                           0.89       360
   macro avg       0.90      0.89      0.89       360
weighted avg       0.90      0.89      0.89       360

2022-10-17 14:57:45,082 - trainer - INFO - {
  "dev_loss": 0.384334534406662,
  "dev_accuracy": 0.8888888888888888,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:45,083 - trainer - INFO -   no_improve_count: 175
2022-10-17 14:57:45,088 - trainer - INFO -   patience: 200
2022-10-17 14:57:45,090 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:45,090 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:45,090 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_978
2022-10-17 14:57:45,092 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_984
2022-10-17 14:57:45,098 - trainer - INFO - save model to path: tmp/mlp_digits\ck_984
2022-10-17 14:57:45,099 - trainer - INFO - 
*****************[epoch: 82, global step: 985] eval training set at end of epoch***************
2022-10-17 14:57:45,105 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.82      0.72      0.77       140
           2       0.91      0.96      0.94       145
           3       0.99      0.92      0.95       149
           4       0.98      0.94      0.96       145
           5       0.80      0.96      0.87       142
           6       0.99      0.97      0.98       143
           7       0.94      1.00      0.97       146
           8       0.74      0.73      0.73       133
           9       0.94      0.89      0.91       149

    accuracy                           0.91      1437
   macro avg       0.91      0.91      0.91      1437
weighted avg       0.91      0.91      0.91      1437

2022-10-17 14:57:45,107 - trainer - INFO - {
  "train_accuracy_score": 0.9088378566457899,
  "train_loss": 0.3990935379018386
}
2022-10-17 14:57:45,108 - trainer - INFO - start training epoch 83
2022-10-17 14:57:45,109 - trainer - INFO - training using device=cuda
2022-10-17 14:57:45,109 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:45,109 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:45,182 - trainer - INFO - 
*****************[epoch: 83, global step: 986] eval training set based on eval_every=2***************
2022-10-17 14:57:45,185 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        28
           1       0.86      0.60      0.71        20
           2       1.00      0.95      0.97        19
           3       0.96      0.96      0.96        25
           4       0.86      0.89      0.87        27
           5       0.75      0.96      0.84        28
           6       0.96      1.00      0.98        24
           7       0.97      0.94      0.96        35
           8       0.81      0.83      0.82        30
           9       0.86      0.75      0.80        24

    accuracy                           0.90       260
   macro avg       0.90      0.89      0.89       260
weighted avg       0.90      0.90      0.89       260

2022-10-17 14:57:45,186 - trainer - INFO - {
  "train_accuracy_score": 0.8961538461538462,
  "train_loss": 0.3145754486322403
}
2022-10-17 14:57:45,466 - trainer - INFO - 
*****************[epoch: 83, global step: 986] eval development set based on eval_every=2***************
2022-10-17 14:57:45,470 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.86      0.91        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.88      0.92        34
         4.0       1.00      0.97      0.99        36
         5.0       0.77      0.90      0.83        40
         6.0       1.00      0.95      0.97        38
         7.0       1.00      0.97      0.98        33
         8.0       0.88      0.93      0.90        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:45,474 - trainer - INFO - {
  "dev_loss": 0.3181339005629222,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:45,475 - trainer - INFO -   no_improve_count: 176
2022-10-17 14:57:45,475 - trainer - INFO -   patience: 200
2022-10-17 14:57:45,477 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:45,478 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:45,478 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_980
2022-10-17 14:57:45,480 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_986
2022-10-17 14:57:45,486 - trainer - INFO - save model to path: tmp/mlp_digits\ck_986
2022-10-17 14:57:45,567 - trainer - INFO - 
*****************[epoch: 83, global step: 988] eval training set based on eval_every=2***************
2022-10-17 14:57:45,571 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99        55
           1       0.95      0.71      0.81        51
           2       1.00      0.98      0.99        53
           3       0.98      0.94      0.96        50
           4       0.91      0.94      0.92        51
           5       0.80      0.98      0.88        56
           6       0.98      0.98      0.98        43
           7       0.98      0.95      0.97        60
           8       0.79      0.90      0.84        51
           9       0.89      0.84      0.87        50

    accuracy                           0.92       520
   macro avg       0.93      0.92      0.92       520
weighted avg       0.93      0.92      0.92       520

2022-10-17 14:57:45,572 - trainer - INFO - {
  "train_accuracy_score": 0.9211538461538461,
  "train_loss": 0.2652648501098156
}
2022-10-17 14:57:45,931 - trainer - INFO - 
*****************[epoch: 83, global step: 988] eval development set based on eval_every=2***************
2022-10-17 14:57:45,936 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.83      0.91        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.85      0.91        34
         4.0       0.97      0.94      0.96        36
         5.0       0.78      0.88      0.82        40
         6.0       0.97      0.92      0.95        38
         7.0       1.00      0.97      0.98        33
         8.0       0.86      0.93      0.89        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.93       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.93      0.93       360

2022-10-17 14:57:45,937 - trainer - INFO - {
  "dev_loss": 0.36109208067258197,
  "dev_accuracy": 0.925,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:45,938 - trainer - INFO -   no_improve_count: 177
2022-10-17 14:57:45,939 - trainer - INFO -   patience: 200
2022-10-17 14:57:45,941 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:45,941 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:45,941 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_982
2022-10-17 14:57:45,943 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_988
2022-10-17 14:57:45,948 - trainer - INFO - save model to path: tmp/mlp_digits\ck_988
2022-10-17 14:57:46,032 - trainer - INFO - 
*****************[epoch: 83, global step: 990] eval training set based on eval_every=2***************
2022-10-17 14:57:46,036 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      0.99        80
           1       0.95      0.72      0.82        72
           2       1.00      0.99      0.99        84
           3       0.97      0.95      0.96        80
           4       0.94      0.95      0.94        80
           5       0.81      0.98      0.89        81
           6       0.98      0.97      0.98        67
           7       0.99      0.95      0.97        82
           8       0.81      0.91      0.85        74
           9       0.90      0.89      0.89        80

    accuracy                           0.93       780
   macro avg       0.94      0.93      0.93       780
weighted avg       0.94      0.93      0.93       780

2022-10-17 14:57:46,037 - trainer - INFO - {
  "train_accuracy_score": 0.9307692307692308,
  "train_loss": 0.19071268290281296
}
2022-10-17 14:57:46,343 - trainer - INFO - 
*****************[epoch: 83, global step: 990] eval development set based on eval_every=2***************
2022-10-17 14:57:46,348 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.90      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.85      0.91        34
         4.0       1.00      0.89      0.94        36
         5.0       0.80      0.88      0.83        40
         6.0       0.97      0.87      0.92        38
         7.0       1.00      0.91      0.95        33
         8.0       0.88      0.90      0.89        41
         9.0       0.74      1.00      0.85        31

    accuracy                           0.91       360
   macro avg       0.92      0.92      0.92       360
weighted avg       0.92      0.91      0.92       360

2022-10-17 14:57:46,349 - trainer - INFO - {
  "dev_loss": 0.4184151738882065,
  "dev_accuracy": 0.9138888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:46,350 - trainer - INFO -   no_improve_count: 178
2022-10-17 14:57:46,350 - trainer - INFO -   patience: 200
2022-10-17 14:57:46,351 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:46,351 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:46,352 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_984
2022-10-17 14:57:46,354 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_990
2022-10-17 14:57:46,359 - trainer - INFO - save model to path: tmp/mlp_digits\ck_990
2022-10-17 14:57:46,438 - trainer - INFO - 
*****************[epoch: 83, global step: 992] eval training set based on eval_every=2***************
2022-10-17 14:57:46,442 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       104
           1       0.91      0.81      0.86       103
           2       1.00      0.99      1.00       106
           3       0.98      0.95      0.97       108
           4       0.95      0.91      0.93       102
           5       0.80      0.97      0.88       100
           6       0.99      0.98      0.98        97
           7       0.99      0.95      0.97       109
           8       0.85      0.89      0.87        99
           9       0.90      0.90      0.90       112

    accuracy                           0.93      1040
   macro avg       0.94      0.93      0.93      1040
weighted avg       0.94      0.93      0.94      1040

2022-10-17 14:57:46,444 - trainer - INFO - {
  "train_accuracy_score": 0.9346153846153846,
  "train_loss": 0.23518844693899155
}
2022-10-17 14:57:46,758 - trainer - INFO - 
*****************[epoch: 83, global step: 992] eval development set based on eval_every=2***************
2022-10-17 14:57:46,763 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.92      1.00      0.96        33
         1.0       0.97      0.93      0.95        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.85      0.91        34
         4.0       1.00      0.83      0.91        36
         5.0       0.74      0.88      0.80        40
         6.0       1.00      0.87      0.93        38
         7.0       0.97      1.00      0.99        33
         8.0       0.88      0.90      0.89        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.92       360
   macro avg       0.93      0.92      0.92       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:46,765 - trainer - INFO - {
  "dev_loss": 0.4174198769032955,
  "dev_accuracy": 0.9194444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:46,765 - trainer - INFO -   no_improve_count: 179
2022-10-17 14:57:46,766 - trainer - INFO -   patience: 200
2022-10-17 14:57:46,767 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:46,767 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:46,767 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_986
2022-10-17 14:57:46,769 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_992
2022-10-17 14:57:46,774 - trainer - INFO - save model to path: tmp/mlp_digits\ck_992
2022-10-17 14:57:46,837 - trainer - INFO - 
*****************[epoch: 83, global step: 994] eval training set based on eval_every=2***************
2022-10-17 14:57:46,841 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       134
           1       0.91      0.83      0.87       128
           2       0.99      0.99      0.99       129
           3       0.98      0.95      0.96       132
           4       0.96      0.91      0.93       134
           5       0.80      0.97      0.88       127
           6       0.99      0.98      0.98       125
           7       0.99      0.96      0.98       132
           8       0.85      0.90      0.88       122
           9       0.92      0.89      0.90       137

    accuracy                           0.94      1300
   macro avg       0.94      0.94      0.94      1300
weighted avg       0.94      0.94      0.94      1300

2022-10-17 14:57:46,843 - trainer - INFO - {
  "train_accuracy_score": 0.936923076923077,
  "train_loss": 0.1984013244509697
}
2022-10-17 14:57:47,124 - trainer - INFO - 
*****************[epoch: 83, global step: 994] eval development set based on eval_every=2***************
2022-10-17 14:57:47,127 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.97      0.93      0.95        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.85      0.91        34
         4.0       1.00      0.83      0.91        36
         5.0       0.74      0.88      0.80        40
         6.0       0.97      0.87      0.92        38
         7.0       1.00      1.00      1.00        33
         8.0       0.88      0.93      0.90        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.92       360
   macro avg       0.93      0.93      0.93       360
weighted avg       0.93      0.92      0.92       360

2022-10-17 14:57:47,128 - trainer - INFO - {
  "dev_loss": 0.3837340250611305,
  "dev_accuracy": 0.9222222222222223,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:47,129 - trainer - INFO -   no_improve_count: 180
2022-10-17 14:57:47,129 - trainer - INFO -   patience: 200
2022-10-17 14:57:47,130 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:47,130 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:47,130 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_988
2022-10-17 14:57:47,132 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_994
2022-10-17 14:57:47,136 - trainer - INFO - save model to path: tmp/mlp_digits\ck_994
2022-10-17 14:57:47,223 - trainer - INFO - 
*****************[epoch: 83, global step: 996] eval training set based on eval_every=2***************
2022-10-17 14:57:47,227 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.90      0.84      0.87       140
           2       0.99      0.99      0.99       145
           3       0.97      0.95      0.96       149
           4       0.96      0.90      0.93       145
           5       0.82      0.96      0.88       142
           6       0.99      0.97      0.98       143
           7       0.99      0.97      0.98       146
           8       0.86      0.90      0.88       133
           9       0.92      0.89      0.91       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:57:47,229 - trainer - INFO - {
  "train_accuracy_score": 0.9380654140570633,
  "train_loss": 0.28507332503795624
}
2022-10-17 14:57:47,502 - trainer - INFO - 
*****************[epoch: 83, global step: 996] eval development set based on eval_every=2***************
2022-10-17 14:57:47,505 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        33
         1.0       0.95      0.90      0.93        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.85      0.92        34
         4.0       1.00      0.89      0.94        36
         5.0       0.79      0.93      0.85        40
         6.0       0.97      0.89      0.93        38
         7.0       1.00      1.00      1.00        33
         8.0       0.93      0.93      0.93        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.93       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.93      0.93       360

2022-10-17 14:57:47,506 - trainer - INFO - {
  "dev_loss": 0.34225130702058476,
  "dev_accuracy": 0.9333333333333333,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:47,507 - trainer - INFO -   no_improve_count: 181
2022-10-17 14:57:47,508 - trainer - INFO -   patience: 200
2022-10-17 14:57:47,508 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:47,509 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:47,509 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_990
2022-10-17 14:57:47,510 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_996
2022-10-17 14:57:47,516 - trainer - INFO - save model to path: tmp/mlp_digits\ck_996
2022-10-17 14:57:47,521 - trainer - INFO - 
*****************[epoch: 83, global step: 997] eval training set at end of epoch***************
2022-10-17 14:57:47,529 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.99      1.00       145
           1       0.90      0.84      0.87       140
           2       0.99      0.99      0.99       145
           3       0.97      0.95      0.96       149
           4       0.96      0.90      0.93       145
           5       0.82      0.96      0.88       142
           6       0.99      0.97      0.98       143
           7       0.99      0.97      0.98       146
           8       0.86      0.90      0.88       133
           9       0.92      0.89      0.91       149

    accuracy                           0.94      1437
   macro avg       0.94      0.94      0.94      1437
weighted avg       0.94      0.94      0.94      1437

2022-10-17 14:57:47,531 - trainer - INFO - {
  "train_accuracy_score": 0.9380654140570633,
  "train_loss": 0.24820267967879772
}
2022-10-17 14:57:47,531 - trainer - INFO - start training epoch 84
2022-10-17 14:57:47,532 - trainer - INFO - training using device=cuda
2022-10-17 14:57:47,532 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:47,532 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:47,593 - trainer - INFO - 
*****************[epoch: 84, global step: 998] eval training set based on eval_every=2***************
2022-10-17 14:57:47,596 - trainer - INFO -               precision    recall  f1-score   support

           0       0.97      1.00      0.98        29
           1       0.73      0.95      0.83        20
           2       1.00      1.00      1.00        26
           3       1.00      0.92      0.96        26
           4       0.95      0.95      0.95        20
           5       0.87      1.00      0.93        20
           6       1.00      0.94      0.97        34
           7       0.94      1.00      0.97        29
           8       0.96      1.00      0.98        23
           9       1.00      0.73      0.84        33

    accuracy                           0.94       260
   macro avg       0.94      0.95      0.94       260
weighted avg       0.95      0.94      0.94       260

2022-10-17 14:57:47,597 - trainer - INFO - {
  "train_accuracy_score": 0.9423076923076923,
  "train_loss": 0.2104223072528839
}
2022-10-17 14:57:47,866 - trainer - INFO - 
*****************[epoch: 84, global step: 998] eval development set based on eval_every=2***************
2022-10-17 14:57:47,869 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.93      0.94        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.82      0.90        34
         4.0       1.00      0.97      0.99        36
         5.0       0.84      0.93      0.88        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.97      0.98        33
         8.0       0.93      0.95      0.94        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:57:47,870 - trainer - INFO - {
  "dev_loss": 0.2931532946725686,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:47,871 - trainer - INFO -   no_improve_count: 182
2022-10-17 14:57:47,872 - trainer - INFO -   patience: 200
2022-10-17 14:57:47,873 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:47,873 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:47,874 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_992
2022-10-17 14:57:47,875 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_998
2022-10-17 14:57:47,879 - trainer - INFO - save model to path: tmp/mlp_digits\ck_998
2022-10-17 14:57:47,938 - trainer - INFO - 
*****************[epoch: 84, global step: 1000] eval training set based on eval_every=2***************
2022-10-17 14:57:47,941 - trainer - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99        58
           1       0.85      0.96      0.90        48
           2       1.00      1.00      1.00        53
           3       1.00      0.93      0.96        54
           4       0.98      0.98      0.98        45
           5       0.85      0.98      0.91        45
           6       0.98      0.97      0.98        62
           7       0.96      0.98      0.97        56
           8       0.94      0.96      0.95        50
           9       1.00      0.78      0.87        49

    accuracy                           0.95       520
   macro avg       0.95      0.95      0.95       520
weighted avg       0.96      0.95      0.95       520

2022-10-17 14:57:47,942 - trainer - INFO - {
  "train_accuracy_score": 0.9538461538461539,
  "train_loss": 0.18299482762813568
}
2022-10-17 14:57:48,210 - trainer - INFO - 
*****************[epoch: 84, global step: 1000] eval development set based on eval_every=2***************
2022-10-17 14:57:48,214 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.95      0.90      0.93        42
         2.0       0.94      0.97      0.95        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      0.94      0.96        36
         5.0       0.80      0.90      0.85        40
         6.0       0.92      0.95      0.94        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.93      0.94        41
         9.0       0.91      0.94      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:48,215 - trainer - INFO - {
  "dev_loss": 0.2835940668980281,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:48,215 - trainer - INFO -   no_improve_count: 183
2022-10-17 14:57:48,216 - trainer - INFO -   patience: 200
2022-10-17 14:57:48,217 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:48,217 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:48,217 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_994
2022-10-17 14:57:48,218 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1000
2022-10-17 14:57:48,222 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1000
2022-10-17 14:57:48,333 - trainer - INFO - 
*****************[epoch: 84, global step: 1002] eval training set based on eval_every=2***************
2022-10-17 14:57:48,337 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        79
           1       0.90      0.96      0.93        75
           2       1.00      1.00      1.00        81
           3       1.00      0.95      0.97        77
           4       0.96      0.99      0.97        70
           5       0.86      0.97      0.91        75
           6       0.99      0.98      0.98        81
           7       0.98      0.98      0.98        88
           8       0.96      0.96      0.96        78
           9       1.00      0.83      0.91        76

    accuracy                           0.96       780
   macro avg       0.96      0.96      0.96       780
weighted avg       0.96      0.96      0.96       780

2022-10-17 14:57:48,338 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.0988938920199871
}
2022-10-17 14:57:48,614 - trainer - INFO - 
*****************[epoch: 84, global step: 1002] eval development set based on eval_every=2***************
2022-10-17 14:57:48,617 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.97      0.93      0.95        42
         2.0       0.94      1.00      0.97        32
         3.0       0.97      0.97      0.97        34
         4.0       0.97      0.94      0.96        36
         5.0       0.82      0.90      0.86        40
         6.0       0.95      0.95      0.95        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.90      0.95        41
         9.0       0.88      0.90      0.89        31

    accuracy                           0.94       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.94      0.94       360

2022-10-17 14:57:48,618 - trainer - INFO - {
  "dev_loss": 0.2938780461748441,
  "dev_accuracy": 0.9444444444444444,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:48,618 - trainer - INFO -   no_improve_count: 184
2022-10-17 14:57:48,619 - trainer - INFO -   patience: 200
2022-10-17 14:57:48,619 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:48,620 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:48,620 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_996
2022-10-17 14:57:48,621 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1002
2022-10-17 14:57:48,626 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1002
2022-10-17 14:57:48,695 - trainer - INFO - 
*****************[epoch: 84, global step: 1004] eval training set based on eval_every=2***************
2022-10-17 14:57:48,699 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       109
           1       0.86      0.97      0.91        99
           2       1.00      1.00      1.00       109
           3       1.00      0.96      0.98       105
           4       0.95      0.96      0.96       100
           5       0.89      0.98      0.93       103
           6       0.98      0.97      0.98       105
           7       0.98      0.96      0.97       108
           8       0.97      0.93      0.95       102
           9       1.00      0.86      0.92       100

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:57:48,700 - trainer - INFO - {
  "train_accuracy_score": 0.9605769230769231,
  "train_loss": 0.2154630646109581
}
2022-10-17 14:57:48,977 - trainer - INFO - 
*****************[epoch: 84, global step: 1004] eval development set based on eval_every=2***************
2022-10-17 14:57:48,980 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       1.00      0.88      0.94        42
         2.0       0.94      1.00      0.97        32
         3.0       0.94      0.97      0.96        34
         4.0       0.97      0.97      0.97        36
         5.0       0.75      0.90      0.82        40
         6.0       0.97      0.89      0.93        38
         7.0       1.00      0.97      0.98        33
         8.0       1.00      0.85      0.92        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:48,981 - trainer - INFO - {
  "dev_loss": 0.4162492901086807,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:48,981 - trainer - INFO -   no_improve_count: 185
2022-10-17 14:57:48,981 - trainer - INFO -   patience: 200
2022-10-17 14:57:48,982 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:48,982 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:48,983 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_998
2022-10-17 14:57:48,983 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1004
2022-10-17 14:57:48,987 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1004
2022-10-17 14:57:49,061 - trainer - INFO - 
*****************[epoch: 84, global step: 1006] eval training set based on eval_every=2***************
2022-10-17 14:57:49,067 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       132
           1       0.88      0.94      0.91       127
           2       1.00      0.99      1.00       137
           3       0.98      0.97      0.98       134
           4       0.95      0.97      0.96       125
           5       0.86      0.98      0.92       129
           6       0.98      0.97      0.97       129
           7       0.98      0.95      0.97       136
           8       0.97      0.92      0.94       125
           9       0.99      0.87      0.93       126

    accuracy                           0.96      1300
   macro avg       0.96      0.96      0.96      1300
weighted avg       0.96      0.96      0.96      1300

2022-10-17 14:57:49,068 - trainer - INFO - {
  "train_accuracy_score": 0.9569230769230769,
  "train_loss": 0.2408950850367546
}
2022-10-17 14:57:49,384 - trainer - INFO - 
*****************[epoch: 84, global step: 1006] eval development set based on eval_every=2***************
2022-10-17 14:57:49,387 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.86      0.92        42
         2.0       0.94      1.00      0.97        32
         3.0       0.94      0.97      0.96        34
         4.0       0.95      0.97      0.96        36
         5.0       0.80      0.90      0.85        40
         6.0       0.97      0.89      0.93        38
         7.0       1.00      0.97      0.98        33
         8.0       0.95      0.90      0.92        41
         9.0       0.88      0.97      0.92        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:49,388 - trainer - INFO - {
  "dev_loss": 0.3687652399142583,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:49,389 - trainer - INFO -   no_improve_count: 186
2022-10-17 14:57:49,389 - trainer - INFO -   patience: 200
2022-10-17 14:57:49,391 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:49,391 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:49,391 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1000
2022-10-17 14:57:49,393 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1006
2022-10-17 14:57:49,396 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1006
2022-10-17 14:57:49,438 - trainer - INFO - 
*****************[epoch: 84, global step: 1008] eval training set based on eval_every=2***************
2022-10-17 14:57:49,444 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.88      0.94      0.91       140
           2       1.00      0.99      1.00       145
           3       0.98      0.97      0.98       149
           4       0.95      0.97      0.96       145
           5       0.86      0.98      0.92       142
           6       0.98      0.97      0.98       143
           7       0.99      0.95      0.97       146
           8       0.97      0.91      0.94       133
           9       0.98      0.87      0.93       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:57:49,445 - trainer - INFO - {
  "train_accuracy_score": 0.9561586638830898,
  "train_loss": 0.11171099224210934
}
2022-10-17 14:57:49,724 - trainer - INFO - 
*****************[epoch: 84, global step: 1008] eval development set based on eval_every=2***************
2022-10-17 14:57:49,727 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.86      0.92        42
         2.0       0.97      0.97      0.97        32
         3.0       0.94      0.94      0.94        34
         4.0       0.97      0.97      0.97        36
         5.0       0.83      0.85      0.84        40
         6.0       0.92      0.92      0.92        38
         7.0       0.92      1.00      0.96        33
         8.0       0.93      0.93      0.93        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:49,728 - trainer - INFO - {
  "dev_loss": 0.2365517020225525,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:49,729 - trainer - INFO -   no_improve_count: 187
2022-10-17 14:57:49,729 - trainer - INFO -   patience: 200
2022-10-17 14:57:49,730 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:49,731 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:49,731 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1002
2022-10-17 14:57:49,733 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1008
2022-10-17 14:57:49,736 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1008
2022-10-17 14:57:49,738 - trainer - INFO - 
*****************[epoch: 84, global step: 1009] eval training set at end of epoch***************
2022-10-17 14:57:49,743 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99       145
           1       0.88      0.94      0.91       140
           2       1.00      0.99      1.00       145
           3       0.98      0.97      0.98       149
           4       0.95      0.97      0.96       145
           5       0.86      0.98      0.92       142
           6       0.98      0.97      0.98       143
           7       0.99      0.95      0.97       146
           8       0.97      0.91      0.94       133
           9       0.98      0.87      0.93       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:57:49,745 - trainer - INFO - {
  "train_accuracy_score": 0.9561586638830898,
  "train_loss": 0.1767300281318048
}
2022-10-17 14:57:49,746 - trainer - INFO - start training epoch 85
2022-10-17 14:57:49,746 - trainer - INFO - training using device=cuda
2022-10-17 14:57:49,746 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:49,748 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:49,831 - trainer - INFO - 
*****************[epoch: 85, global step: 1010] eval training set based on eval_every=2***************
2022-10-17 14:57:49,836 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        32
           1       1.00      0.87      0.93        23
           2       1.00      0.97      0.98        32
           3       0.97      0.94      0.95        32
           4       0.94      0.94      0.94        17
           5       0.88      0.97      0.92        30
           6       1.00      1.00      1.00        26
           7       1.00      1.00      1.00        24
           8       0.79      1.00      0.88        19
           9       0.96      0.88      0.92        25

    accuracy                           0.95       260
   macro avg       0.95      0.95      0.95       260
weighted avg       0.96      0.95      0.95       260

2022-10-17 14:57:49,837 - trainer - INFO - {
  "train_accuracy_score": 0.9538461538461539,
  "train_loss": 0.15964613109827042
}
2022-10-17 14:57:50,118 - trainer - INFO - 
*****************[epoch: 85, global step: 1010] eval development set based on eval_every=2***************
2022-10-17 14:57:50,123 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.88      0.93        42
         2.0       0.94      0.97      0.95        32
         3.0       0.97      0.88      0.92        34
         4.0       0.97      1.00      0.99        36
         5.0       0.79      0.82      0.80        40
         6.0       0.97      0.92      0.95        38
         7.0       0.92      1.00      0.96        33
         8.0       0.95      0.95      0.95        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:50,124 - trainer - INFO - {
  "dev_loss": 0.24840241049726805,
  "dev_accuracy": 0.9361111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:50,124 - trainer - INFO -   no_improve_count: 188
2022-10-17 14:57:50,125 - trainer - INFO -   patience: 200
2022-10-17 14:57:50,126 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:50,126 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:50,126 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1004
2022-10-17 14:57:50,127 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1010
2022-10-17 14:57:50,131 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1010
2022-10-17 14:57:50,194 - trainer - INFO - 
*****************[epoch: 85, global step: 1012] eval training set based on eval_every=2***************
2022-10-17 14:57:50,197 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        58
           1       1.00      0.87      0.93        47
           2       1.00      0.97      0.98        58
           3       0.97      0.97      0.97        60
           4       0.98      0.96      0.97        47
           5       0.83      0.94      0.88        51
           6       1.00      1.00      1.00        50
           7       0.98      0.98      0.98        50
           8       0.82      1.00      0.90        40
           9       0.96      0.88      0.92        59

    accuracy                           0.95       520
   macro avg       0.95      0.95      0.95       520
weighted avg       0.96      0.95      0.95       520

2022-10-17 14:57:50,198 - trainer - INFO - {
  "train_accuracy_score": 0.9519230769230769,
  "train_loss": 0.18470782414078712
}
2022-10-17 14:57:50,528 - trainer - INFO - 
*****************[epoch: 85, global step: 1012] eval development set based on eval_every=2***************
2022-10-17 14:57:50,531 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.90      0.94        42
         2.0       0.97      0.97      0.97        32
         3.0       1.00      0.88      0.94        34
         4.0       0.97      0.97      0.97        36
         5.0       0.78      0.88      0.82        40
         6.0       0.97      0.92      0.95        38
         7.0       0.92      1.00      0.96        33
         8.0       0.93      0.95      0.94        41
         9.0       0.94      0.94      0.94        31

    accuracy                           0.94       360
   macro avg       0.94      0.94      0.94       360
weighted avg       0.94      0.94      0.94       360

2022-10-17 14:57:50,531 - trainer - INFO - {
  "dev_loss": 0.22999590945740542,
  "dev_accuracy": 0.9388888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:50,532 - trainer - INFO -   no_improve_count: 189
2022-10-17 14:57:50,532 - trainer - INFO -   patience: 200
2022-10-17 14:57:50,533 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:50,533 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:50,533 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1006
2022-10-17 14:57:50,535 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1012
2022-10-17 14:57:50,539 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1012
2022-10-17 14:57:50,601 - trainer - INFO - 
*****************[epoch: 85, global step: 1014] eval training set based on eval_every=2***************
2022-10-17 14:57:50,606 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.99        78
           1       0.98      0.89      0.94        66
           2       1.00      0.97      0.99        80
           3       0.98      0.96      0.97        84
           4       0.99      0.97      0.98        78
           5       0.86      0.95      0.90        81
           6       1.00      1.00      1.00        79
           7       0.98      0.99      0.98        85
           8       0.86      0.97      0.91        63
           9       0.97      0.91      0.94        86

    accuracy                           0.96       780
   macro avg       0.96      0.96      0.96       780
weighted avg       0.96      0.96      0.96       780

2022-10-17 14:57:50,607 - trainer - INFO - {
  "train_accuracy_score": 0.9602564102564103,
  "train_loss": 0.1113695427775383
}
2022-10-17 14:57:50,880 - trainer - INFO - 
*****************[epoch: 85, global step: 1014] eval development set based on eval_every=2***************
2022-10-17 14:57:50,885 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      0.97      0.98        32
         3.0       0.97      0.91      0.94        34
         4.0       1.00      0.97      0.99        36
         5.0       0.83      0.85      0.84        40
         6.0       0.97      0.95      0.96        38
         7.0       0.92      1.00      0.96        33
         8.0       0.97      0.95      0.96        41
         9.0       0.94      0.97      0.95        31

    accuracy                           0.95       360
   macro avg       0.96      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:57:50,886 - trainer - INFO - {
  "dev_loss": 0.19355633979042372,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:50,887 - trainer - INFO -   no_improve_count: 190
2022-10-17 14:57:50,887 - trainer - INFO -   patience: 200
2022-10-17 14:57:50,888 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:50,889 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:50,889 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1008
2022-10-17 14:57:50,890 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1014
2022-10-17 14:57:50,895 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1014
2022-10-17 14:57:50,959 - trainer - INFO - 
*****************[epoch: 85, global step: 1016] eval training set based on eval_every=2***************
2022-10-17 14:57:50,962 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       104
           1       0.95      0.93      0.94        94
           2       1.00      0.98      0.99       105
           3       0.98      0.94      0.96       111
           4       0.99      0.98      0.99       106
           5       0.86      0.96      0.91       100
           6       1.00      0.98      0.99       102
           7       0.97      0.98      0.98       111
           8       0.89      0.95      0.92        97
           9       0.97      0.93      0.95       110

    accuracy                           0.96      1040
   macro avg       0.96      0.96      0.96      1040
weighted avg       0.96      0.96      0.96      1040

2022-10-17 14:57:50,963 - trainer - INFO - {
  "train_accuracy_score": 0.9605769230769231,
  "train_loss": 0.18571698665618896
}
2022-10-17 14:57:51,238 - trainer - INFO - 
*****************[epoch: 85, global step: 1016] eval development set based on eval_every=2***************
2022-10-17 14:57:51,241 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      1.00      0.99        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.91      0.94        34
         4.0       1.00      0.97      0.99        36
         5.0       0.88      0.88      0.88        40
         6.0       0.97      0.95      0.96        38
         7.0       0.94      1.00      0.97        33
         8.0       0.97      0.95      0.96        41
         9.0       0.94      1.00      0.97        31

    accuracy                           0.96       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:51,242 - trainer - INFO - {
  "dev_loss": 0.13622277912994227,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:51,242 - trainer - INFO -   no_improve_count: 191
2022-10-17 14:57:51,242 - trainer - INFO -   patience: 200
2022-10-17 14:57:51,243 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:51,244 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:51,244 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1010
2022-10-17 14:57:51,245 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1016
2022-10-17 14:57:51,249 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1016
2022-10-17 14:57:51,314 - trainer - INFO - 
*****************[epoch: 85, global step: 1018] eval training set based on eval_every=2***************
2022-10-17 14:57:51,319 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.98      0.99       128
           1       0.91      0.94      0.92       124
           2       1.00      0.98      0.99       130
           3       0.98      0.95      0.97       133
           4       0.99      0.98      0.99       135
           5       0.86      0.96      0.91       122
           6       1.00      0.98      0.99       133
           7       0.98      0.99      0.98       136
           8       0.90      0.95      0.92       122
           9       0.98      0.90      0.94       137

    accuracy                           0.96      1300
   macro avg       0.96      0.96      0.96      1300
weighted avg       0.96      0.96      0.96      1300

2022-10-17 14:57:51,320 - trainer - INFO - {
  "train_accuracy_score": 0.96,
  "train_loss": 0.19621525332331657
}
2022-10-17 14:57:51,644 - trainer - INFO - 
*****************[epoch: 85, global step: 1018] eval development set based on eval_every=2***************
2022-10-17 14:57:51,647 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.97      0.93      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.94      0.97        36
         5.0       0.90      0.90      0.90        40
         6.0       0.95      0.97      0.96        38
         7.0       1.00      1.00      1.00        33
         8.0       0.95      0.95      0.95        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.96       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:51,648 - trainer - INFO - {
  "dev_loss": 0.13134380957732597,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:51,648 - trainer - INFO -   no_improve_count: 192
2022-10-17 14:57:51,648 - trainer - INFO -   patience: 200
2022-10-17 14:57:51,649 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:51,650 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:51,650 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1012
2022-10-17 14:57:51,651 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1018
2022-10-17 14:57:51,659 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1018
2022-10-17 14:57:51,713 - trainer - INFO - 
*****************[epoch: 85, global step: 1020] eval training set based on eval_every=2***************
2022-10-17 14:57:51,718 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.92      0.94      0.93       140
           2       1.00      0.98      0.99       145
           3       0.98      0.95      0.96       149
           4       0.99      0.98      0.99       145
           5       0.86      0.96      0.91       142
           6       1.00      0.97      0.99       143
           7       0.98      0.99      0.98       146
           8       0.89      0.95      0.92       133
           9       0.98      0.90      0.94       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:57:51,720 - trainer - INFO - {
  "train_accuracy_score": 0.9589422407794015,
  "train_loss": 0.12412867788225412
}
2022-10-17 14:57:51,993 - trainer - INFO - 
*****************[epoch: 85, global step: 1020] eval development set based on eval_every=2***************
2022-10-17 14:57:51,996 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.90      0.95        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.92      0.96        36
         5.0       0.88      0.90      0.89        40
         6.0       0.93      0.97      0.95        38
         7.0       1.00      1.00      1.00        33
         8.0       0.95      0.98      0.96        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:51,997 - trainer - INFO - {
  "dev_loss": 0.1550590650488933,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:51,998 - trainer - INFO -   no_improve_count: 193
2022-10-17 14:57:51,998 - trainer - INFO -   patience: 200
2022-10-17 14:57:51,999 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:51,999 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:52,000 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1014
2022-10-17 14:57:52,001 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1020
2022-10-17 14:57:52,005 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1020
2022-10-17 14:57:52,006 - trainer - INFO - 
*****************[epoch: 85, global step: 1021] eval training set at end of epoch***************
2022-10-17 14:57:52,012 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.92      0.94      0.93       140
           2       1.00      0.98      0.99       145
           3       0.98      0.95      0.96       149
           4       0.99      0.98      0.99       145
           5       0.86      0.96      0.91       142
           6       1.00      0.97      0.99       143
           7       0.98      0.99      0.98       146
           8       0.89      0.95      0.92       133
           9       0.98      0.90      0.94       149

    accuracy                           0.96      1437
   macro avg       0.96      0.96      0.96      1437
weighted avg       0.96      0.96      0.96      1437

2022-10-17 14:57:52,015 - trainer - INFO - {
  "train_accuracy_score": 0.9589422407794015,
  "train_loss": 0.16029740264639258
}
2022-10-17 14:57:52,016 - trainer - INFO - start training epoch 86
2022-10-17 14:57:52,016 - trainer - INFO - training using device=cuda
2022-10-17 14:57:52,016 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:52,017 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:52,076 - trainer - INFO - 
*****************[epoch: 86, global step: 1022] eval training set based on eval_every=2***************
2022-10-17 14:57:52,078 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        22
           1       1.00      0.93      0.96        27
           2       1.00      1.00      1.00        26
           3       0.96      0.96      0.96        23
           4       1.00      0.96      0.98        25
           5       0.88      0.97      0.92        31
           6       1.00      0.96      0.98        25
           7       1.00      0.97      0.98        29
           8       0.90      0.96      0.93        27
           9       0.92      0.92      0.92        25

    accuracy                           0.96       260
   macro avg       0.97      0.96      0.96       260
weighted avg       0.96      0.96      0.96       260

2022-10-17 14:57:52,079 - trainer - INFO - {
  "train_accuracy_score": 0.9615384615384616,
  "train_loss": 0.1328815370798111
}
2022-10-17 14:57:52,352 - trainer - INFO - 
*****************[epoch: 86, global step: 1022] eval development set based on eval_every=2***************
2022-10-17 14:57:52,355 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.88      0.94        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.92      0.96        36
         5.0       0.83      0.85      0.84        40
         6.0       0.93      1.00      0.96        38
         7.0       0.97      1.00      0.99        33
         8.0       0.97      0.95      0.96        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.95       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.95      0.95       360

2022-10-17 14:57:52,357 - trainer - INFO - {
  "dev_loss": 0.19412130117416382,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:52,357 - trainer - INFO -   no_improve_count: 194
2022-10-17 14:57:52,358 - trainer - INFO -   patience: 200
2022-10-17 14:57:52,359 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:52,359 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:52,359 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1016
2022-10-17 14:57:52,360 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1022
2022-10-17 14:57:52,365 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1022
2022-10-17 14:57:52,425 - trainer - INFO - 
*****************[epoch: 86, global step: 1024] eval training set based on eval_every=2***************
2022-10-17 14:57:52,428 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      1.00      1.00        49
           1       1.00      0.88      0.93        49
           2       1.00      1.00      1.00        57
           3       0.98      0.98      0.98        49
           4       0.98      0.96      0.97        46
           5       0.91      0.95      0.93        55
           6       0.98      0.96      0.97        54
           7       1.00      0.98      0.99        57
           8       0.88      0.96      0.92        48
           9       0.92      0.96      0.94        56

    accuracy                           0.96       520
   macro avg       0.97      0.96      0.96       520
weighted avg       0.97      0.96      0.96       520

2022-10-17 14:57:52,429 - trainer - INFO - {
  "train_accuracy_score": 0.9634615384615385,
  "train_loss": 0.13460633531212807
}
2022-10-17 14:57:52,740 - trainer - INFO - 
*****************[epoch: 86, global step: 1024] eval development set based on eval_every=2***************
2022-10-17 14:57:52,744 - trainer - INFO -               precision    recall  f1-score   support

         0.0       0.97      1.00      0.99        33
         1.0       0.98      0.95      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.91      0.95        34
         4.0       1.00      1.00      1.00        36
         5.0       0.90      0.90      0.90        40
         6.0       0.97      1.00      0.99        38
         7.0       0.92      1.00      0.96        33
         8.0       1.00      0.93      0.96        41
         9.0       0.91      0.97      0.94        31

    accuracy                           0.96       360
   macro avg       0.96      0.97      0.96       360
weighted avg       0.97      0.96      0.96       360

2022-10-17 14:57:52,745 - trainer - INFO - {
  "dev_loss": 0.15879462038477263,
  "dev_accuracy": 0.9638888888888889,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:52,746 - trainer - INFO -   no_improve_count: 195
2022-10-17 14:57:52,746 - trainer - INFO -   patience: 200
2022-10-17 14:57:52,747 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:52,748 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:52,748 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1018
2022-10-17 14:57:52,749 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1024
2022-10-17 14:57:52,754 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1024
2022-10-17 14:57:52,814 - trainer - INFO - 
*****************[epoch: 86, global step: 1026] eval training set based on eval_every=2***************
2022-10-17 14:57:52,819 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      0.99        81
           1       0.99      0.90      0.94        78
           2       0.99      1.00      0.99        81
           3       0.99      0.96      0.98        82
           4       0.99      0.97      0.98        71
           5       0.89      0.96      0.93        79
           6       0.99      0.97      0.98        79
           7       1.00      0.97      0.99        80
           8       0.92      0.94      0.93        72
           9       0.93      0.96      0.94        77

    accuracy                           0.97       780
   macro avg       0.97      0.96      0.97       780
weighted avg       0.97      0.97      0.97       780

2022-10-17 14:57:52,820 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.12268070504069328
}
2022-10-17 14:57:53,097 - trainer - INFO - 
*****************[epoch: 86, global step: 1026] eval development set based on eval_every=2***************
2022-10-17 14:57:53,101 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       1.00      0.91      0.95        34
         4.0       0.97      1.00      0.99        36
         5.0       0.97      0.88      0.92        40
         6.0       0.97      1.00      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       0.95      0.93      0.94        41
         9.0       0.91      1.00      0.95        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:53,102 - trainer - INFO - {
  "dev_loss": 0.16630865136782327,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:53,102 - trainer - INFO -   no_improve_count: 196
2022-10-17 14:57:53,103 - trainer - INFO -   patience: 200
2022-10-17 14:57:53,104 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:53,104 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:53,104 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1020
2022-10-17 14:57:53,105 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1026
2022-10-17 14:57:53,111 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1026
2022-10-17 14:57:53,169 - trainer - INFO - 
*****************[epoch: 86, global step: 1028] eval training set based on eval_every=2***************
2022-10-17 14:57:53,173 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       107
           1       0.96      0.93      0.94       107
           2       0.99      0.99      0.99       106
           3       0.99      0.96      0.98       104
           4       0.99      0.96      0.98       107
           5       0.88      0.97      0.92       101
           6       0.99      0.98      0.98        97
           7       1.00      0.98      0.99       109
           8       0.93      0.94      0.94       101
           9       0.93      0.94      0.94       101

    accuracy                           0.97      1040
   macro avg       0.97      0.97      0.97      1040
weighted avg       0.97      0.97      0.97      1040

2022-10-17 14:57:53,174 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.1167893074452877
}
2022-10-17 14:57:53,451 - trainer - INFO - 
*****************[epoch: 86, global step: 1028] eval development set based on eval_every=2***************
2022-10-17 14:57:53,455 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.97      0.98        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.91      0.94        34
         4.0       0.97      1.00      0.99        36
         5.0       0.89      0.82      0.86        40
         6.0       0.97      1.00      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       0.95      0.88      0.91        41
         9.0       0.89      1.00      0.94        31

    accuracy                           0.95       360
   macro avg       0.95      0.96      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:57:53,456 - trainer - INFO - {
  "dev_loss": 0.21371237436930338,
  "dev_accuracy": 0.9527777777777777,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:53,457 - trainer - INFO -   no_improve_count: 197
2022-10-17 14:57:53,457 - trainer - INFO -   patience: 200
2022-10-17 14:57:53,459 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:53,459 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:53,459 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1022
2022-10-17 14:57:53,460 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1028
2022-10-17 14:57:53,465 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1028
2022-10-17 14:57:53,527 - trainer - INFO - 
*****************[epoch: 86, global step: 1030] eval training set based on eval_every=2***************
2022-10-17 14:57:53,531 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      1.00      1.00       133
           1       0.95      0.92      0.94       127
           2       0.99      0.99      0.99       132
           3       0.99      0.95      0.97       132
           4       0.99      0.97      0.98       131
           5       0.88      0.97      0.92       125
           6       0.98      0.98      0.98       131
           7       1.00      0.99      0.99       134
           8       0.94      0.93      0.94       123
           9       0.93      0.95      0.94       132

    accuracy                           0.97      1300
   macro avg       0.97      0.96      0.97      1300
weighted avg       0.97      0.97      0.97      1300

2022-10-17 14:57:53,532 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.10620327107608318
}
2022-10-17 14:57:53,803 - trainer - INFO - 
*****************[epoch: 86, global step: 1030] eval development set based on eval_every=2***************
2022-10-17 14:57:53,806 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      0.88      0.94        33
         1.0       0.95      0.98      0.96        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.94      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.80      0.82      0.81        40
         6.0       0.97      1.00      0.99        38
         7.0       0.94      1.00      0.97        33
         8.0       1.00      0.88      0.94        41
         9.0       0.86      1.00      0.93        31

    accuracy                           0.95       360
   macro avg       0.95      0.95      0.95       360
weighted avg       0.95      0.95      0.95       360

2022-10-17 14:57:53,807 - trainer - INFO - {
  "dev_loss": 0.23060311873753866,
  "dev_accuracy": 0.9472222222222222,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:53,808 - trainer - INFO -   no_improve_count: 198
2022-10-17 14:57:53,809 - trainer - INFO -   patience: 200
2022-10-17 14:57:53,810 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:53,810 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:53,810 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1024
2022-10-17 14:57:53,811 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1030
2022-10-17 14:57:53,815 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1030
2022-10-17 14:57:53,906 - trainer - INFO - 
*****************[epoch: 86, global step: 1032] eval training set based on eval_every=2***************
2022-10-17 14:57:53,910 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.96      0.93      0.94       140
           2       0.99      0.99      0.99       145
           3       0.99      0.96      0.97       149
           4       0.99      0.97      0.98       145
           5       0.88      0.96      0.92       142
           6       0.99      0.98      0.98       143
           7       0.99      0.99      0.99       146
           8       0.95      0.94      0.94       133
           9       0.94      0.95      0.95       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:57:53,911 - trainer - INFO - {
  "train_accuracy_score": 0.9665970772442589,
  "train_loss": 0.057327295653522015
}
2022-10-17 14:57:54,177 - trainer - INFO - 
*****************[epoch: 86, global step: 1032] eval development set based on eval_every=2***************
2022-10-17 14:57:54,180 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       1.00      0.95      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.94      0.96        34
         4.0       1.00      1.00      1.00        36
         5.0       0.89      0.85      0.87        40
         6.0       0.97      0.97      0.97        38
         7.0       0.97      1.00      0.99        33
         8.0       0.97      0.93      0.95        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.96       360
   macro avg       0.96      0.96      0.96       360
weighted avg       0.96      0.96      0.96       360

2022-10-17 14:57:54,185 - trainer - INFO - {
  "dev_loss": 0.199176254371802,
  "dev_accuracy": 0.9611111111111111,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:54,185 - trainer - INFO -   no_improve_count: 199
2022-10-17 14:57:54,186 - trainer - INFO -   patience: 200
2022-10-17 14:57:54,187 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:54,187 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:54,187 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1026
2022-10-17 14:57:54,188 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1032
2022-10-17 14:57:54,193 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1032
2022-10-17 14:57:54,194 - trainer - INFO - 
*****************[epoch: 86, global step: 1033] eval training set at end of epoch***************
2022-10-17 14:57:54,199 - trainer - INFO -               precision    recall  f1-score   support

           0       0.99      0.99      0.99       145
           1       0.96      0.93      0.94       140
           2       0.99      0.99      0.99       145
           3       0.99      0.96      0.97       149
           4       0.99      0.97      0.98       145
           5       0.88      0.96      0.92       142
           6       0.99      0.98      0.98       143
           7       0.99      0.99      0.99       146
           8       0.95      0.94      0.94       133
           9       0.94      0.95      0.95       149

    accuracy                           0.97      1437
   macro avg       0.97      0.97      0.97      1437
weighted avg       0.97      0.97      0.97      1437

2022-10-17 14:57:54,201 - trainer - INFO - {
  "train_accuracy_score": 0.9665970772442589,
  "train_loss": 0.1117480752679209
}
2022-10-17 14:57:54,202 - trainer - INFO - start training epoch 87
2022-10-17 14:57:54,202 - trainer - INFO - training using device=cuda
2022-10-17 14:57:54,203 - trainer - INFO - 
*************hyperparam_dict**********

2022-10-17 14:57:54,203 - trainer - INFO - {
  "train_epochs": 100,
  "eval_batch_size": 64,
  "train_batch_size": 130,
  "no_improve_count": 0,
  "device": "cuda",
  "patience": 200,
  "save_path": "tmp/mlp_digits",
  "eval_on": "accuracy",
  "eval_every": 2,
  "use_wandb": false,
  "loss_fn": "ce",
  "keep_ck_num": 3,
  "lr": 0.03
}
2022-10-17 14:57:54,265 - trainer - INFO - 
*****************[epoch: 87, global step: 1034] eval training set based on eval_every=2***************
2022-10-17 14:57:54,268 - trainer - INFO -               precision    recall  f1-score   support

           0       1.00      0.97      0.98        32
           1       1.00      0.91      0.95        23
           2       1.00      0.90      0.95        20
           3       0.86      1.00      0.92        18
           4       1.00      0.96      0.98        24
           5       0.96      0.93      0.95        29
           6       1.00      1.00      1.00        32
           7       1.00      1.00      1.00        26
           8       0.96      0.96      0.96        23
           9       0.89      1.00      0.94        33

    accuracy                           0.97       260
   macro avg       0.97      0.96      0.96       260
weighted avg       0.97      0.97      0.97       260

2022-10-17 14:57:54,269 - trainer - INFO - {
  "train_accuracy_score": 0.9653846153846154,
  "train_loss": 0.12266289815306664
}
2022-10-17 14:57:54,538 - trainer - INFO - 
*****************[epoch: 87, global step: 1034] eval development set based on eval_every=2***************
2022-10-17 14:57:54,541 - trainer - INFO -               precision    recall  f1-score   support

         0.0       1.00      1.00      1.00        33
         1.0       0.98      0.98      0.98        42
         2.0       1.00      1.00      1.00        32
         3.0       0.97      0.97      0.97        34
         4.0       1.00      0.97      0.99        36
         5.0       0.95      0.88      0.91        40
         6.0       0.97      0.97      0.97        38
         7.0       1.00      1.00      1.00        33
         8.0       0.97      0.93      0.95        41
         9.0       0.84      1.00      0.91        31

    accuracy                           0.97       360
   macro avg       0.97      0.97      0.97       360
weighted avg       0.97      0.97      0.97       360

2022-10-17 14:57:54,542 - trainer - INFO - {
  "dev_loss": 0.16722028950850168,
  "dev_accuracy": 0.9666666666666667,
  "dev_best_score_for_accuracy": 0.9888888888888889
}
2022-10-17 14:57:54,543 - trainer - INFO -   no_improve_count: 200
2022-10-17 14:57:54,543 - trainer - INFO -   patience: 200
2022-10-17 14:57:54,544 - trainer - INFO -   run out of patience=200 and save model before exit
2022-10-17 14:57:54,544 - trainer - INFO -    Check 3 checkpoints already saved
2022-10-17 14:57:54,545 - trainer - INFO -    There are more than keep_ck_num as specified, then remove the oldest saved checkpoint
2022-10-17 14:57:54,545 - trainer - INFO -   Remove checkpoint tmp/mlp_digits\ck_1028
2022-10-17 14:57:54,546 - trainer - INFO -   Save checkpoint to tmp/mlp_digits\ck_1034
2022-10-17 14:57:54,549 - trainer - INFO - save model to path: tmp/mlp_digits\ck_1034
